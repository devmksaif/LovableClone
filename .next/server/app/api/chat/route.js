"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:async_hooks":
/*!***********************************!*\
  !*** external "node:async_hooks" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:async_hooks");

/***/ }),

/***/ "node:child_process":
/*!*************************************!*\
  !*** external "node:child_process" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("node:child_process");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:events");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:module":
/*!******************************!*\
  !*** external "node:module" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:module");

/***/ }),

/***/ "node:os":
/*!**************************!*\
  !*** external "node:os" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:os");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "node:process":
/*!*******************************!*\
  !*** external "node:process" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("node:process");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:url");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:util");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_Apple_Desktop_NextLovable_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/Apple/Desktop/NextLovable/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_Apple_Desktop_NextLovable_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjVfQHBsYXl3cmlnaHQrdGVzdEAxLjU2LjFfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjFfX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRkFwcGxlJTJGRGVza3RvcCUyRk5leHRMb3ZhYmxlJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRkFwcGxlJTJGRGVza3RvcCUyRk5leHRMb3ZhYmxlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNNO0FBQ25GO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvP2ZkZmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL0FwcGxlL0Rlc2t0b3AvTmV4dExvdmFibGUvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9BcHBsZS9EZXNrdG9wL05leHRMb3ZhYmxlL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/agents/agent-core */ \"(rsc)/./lib/agents/agent-core.ts\");\n/* harmony import */ var _lib_agents_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/agents/utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _lib_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/utils/memory-db */ \"(rsc)/./lib/utils/memory-db.ts\");\n/* harmony import */ var _lib_db_database__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/db/database */ \"(rsc)/./lib/db/database.ts\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _lib_utils_project_embeddings__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/utils/project-embeddings */ \"(rsc)/./lib/utils/project-embeddings.ts\");\n\n\n\n\n\n\n\n// Store for ongoing streams\nconst activeStreams = new Map();\nasync function POST(request) {\n    const encoder = new TextEncoder();\n    const stream = new ReadableStream({\n        async start (controller) {\n            try {\n                const { userRequest, sessionId, model } = await request.json();\n                if (!userRequest) {\n                    controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                        error: \"userRequest is required\"\n                    })}\\n\\n`));\n                    controller.close();\n                    return;\n                }\n                if (sessionId) {\n                    activeStreams.set(sessionId, {\n                        controller,\n                        isComplete: false\n                    });\n                    // Set the emit function for this session\n                    (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.setEmitFunction)(emitStreamEvent);\n                }\n                console.log(\"\\uD83D\\uDE80 Starting agent generation for request:\", userRequest);\n                // Initialize session memory and create project folder\n                (0,_lib_agents_utils__WEBPACK_IMPORTED_MODULE_1__.setSessionMemory)(sessionId || \"default\");\n                const projectFolder = (0,_lib_agents_utils__WEBPACK_IMPORTED_MODULE_1__.getProjectFolder)();\n                // Ensure session exists in database before adding messages\n                await (0,_lib_db_database__WEBPACK_IMPORTED_MODULE_3__.getOrCreateSession)(sessionId || \"default\", projectFolder);\n                const memory = (0,_lib_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__.getSessionMemory)(sessionId || \"default\", projectFolder);\n                console.log(\"\\uD83D\\uDCC1 Project folder:\", projectFolder);\n                // Save user message to database\n                await (0,_lib_db_database__WEBPACK_IMPORTED_MODULE_3__.addConversation)(sessionId, \"user\", userRequest);\n                // Add user message to memory\n                await memory.addMessage(\"user\", userRequest);\n                // Get conversation context for the agent\n                const contextSummary = await memory.getContextSummary();\n                console.log(\"\\uD83D\\uDCAD Context from memory:\", contextSummary ? \"Available\" : \"None\");\n                // Create the streaming agent graph with context\n                const graph = (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.createStreamingLovableAgentGraph)(sessionId, model);\n                // Run the agent workflow with context\n                const result = await graph.invoke({\n                    userRequest: contextSummary ? `${contextSummary}\\n\\nNew request: ${userRequest}` : userRequest,\n                    messages: [\n                        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.HumanMessage(contextSummary ? `${contextSummary}\\n\\n${userRequest}` : userRequest)\n                    ]\n                });\n                console.log(\"\\n✅ Generation complete!\");\n                // Extract chain of thought from messages\n                const chainOfThought = [];\n                result.messages.forEach((message, index)=>{\n                    if (message.content.toString().includes(\"Chain of Thought:\")) {\n                        const cotMatch = message.content.toString().match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Files:|FILENAME:|$)/i);\n                        if (cotMatch) {\n                            chainOfThought.push(`Step ${Math.floor(index / 2) + 1}: ${cotMatch[1].trim()}`);\n                        }\n                    }\n                });\n                // Save generated files and track in memory\n                if (Object.keys(result.generatedFiles).length > 0) {\n                    (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.saveGeneratedFiles)(result.generatedFiles);\n                    // Track file operations in memory\n                    for (const filename of Object.keys(result.generatedFiles)){\n                        await memory.addFileOperation(\"created\", path__WEBPACK_IMPORTED_MODULE_5__.join(projectFolder, filename));\n                    }\n                    // Embed the project files in ChromaDB for future semantic search\n                    try {\n                        console.log(\"\\uD83D\\uDCE5 Embedding project files in ChromaDB...\");\n                        await (0,_lib_utils_project_embeddings__WEBPACK_IMPORTED_MODULE_6__.embedProject)(sessionId || \"default\", projectFolder);\n                        console.log(\"✅ Project files embedded successfully\");\n                    } catch (embedError) {\n                        console.warn(\"⚠️ Failed to embed project files:\", embedError);\n                    // Don't fail the request if embedding fails\n                    }\n                }\n                // Get tool call statistics\n                const toolStats = (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.getToolCallSummary)();\n                console.log(\"\\n\" + toolStats);\n                const response = {\n                    success: true,\n                    plan: result.plan,\n                    generatedFiles: Object.keys(result.generatedFiles),\n                    projectFolder: projectFolder,\n                    chainOfThought,\n                    reviewFeedback: result.reviewFeedback,\n                    isComplete: result.isComplete,\n                    toolStats: toolStats,\n                    type: \"complete\"\n                };\n                // Add AI response to memory (summarized)\n                const aiSummary = `Generated ${Object.keys(result.generatedFiles).length} files following ${result.plan?.length || 0} steps. ${result.reviewFeedback || \"\"}`;\n                // Save AI response to database\n                await (0,_lib_db_database__WEBPACK_IMPORTED_MODULE_3__.addConversation)(sessionId, \"assistant\", aiSummary);\n                await memory.addMessage(\"assistant\", aiSummary);\n                controller.enqueue(encoder.encode(`data: ${JSON.stringify(response)}\\n\\n`));\n                controller.close();\n                // Clear tool logs for next request\n                (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.clearToolCallLogs)();\n                if (sessionId) {\n                    const streamData = activeStreams.get(sessionId);\n                    if (streamData) {\n                        streamData.isComplete = true;\n                        activeStreams.delete(sessionId);\n                    }\n                }\n            } catch (error) {\n                console.error(\"Error:\", error);\n                controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                    error: \"Failed to process request\",\n                    details: error instanceof Error ? error.message : String(error),\n                    type: \"error\"\n                })}\\n\\n`));\n                controller.close();\n            }\n        }\n    });\n    return new Response(stream, {\n        headers: {\n            \"Content-Type\": \"text/event-stream\",\n            \"Cache-Control\": \"no-cache\",\n            \"Connection\": \"keep-alive\"\n        }\n    });\n}\n// Function to emit streaming events\nfunction emitStreamEvent(sessionId, data) {\n    const streamData = activeStreams.get(sessionId);\n    if (streamData && !streamData.isComplete) {\n        const encoder = new TextEncoder();\n        streamData.controller.enqueue(encoder.encode(`data: ${JSON.stringify(data)}\\n\\n`));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM7SUFDbEY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGNyZWF0ZVN0cmVhbWluZ0xvdmFibGVBZ2VudEdyYXBoLCBzYXZlR2VuZXJhdGVkRmlsZXMsIHNldEVtaXRGdW5jdGlvbiwgZ2V0VG9vbENhbGxTdW1tYXJ5LCBjbGVhclRvb2xDYWxsTG9ncyB9IGZyb20gJy4uLy4uLy4uL2xpYi9hZ2VudHMvYWdlbnQtY29yZSc7XG5pbXBvcnQgeyBzZXRTZXNzaW9uTWVtb3J5LCBnZXRQcm9qZWN0Rm9sZGVyIH0gZnJvbSAnLi4vLi4vLi4vbGliL2FnZW50cy91dGlscyc7XG5pbXBvcnQgeyBnZXRTZXNzaW9uTWVtb3J5IH0gZnJvbSAnLi4vLi4vLi4vbGliL3V0aWxzL21lbW9yeS1kYic7XG5pbXBvcnQgeyBnZXRPckNyZWF0ZVNlc3Npb24sIGFkZENvbnZlcnNhdGlvbiB9IGZyb20gJy4uLy4uLy4uL2xpYi9kYi9kYXRhYmFzZSc7XG5pbXBvcnQgeyBIdW1hbk1lc3NhZ2UgfSBmcm9tICdAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGVtYmVkUHJvamVjdCB9IGZyb20gJy4uLy4uLy4uL2xpYi91dGlscy9wcm9qZWN0LWVtYmVkZGluZ3MnO1xuXG4vLyBTdG9yZSBmb3Igb25nb2luZyBzdHJlYW1zXG5jb25zdCBhY3RpdmVTdHJlYW1zID0gbmV3IE1hcCgpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgYXN5bmMgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyB1c2VyUmVxdWVzdCwgc2Vzc2lvbklkLCBtb2RlbCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICAgICAgaWYgKCF1c2VyUmVxdWVzdCkge1xuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAndXNlclJlcXVlc3QgaXMgcmVxdWlyZWQnIH0pfVxcblxcbmApKTtcbiAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgICAgIGFjdGl2ZVN0cmVhbXMuc2V0KHNlc3Npb25JZCwgeyBjb250cm9sbGVyLCBpc0NvbXBsZXRlOiBmYWxzZSB9KTtcbiAgICAgICAgICAvLyBTZXQgdGhlIGVtaXQgZnVuY3Rpb24gZm9yIHRoaXMgc2Vzc2lvblxuICAgICAgICAgIHNldEVtaXRGdW5jdGlvbihlbWl0U3RyZWFtRXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ/CfmoAgU3RhcnRpbmcgYWdlbnQgZ2VuZXJhdGlvbiBmb3IgcmVxdWVzdDonLCB1c2VyUmVxdWVzdCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBzZXNzaW9uIG1lbW9yeSBhbmQgY3JlYXRlIHByb2plY3QgZm9sZGVyXG4gICAgICAgIHNldFNlc3Npb25NZW1vcnkoc2Vzc2lvbklkIHx8ICdkZWZhdWx0Jyk7XG4gICAgICAgIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFbnN1cmUgc2Vzc2lvbiBleGlzdHMgaW4gZGF0YWJhc2UgYmVmb3JlIGFkZGluZyBtZXNzYWdlc1xuICAgICAgICBhd2FpdCBnZXRPckNyZWF0ZVNlc3Npb24oc2Vzc2lvbklkIHx8ICdkZWZhdWx0JywgcHJvamVjdEZvbGRlcik7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KHNlc3Npb25JZCB8fCAnZGVmYXVsdCcsIHByb2plY3RGb2xkZXIpO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4EgUHJvamVjdCBmb2xkZXI6JywgcHJvamVjdEZvbGRlcik7XG5cbiAgICAgICAgLy8gU2F2ZSB1c2VyIG1lc3NhZ2UgdG8gZGF0YWJhc2VcbiAgICAgICAgYXdhaXQgYWRkQ29udmVyc2F0aW9uKHNlc3Npb25JZCwgJ3VzZXInLCB1c2VyUmVxdWVzdCk7XG5cbiAgICAgICAgLy8gQWRkIHVzZXIgbWVzc2FnZSB0byBtZW1vcnlcbiAgICAgICAgYXdhaXQgbWVtb3J5LmFkZE1lc3NhZ2UoJ3VzZXInLCB1c2VyUmVxdWVzdCk7XG5cbiAgICAgICAgLy8gR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciB0aGUgYWdlbnRcbiAgICAgICAgY29uc3QgY29udGV4dFN1bW1hcnkgPSBhd2FpdCBtZW1vcnkuZ2V0Q29udGV4dFN1bW1hcnkoKTtcblxuICAgICAgICBjb25zb2xlLmxvZygn8J+SrSBDb250ZXh0IGZyb20gbWVtb3J5OicsIGNvbnRleHRTdW1tYXJ5ID8gJ0F2YWlsYWJsZScgOiAnTm9uZScpO1xuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgc3RyZWFtaW5nIGFnZW50IGdyYXBoIHdpdGggY29udGV4dFxuICAgICAgICBjb25zdCBncmFwaCA9IGNyZWF0ZVN0cmVhbWluZ0xvdmFibGVBZ2VudEdyYXBoKHNlc3Npb25JZCwgbW9kZWwpO1xuXG4gICAgICAgIC8vIFJ1biB0aGUgYWdlbnQgd29ya2Zsb3cgd2l0aCBjb250ZXh0XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdyYXBoLmludm9rZSh7XG4gICAgICAgICAgdXNlclJlcXVlc3Q6IGNvbnRleHRTdW1tYXJ5ID8gYCR7Y29udGV4dFN1bW1hcnl9XFxuXFxuTmV3IHJlcXVlc3Q6ICR7dXNlclJlcXVlc3R9YCA6IHVzZXJSZXF1ZXN0LFxuICAgICAgICAgIG1lc3NhZ2VzOiBbbmV3IEh1bWFuTWVzc2FnZShjb250ZXh0U3VtbWFyeSA/IGAke2NvbnRleHRTdW1tYXJ5fVxcblxcbiR7dXNlclJlcXVlc3R9YCA6IHVzZXJSZXF1ZXN0KV0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdcXG7inIUgR2VuZXJhdGlvbiBjb21wbGV0ZSEnKTtcblxuICAgICAgICAvLyBFeHRyYWN0IGNoYWluIG9mIHRob3VnaHQgZnJvbSBtZXNzYWdlc1xuICAgICAgICBjb25zdCBjaGFpbk9mVGhvdWdodDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgcmVzdWx0Lm1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKG1lc3NhZ2UuY29udGVudC50b1N0cmluZygpLmluY2x1ZGVzKCdDaGFpbiBvZiBUaG91Z2h0OicpKSB7XG4gICAgICAgICAgICBjb25zdCBjb3RNYXRjaCA9IG1lc3NhZ2UuY29udGVudC50b1N0cmluZygpLm1hdGNoKC9DaGFpbiBvZiBUaG91Z2h0OlxccyooW1xcc1xcU10qPykoPz1GaWxlczp8RklMRU5BTUU6fCQpL2kpO1xuICAgICAgICAgICAgaWYgKGNvdE1hdGNoKSB7XG4gICAgICAgICAgICAgIGNoYWluT2ZUaG91Z2h0LnB1c2goYFN0ZXAgJHtNYXRoLmZsb29yKGluZGV4IC8gMikgKyAxfTogJHtjb3RNYXRjaFsxXS50cmltKCl9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTYXZlIGdlbmVyYXRlZCBmaWxlcyBhbmQgdHJhY2sgaW4gbWVtb3J5XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhyZXN1bHQuZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzYXZlR2VuZXJhdGVkRmlsZXMocmVzdWx0LmdlbmVyYXRlZEZpbGVzKTtcblxuICAgICAgICAgIC8vIFRyYWNrIGZpbGUgb3BlcmF0aW9ucyBpbiBtZW1vcnlcbiAgICAgICAgICBmb3IgKGNvbnN0IGZpbGVuYW1lIG9mIE9iamVjdC5rZXlzKHJlc3VsdC5nZW5lcmF0ZWRGaWxlcykpIHtcbiAgICAgICAgICAgIGF3YWl0IG1lbW9yeS5hZGRGaWxlT3BlcmF0aW9uKCdjcmVhdGVkJywgcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVuYW1lKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRW1iZWQgdGhlIHByb2plY3QgZmlsZXMgaW4gQ2hyb21hREIgZm9yIGZ1dHVyZSBzZW1hbnRpYyBzZWFyY2hcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ/Cfk6UgRW1iZWRkaW5nIHByb2plY3QgZmlsZXMgaW4gQ2hyb21hREIuLi4nKTtcbiAgICAgICAgICAgIGF3YWl0IGVtYmVkUHJvamVjdChzZXNzaW9uSWQgfHwgJ2RlZmF1bHQnLCBwcm9qZWN0Rm9sZGVyKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgUHJvamVjdCBmaWxlcyBlbWJlZGRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgICB9IGNhdGNoIChlbWJlZEVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBGYWlsZWQgdG8gZW1iZWQgcHJvamVjdCBmaWxlczonLCBlbWJlZEVycm9yKTtcbiAgICAgICAgICAgIC8vIERvbid0IGZhaWwgdGhlIHJlcXVlc3QgaWYgZW1iZWRkaW5nIGZhaWxzXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IHRvb2wgY2FsbCBzdGF0aXN0aWNzXG4gICAgICAgIGNvbnN0IHRvb2xTdGF0cyA9IGdldFRvb2xDYWxsU3VtbWFyeSgpO1xuICAgICAgICBjb25zb2xlLmxvZygnXFxuJyArIHRvb2xTdGF0cyk7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBwbGFuOiByZXN1bHQucGxhbixcbiAgICAgICAgICBnZW5lcmF0ZWRGaWxlczogT2JqZWN0LmtleXMocmVzdWx0LmdlbmVyYXRlZEZpbGVzKSxcbiAgICAgICAgICBwcm9qZWN0Rm9sZGVyOiBwcm9qZWN0Rm9sZGVyLFxuICAgICAgICAgIGNoYWluT2ZUaG91Z2h0LFxuICAgICAgICAgIHJldmlld0ZlZWRiYWNrOiByZXN1bHQucmV2aWV3RmVlZGJhY2ssXG4gICAgICAgICAgaXNDb21wbGV0ZTogcmVzdWx0LmlzQ29tcGxldGUsXG4gICAgICAgICAgdG9vbFN0YXRzOiB0b29sU3RhdHMsXG4gICAgICAgICAgdHlwZTogJ2NvbXBsZXRlJ1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFkZCBBSSByZXNwb25zZSB0byBtZW1vcnkgKHN1bW1hcml6ZWQpXG4gICAgICAgIGNvbnN0IGFpU3VtbWFyeSA9IGBHZW5lcmF0ZWQgJHtPYmplY3Qua2V5cyhyZXN1bHQuZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aH0gZmlsZXMgZm9sbG93aW5nICR7cmVzdWx0LnBsYW4/Lmxlbmd0aCB8fCAwfSBzdGVwcy4gJHtyZXN1bHQucmV2aWV3RmVlZGJhY2sgfHwgJyd9YDtcblxuICAgICAgICAvLyBTYXZlIEFJIHJlc3BvbnNlIHRvIGRhdGFiYXNlXG4gICAgICAgIGF3YWl0IGFkZENvbnZlcnNhdGlvbihzZXNzaW9uSWQsICdhc3Npc3RhbnQnLCBhaVN1bW1hcnkpO1xuXG4gICAgICAgIGF3YWl0IG1lbW9yeS5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCBhaVN1bW1hcnkpO1xuXG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeShyZXNwb25zZSl9XFxuXFxuYCkpO1xuICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhciB0b29sIGxvZ3MgZm9yIG5leHQgcmVxdWVzdFxuICAgICAgICBjbGVhclRvb2xDYWxsTG9ncygpO1xuXG4gICAgICAgIGlmIChzZXNzaW9uSWQpIHtcbiAgICAgICAgICBjb25zdCBzdHJlYW1EYXRhID0gYWN0aXZlU3RyZWFtcy5nZXQoc2Vzc2lvbklkKTtcbiAgICAgICAgICBpZiAoc3RyZWFtRGF0YSkge1xuICAgICAgICAgICAgc3RyZWFtRGF0YS5pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIGFjdGl2ZVN0cmVhbXMuZGVsZXRlKHNlc3Npb25JZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKTtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBwcm9jZXNzIHJlcXVlc3QnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICAgICAgICB0eXBlOiAnZXJyb3InXG4gICAgICAgIH0pfVxcblxcbmApKTtcbiAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShzdHJlYW0sIHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvZXZlbnQtc3RyZWFtJyxcbiAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlJyxcbiAgICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLFxuICAgIH0sXG4gIH0pO1xufVxuXG4vLyBGdW5jdGlvbiB0byBlbWl0IHN0cmVhbWluZyBldmVudHNcbmZ1bmN0aW9uIGVtaXRTdHJlYW1FdmVudChzZXNzaW9uSWQ6IHN0cmluZywgZGF0YTogYW55KSB7XG4gIGNvbnN0IHN0cmVhbURhdGEgPSBhY3RpdmVTdHJlYW1zLmdldChzZXNzaW9uSWQpO1xuICBpZiAoc3RyZWFtRGF0YSAmJiAhc3RyZWFtRGF0YS5pc0NvbXBsZXRlKSB7XG4gICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgIHN0cmVhbURhdGEuY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KGRhdGEpfVxcblxcbmApKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVN0cmVhbWluZ0xvdmFibGVBZ2VudEdyYXBoIiwic2F2ZUdlbmVyYXRlZEZpbGVzIiwic2V0RW1pdEZ1bmN0aW9uIiwiZ2V0VG9vbENhbGxTdW1tYXJ5IiwiY2xlYXJUb29sQ2FsbExvZ3MiLCJzZXRTZXNzaW9uTWVtb3J5IiwiZ2V0UHJvamVjdEZvbGRlciIsImdldFNlc3Npb25NZW1vcnkiLCJnZXRPckNyZWF0ZVNlc3Npb24iLCJhZGRDb252ZXJzYXRpb24iLCJIdW1hbk1lc3NhZ2UiLCJwYXRoIiwiZW1iZWRQcm9qZWN0IiwiYWN0aXZlU3RyZWFtcyIsIk1hcCIsIlBPU1QiLCJyZXF1ZXN0IiwiZW5jb2RlciIsIlRleHRFbmNvZGVyIiwic3RyZWFtIiwiUmVhZGFibGVTdHJlYW0iLCJzdGFydCIsImNvbnRyb2xsZXIiLCJ1c2VyUmVxdWVzdCIsInNlc3Npb25JZCIsIm1vZGVsIiwianNvbiIsImVucXVldWUiLCJlbmNvZGUiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJjbG9zZSIsInNldCIsImlzQ29tcGxldGUiLCJlbWl0U3RyZWFtRXZlbnQiLCJjb25zb2xlIiwibG9nIiwicHJvamVjdEZvbGRlciIsIm1lbW9yeSIsImFkZE1lc3NhZ2UiLCJjb250ZXh0U3VtbWFyeSIsImdldENvbnRleHRTdW1tYXJ5IiwiZ3JhcGgiLCJyZXN1bHQiLCJpbnZva2UiLCJtZXNzYWdlcyIsImNoYWluT2ZUaG91Z2h0IiwiZm9yRWFjaCIsIm1lc3NhZ2UiLCJpbmRleCIsImNvbnRlbnQiLCJ0b1N0cmluZyIsImluY2x1ZGVzIiwiY290TWF0Y2giLCJtYXRjaCIsInB1c2giLCJNYXRoIiwiZmxvb3IiLCJ0cmltIiwiT2JqZWN0Iiwia2V5cyIsImdlbmVyYXRlZEZpbGVzIiwibGVuZ3RoIiwiZmlsZW5hbWUiLCJhZGRGaWxlT3BlcmF0aW9uIiwiam9pbiIsImVtYmVkRXJyb3IiLCJ3YXJuIiwidG9vbFN0YXRzIiwicmVzcG9uc2UiLCJzdWNjZXNzIiwicGxhbiIsInJldmlld0ZlZWRiYWNrIiwidHlwZSIsImFpU3VtbWFyeSIsInN0cmVhbURhdGEiLCJnZXQiLCJkZWxldGUiLCJkZXRhaWxzIiwiRXJyb3IiLCJTdHJpbmciLCJSZXNwb25zZSIsImhlYWRlcnMiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/agent-core.ts":
/*!**********************************!*\
  !*** ./lib/agents/agent-core.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearToolCallLogs: () => (/* binding */ clearToolCallLogs),\n/* harmony export */   createStreamingLovableAgentGraph: () => (/* binding */ createStreamingLovableAgentGraph),\n/* harmony export */   getMemoryStats: () => (/* binding */ getMemoryStats),\n/* harmony export */   getToolCallStats: () => (/* binding */ getToolCallStats),\n/* harmony export */   getToolCallSummary: () => (/* binding */ getToolCallSummary),\n/* harmony export */   saveGeneratedFiles: () => (/* binding */ saveGeneratedFiles),\n/* harmony export */   setEmitFunction: () => (/* binding */ setEmitFunction)\n/* harmony export */ });\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.0.1_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___r_79a741b742ae68db3a00eb54de512e24/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/tool-logger */ \"(rsc)/./lib/utils/tool-logger.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _streaming_agents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./streaming-agents */ \"(rsc)/./lib/agents/streaming-agents.ts\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n// Import the emit function from the API route\nlet emitEvent = ()=>{};\nfunction setEmitFunction(fn) {\n    emitEvent = fn;\n}\n// Define the state schema for our Lovable-like agent\nconst AgentState = _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation.Root({\n    messages: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (current, update)=>[\n                ...current,\n                ...update\n            ],\n        default: ()=>[]\n    }),\n    userRequest: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>\"\"\n    }),\n    plan: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>[]\n    }),\n    generatedFiles: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (current, update)=>({\n                ...current,\n                ...update\n            }),\n        default: ()=>({})\n    }),\n    currentIteration: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>0\n    }),\n    reviewFeedback: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>\"\"\n    }),\n    isComplete: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>false\n    }),\n    reviewIterations: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>0\n    })\n});\n// Non-streaming agent graph\nfunction createStreamingLovableAgentGraph(sessionId, model) {\n    const workflow = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateGraph(AgentState).addNode(\"planner\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingPlannerAgent)(state, sessionId, model)).addNode(\"generator\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingCodeGeneratorAgent)(state, sessionId, model)).addNode(\"completion\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingCompletionAgent)(state, sessionId, model)).addNode(\"reviewer\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingReviewerAgent)(state, sessionId, model)).addNode(\"fix_issues\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingFixerAgent)(state, sessionId, model)).addEdge(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.START, \"planner\").addConditionalEdges(\"planner\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        // Allow planner to route to any of the workflow nodes that\n        // shouldContinue may return. Providing a superset prevents\n        // unknown/null destination errors in the branch router.\n        planner: \"planner\",\n        generator: \"generator\",\n        completion: \"completion\",\n        reviewer: \"reviewer\",\n        fix_issues: \"fix_issues\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"generator\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        // Generator may route to other nodes depending on state\n        generator: \"generator\",\n        completion: \"completion\",\n        reviewer: \"reviewer\",\n        planner: \"planner\",\n        fix_issues: \"fix_issues\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"completion\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        // The completion node can route to multiple places depending on shouldContinue.\n        // Provide a superset of possible destinations so the branch router never\n        // receives an unknown/null destination when shouldContinue returns one\n        // of the expected control strings.\n        reviewer: \"reviewer\",\n        generator: \"generator\",\n        planner: \"planner\",\n        fix_issues: \"fix_issues\",\n        completion: \"completion\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"reviewer\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        // Reviewer may send flow back to fixer, generator, planner or end\n        fix_issues: \"fix_issues\",\n        generator: \"generator\",\n        planner: \"planner\",\n        completion: \"completion\",\n        reviewer: \"reviewer\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"fix_issues\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        // Fixer can route to reviewer, generator, or end depending on results\n        reviewer: \"reviewer\",\n        generator: \"generator\",\n        planner: \"planner\",\n        completion: \"completion\",\n        fix_issues: \"fix_issues\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    });\n    return workflow.compile();\n}\n// Helper function to emit agent messages for real-time chat display\nfunction emitAgentMessages(sessionId, messages) {\n    if (!sessionId || messages.length === 0) return;\n    messages.forEach((message)=>{\n        const content = message.content.toString();\n        if (content.trim()) {\n            emitEvent(sessionId, {\n                type: \"agent_message\",\n                content: content,\n                timestamp: new Date().toISOString()\n            });\n        }\n    });\n}\n// Helper function to save generated files to disk\nfunction saveGeneratedFiles(files, outputDir) {\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getMemory)();\n    // Use project folder if no output directory specified\n    const targetDir = outputDir || (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getProjectFolder)();\n    if (!fs__WEBPACK_IMPORTED_MODULE_4__.existsSync(targetDir)) {\n        fs__WEBPACK_IMPORTED_MODULE_4__.mkdirSync(targetDir, {\n            recursive: true\n        });\n    }\n    const savedFiles = [];\n    for (const [filename, content] of Object.entries(files)){\n        const fullPath = path__WEBPACK_IMPORTED_MODULE_5__.join(targetDir, filename);\n        const dir = path__WEBPACK_IMPORTED_MODULE_5__.dirname(fullPath);\n        if (!fs__WEBPACK_IMPORTED_MODULE_4__.existsSync(dir)) {\n            fs__WEBPACK_IMPORTED_MODULE_4__.mkdirSync(dir, {\n                recursive: true\n            });\n        }\n        const exists = fs__WEBPACK_IMPORTED_MODULE_4__.existsSync(fullPath);\n        fs__WEBPACK_IMPORTED_MODULE_4__.writeFileSync(fullPath, content, \"utf-8\");\n        // Track in memory\n        memory.addFileOperation(exists ? \"modified\" : \"created\", fullPath);\n        savedFiles.push(fullPath);\n    }\n    return savedFiles;\n}\n// Export tool logger statistics\nfunction getToolCallStats() {\n    return _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__.toolLogger.getStats();\n}\nfunction getToolCallSummary() {\n    return _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__.toolLogger.getSummary();\n}\nfunction clearToolCallLogs() {\n    _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__.toolLogger.clear();\n}\n// Get memory statistics for debugging/monitoring\nasync function getMemoryStats() {\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getMemory)();\n    const messages = await memory.getMessages();\n    const fileOps = await memory.getRecentFileOperations();\n    const sessionFiles = await memory.getSessionFiles();\n    return {\n        tokenEstimate: await memory.getTokenEstimate(),\n        messageCount: messages.length,\n        fileOperationCount: fileOps.length,\n        sessionFiles: sessionFiles\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFVBQVVoQixRQUFRLElBQUlpQixPQUFPQyxPQUFPLENBQUNWLE9BQVE7UUFDdkQsTUFBTVcsV0FBV3pELHNDQUFTLENBQUNpRCxXQUFXSztRQUN0QyxNQUFNSyxNQUFNM0QseUNBQVksQ0FBQ3lEO1FBRXpCLElBQUksQ0FBQzFELDBDQUFhLENBQUM0RCxNQUFNO1lBQ3ZCNUQseUNBQVksQ0FBQzRELEtBQUs7Z0JBQUVQLFdBQVc7WUFBSztRQUN0QztRQUVBLE1BQU1TLFNBQVM5RCwwQ0FBYSxDQUFDMEQ7UUFDN0IxRCw2Q0FBZ0IsQ0FBQzBELFVBQVVuQixTQUFTO1FBRXBDLGtCQUFrQjtRQUNsQlUsT0FBT2UsZ0JBQWdCLENBQUNGLFNBQVMsYUFBYSxXQUFXSjtRQUV6REosV0FBV1csSUFBSSxDQUFDUDtJQUNsQjtJQUVBLE9BQU9KO0FBQ1Q7QUFFQSxnQ0FBZ0M7QUFDekIsU0FBU1k7SUFDZCxPQUFPM0UsMERBQVVBLENBQUM0RSxRQUFRO0FBQzVCO0FBRU8sU0FBU0M7SUFDZCxPQUFPN0UsMERBQVVBLENBQUM4RSxVQUFVO0FBQzlCO0FBRU8sU0FBU0M7SUFDZC9FLDBEQUFVQSxDQUFDZ0YsS0FBSztBQUNsQjtBQUVBLGlEQUFpRDtBQUMxQyxlQUFlQztJQUNwQixNQUFNdkIsU0FBU3pELGlEQUFTQTtJQUN4QixNQUFNZSxXQUFXLE1BQU0wQyxPQUFPd0IsV0FBVztJQUN6QyxNQUFNQyxVQUFVLE1BQU16QixPQUFPMEIsdUJBQXVCO0lBQ3BELE1BQU1DLGVBQWUsTUFBTTNCLE9BQU80QixlQUFlO0lBRWpELE9BQU87UUFDTEMsZUFBZSxNQUFNN0IsT0FBTzhCLGdCQUFnQjtRQUM1Q0MsY0FBY3pFLFNBQVM2QixNQUFNO1FBQzdCNkMsb0JBQW9CUCxRQUFRdEMsTUFBTTtRQUNsQ3dDLGNBQWNBO0lBQ2hCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi9hZ2VudHMvYWdlbnQtY29yZS50cz84MjliIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0YXRlR3JhcGgsIEVORCwgU1RBUlQsIEFubm90YXRpb24gfSBmcm9tICdAbGFuZ2NoYWluL2xhbmdncmFwaCc7XG5pbXBvcnQgeyBCYXNlTWVzc2FnZSwgSHVtYW5NZXNzYWdlLCBBSU1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UgfSBmcm9tICdAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXMnO1xuaW1wb3J0IHsgdG9vbExvZ2dlciB9IGZyb20gJy4uL3V0aWxzL3Rvb2wtbG9nZ2VyJztcbmltcG9ydCB7IHByb21wdE9wdGltaXplciB9IGZyb20gJy4uL3V0aWxzL3Byb21wdC1vcHRpbWl6ZXInO1xuaW1wb3J0IHsgY29tcHJlc3NDb250ZXh0LCBzdW1tYXJpemVGaWxlQ29udGVudHMsIGVzdGltYXRlVG9rZW5zLCBzaG91bGRDb21wcmVzcywgc21hcnRUcnVuY2F0ZSB9IGZyb20gJy4uL3V0aWxzL3N1bW1hcml6ZXInO1xuaW1wb3J0IHsgZ2V0TWVtb3J5LCBnZXRQcm9qZWN0Rm9sZGVyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBsbG0gfSBmcm9tICcuL21vZGVsLXByb3ZpZGVycyc7XG5pbXBvcnQgeyB0b29scywgd3JhcFRvb2xXaXRoTG9nZ2luZyB9IGZyb20gJy4vdG9vbHMnO1xuaW1wb3J0IHsgc3RyZWFtaW5nUGxhbm5lckFnZW50LCBzdHJlYW1pbmdDb2RlR2VuZXJhdG9yQWdlbnQsIHN0cmVhbWluZ1Jldmlld2VyQWdlbnQsIHN0cmVhbWluZ0ZpeGVyQWdlbnQsIHN0cmVhbWluZ0NvbXBsZXRpb25BZ2VudCwgc2hvdWxkQ29udGludWUgfSBmcm9tICcuL3N0cmVhbWluZy1hZ2VudHMnO1xuaW1wb3J0IHsgcGxhbm5lckFnZW50LCBjb2RlR2VuZXJhdG9yQWdlbnQsIHJldmlld2VyQWdlbnQgfSBmcm9tICcuL2FnZW50cyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG4vLyBJbXBvcnQgdGhlIGVtaXQgZnVuY3Rpb24gZnJvbSB0aGUgQVBJIHJvdXRlXG5sZXQgZW1pdEV2ZW50OiAoc2Vzc2lvbklkOiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdm9pZCA9ICgpID0+IHt9O1xuZXhwb3J0IGZ1bmN0aW9uIHNldEVtaXRGdW5jdGlvbihmbjogKHNlc3Npb25JZDogc3RyaW5nLCBkYXRhOiBhbnkpID0+IHZvaWQpIHtcbiAgZW1pdEV2ZW50ID0gZm47XG59XG5cbi8vIERlZmluZSB0aGUgc3RhdGUgc2NoZW1hIGZvciBvdXIgTG92YWJsZS1saWtlIGFnZW50XG5jb25zdCBBZ2VudFN0YXRlID0gQW5ub3RhdGlvbi5Sb290KHtcbiAgbWVzc2FnZXM6IEFubm90YXRpb248QmFzZU1lc3NhZ2VbXT4oe1xuICAgIHJlZHVjZXI6IChjdXJyZW50LCB1cGRhdGUpID0+IFsuLi5jdXJyZW50LCAuLi51cGRhdGVdLFxuICAgIGRlZmF1bHQ6ICgpID0+IFtdLFxuICB9KSxcbiAgdXNlclJlcXVlc3Q6IEFubm90YXRpb248c3RyaW5nPih7XG4gICAgcmVkdWNlcjogKF8sIHVwZGF0ZSkgPT4gdXBkYXRlLFxuICAgIGRlZmF1bHQ6ICgpID0+ICcnLFxuICB9KSxcbiAgcGxhbjogQW5ub3RhdGlvbjxzdHJpbmdbXT4oe1xuICAgIHJlZHVjZXI6IChfLCB1cGRhdGUpID0+IHVwZGF0ZSxcbiAgICBkZWZhdWx0OiAoKSA9PiBbXSxcbiAgfSksXG4gIGdlbmVyYXRlZEZpbGVzOiBBbm5vdGF0aW9uPFJlY29yZDxzdHJpbmcsIHN0cmluZz4+KHtcbiAgICByZWR1Y2VyOiAoY3VycmVudCwgdXBkYXRlKSA9PiAoeyAuLi5jdXJyZW50LCAuLi51cGRhdGUgfSksXG4gICAgZGVmYXVsdDogKCkgPT4gKHt9KSxcbiAgfSksXG4gIGN1cnJlbnRJdGVyYXRpb246IEFubm90YXRpb248bnVtYmVyPih7XG4gICAgcmVkdWNlcjogKF8sIHVwZGF0ZSkgPT4gdXBkYXRlLFxuICAgIGRlZmF1bHQ6ICgpID0+IDAsXG4gIH0pLFxuICByZXZpZXdGZWVkYmFjazogQW5ub3RhdGlvbjxzdHJpbmc+KHtcbiAgICByZWR1Y2VyOiAoXywgdXBkYXRlKSA9PiB1cGRhdGUsXG4gICAgZGVmYXVsdDogKCkgPT4gJycsXG4gIH0pLFxuICBpc0NvbXBsZXRlOiBBbm5vdGF0aW9uPGJvb2xlYW4+KHtcbiAgICByZWR1Y2VyOiAoXywgdXBkYXRlKSA9PiB1cGRhdGUsXG4gICAgZGVmYXVsdDogKCkgPT4gZmFsc2UsXG4gIH0pLFxuICByZXZpZXdJdGVyYXRpb25zOiBBbm5vdGF0aW9uPG51bWJlcj4oe1xuICAgIHJlZHVjZXI6IChfLCB1cGRhdGUpID0+IHVwZGF0ZSxcbiAgICBkZWZhdWx0OiAoKSA9PiAwLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgdHlwZSBBZ2VudFN0YXRlVHlwZSA9IHR5cGVvZiBBZ2VudFN0YXRlLlN0YXRlO1xuXG4gXG4vLyBOb24tc3RyZWFtaW5nIGFnZW50IGdyYXBoXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RyZWFtaW5nTG92YWJsZUFnZW50R3JhcGgoc2Vzc2lvbklkPzogc3RyaW5nLCBtb2RlbD86IHN0cmluZykge1xuICBjb25zdCB3b3JrZmxvdyA9IG5ldyBTdGF0ZUdyYXBoKEFnZW50U3RhdGUpXG4gICAgLmFkZE5vZGUoJ3BsYW5uZXInLCAoc3RhdGUpID0+IHN0cmVhbWluZ1BsYW5uZXJBZ2VudChzdGF0ZSwgc2Vzc2lvbklkLCBtb2RlbCkpXG4gICAgLmFkZE5vZGUoJ2dlbmVyYXRvcicsIChzdGF0ZSkgPT4gc3RyZWFtaW5nQ29kZUdlbmVyYXRvckFnZW50KHN0YXRlLCBzZXNzaW9uSWQsIG1vZGVsKSlcbiAgICAuYWRkTm9kZSgnY29tcGxldGlvbicsIChzdGF0ZSkgPT4gc3RyZWFtaW5nQ29tcGxldGlvbkFnZW50KHN0YXRlLCBzZXNzaW9uSWQsIG1vZGVsKSlcbiAgICAuYWRkTm9kZSgncmV2aWV3ZXInLCAoc3RhdGUpID0+IHN0cmVhbWluZ1Jldmlld2VyQWdlbnQoc3RhdGUsIHNlc3Npb25JZCwgbW9kZWwpKVxuICAgIC5hZGROb2RlKCdmaXhfaXNzdWVzJywgKHN0YXRlKSA9PiBzdHJlYW1pbmdGaXhlckFnZW50KHN0YXRlLCBzZXNzaW9uSWQsIG1vZGVsKSlcbiAgICAuYWRkRWRnZShTVEFSVCwgJ3BsYW5uZXInKVxuICAgIC5hZGRDb25kaXRpb25hbEVkZ2VzKCdwbGFubmVyJywgc2hvdWxkQ29udGludWUsIHtcbiAgICAgIC8vIEFsbG93IHBsYW5uZXIgdG8gcm91dGUgdG8gYW55IG9mIHRoZSB3b3JrZmxvdyBub2RlcyB0aGF0XG4gICAgICAvLyBzaG91bGRDb250aW51ZSBtYXkgcmV0dXJuLiBQcm92aWRpbmcgYSBzdXBlcnNldCBwcmV2ZW50c1xuICAgICAgLy8gdW5rbm93bi9udWxsIGRlc3RpbmF0aW9uIGVycm9ycyBpbiB0aGUgYnJhbmNoIHJvdXRlci5cbiAgICAgIHBsYW5uZXI6ICdwbGFubmVyJyxcbiAgICAgIGdlbmVyYXRvcjogJ2dlbmVyYXRvcicsXG4gICAgICBjb21wbGV0aW9uOiAnY29tcGxldGlvbicsXG4gICAgICByZXZpZXdlcjogJ3Jldmlld2VyJyxcbiAgICAgIGZpeF9pc3N1ZXM6ICdmaXhfaXNzdWVzJyxcbiAgICAgIGVuZDogRU5ELFxuICAgIH0pXG4gICAgLmFkZENvbmRpdGlvbmFsRWRnZXMoJ2dlbmVyYXRvcicsIHNob3VsZENvbnRpbnVlLCB7XG4gICAgICAvLyBHZW5lcmF0b3IgbWF5IHJvdXRlIHRvIG90aGVyIG5vZGVzIGRlcGVuZGluZyBvbiBzdGF0ZVxuICAgICAgZ2VuZXJhdG9yOiAnZ2VuZXJhdG9yJyxcbiAgICAgIGNvbXBsZXRpb246ICdjb21wbGV0aW9uJyxcbiAgICAgIHJldmlld2VyOiAncmV2aWV3ZXInLFxuICAgICAgcGxhbm5lcjogJ3BsYW5uZXInLFxuICAgICAgZml4X2lzc3VlczogJ2ZpeF9pc3N1ZXMnLFxuICAgICAgZW5kOiBFTkQsXG4gICAgfSlcbiAgICAuYWRkQ29uZGl0aW9uYWxFZGdlcygnY29tcGxldGlvbicsIHNob3VsZENvbnRpbnVlLCB7XG4gICAgICAvLyBUaGUgY29tcGxldGlvbiBub2RlIGNhbiByb3V0ZSB0byBtdWx0aXBsZSBwbGFjZXMgZGVwZW5kaW5nIG9uIHNob3VsZENvbnRpbnVlLlxuICAgICAgLy8gUHJvdmlkZSBhIHN1cGVyc2V0IG9mIHBvc3NpYmxlIGRlc3RpbmF0aW9ucyBzbyB0aGUgYnJhbmNoIHJvdXRlciBuZXZlclxuICAgICAgLy8gcmVjZWl2ZXMgYW4gdW5rbm93bi9udWxsIGRlc3RpbmF0aW9uIHdoZW4gc2hvdWxkQ29udGludWUgcmV0dXJucyBvbmVcbiAgICAgIC8vIG9mIHRoZSBleHBlY3RlZCBjb250cm9sIHN0cmluZ3MuXG4gICAgICByZXZpZXdlcjogJ3Jldmlld2VyJyxcbiAgICAgIGdlbmVyYXRvcjogJ2dlbmVyYXRvcicsXG4gICAgICBwbGFubmVyOiAncGxhbm5lcicsXG4gICAgICBmaXhfaXNzdWVzOiAnZml4X2lzc3VlcycsXG4gICAgICBjb21wbGV0aW9uOiAnY29tcGxldGlvbicsXG4gICAgICBlbmQ6IEVORCxcbiAgICB9KVxuICAgIC5hZGRDb25kaXRpb25hbEVkZ2VzKCdyZXZpZXdlcicsIHNob3VsZENvbnRpbnVlLCB7XG4gICAgICAvLyBSZXZpZXdlciBtYXkgc2VuZCBmbG93IGJhY2sgdG8gZml4ZXIsIGdlbmVyYXRvciwgcGxhbm5lciBvciBlbmRcbiAgICAgIGZpeF9pc3N1ZXM6ICdmaXhfaXNzdWVzJyxcbiAgICAgIGdlbmVyYXRvcjogJ2dlbmVyYXRvcicsXG4gICAgICBwbGFubmVyOiAncGxhbm5lcicsXG4gICAgICBjb21wbGV0aW9uOiAnY29tcGxldGlvbicsXG4gICAgICByZXZpZXdlcjogJ3Jldmlld2VyJyxcbiAgICAgIGVuZDogRU5ELFxuICAgIH0pXG4gICAgLmFkZENvbmRpdGlvbmFsRWRnZXMoJ2ZpeF9pc3N1ZXMnLCBzaG91bGRDb250aW51ZSwge1xuICAgICAgLy8gRml4ZXIgY2FuIHJvdXRlIHRvIHJldmlld2VyLCBnZW5lcmF0b3IsIG9yIGVuZCBkZXBlbmRpbmcgb24gcmVzdWx0c1xuICAgICAgcmV2aWV3ZXI6ICdyZXZpZXdlcicsXG4gICAgICBnZW5lcmF0b3I6ICdnZW5lcmF0b3InLFxuICAgICAgcGxhbm5lcjogJ3BsYW5uZXInLFxuICAgICAgY29tcGxldGlvbjogJ2NvbXBsZXRpb24nLFxuICAgICAgZml4X2lzc3VlczogJ2ZpeF9pc3N1ZXMnLFxuICAgICAgZW5kOiBFTkQsXG4gICAgfSk7XG5cbiAgcmV0dXJuIHdvcmtmbG93LmNvbXBpbGUoKTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGVtaXQgYWdlbnQgbWVzc2FnZXMgZm9yIHJlYWwtdGltZSBjaGF0IGRpc3BsYXlcbmZ1bmN0aW9uIGVtaXRBZ2VudE1lc3NhZ2VzKHNlc3Npb25JZDogc3RyaW5nIHwgdW5kZWZpbmVkLCBtZXNzYWdlczogQmFzZU1lc3NhZ2VbXSkge1xuICBpZiAoIXNlc3Npb25JZCB8fCBtZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICBtZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgY29udGVudCA9IG1lc3NhZ2UuY29udGVudC50b1N0cmluZygpO1xuICAgIGlmIChjb250ZW50LnRyaW0oKSkge1xuICAgICAgZW1pdEV2ZW50KHNlc3Npb25JZCwge1xuICAgICAgICB0eXBlOiAnYWdlbnRfbWVzc2FnZScsXG4gICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHNhdmUgZ2VuZXJhdGVkIGZpbGVzIHRvIGRpc2tcbmV4cG9ydCBmdW5jdGlvbiBzYXZlR2VuZXJhdGVkRmlsZXMoZmlsZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG91dHB1dERpcj86IHN0cmluZykge1xuICBjb25zdCBtZW1vcnkgPSBnZXRNZW1vcnkoKTtcblxuICAvLyBVc2UgcHJvamVjdCBmb2xkZXIgaWYgbm8gb3V0cHV0IGRpcmVjdG9yeSBzcGVjaWZpZWRcbiAgY29uc3QgdGFyZ2V0RGlyID0gb3V0cHV0RGlyIHx8IGdldFByb2plY3RGb2xkZXIoKTtcblxuICBpZiAoIWZzLmV4aXN0c1N5bmModGFyZ2V0RGlyKSkge1xuICAgIGZzLm1rZGlyU3luYyh0YXJnZXREaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICB9XG5cbiAgY29uc3Qgc2F2ZWRGaWxlczogc3RyaW5nW10gPSBbXTtcblxuICBmb3IgKGNvbnN0IFtmaWxlbmFtZSwgY29udGVudF0gb2YgT2JqZWN0LmVudHJpZXMoZmlsZXMpKSB7XG4gICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmpvaW4odGFyZ2V0RGlyLCBmaWxlbmFtZSk7XG4gICAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKGZ1bGxQYXRoKTtcblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBleGlzdHMgPSBmcy5leGlzdHNTeW5jKGZ1bGxQYXRoKTtcbiAgICBmcy53cml0ZUZpbGVTeW5jKGZ1bGxQYXRoLCBjb250ZW50LCAndXRmLTgnKTtcblxuICAgIC8vIFRyYWNrIGluIG1lbW9yeVxuICAgIG1lbW9yeS5hZGRGaWxlT3BlcmF0aW9uKGV4aXN0cyA/ICdtb2RpZmllZCcgOiAnY3JlYXRlZCcsIGZ1bGxQYXRoKTtcblxuICAgIHNhdmVkRmlsZXMucHVzaChmdWxsUGF0aCk7XG4gIH1cblxuICByZXR1cm4gc2F2ZWRGaWxlcztcbn1cblxuLy8gRXhwb3J0IHRvb2wgbG9nZ2VyIHN0YXRpc3RpY3NcbmV4cG9ydCBmdW5jdGlvbiBnZXRUb29sQ2FsbFN0YXRzKCkge1xuICByZXR1cm4gdG9vbExvZ2dlci5nZXRTdGF0cygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VG9vbENhbGxTdW1tYXJ5KCkge1xuICByZXR1cm4gdG9vbExvZ2dlci5nZXRTdW1tYXJ5KCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRvb2xDYWxsTG9ncygpIHtcbiAgdG9vbExvZ2dlci5jbGVhcigpO1xufVxuXG4vLyBHZXQgbWVtb3J5IHN0YXRpc3RpY3MgZm9yIGRlYnVnZ2luZy9tb25pdG9yaW5nXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWVtb3J5U3RhdHMoKSB7XG4gIGNvbnN0IG1lbW9yeSA9IGdldE1lbW9yeSgpO1xuICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IG1lbW9yeS5nZXRNZXNzYWdlcygpO1xuICBjb25zdCBmaWxlT3BzID0gYXdhaXQgbWVtb3J5LmdldFJlY2VudEZpbGVPcGVyYXRpb25zKCk7XG4gIGNvbnN0IHNlc3Npb25GaWxlcyA9IGF3YWl0IG1lbW9yeS5nZXRTZXNzaW9uRmlsZXMoKTtcblxuICByZXR1cm4ge1xuICAgIHRva2VuRXN0aW1hdGU6IGF3YWl0IG1lbW9yeS5nZXRUb2tlbkVzdGltYXRlKCksXG4gICAgbWVzc2FnZUNvdW50OiBtZXNzYWdlcy5sZW5ndGgsXG4gICAgZmlsZU9wZXJhdGlvbkNvdW50OiBmaWxlT3BzLmxlbmd0aCxcbiAgICBzZXNzaW9uRmlsZXM6IHNlc3Npb25GaWxlcyxcbiAgfTtcbn0iXSwibmFtZXMiOlsiU3RhdGVHcmFwaCIsIkVORCIsIlNUQVJUIiwiQW5ub3RhdGlvbiIsInRvb2xMb2dnZXIiLCJnZXRNZW1vcnkiLCJnZXRQcm9qZWN0Rm9sZGVyIiwic3RyZWFtaW5nUGxhbm5lckFnZW50Iiwic3RyZWFtaW5nQ29kZUdlbmVyYXRvckFnZW50Iiwic3RyZWFtaW5nUmV2aWV3ZXJBZ2VudCIsInN0cmVhbWluZ0ZpeGVyQWdlbnQiLCJzdHJlYW1pbmdDb21wbGV0aW9uQWdlbnQiLCJzaG91bGRDb250aW51ZSIsImZzIiwicGF0aCIsImVtaXRFdmVudCIsInNldEVtaXRGdW5jdGlvbiIsImZuIiwiQWdlbnRTdGF0ZSIsIlJvb3QiLCJtZXNzYWdlcyIsInJlZHVjZXIiLCJjdXJyZW50IiwidXBkYXRlIiwiZGVmYXVsdCIsInVzZXJSZXF1ZXN0IiwiXyIsInBsYW4iLCJnZW5lcmF0ZWRGaWxlcyIsImN1cnJlbnRJdGVyYXRpb24iLCJyZXZpZXdGZWVkYmFjayIsImlzQ29tcGxldGUiLCJyZXZpZXdJdGVyYXRpb25zIiwiY3JlYXRlU3RyZWFtaW5nTG92YWJsZUFnZW50R3JhcGgiLCJzZXNzaW9uSWQiLCJtb2RlbCIsIndvcmtmbG93IiwiYWRkTm9kZSIsInN0YXRlIiwiYWRkRWRnZSIsImFkZENvbmRpdGlvbmFsRWRnZXMiLCJwbGFubmVyIiwiZ2VuZXJhdG9yIiwiY29tcGxldGlvbiIsInJldmlld2VyIiwiZml4X2lzc3VlcyIsImVuZCIsImNvbXBpbGUiLCJlbWl0QWdlbnRNZXNzYWdlcyIsImxlbmd0aCIsImZvckVhY2giLCJtZXNzYWdlIiwiY29udGVudCIsInRvU3RyaW5nIiwidHJpbSIsInR5cGUiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzYXZlR2VuZXJhdGVkRmlsZXMiLCJmaWxlcyIsIm91dHB1dERpciIsIm1lbW9yeSIsInRhcmdldERpciIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJzYXZlZEZpbGVzIiwiZmlsZW5hbWUiLCJPYmplY3QiLCJlbnRyaWVzIiwiZnVsbFBhdGgiLCJqb2luIiwiZGlyIiwiZGlybmFtZSIsImV4aXN0cyIsIndyaXRlRmlsZVN5bmMiLCJhZGRGaWxlT3BlcmF0aW9uIiwicHVzaCIsImdldFRvb2xDYWxsU3RhdHMiLCJnZXRTdGF0cyIsImdldFRvb2xDYWxsU3VtbWFyeSIsImdldFN1bW1hcnkiLCJjbGVhclRvb2xDYWxsTG9ncyIsImNsZWFyIiwiZ2V0TWVtb3J5U3RhdHMiLCJnZXRNZXNzYWdlcyIsImZpbGVPcHMiLCJnZXRSZWNlbnRGaWxlT3BlcmF0aW9ucyIsInNlc3Npb25GaWxlcyIsImdldFNlc3Npb25GaWxlcyIsInRva2VuRXN0aW1hdGUiLCJnZXRUb2tlbkVzdGltYXRlIiwibWVzc2FnZUNvdW50IiwiZmlsZU9wZXJhdGlvbkNvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/agent-core.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/model-providers.ts":
/*!***************************************!*\
  !*** ./lib/agents/model-providers.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLLM: () => (/* binding */ createLLM),\n/* harmony export */   getModelName: () => (/* binding */ getModelName),\n/* harmony export */   llm: () => (/* binding */ llm)\n/* harmony export */ });\n/* harmony import */ var _langchain_groq__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/groq */ \"(rsc)/./node_modules/.pnpm/@langchain+groq@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__/node_modules/@langchain/groq/dist/index.js\");\n/* harmony import */ var _langchain_google_genai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/google-genai */ \"(rsc)/./node_modules/.pnpm/@langchain+google-genai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__/node_modules/@langchain/google-genai/dist/index.js\");\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/.pnpm/@langchain+openai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___ws@8.18.3/node_modules/@langchain/openai/dist/index.js\");\n\n\n\n// Model ID to actual model name mapping\nconst getModelName = (modelId)=>{\n    const modelMappings = {\n        \"groq-mixtral-8x7b\": \"mixtral-8x7b-32768\",\n        \"groq-llama-3.1-8b-instant\": \"llama-3.1-8b-instant\",\n        \"groq-llama-3.3-70b-versatile\": \"llama-3.3-70b-versatile\",\n        \"gemini-2.5-flash\": \"gemini-2.5-flash\",\n        \"gemini-2.5-pro\": \"gemini-2.5-pro\"\n    };\n    return modelMappings[modelId] || modelId;\n};\n// Initialize the LLM model with provider selection\nfunction createLLM(model, streaming = false) {\n    // If a specific model is requested, try to use it\n    if (model) {\n        const groqApiKey = process.env.GROQ_API_KEY;\n        const geminiApiKey = process.env.GEMINI_API_KEY;\n        const openRouterApiKey = process.env.OPENROUTER_API_KEY ?? process.env.OPENAI_API_KEY;\n        if (model.startsWith(\"groq-\") && groqApiKey) {\n            const actualModel = getModelName(model);\n            console.log(\"⚡ Using Groq API (Fastest) - Model:\", actualModel);\n            return new _langchain_groq__WEBPACK_IMPORTED_MODULE_0__.ChatGroq({\n                apiKey: groqApiKey,\n                model: actualModel,\n                temperature: 0.4,\n                streaming\n            });\n        } else if (model.startsWith(\"gemini-\") && geminiApiKey) {\n            const actualModel = getModelName(model);\n            console.log(\"\\uD83E\\uDD16 Using Google Gemini API - Model:\", actualModel);\n            return new _langchain_google_genai__WEBPACK_IMPORTED_MODULE_1__.ChatGoogleGenerativeAI({\n                apiKey: geminiApiKey,\n                model: actualModel,\n                temperature: 0.4,\n                streaming\n            });\n        } else if (openRouterApiKey) {\n            console.log(\"\\uD83D\\uDD04 Using OpenRouter API - Model:\", model);\n            const apiBase = process.env.OPENROUTER_API_BASE ?? process.env.OPENAI_API_BASE ?? \"https://openrouter.ai/api/v1\";\n            return new _langchain_openai__WEBPACK_IMPORTED_MODULE_2__.ChatOpenAI({\n                apiKey: openRouterApiKey,\n                configuration: {\n                    baseURL: apiBase\n                },\n                model: model,\n                temperature: 0.4,\n                streaming\n            });\n        }\n    }\n    // Default priority: Groq (fastest) → Gemini (reliable) → OpenRouter (fallback)\n    const groqApiKey = process.env.GROQ_API_KEY;\n    const geminiApiKey = process.env.GEMINI_API_KEY;\n    const openRouterApiKey = process.env.OPENROUTER_API_KEY ?? process.env.OPENAI_API_KEY;\n    if (groqApiKey) {\n        console.log(\"⚡ Using Groq API (Fastest)\");\n        return new _langchain_groq__WEBPACK_IMPORTED_MODULE_0__.ChatGroq({\n            apiKey: groqApiKey,\n            model: process.env.GROQ_MODEL ?? \"llama-3.1-8b-instant\",\n            temperature: 0.7,\n            maxTokens: 4096,\n            streaming\n        });\n    } else if (geminiApiKey) {\n        console.log(\"\\uD83E\\uDD16 Using Google Gemini API\");\n        return new _langchain_google_genai__WEBPACK_IMPORTED_MODULE_1__.ChatGoogleGenerativeAI({\n            apiKey: geminiApiKey,\n            model: process.env.GEMINI_MODEL ?? \"gemini-2.5-flash\",\n            temperature: 0.7,\n            maxOutputTokens: 4096,\n            streaming\n        });\n    } else if (openRouterApiKey) {\n        console.log(\"\\uD83D\\uDD04 Using OpenRouter API\");\n        const apiBase = process.env.OPENROUTER_API_BASE ?? process.env.OPENAI_API_BASE ?? \"https://openrouter.ai/api/v1\";\n        return new _langchain_openai__WEBPACK_IMPORTED_MODULE_2__.ChatOpenAI({\n            apiKey: openRouterApiKey,\n            configuration: {\n                baseURL: apiBase\n            },\n            model: process.env.OPENAI_MODEL ?? process.env.OPENROUTER_MODEL ?? \"openai/gpt-4o\",\n            temperature: 0.7,\n            streaming\n        });\n    } else {\n        throw new Error(\"No API key found. Set GROQ_API_KEY, GEMINI_API_KEY, or OPENROUTER_API_KEY/OPENAI_API_KEY\");\n    }\n}\nlet llm = createLLM();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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akIsT0FBT0csUUFBUUMsR0FBRyxDQUFDc0IsWUFBWSxJQUFJdkIsUUFBUUMsR0FBRyxDQUFDdUIsZ0JBQWdCLElBQUk7WUFDbkVYLGFBQWE7WUFDYmY7UUFDRjtJQUNGLE9BQU87UUFDTCxNQUFNLElBQUkyQixNQUFNO0lBQ2xCO0FBQ0Y7QUFFTyxJQUFJQyxNQUFNOUIsWUFBWSIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2FnZW50cy9tb2RlbC1wcm92aWRlcnMudHM/ZTg3MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGF0R3JvcSB9IGZyb20gJ0BsYW5nY2hhaW4vZ3JvcSc7XG5pbXBvcnQgeyBDaGF0R29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSAnQGxhbmdjaGFpbi9nb29nbGUtZ2VuYWknO1xuaW1wb3J0IHsgQ2hhdE9wZW5BSSB9IGZyb20gJ0BsYW5nY2hhaW4vb3BlbmFpJztcblxuLy8gTW9kZWwgSUQgdG8gYWN0dWFsIG1vZGVsIG5hbWUgbWFwcGluZ1xuZXhwb3J0IGNvbnN0IGdldE1vZGVsTmFtZSA9IChtb2RlbElkOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBtb2RlbE1hcHBpbmdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICdncm9xLW1peHRyYWwtOHg3Yic6ICdtaXh0cmFsLTh4N2ItMzI3NjgnLFxuICAgICdncm9xLWxsYW1hLTMuMS04Yi1pbnN0YW50JzogJ2xsYW1hLTMuMS04Yi1pbnN0YW50JyxcbiAgICAnZ3JvcS1sbGFtYS0zLjMtNzBiLXZlcnNhdGlsZSc6ICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZScsXG4gICAgJ2dlbWluaS0yLjUtZmxhc2gnOiAnZ2VtaW5pLTIuNS1mbGFzaCcsXG4gICAgJ2dlbWluaS0yLjUtcHJvJzogJ2dlbWluaS0yLjUtcHJvJyxcbiAgfTtcbiAgcmV0dXJuIG1vZGVsTWFwcGluZ3NbbW9kZWxJZF0gfHwgbW9kZWxJZDtcbn07XG5cbi8vIEluaXRpYWxpemUgdGhlIExMTSBtb2RlbCB3aXRoIHByb3ZpZGVyIHNlbGVjdGlvblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxMTShtb2RlbD86IHN0cmluZywgc3RyZWFtaW5nOiBib29sZWFuID0gZmFsc2UpIHtcbiAgLy8gSWYgYSBzcGVjaWZpYyBtb2RlbCBpcyByZXF1ZXN0ZWQsIHRyeSB0byB1c2UgaXRcbiAgaWYgKG1vZGVsKSB7XG4gICAgY29uc3QgZ3JvcUFwaUtleSA9IHByb2Nlc3MuZW52LkdST1FfQVBJX0tFWTtcbiAgICBjb25zdCBnZW1pbmlBcGlLZXkgPSBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWTtcbiAgICBjb25zdCBvcGVuUm91dGVyQXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZO1xuXG4gICAgaWYgKG1vZGVsLnN0YXJ0c1dpdGgoJ2dyb3EtJykgJiYgZ3JvcUFwaUtleSkge1xuICAgICAgY29uc3QgYWN0dWFsTW9kZWwgPSBnZXRNb2RlbE5hbWUobW9kZWwpO1xuICAgICAgY29uc29sZS5sb2coJ+KaoSBVc2luZyBHcm9xIEFQSSAoRmFzdGVzdCkgLSBNb2RlbDonLCBhY3R1YWxNb2RlbCk7XG4gICAgICByZXR1cm4gbmV3IENoYXRHcm9xKHtcbiAgICAgICAgYXBpS2V5OiBncm9xQXBpS2V5LFxuICAgICAgICBtb2RlbDogYWN0dWFsTW9kZWwsXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjQsXG4gICAgICAgIFxuICAgICAgICBzdHJlYW1pbmcsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKG1vZGVsLnN0YXJ0c1dpdGgoJ2dlbWluaS0nKSAmJiBnZW1pbmlBcGlLZXkpIHtcbiAgICAgIGNvbnN0IGFjdHVhbE1vZGVsID0gZ2V0TW9kZWxOYW1lKG1vZGVsKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn6SWIFVzaW5nIEdvb2dsZSBHZW1pbmkgQVBJIC0gTW9kZWw6JywgYWN0dWFsTW9kZWwpO1xuICAgICAgcmV0dXJuIG5ldyBDaGF0R29vZ2xlR2VuZXJhdGl2ZUFJKHtcbiAgICAgICAgYXBpS2V5OiBnZW1pbmlBcGlLZXksXG4gICAgICAgIG1vZGVsOiBhY3R1YWxNb2RlbCxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNCxcbiAgICAgICBcbiAgICAgICAgc3RyZWFtaW5nLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChvcGVuUm91dGVyQXBpS2V5KSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBVc2luZyBPcGVuUm91dGVyIEFQSSAtIE1vZGVsOicsIG1vZGVsKTtcbiAgICAgIGNvbnN0IGFwaUJhc2UgPSBwcm9jZXNzLmVudi5PUEVOUk9VVEVSX0FQSV9CQVNFID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfQkFTRSA/PyAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MSc7XG4gICAgICByZXR1cm4gbmV3IENoYXRPcGVuQUkoe1xuICAgICAgICBhcGlLZXk6IG9wZW5Sb3V0ZXJBcGlLZXksXG4gICAgICAgIGNvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICBiYXNlVVJMOiBhcGlCYXNlLFxuICAgICAgICB9LFxuICAgICAgICBtb2RlbDogbW9kZWwsXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjQsXG4gICAgICAgIHN0cmVhbWluZyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIERlZmF1bHQgcHJpb3JpdHk6IEdyb3EgKGZhc3Rlc3QpIOKGkiBHZW1pbmkgKHJlbGlhYmxlKSDihpIgT3BlblJvdXRlciAoZmFsbGJhY2spXG4gIGNvbnN0IGdyb3FBcGlLZXkgPSBwcm9jZXNzLmVudi5HUk9RX0FQSV9LRVk7XG4gIGNvbnN0IGdlbWluaUFwaUtleSA9IHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZO1xuICBjb25zdCBvcGVuUm91dGVyQXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZO1xuXG4gIGlmIChncm9xQXBpS2V5KSB7XG4gICAgY29uc29sZS5sb2coJ+KaoSBVc2luZyBHcm9xIEFQSSAoRmFzdGVzdCknKTtcbiAgICByZXR1cm4gbmV3IENoYXRHcm9xKHtcbiAgICAgIGFwaUtleTogZ3JvcUFwaUtleSxcbiAgICAgIG1vZGVsOiBwcm9jZXNzLmVudi5HUk9RX01PREVMID8/ICdsbGFtYS0zLjEtOGItaW5zdGFudCcsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgbWF4VG9rZW5zOiA0MDk2LFxuICAgICAgc3RyZWFtaW5nLFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKGdlbWluaUFwaUtleSkge1xuICAgIGNvbnNvbGUubG9nKCfwn6SWIFVzaW5nIEdvb2dsZSBHZW1pbmkgQVBJJyk7XG4gICAgcmV0dXJuIG5ldyBDaGF0R29vZ2xlR2VuZXJhdGl2ZUFJKHtcbiAgICAgIGFwaUtleTogZ2VtaW5pQXBpS2V5LFxuICAgICAgbW9kZWw6IHByb2Nlc3MuZW52LkdFTUlOSV9NT0RFTCA/PyAnZ2VtaW5pLTIuNS1mbGFzaCcsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgbWF4T3V0cHV0VG9rZW5zOiA0MDk2LFxuICAgICAgc3RyZWFtaW5nLFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKG9wZW5Sb3V0ZXJBcGlLZXkpIHtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBVc2luZyBPcGVuUm91dGVyIEFQSScpO1xuICAgIGNvbnN0IGFwaUJhc2UgPSBwcm9jZXNzLmVudi5PUEVOUk9VVEVSX0FQSV9CQVNFID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfQkFTRSA/PyAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MSc7XG4gICAgcmV0dXJuIG5ldyBDaGF0T3BlbkFJKHtcbiAgICAgIGFwaUtleTogb3BlblJvdXRlckFwaUtleSxcbiAgICAgIGNvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgYmFzZVVSTDogYXBpQmFzZSxcbiAgICAgIH0sXG4gICAgICBtb2RlbDogcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMID8/IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfTU9ERUwgPz8gJ29wZW5haS9ncHQtNG8nLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgIHN0cmVhbWluZyxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEFQSSBrZXkgZm91bmQuIFNldCBHUk9RX0FQSV9LRVksIEdFTUlOSV9BUElfS0VZLCBvciBPUEVOUk9VVEVSX0FQSV9LRVkvT1BFTkFJX0FQSV9LRVknKTtcbiAgfVxufVxuXG5leHBvcnQgbGV0IGxsbSA9IGNyZWF0ZUxMTSgpOyJdLCJuYW1lcyI6WyJDaGF0R3JvcSIsIkNoYXRHb29nbGVHZW5lcmF0aXZlQUkiLCJDaGF0T3BlbkFJIiwiZ2V0TW9kZWxOYW1lIiwibW9kZWxJZCIsIm1vZGVsTWFwcGluZ3MiLCJjcmVhdGVMTE0iLCJtb2RlbCIsInN0cmVhbWluZyIsImdyb3FBcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiR1JPUV9BUElfS0VZIiwiZ2VtaW5pQXBpS2V5IiwiR0VNSU5JX0FQSV9LRVkiLCJvcGVuUm91dGVyQXBpS2V5IiwiT1BFTlJPVVRFUl9BUElfS0VZIiwiT1BFTkFJX0FQSV9LRVkiLCJzdGFydHNXaXRoIiwiYWN0dWFsTW9kZWwiLCJjb25zb2xlIiwibG9nIiwiYXBpS2V5IiwidGVtcGVyYXR1cmUiLCJhcGlCYXNlIiwiT1BFTlJPVVRFUl9BUElfQkFTRSIsIk9QRU5BSV9BUElfQkFTRSIsImNvbmZpZ3VyYXRpb24iLCJiYXNlVVJMIiwiR1JPUV9NT0RFTCIsIm1heFRva2VucyIsIkdFTUlOSV9NT0RFTCIsIm1heE91dHB1dFRva2VucyIsIk9QRU5BSV9NT0RFTCIsIk9QRU5ST1VURVJfTU9ERUwiLCJFcnJvciIsImxsbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/model-providers.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/streaming-agents.ts":
/*!****************************************!*\
  !*** ./lib/agents/streaming-agents.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   setEmitFunction: () => (/* binding */ setEmitFunction),\n/* harmony export */   shouldContinue: () => (/* binding */ shouldContinue),\n/* harmony export */   streamingCodeGeneratorAgent: () => (/* binding */ streamingCodeGeneratorAgent),\n/* harmony export */   streamingCompletionAgent: () => (/* binding */ streamingCompletionAgent),\n/* harmony export */   streamingFixerAgent: () => (/* binding */ streamingFixerAgent),\n/* harmony export */   streamingPlannerAgent: () => (/* binding */ streamingPlannerAgent),\n/* harmony export */   streamingReviewerAgent: () => (/* binding */ streamingReviewerAgent)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _utils_prompt_optimizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/prompt-optimizer */ \"(rsc)/./lib/utils/prompt-optimizer.ts\");\n/* harmony import */ var _utils_summarizer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/summarizer */ \"(rsc)/./lib/utils/summarizer.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _model_providers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./model-providers */ \"(rsc)/./lib/agents/model-providers.ts\");\n/* harmony import */ var _tools__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tools */ \"(rsc)/./lib/agents/tools.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n// Import the emit function from the API route\nlet emitEvent = ()=>{};\nfunction setEmitFunction(fn) {\n    emitEvent = fn;\n}\n// Bind tools to the LLM\nconst llmWithTools = _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools);\n// Helper function to get comprehensive tool list for prompts\nfunction getToolDefinitions() {\n    return `\nAVAILABLE TOOLS:\n- read_file: Read the contents of a file. Use this to examine existing code or documents. Parameters: { filePath: string }\n- write_file: Create new files or replace entire files. Parameters: { filePath: string, content: string }\n- append_to_file: Add content to the end of an existing file. Parameters: { filePath: string, content: string }\n- delete_file: Delete a file from the filesystem. Parameters: { filePath: string }\n- list_directory: List the contents of a directory. Use this to see what files are available. Parameters: { dirPath: string }\n- search_files: Search for files containing a regex pattern. Use this to find specific code patterns or text. Parameters: { dirPath: string, pattern: string }\n- replace_in_file: Find and replace text in a file using regex. Use this for refactoring or fixing code patterns. Parameters: { filePath: string, searchText: string, replaceText: string }\n- insert_at_line: Insert content at a specific line number in a file. Use this for precise code additions. Parameters: { filePath: string, lineNumber: number, content: string }\n- delete_lines: Delete a range of lines from a file. Use this to remove code blocks. Parameters: { filePath: string, startLine: number, endLine: number }\n- replace_block: Replace a block of code between two markers. More efficient than rewriting entire file. Perfect for updating functions, classes, or sections. Parameters: { filePath: string, startMarker: string, endMarker: string, newContent: string }\n- replace_line_range: Replace a specific range of lines with new content. More precise than replace_block. Use when you know exact line numbers. Parameters: { filePath: string, startLine: number, endLine: number, newContent: string }\n- read_lines: Read a specific range of lines from a file. Use this to examine specific code sections. Parameters: { filePath: string, startLine: number, endLine: number }\n- get_file_info: Get detailed information about a file (size, lines, dates, etc.). Use this to understand file structure. Parameters: { filePath: string }\n- create_directory: Create a new directory (including parent directories if needed). Use this to organize project structure. Parameters: { dirPath: string }\n- copy_file: Copy a file to a new location. Use this to duplicate files or create templates. Parameters: { sourcePath: string, destinationPath: string }\n- move_file: Move or rename a file. Use this to reorganize project structure. Parameters: { sourcePath: string, destinationPath: string }\n- get_project_structure: Get a tree view of the project directory structure. Use this to understand project organization. Parameters: { maxDepth?: number }\n- execute_command: Execute a shell command in the project directory. Use this for npm install, git operations, building, testing, etc. ALWAYS provide a clear description. Parameters: { command: string, description: string }\n- search_similar_code: Search for similar code examples in the vector database. Use this to find relevant code patterns and implementations. Parameters: { query: string, maxResults?: number }\n- get_project_context: Get comprehensive project statistics and structure information from the vector database. Parameters: {}\n\nTOOL USAGE GUIDELINES:\n- Use tools by calling them directly in your response\n- Each tool call should be a separate function call with proper JSON arguments\n- Tools will automatically execute and provide results\n- Format: Call tools like normal function calls with the tool name and arguments\n- Example: write_file({ \"filePath\": \"index.html\", \"content\": \"<html>...</html>\" })\n- Always read files first to understand current state before making changes\n- Use search_files to find existing code patterns before implementing new ones\n- Test your changes by reading files back to verify correctness\n- Use execute_command for npm, git, build, and test operations`;\n}\n// Helper function to parse generated files from LLM output\nfunction parseGeneratedFiles(content) {\n    const files = {};\n    const fileRegex = /FILENAME:\\s*(.+?)\\n```(\\w+)?\\n([\\s\\S]*?)```/g;\n    let match;\n    while((match = fileRegex.exec(content)) !== null){\n        const filename = match[1].trim();\n        const code = match[3].trim();\n        files[filename] = code;\n    }\n    return files;\n}\n// Streaming Planner Agent: Breaks down user request into actionable steps\nasync function streamingPlannerAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Planning your request...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    // Add user request to memory\n    await memory.addMessage(\"user\", state.userRequest);\n    // Get compressed context from memory\n    const contextSummary = await memory.getCompressedContext(state.userRequest);\n    const sessionFiles = await memory.getSessionFiles();\n    // Check if there are existing files - if so, this is a modification request\n    const hasExistingFiles = Object.keys(state.generatedFiles).length > 0 || sessionFiles.length > 0;\n    let systemPrompt = `You are a senior software architect. Analyze the user's request and create a clear plan.\n\n${hasExistingFiles ? `\nIMPORTANT: There are EXISTING FILES in this session. The user wants to MODIFY or ENHANCE them.\nSession files: ${sessionFiles.length > 0 ? sessionFiles.join(\", \") : \"None\"}\nCurrent state files: ${Object.keys(state.generatedFiles).join(\", \")}\n\nYour plan should focus on MODIFYING these existing files, not creating new random files.\n` : `\nThis is a NEW project. Create a plan to build it from scratch.\n`}\n\n${contextSummary ? `\\nRECENT CONTEXT:\\n${(0,_utils_summarizer__WEBPACK_IMPORTED_MODULE_2__.smartTruncate)(contextSummary, 800)}` : \"\"}\n\n${getToolDefinitions()}\n\nOUTPUT FORMAT: Just numbered steps like:\n1. Create/Modify [specific file] - [what to do]\n2. Update [specific file] - [what to change]\n3. Add [feature] to [file]\n\nRULES:\n- Maximum 5 steps\n- Be SPECIFIC about which files to create/modify\n- If modifying, say \"Modify\" or \"Update\", not \"Create\"\n- Each step should produce tangible code\n- Keep it simple and actionable`;\n    // Optimize the system prompt\n    systemPrompt = _utils_prompt_optimizer__WEBPACK_IMPORTED_MODULE_1__.promptOptimizer.optimizeSystemPrompt(systemPrompt, contextSummary || undefined);\n    let contextInfo = `User request: ${state.userRequest}`;\n    if (hasExistingFiles) {\n        const allFiles = Array.from(new Set([\n            ...sessionFiles,\n            ...Object.keys(state.generatedFiles)\n        ]));\n        contextInfo += `\\n\\nEXISTING PROJECT FILES:\\n${allFiles.map((f)=>`- ${f}`).join(\"\\n\")}`;\n        contextInfo += `\\n\\nThe user wants to modify/enhance the existing project. Create a plan that works WITH these files.`;\n    }\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(contextInfo)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llm\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm;\n    const stream = await llmToUse.stream(messages);\n    let planText = \"\";\n    let chainOfThought = \"\";\n    const cotMessages = []; // Collect COT messages for chat\n    // Process the streaming response\n    for await (const chunk of stream){\n        const chunkContent = chunk.content;\n        if (chunkContent) {\n            planText += chunkContent;\n            // Extract chain of thought from the accumulating content\n            const cotMatch = planText.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=\\d+\\.|$)/i);\n            if (cotMatch) {\n                const newCot = cotMatch[1].trim();\n                if (newCot !== chainOfThought) {\n                    const previousLength = chainOfThought.length;\n                    chainOfThought = newCot;\n                    // Emit real-time chain of thought updates\n                    const newReasoning = chainOfThought.substring(previousLength);\n                    if (newReasoning.trim()) {\n                        console.log(`🔍 Real-time Planner COT: ${newReasoning.substring(0, 100)}${newReasoning.length > 100 ? \"...\" : \"\"}`);\n                        // Add to chat messages immediately for real-time display\n                        cotMessages.push(new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`🔍 ${newReasoning.trim()}`));\n                        emitEvent(sessionId || \"\", {\n                            type: \"chain_of_thought\",\n                            step: \"planner\",\n                            reasoning: chainOfThought.length > 500 ? chainOfThought.substring(0, 500) + \"...\" : chainOfThought,\n                            isPartial: true\n                        });\n                    }\n                }\n            }\n        }\n    }\n    // Add plan to memory\n    await memory.addMessage(\"assistant\", `Planning: ${planText.substring(0, 200)}...`);\n    // Parse the plan into steps\n    const planSteps = planText.split(\"\\n\").filter((line)=>/^\\d+\\./.test(line.trim())).map((line)=>line.replace(/^\\d+\\.\\s*/, \"\").trim()).filter((step)=>step.length > 0).slice(0, 5); // Limit to 5 steps\n    console.log(`📋 Generated plan with ${planSteps.length} steps:`, planSteps);\n    // Emit plan to client\n    emitEvent(sessionId || \"\", {\n        type: \"plan\",\n        plan: planSteps\n    });\n    // Emit real-time messages for chat display\n    if (cotMessages.length > 0) {\n        cotMessages.forEach((message)=>{\n            emitEvent(sessionId || \"\", {\n                type: \"agent_message\",\n                content: message.content.toString(),\n                timestamp: new Date().toISOString()\n            });\n        });\n    }\n    return {\n        plan: planSteps,\n        messages: cotMessages.length > 0 ? cotMessages : planText ? [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Planning: ${planText.substring(0, 500)}${planText.length > 500 ? \"...\" : \"\"}`)\n        ] : []\n    };\n}\n// Streaming Code Generator Agent: Implements each step of the plan\nasync function streamingCodeGeneratorAgent(state, sessionId, model) {\n    const currentStep = state.currentIteration;\n    const stepToImplement = state.plan[currentStep];\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: `Generating code for step ${currentStep + 1}: ${stepToImplement?.substring(0, 50)}...`\n    });\n    if (!stepToImplement) {\n        console.log(\"⚠️  No step to implement at iteration\", currentStep);\n        return {\n            isComplete: true\n        };\n    }\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const contextSummary = await memory.getCompressedContext(state.userRequest);\n    const sessionFiles = await memory.getSessionFiles();\n    // Get existing files for context\n    const existingFiles = {\n        ...state.generatedFiles\n    };\n    for (const file of sessionFiles){\n        try {\n            const content = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23)).then((fs)=>fs.readFileSync(file, \"utf-8\"));\n            existingFiles[file] = content;\n        } catch (error) {\n            console.warn(`Could not read existing file ${file}:`, error);\n        }\n    }\n    const systemPrompt = `You are an expert software engineer. Implement the specified step using the available tools.\n\nIMPORTANT RULES:\n- Use the provided tools to create/modify files\n- Each tool call should be purposeful and targeted\n- Read existing files first to understand the current state\n- Make incremental, testable changes\n- Include proper imports and dependencies\n- Follow the existing code style and patterns\n- Test your changes by reading the files back\n\n${contextSummary ? `CONTEXT:\\n${(0,_utils_summarizer__WEBPACK_IMPORTED_MODULE_2__.smartTruncate)(contextSummary, 600)}\\n\\n` : \"\"}\n\n${getToolDefinitions()}\n\nOUTPUT FORMAT:\nChain of Thought: [Your reasoning process]\nFiles: [List of files you'll create/modify]\n[Then use the appropriate tools to implement the changes]\n\nTOOL USAGE:\n- Use tools by calling them directly in your response\n- Each tool call should be a separate function call with proper JSON arguments\n- Tools will automatically execute and provide results\n- Format: Call tools like normal function calls with the tool name and arguments\n- Example: write_file({ \"filePath\": \"index.html\", \"content\": \"<html>...</html>\" })`;\n    const userPrompt = `Implement this step: \"${stepToImplement}\"\n\nExisting project files: ${Object.keys(existingFiles).join(\", \") || \"None\"}\n\n${state.reviewFeedback ? `Previous review feedback to address: ${state.reviewFeedback}` : \"\"}`;\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(userPrompt)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llmWithTools\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model, true) : (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(undefined, true); // Enable streaming\n    const llmWithToolsToUse = model ? llmToUse.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools) : llmWithTools;\n    // Stream the response for real-time chain of thought\n    const stream = await llmWithToolsToUse.stream(messages);\n    // Extract generated files from tool calls or response content\n    const generatedFiles = {};\n    let chainOfThought = \"\";\n    let fullContent = \"\";\n    let currentCotChunk = \"\";\n    const cotMessages = []; // Collect COT messages for chat\n    // Process the streaming response\n    for await (const chunk of stream){\n        const chunkContent = chunk.content;\n        if (chunkContent) {\n            fullContent += chunkContent;\n            currentCotChunk += chunkContent;\n            // Extract chain of thought from the accumulating content\n            const cotMatch = fullContent.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Files:|FILENAME:|$)/i);\n            if (cotMatch) {\n                const newCot = cotMatch[1].trim();\n                if (newCot !== chainOfThought) {\n                    const previousLength = chainOfThought.length;\n                    chainOfThought = newCot;\n                    // Emit real-time chain of thought updates (truncated like Gemini)\n                    const newReasoning = chainOfThought.substring(previousLength);\n                    if (newReasoning.trim()) {\n                        console.log(`🔍 Real-time COT Step ${currentStep + 1}: ${newReasoning.substring(0, 100)}${newReasoning.length > 100 ? \"...\" : \"\"}`);\n                        // Add to chat messages immediately for real-time display\n                        cotMessages.push(new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`🔍 ${newReasoning.trim()}`));\n                        emitEvent(sessionId || \"\", {\n                            type: \"chain_of_thought\",\n                            step: currentStep + 1,\n                            reasoning: chainOfThought.length > 500 ? chainOfThought.substring(0, 500) + \"...\" : chainOfThought,\n                            isPartial: true\n                        });\n                    }\n                }\n            }\n        }\n        // Handle tool calls in streaming (if any)\n        if (chunk.tool_calls && chunk.tool_calls.length > 0) {\n            for (const toolCall of chunk.tool_calls){\n                console.log(`🔧 Tool called: ${toolCall.name}`, toolCall.args);\n                try {\n                    // Find the tool function\n                    const tool = _tools__WEBPACK_IMPORTED_MODULE_5__.tools.find((t)=>t.name === toolCall.name);\n                    if (tool) {\n                        // Execute the tool with logging wrapper\n                        const wrappedTool = (0,_tools__WEBPACK_IMPORTED_MODULE_5__.wrapToolWithLogging)(tool, toolCall.name);\n                        const result = await wrappedTool(toolCall.args);\n                        console.log(`✅ Tool ${toolCall.name} executed successfully:`, result);\n                        // Handle specific tool results\n                        if (toolCall.name === \"read_file\") {\n                            // Store read file content for later use\n                            const args = toolCall.args;\n                            if (args.filePath && typeof result === \"string\") {\n                                generatedFiles[args.filePath] = result;\n                            }\n                        } else if (toolCall.name === \"write_file\" || toolCall.name === \"append_to_file\") {\n                            // Extract file content from tool call args for generated files\n                            const args = toolCall.args;\n                            if (args.filePath && args.content) {\n                                generatedFiles[args.filePath] = args.content;\n                            }\n                        }\n                    } else {\n                        console.warn(`⚠️ Tool ${toolCall.name} not found in tools array`);\n                    }\n                } catch (error) {\n                    console.error(`❌ Tool ${toolCall.name} execution failed:`, error);\n                // Continue processing other tools even if one fails\n                }\n            }\n        }\n    }\n    // Final processing after streaming is complete\n    console.log(`📊 Processed streaming response`);\n    // Extract final chain of thought\n    const finalCotMatch = fullContent.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Files:|FILENAME:|$)/i);\n    if (finalCotMatch) {\n        chainOfThought = finalCotMatch[1].trim();\n    }\n    // Fallback: parse files from accumulated content if no tool calls generated files\n    if (Object.keys(generatedFiles).length === 0) {\n        const newFiles = parseGeneratedFiles(fullContent);\n        Object.assign(generatedFiles, newFiles);\n    }\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Step ${currentStep + 1}: ${chainOfThought.substring(0, 200)}...`);\n    // Emit final chain of thought (complete)\n    if (chainOfThought) {\n        emitEvent(sessionId || \"\", {\n            type: \"chain_of_thought\",\n            step: currentStep + 1,\n            reasoning: chainOfThought.length > 1000 ? chainOfThought.substring(0, 1000) + \"...\" : chainOfThought,\n            isPartial: false\n        });\n    }\n    if (Object.keys(generatedFiles).length > 0) {\n        const files = Object.keys(generatedFiles);\n        console.log(`📁 Real-time Files Generated: ${files.join(\", \")}`);\n        emitEvent(sessionId || \"\", {\n            type: \"files_generated\",\n            files: files,\n            step: currentStep + 1\n        });\n    }\n    // Emit real-time messages for chat display\n    if (cotMessages.length > 0) {\n        cotMessages.forEach((message)=>{\n            emitEvent(sessionId || \"\", {\n                type: \"agent_message\",\n                content: message.content.toString(),\n                timestamp: new Date().toISOString()\n            });\n        });\n    }\n    return {\n        generatedFiles,\n        currentIteration: currentStep + 1,\n        messages: cotMessages.length > 0 ? cotMessages : chainOfThought ? [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(chainOfThought)\n        ] : []\n    };\n}\n// Streaming Reviewer Agent: Reviews the generated code for quality and completeness\nasync function streamingReviewerAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Reviewing generated code...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const allFiles = {\n        ...state.generatedFiles\n    };\n    // Read current state of all files using tools\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getProjectFolder)();\n    // Use tools to read the actual file contents\n    for (const filePath of Object.keys(allFiles)){\n        try {\n            // Try to read the file using the read_file tool\n            const fullPath = path__WEBPACK_IMPORTED_MODULE_6__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_6__.join(projectFolder, filePath);\n            // Import the tool and call it directly\n            const { readFileTool } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ./tools */ \"(rsc)/./lib/agents/tools.ts\"));\n            const result = await readFileTool.invoke({\n                filePath: fullPath\n            });\n            if (result && typeof result === \"string\" && result.startsWith(\"File content:\")) {\n                // Extract the actual content from the tool response\n                allFiles[filePath] = result.replace(\"File content:\\n\", \"\");\n            } else {\n                console.warn(`Could not read file ${filePath} using tool; using in-memory content`);\n            }\n        } catch (error) {\n            console.warn(`Could not read file ${filePath} for review:`, error);\n        }\n    }\n    const systemPrompt = `You are a senior code reviewer. Review the generated code for quality, completeness, and correctness.\n\nEVALUATION CRITERIA:\n- Code quality and best practices\n- Proper imports and dependencies\n- Error handling and edge cases\n- TypeScript types (if applicable)\n- Code organization and readability\n- Completeness of implementation\n- Integration with existing codebase\n\n${getToolDefinitions()}\n\nOUTPUT FORMAT:\nChain of Thought: [Your step-by-step analysis]\nAPPROVED or NEEDS IMPROVEMENT\n\nIf NEEDS IMPROVEMENT, provide specific, actionable feedback.\nIf APPROVED, confirm the implementation is complete and ready.\n\nBe constructive and specific in your feedback.`;\n    const codeSummary = Object.entries(allFiles).map(([file, content])=>`=== ${file} ===\\n${content}`).join(\"\\n\\n\");\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Review the following generated code:\\n\\n${codeSummary}`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llmWithTools\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model, true) : (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(undefined, true); // Enable streaming\n    const llmWithToolsToUse = model ? llmToUse.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools) : llmWithTools;\n    // Stream the response for real-time chain of thought\n    const stream = await llmWithToolsToUse.stream(messages);\n    let chainOfThought = \"\";\n    let fullContent = \"\";\n    let reviewResult = \"\";\n    const cotMessages = []; // Collect COT messages for chat\n    // Process the streaming response\n    for await (const chunk of stream){\n        const chunkContent = chunk.content;\n        if (chunkContent) {\n            fullContent += chunkContent;\n            // Extract chain of thought from the accumulating content\n            const cotMatch = fullContent.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=APPROVED|NEEDS IMPROVEMENT|$)/i);\n            if (cotMatch) {\n                const newCot = cotMatch[1].trim();\n                if (newCot !== chainOfThought) {\n                    const previousLength = chainOfThought.length;\n                    chainOfThought = newCot;\n                    // Emit real-time chain of thought updates\n                    const newReasoning = chainOfThought.substring(previousLength);\n                    if (newReasoning.trim()) {\n                        console.log(`🔍 Real-time COT (Review): ${newReasoning.substring(0, 100)}${newReasoning.length > 100 ? \"...\" : \"\"}`);\n                        // Add to chat messages immediately for real-time display\n                        cotMessages.push(new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`🔍 ${newReasoning.trim()}`));\n                        emitEvent(sessionId || \"\", {\n                            type: \"chain_of_thought\",\n                            step: \"review\",\n                            reasoning: chainOfThought.length > 500 ? chainOfThought.substring(0, 500) + \"...\" : chainOfThought,\n                            isPartial: true\n                        });\n                    }\n                }\n            }\n            // Check for final result\n            if (fullContent.includes(\"APPROVED\") || fullContent.includes(\"NEEDS IMPROVEMENT\")) {\n                reviewResult = fullContent;\n                break; // We have the complete review\n            }\n        }\n    }\n    // Extract the final feedback from the complete response\n    const feedback = reviewResult || fullContent;\n    const isApproved = feedback.toUpperCase().includes(\"APPROVED\") && !feedback.toLowerCase().includes(\"missing\") && !feedback.toLowerCase().includes(\"not implemented\");\n    console.log(`🔍 Review result: ${isApproved ? \"APPROVED\" : \"NEEDS IMPROVEMENT\"}`);\n    console.log(`📝 Feedback: ${feedback.substring(0, 100)}...`);\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Review: ${feedback.substring(0, 200)}...`);\n    // Emit review results\n    emitEvent(sessionId || \"\", {\n        type: \"review\",\n        feedback: feedback\n    });\n    if (isApproved) {\n        emitEvent(sessionId || \"\", {\n            type: \"complete\",\n            message: \"Code generation completed successfully!\"\n        });\n    }\n    return {\n        reviewFeedback: feedback,\n        isComplete: isApproved,\n        reviewIterations: (state.reviewIterations || 0) + 1,\n        messages: cotMessages\n    };\n}\n// Streaming Fixer Agent: Addresses review feedback by fixing issues\nasync function streamingFixerAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Fixing issues based on review...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const contextSummary = await memory.getCompressedContext(state.userRequest);\n    const systemPrompt = `You are an expert software engineer. Fix the issues identified in the review feedback.\n\nINSTRUCTIONS:\n- Address each point in the review feedback\n- Make targeted fixes using the available tools\n- Test your changes by reading files back\n- Ensure the fixes are complete and correct\n- Maintain code quality and consistency\n\n${contextSummary ? `CONTEXT:\\n${(0,_utils_summarizer__WEBPACK_IMPORTED_MODULE_2__.smartTruncate)(contextSummary, 400)}\\n\\n` : \"\"}\n\n${getToolDefinitions()}\n\nUse the same tools as before to implement fixes.`;\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Review feedback to address: ${state.reviewFeedback}\n\nCurrent files: ${Object.keys(state.generatedFiles).join(\", \")}\n\nPlease fix the identified issues.`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llmWithTools\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model, true) : (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(undefined, true); // Enable streaming\n    const llmWithToolsToUse = model ? llmToUse.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools) : llmWithTools;\n    // Stream the response for real-time chain of thought\n    const stream = await llmWithToolsToUse.stream(messages);\n    // Extract fixed files from tool calls or response content\n    const generatedFiles = {};\n    let fullContent = \"\";\n    let chainOfThought = \"\";\n    const cotMessages = []; // Collect COT messages for chat\n    // Process the streaming response\n    for await (const chunk of stream){\n        const chunkContent = chunk.content;\n        if (chunkContent) {\n            fullContent += chunkContent;\n            // Extract chain of thought from the accumulating content\n            const cotMatch = fullContent.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Files:|FILENAME:|$)/i);\n            if (cotMatch) {\n                const newCot = cotMatch[1].trim();\n                if (newCot !== chainOfThought) {\n                    const previousLength = chainOfThought.length;\n                    chainOfThought = newCot;\n                    // Emit real-time chain of thought updates\n                    const newReasoning = chainOfThought.substring(previousLength);\n                    if (newReasoning.trim()) {\n                        console.log(`🔍 Real-time Fixer COT: ${newReasoning.substring(0, 100)}${newReasoning.length > 100 ? \"...\" : \"\"}`);\n                        // Add to chat messages immediately for real-time display\n                        cotMessages.push(new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`🔍 ${newReasoning.trim()}`));\n                        emitEvent(sessionId || \"\", {\n                            type: \"chain_of_thought\",\n                            step: \"fixer\",\n                            reasoning: chainOfThought.length > 500 ? chainOfThought.substring(0, 500) + \"...\" : chainOfThought,\n                            isPartial: true\n                        });\n                    }\n                }\n            }\n        }\n        // Handle tool calls in streaming (if any)\n        if (chunk.tool_calls && chunk.tool_calls.length > 0) {\n            for (const toolCall of chunk.tool_calls){\n                console.log(`🔧 Tool called: ${toolCall.name}`, toolCall.args);\n                try {\n                    // Find the tool function\n                    const tool = _tools__WEBPACK_IMPORTED_MODULE_5__.tools.find((t)=>t.name === toolCall.name);\n                    if (tool) {\n                        // Execute the tool with logging wrapper\n                        const wrappedTool = (0,_tools__WEBPACK_IMPORTED_MODULE_5__.wrapToolWithLogging)(tool, toolCall.name);\n                        const result = await wrappedTool(toolCall.args);\n                        console.log(`✅ Tool ${toolCall.name} executed successfully:`, result);\n                        // Handle specific tool results\n                        if (toolCall.name === \"read_file\") {\n                            // Store read file content for later use\n                            const args = toolCall.args;\n                            if (args.filePath && typeof result === \"string\") {\n                                generatedFiles[args.filePath] = result;\n                            }\n                        } else if (toolCall.name === \"write_file\" || toolCall.name === \"append_to_file\") {\n                            // Extract file content from tool call args for generated files\n                            const args = toolCall.args;\n                            if (args.filePath && args.content) {\n                                generatedFiles[args.filePath] = args.content;\n                            }\n                        }\n                    } else {\n                        console.warn(`⚠️ Tool ${toolCall.name} not found in tools array`);\n                    }\n                } catch (error) {\n                    console.error(`❌ Tool ${toolCall.name} execution failed:`, error);\n                // Continue processing other tools even if one fails\n                }\n            }\n        }\n    }\n    // Final processing after streaming is complete\n    console.log(`📊 Processed streaming fixer response`);\n    // Fallback: parse files from accumulated content if no tool calls generated files\n    if (Object.keys(generatedFiles).length === 0) {\n        const fixedFiles = parseGeneratedFiles(fullContent);\n        Object.assign(generatedFiles, fixedFiles);\n    }\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Fixed issues based on review feedback. Updated ${Object.keys(generatedFiles).length} files.`);\n    // Emit fixes\n    if (Object.keys(generatedFiles).length > 0) {\n        const files = Object.keys(generatedFiles);\n        console.log(`🔧 Real-time Fixes Applied: ${files.join(\", \")}`);\n        emitEvent(sessionId || \"\", {\n            type: \"files_fixed\",\n            files: files\n        });\n    }\n    // Emit real-time messages for chat display\n    if (cotMessages.length > 0) {\n        cotMessages.forEach((message)=>{\n            emitEvent(sessionId || \"\", {\n                type: \"agent_message\",\n                content: message.content.toString(),\n                timestamp: new Date().toISOString()\n            });\n        });\n    }\n    return {\n        generatedFiles,\n        currentIteration: state.plan.length,\n        reviewFeedback: \"\",\n        messages: cotMessages.length > 0 ? cotMessages : fullContent ? [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Fixing issues: ${fullContent.substring(0, 500)}${fullContent.length > 500 ? \"...\" : \"\"}`)\n        ] : []\n    };\n}\n// Streaming Completion Agent: Ensures generated code is complete and functional\nasync function streamingCompletionAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Ensuring code completeness...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const allFiles = {\n        ...state.generatedFiles\n    };\n    // Read current state of all files\n    const sessionFiles = await memory.getSessionFiles();\n    for (const filePath of Object.keys(allFiles)){\n        try {\n            const fs = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n            const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getProjectFolder)();\n            // Try to read the actual file content\n            const candidate = path__WEBPACK_IMPORTED_MODULE_6__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_6__.join(projectFolder, filePath);\n            if (fs.existsSync(candidate)) {\n                allFiles[filePath] = fs.readFileSync(candidate, \"utf-8\");\n                continue;\n            }\n            // Try to find by basename in session files\n            const base = path__WEBPACK_IMPORTED_MODULE_6__.basename(filePath);\n            const match = sessionFiles.find((f)=>path__WEBPACK_IMPORTED_MODULE_6__.basename(f) === base);\n            if (match && fs.existsSync(match)) {\n                allFiles[filePath] = fs.readFileSync(match, \"utf-8\");\n                continue;\n            }\n        } catch (error) {\n            console.warn(`Could not read file ${filePath} for completion check:`, error);\n        }\n    }\n    const systemPrompt = `You are an expert software engineer specializing in code completion and validation. Your task is to ensure the generated code is COMPLETE and FUNCTIONAL.\n\nCOMPLETENESS CHECKS:\n1. **Function Definitions**: All functions must have complete implementations (not just signatures)\n2. **Imports & Dependencies**: All required imports must be present\n3. **Class Methods**: All class methods must be implemented\n4. **Error Handling**: Basic error handling where appropriate\n5. **Return Statements**: Functions that should return values must do so\n6. **Variable Declarations**: All variables must be properly declared\n7. **Syntax Validation**: Code must be syntactically correct\n8. **Integration Points**: Code must properly integrate with existing codebase\n\n${getToolDefinitions()}\n\nOUTPUT FORMAT:\nChain of Thought: [Your analysis of what's missing/incomplete]\nCompletion Status: COMPLETE or INCOMPLETE\n\nIf INCOMPLETE, provide specific fixes using the available tools.\nIf COMPLETE, confirm the code is ready for review.\n\nBe thorough - incomplete code is worse than no code!`;\n    const codeSummary = Object.entries(allFiles).map(([file, content])=>`=== ${file} ===\\n${content}`).join(\"\\n\\n\");\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Analyze and complete the following generated code:\\n\\n${codeSummary}\n\nEnsure all implementations are complete and functional. Fix any missing parts, incomplete functions, or integration issues.`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llmWithTools\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model, true) : (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(undefined, true);\n    const llmWithToolsToUse = model ? llmToUse.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools) : llmWithTools;\n    // Stream the response for real-time updates\n    const stream = await llmWithToolsToUse.stream(messages);\n    // Extract completed files from tool calls or response content\n    const completedFiles = {};\n    let chainOfThought = \"\";\n    let fullContent = \"\";\n    let completionStatus = \"INCOMPLETE\";\n    const cotMessages = []; // Collect COT messages for chat\n    // Process the streaming response\n    for await (const chunk of stream){\n        const chunkContent = chunk.content;\n        if (chunkContent) {\n            fullContent += chunkContent;\n            // Extract completion status\n            const statusMatch = fullContent.match(/Completion Status:\\s*(COMPLETE|INCOMPLETE)/i);\n            if (statusMatch) {\n                completionStatus = statusMatch[1].toUpperCase();\n            }\n            // Extract chain of thought from the accumulating content\n            const cotMatch = fullContent.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Completion Status:|$)/i);\n            if (cotMatch) {\n                const newCot = cotMatch[1].trim();\n                if (newCot !== chainOfThought) {\n                    const previousLength = chainOfThought.length;\n                    chainOfThought = newCot;\n                    // Emit real-time chain of thought updates\n                    const newReasoning = chainOfThought.substring(previousLength);\n                    if (newReasoning.trim()) {\n                        console.log(`🔍 Real-time Completion COT: ${newReasoning.substring(0, 100)}${newReasoning.length > 100 ? \"...\" : \"\"}`);\n                        // Add to chat messages immediately for real-time display\n                        cotMessages.push(new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`🔍 ${newReasoning.trim()}`));\n                        emitEvent(sessionId || \"\", {\n                            type: \"chain_of_thought\",\n                            step: \"completion\",\n                            reasoning: chainOfThought.length > 500 ? chainOfThought.substring(0, 500) + \"...\" : chainOfThought,\n                            isPartial: true\n                        });\n                    }\n                }\n            }\n        }\n        // Handle tool calls in streaming\n        if (chunk.tool_calls && chunk.tool_calls.length > 0) {\n            for (const toolCall of chunk.tool_calls){\n                console.log(`🔧 Completion Tool called: ${toolCall.name}`, toolCall.args);\n                try {\n                    const tool = _tools__WEBPACK_IMPORTED_MODULE_5__.tools.find((t)=>t.name === toolCall.name);\n                    if (tool) {\n                        const wrappedTool = (0,_tools__WEBPACK_IMPORTED_MODULE_5__.wrapToolWithLogging)(tool, toolCall.name);\n                        const result = await wrappedTool(toolCall.args);\n                        console.log(`✅ Completion Tool ${toolCall.name} executed successfully:`, result);\n                        // Handle specific tool results\n                        if (toolCall.name === \"read_file\") {\n                            const args = toolCall.args;\n                            if (args.filePath && typeof result === \"string\") {\n                                completedFiles[args.filePath] = result;\n                            }\n                        } else if (toolCall.name === \"write_file\" || toolCall.name === \"append_to_file\") {\n                            const args = toolCall.args;\n                            if (args.filePath && args.content) {\n                                completedFiles[args.filePath] = args.content;\n                            }\n                        }\n                    } else {\n                        console.warn(`⚠️ Completion Tool ${toolCall.name} not found`);\n                    }\n                } catch (error) {\n                    console.error(`❌ Completion Tool ${toolCall.name} execution failed:`, error);\n                }\n            }\n        }\n    }\n    // Final processing\n    console.log(`📊 Completion check result: ${completionStatus}`);\n    // Fallback: parse files from content if no tool calls\n    if (Object.keys(completedFiles).length === 0) {\n        const newFiles = parseGeneratedFiles(fullContent);\n        Object.assign(completedFiles, newFiles);\n    }\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Completion check: ${completionStatus}. ${chainOfThought.substring(0, 200)}...`);\n    // Emit completion results\n    emitEvent(sessionId || \"\", {\n        type: \"completion_check\",\n        status: completionStatus,\n        reasoning: chainOfThought,\n        filesCompleted: Object.keys(completedFiles)\n    });\n    if (completionStatus === \"COMPLETE\") {\n        emitEvent(sessionId || \"\", {\n            type: \"status\",\n            message: \"Code completion verified - proceeding to review...\"\n        });\n    }\n    // Emit real-time messages for chat display\n    if (cotMessages.length > 0) {\n        cotMessages.forEach((message)=>{\n            emitEvent(sessionId || \"\", {\n                type: \"agent_message\",\n                content: message.content.toString(),\n                timestamp: new Date().toISOString()\n            });\n        });\n    }\n    return {\n        generatedFiles: completedFiles,\n        messages: cotMessages.length > 0 ? cotMessages : chainOfThought ? [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Completion Analysis: ${chainOfThought}`)\n        ] : []\n    };\n}\nfunction shouldContinue(state) {\n    // Defensive logging to help debug branch routing issues\n    try {\n        const planLen = Array.isArray(state.plan) ? state.plan.length : 0;\n        const currentIt = typeof state.currentIteration === \"number\" ? state.currentIteration : 0;\n        const reviewIter = typeof state.reviewIterations === \"number\" ? state.reviewIterations : 0;\n        const feedback = state.reviewFeedback || \"\";\n        console.log(\"shouldContinue check\", {\n            isComplete: state.isComplete,\n            planLength: planLen,\n            currentIteration: currentIt,\n            hasReviewFeedback: !!feedback,\n            reviewIterations: reviewIter\n        });\n        // Defensive guard: if we've looped through reviews too many times, stop to avoid\n        // LangGraph recursion/looping issues. Emit an event for diagnostics.\n        if (reviewIter >= 10) {\n            console.warn(`⚠️ Excessive review iterations (${reviewIter}), forcing end to avoid recursion`);\n            try {\n                emitEvent && emitEvent(\"\", {\n                    type: \"diagnostic\",\n                    message: `Exceeded review iteration limit (${reviewIter}), ending workflow to prevent infinite loop.`\n                });\n            } catch (e) {\n            // ignore\n            }\n            return \"end\";\n        }\n        // If marked complete, we're done\n        if (state.isComplete) {\n            console.log(\"shouldContinue -> end (isComplete)\");\n            return \"end\";\n        }\n        // Start with planning if no plan exists\n        if (planLen === 0) {\n            console.log(\"shouldContinue -> planner (no plan)\");\n            return \"planner\";\n        }\n        // If we haven't finished all steps, continue generating\n        if (currentIt < planLen) {\n            console.log(\"shouldContinue -> generator (still steps left)\");\n            return \"generator\";\n        }\n        // All steps completed - if no review feedback yet, go to completion check\n        // But if we're already in completion and have no feedback, we need to proceed to review\n        // This handles the case where completion agent found issues and we need to review\n        if (!feedback) {\n            // Check if we've been through completion already by looking at currentIteration\n            // If currentIteration equals plan length, we've completed generation\n            // If we have generatedFiles but no feedback, we should go to reviewer\n            const hasGeneratedFiles = Object.keys(state.generatedFiles || {}).length > 0;\n            if (hasGeneratedFiles && currentIt >= planLen) {\n                console.log(\"shouldContinue -> reviewer (generation complete, ready for review)\");\n                return \"reviewer\";\n            } else {\n                console.log(\"shouldContinue -> completion (all steps done, checking completeness)\");\n                return \"completion\";\n            }\n        }\n        // If we have review feedback but are still in completion node, go to reviewer\n        // This handles the case where completion agent provided feedback and we need review\n        if (feedback && currentIt >= planLen) {\n            console.log(\"shouldContinue -> reviewer (completion done, proceeding to review)\");\n            return \"reviewer\";\n        }\n        // Review feedback exists - check if approved\n        const up = feedback.toUpperCase();\n        const isApproved = up.includes(\"APPROVED\") && !feedback.toLowerCase().includes(\"missing\") && !feedback.toLowerCase().includes(\"not implemented\");\n        if (isApproved) {\n            // Approved - we're done!\n            console.log(\"shouldContinue -> end (approved)\");\n            return \"end\";\n        }\n        // Not approved - check if we can retry\n        if (reviewIter >= 3) {\n            // Max iterations reached, force end\n            console.log(\"⚠️ Max review iterations reached, ending\");\n            return \"end\";\n        }\n        // Not approved and can retry - go to fix_issues\n        console.log(`🔄 Review not approved (iteration ${reviewIter}), going to fix_issues`);\n        return \"fix_issues\";\n    } catch (err) {\n        console.error(\"Error in shouldContinue:\", err);\n        // Safe fallback - end the workflow rather than crash\n        return \"end\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGFBQWF5QixHQUFHM0IsUUFBUSxDQUFDLGVBQ1osQ0FBQ0MsU0FBU0csV0FBVyxHQUFHSixRQUFRLENBQUMsY0FDakMsQ0FBQ0MsU0FBU0csV0FBVyxHQUFHSixRQUFRLENBQUM7UUFFcEQsSUFBSUUsWUFBWTtZQUNkLHlCQUF5QjtZQUN6QjdELFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU87UUFDVDtRQUVBLHVDQUF1QztRQUN2QyxJQUFJZ0YsY0FBYyxHQUFHO1lBQ25CLG9DQUFvQztZQUNwQ2pGLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU87UUFDVDtRQUVBLGdEQUFnRDtRQUNoREQsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUVnRixXQUFXLHNCQUFzQixDQUFDO1FBQ25GLE9BQU87SUFFVCxFQUFFLE9BQU9NLEtBQUs7UUFDWnZGLFFBQVE2QixLQUFLLENBQUMsNEJBQTRCMEQ7UUFDMUMscURBQXFEO1FBQ3JELE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvLi9saWIvYWdlbnRzL3N0cmVhbWluZy1hZ2VudHMudHM/YjM3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlTWVzc2FnZSwgSHVtYW5NZXNzYWdlLCBBSU1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UgfSBmcm9tICdAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXMnO1xuaW1wb3J0IHsgdG9vbExvZ2dlciB9IGZyb20gJy4uL3V0aWxzL3Rvb2wtbG9nZ2VyJztcbmltcG9ydCB7IHByb21wdE9wdGltaXplciB9IGZyb20gJy4uL3V0aWxzL3Byb21wdC1vcHRpbWl6ZXInO1xuaW1wb3J0IHsgY29tcHJlc3NDb250ZXh0LCBzdW1tYXJpemVGaWxlQ29udGVudHMsIGVzdGltYXRlVG9rZW5zLCBzaG91bGRDb21wcmVzcywgc21hcnRUcnVuY2F0ZSB9IGZyb20gJy4uL3V0aWxzL3N1bW1hcml6ZXInO1xuaW1wb3J0IHsgZ2V0TWVtb3J5LCBnZXRQcm9qZWN0Rm9sZGVyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBsbG0sIGNyZWF0ZUxMTSB9IGZyb20gJy4vbW9kZWwtcHJvdmlkZXJzJztcbmltcG9ydCB7IHRvb2xzLCB3cmFwVG9vbFdpdGhMb2dnaW5nIH0gZnJvbSAnLi90b29scyc7XG5pbXBvcnQgeyBBZ2VudFN0YXRlVHlwZSB9IGZyb20gJy4vYWdlbnQtY29yZSc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG4vLyBJbXBvcnQgdGhlIGVtaXQgZnVuY3Rpb24gZnJvbSB0aGUgQVBJIHJvdXRlXG5sZXQgZW1pdEV2ZW50OiAoc2Vzc2lvbklkOiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdm9pZCA9ICgpID0+IHt9O1xuZXhwb3J0IGZ1bmN0aW9uIHNldEVtaXRGdW5jdGlvbihmbjogKHNlc3Npb25JZDogc3RyaW5nLCBkYXRhOiBhbnkpID0+IHZvaWQpIHtcbiAgZW1pdEV2ZW50ID0gZm47XG59XG5cbi8vIEJpbmQgdG9vbHMgdG8gdGhlIExMTVxuY29uc3QgbGxtV2l0aFRvb2xzID0gbGxtLmJpbmRUb29scyh0b29scyk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgY29tcHJlaGVuc2l2ZSB0b29sIGxpc3QgZm9yIHByb21wdHNcbmZ1bmN0aW9uIGdldFRvb2xEZWZpbml0aW9ucygpOiBzdHJpbmcge1xuICByZXR1cm4gYFxuQVZBSUxBQkxFIFRPT0xTOlxuLSByZWFkX2ZpbGU6IFJlYWQgdGhlIGNvbnRlbnRzIG9mIGEgZmlsZS4gVXNlIHRoaXMgdG8gZXhhbWluZSBleGlzdGluZyBjb2RlIG9yIGRvY3VtZW50cy4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nIH1cbi0gd3JpdGVfZmlsZTogQ3JlYXRlIG5ldyBmaWxlcyBvciByZXBsYWNlIGVudGlyZSBmaWxlcy4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcgfVxuLSBhcHBlbmRfdG9fZmlsZTogQWRkIGNvbnRlbnQgdG8gdGhlIGVuZCBvZiBhbiBleGlzdGluZyBmaWxlLiBQYXJhbWV0ZXJzOiB7IGZpbGVQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyB9XG4tIGRlbGV0ZV9maWxlOiBEZWxldGUgYSBmaWxlIGZyb20gdGhlIGZpbGVzeXN0ZW0uIFBhcmFtZXRlcnM6IHsgZmlsZVBhdGg6IHN0cmluZyB9XG4tIGxpc3RfZGlyZWN0b3J5OiBMaXN0IHRoZSBjb250ZW50cyBvZiBhIGRpcmVjdG9yeS4gVXNlIHRoaXMgdG8gc2VlIHdoYXQgZmlsZXMgYXJlIGF2YWlsYWJsZS4gUGFyYW1ldGVyczogeyBkaXJQYXRoOiBzdHJpbmcgfVxuLSBzZWFyY2hfZmlsZXM6IFNlYXJjaCBmb3IgZmlsZXMgY29udGFpbmluZyBhIHJlZ2V4IHBhdHRlcm4uIFVzZSB0aGlzIHRvIGZpbmQgc3BlY2lmaWMgY29kZSBwYXR0ZXJucyBvciB0ZXh0LiBQYXJhbWV0ZXJzOiB7IGRpclBhdGg6IHN0cmluZywgcGF0dGVybjogc3RyaW5nIH1cbi0gcmVwbGFjZV9pbl9maWxlOiBGaW5kIGFuZCByZXBsYWNlIHRleHQgaW4gYSBmaWxlIHVzaW5nIHJlZ2V4LiBVc2UgdGhpcyBmb3IgcmVmYWN0b3Jpbmcgb3IgZml4aW5nIGNvZGUgcGF0dGVybnMuIFBhcmFtZXRlcnM6IHsgZmlsZVBhdGg6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nLCByZXBsYWNlVGV4dDogc3RyaW5nIH1cbi0gaW5zZXJ0X2F0X2xpbmU6IEluc2VydCBjb250ZW50IGF0IGEgc3BlY2lmaWMgbGluZSBudW1iZXIgaW4gYSBmaWxlLiBVc2UgdGhpcyBmb3IgcHJlY2lzZSBjb2RlIGFkZGl0aW9ucy4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nLCBsaW5lTnVtYmVyOiBudW1iZXIsIGNvbnRlbnQ6IHN0cmluZyB9XG4tIGRlbGV0ZV9saW5lczogRGVsZXRlIGEgcmFuZ2Ugb2YgbGluZXMgZnJvbSBhIGZpbGUuIFVzZSB0aGlzIHRvIHJlbW92ZSBjb2RlIGJsb2Nrcy4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nLCBzdGFydExpbmU6IG51bWJlciwgZW5kTGluZTogbnVtYmVyIH1cbi0gcmVwbGFjZV9ibG9jazogUmVwbGFjZSBhIGJsb2NrIG9mIGNvZGUgYmV0d2VlbiB0d28gbWFya2Vycy4gTW9yZSBlZmZpY2llbnQgdGhhbiByZXdyaXRpbmcgZW50aXJlIGZpbGUuIFBlcmZlY3QgZm9yIHVwZGF0aW5nIGZ1bmN0aW9ucywgY2xhc3Nlcywgb3Igc2VjdGlvbnMuIFBhcmFtZXRlcnM6IHsgZmlsZVBhdGg6IHN0cmluZywgc3RhcnRNYXJrZXI6IHN0cmluZywgZW5kTWFya2VyOiBzdHJpbmcsIG5ld0NvbnRlbnQ6IHN0cmluZyB9XG4tIHJlcGxhY2VfbGluZV9yYW5nZTogUmVwbGFjZSBhIHNwZWNpZmljIHJhbmdlIG9mIGxpbmVzIHdpdGggbmV3IGNvbnRlbnQuIE1vcmUgcHJlY2lzZSB0aGFuIHJlcGxhY2VfYmxvY2suIFVzZSB3aGVuIHlvdSBrbm93IGV4YWN0IGxpbmUgbnVtYmVycy4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nLCBzdGFydExpbmU6IG51bWJlciwgZW5kTGluZTogbnVtYmVyLCBuZXdDb250ZW50OiBzdHJpbmcgfVxuLSByZWFkX2xpbmVzOiBSZWFkIGEgc3BlY2lmaWMgcmFuZ2Ugb2YgbGluZXMgZnJvbSBhIGZpbGUuIFVzZSB0aGlzIHRvIGV4YW1pbmUgc3BlY2lmaWMgY29kZSBzZWN0aW9ucy4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nLCBzdGFydExpbmU6IG51bWJlciwgZW5kTGluZTogbnVtYmVyIH1cbi0gZ2V0X2ZpbGVfaW5mbzogR2V0IGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IGEgZmlsZSAoc2l6ZSwgbGluZXMsIGRhdGVzLCBldGMuKS4gVXNlIHRoaXMgdG8gdW5kZXJzdGFuZCBmaWxlIHN0cnVjdHVyZS4gUGFyYW1ldGVyczogeyBmaWxlUGF0aDogc3RyaW5nIH1cbi0gY3JlYXRlX2RpcmVjdG9yeTogQ3JlYXRlIGEgbmV3IGRpcmVjdG9yeSAoaW5jbHVkaW5nIHBhcmVudCBkaXJlY3RvcmllcyBpZiBuZWVkZWQpLiBVc2UgdGhpcyB0byBvcmdhbml6ZSBwcm9qZWN0IHN0cnVjdHVyZS4gUGFyYW1ldGVyczogeyBkaXJQYXRoOiBzdHJpbmcgfVxuLSBjb3B5X2ZpbGU6IENvcHkgYSBmaWxlIHRvIGEgbmV3IGxvY2F0aW9uLiBVc2UgdGhpcyB0byBkdXBsaWNhdGUgZmlsZXMgb3IgY3JlYXRlIHRlbXBsYXRlcy4gUGFyYW1ldGVyczogeyBzb3VyY2VQYXRoOiBzdHJpbmcsIGRlc3RpbmF0aW9uUGF0aDogc3RyaW5nIH1cbi0gbW92ZV9maWxlOiBNb3ZlIG9yIHJlbmFtZSBhIGZpbGUuIFVzZSB0aGlzIHRvIHJlb3JnYW5pemUgcHJvamVjdCBzdHJ1Y3R1cmUuIFBhcmFtZXRlcnM6IHsgc291cmNlUGF0aDogc3RyaW5nLCBkZXN0aW5hdGlvblBhdGg6IHN0cmluZyB9XG4tIGdldF9wcm9qZWN0X3N0cnVjdHVyZTogR2V0IGEgdHJlZSB2aWV3IG9mIHRoZSBwcm9qZWN0IGRpcmVjdG9yeSBzdHJ1Y3R1cmUuIFVzZSB0aGlzIHRvIHVuZGVyc3RhbmQgcHJvamVjdCBvcmdhbml6YXRpb24uIFBhcmFtZXRlcnM6IHsgbWF4RGVwdGg/OiBudW1iZXIgfVxuLSBleGVjdXRlX2NvbW1hbmQ6IEV4ZWN1dGUgYSBzaGVsbCBjb21tYW5kIGluIHRoZSBwcm9qZWN0IGRpcmVjdG9yeS4gVXNlIHRoaXMgZm9yIG5wbSBpbnN0YWxsLCBnaXQgb3BlcmF0aW9ucywgYnVpbGRpbmcsIHRlc3RpbmcsIGV0Yy4gQUxXQVlTIHByb3ZpZGUgYSBjbGVhciBkZXNjcmlwdGlvbi4gUGFyYW1ldGVyczogeyBjb21tYW5kOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcgfVxuLSBzZWFyY2hfc2ltaWxhcl9jb2RlOiBTZWFyY2ggZm9yIHNpbWlsYXIgY29kZSBleGFtcGxlcyBpbiB0aGUgdmVjdG9yIGRhdGFiYXNlLiBVc2UgdGhpcyB0byBmaW5kIHJlbGV2YW50IGNvZGUgcGF0dGVybnMgYW5kIGltcGxlbWVudGF0aW9ucy4gUGFyYW1ldGVyczogeyBxdWVyeTogc3RyaW5nLCBtYXhSZXN1bHRzPzogbnVtYmVyIH1cbi0gZ2V0X3Byb2plY3RfY29udGV4dDogR2V0IGNvbXByZWhlbnNpdmUgcHJvamVjdCBzdGF0aXN0aWNzIGFuZCBzdHJ1Y3R1cmUgaW5mb3JtYXRpb24gZnJvbSB0aGUgdmVjdG9yIGRhdGFiYXNlLiBQYXJhbWV0ZXJzOiB7fVxuXG5UT09MIFVTQUdFIEdVSURFTElORVM6XG4tIFVzZSB0b29scyBieSBjYWxsaW5nIHRoZW0gZGlyZWN0bHkgaW4geW91ciByZXNwb25zZVxuLSBFYWNoIHRvb2wgY2FsbCBzaG91bGQgYmUgYSBzZXBhcmF0ZSBmdW5jdGlvbiBjYWxsIHdpdGggcHJvcGVyIEpTT04gYXJndW1lbnRzXG4tIFRvb2xzIHdpbGwgYXV0b21hdGljYWxseSBleGVjdXRlIGFuZCBwcm92aWRlIHJlc3VsdHNcbi0gRm9ybWF0OiBDYWxsIHRvb2xzIGxpa2Ugbm9ybWFsIGZ1bmN0aW9uIGNhbGxzIHdpdGggdGhlIHRvb2wgbmFtZSBhbmQgYXJndW1lbnRzXG4tIEV4YW1wbGU6IHdyaXRlX2ZpbGUoeyBcImZpbGVQYXRoXCI6IFwiaW5kZXguaHRtbFwiLCBcImNvbnRlbnRcIjogXCI8aHRtbD4uLi48L2h0bWw+XCIgfSlcbi0gQWx3YXlzIHJlYWQgZmlsZXMgZmlyc3QgdG8gdW5kZXJzdGFuZCBjdXJyZW50IHN0YXRlIGJlZm9yZSBtYWtpbmcgY2hhbmdlc1xuLSBVc2Ugc2VhcmNoX2ZpbGVzIHRvIGZpbmQgZXhpc3RpbmcgY29kZSBwYXR0ZXJucyBiZWZvcmUgaW1wbGVtZW50aW5nIG5ldyBvbmVzXG4tIFRlc3QgeW91ciBjaGFuZ2VzIGJ5IHJlYWRpbmcgZmlsZXMgYmFjayB0byB2ZXJpZnkgY29ycmVjdG5lc3Ncbi0gVXNlIGV4ZWN1dGVfY29tbWFuZCBmb3IgbnBtLCBnaXQsIGJ1aWxkLCBhbmQgdGVzdCBvcGVyYXRpb25zYDtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHBhcnNlIGdlbmVyYXRlZCBmaWxlcyBmcm9tIExMTSBvdXRwdXRcbmZ1bmN0aW9uIHBhcnNlR2VuZXJhdGVkRmlsZXMoY29udGVudDogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gIGNvbnN0IGZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGNvbnN0IGZpbGVSZWdleCA9IC9GSUxFTkFNRTpcXHMqKC4rPylcXG5gYGAoXFx3Kyk/XFxuKFtcXHNcXFNdKj8pYGBgL2c7XG5cbiAgbGV0IG1hdGNoO1xuICB3aGlsZSAoKG1hdGNoID0gZmlsZVJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG4gICAgY29uc3QgZmlsZW5hbWUgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgY29uc3QgY29kZSA9IG1hdGNoWzNdLnRyaW0oKTtcbiAgICBmaWxlc1tmaWxlbmFtZV0gPSBjb2RlO1xuICB9XG5cbiAgcmV0dXJuIGZpbGVzO1xufVxuXG4vLyBTdHJlYW1pbmcgUGxhbm5lciBBZ2VudDogQnJlYWtzIGRvd24gdXNlciByZXF1ZXN0IGludG8gYWN0aW9uYWJsZSBzdGVwc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0cmVhbWluZ1BsYW5uZXJBZ2VudChzdGF0ZTogQWdlbnRTdGF0ZVR5cGUsIHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8QWdlbnRTdGF0ZVR5cGU+PiB7XG4gIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ3N0YXR1cycsIG1lc3NhZ2U6ICdQbGFubmluZyB5b3VyIHJlcXVlc3QuLi4nIH0pO1xuXG4gIGNvbnN0IG1lbW9yeSA9IGdldE1lbW9yeSgpO1xuXG4gIC8vIEFkZCB1c2VyIHJlcXVlc3QgdG8gbWVtb3J5XG4gIGF3YWl0IG1lbW9yeS5hZGRNZXNzYWdlKCd1c2VyJywgc3RhdGUudXNlclJlcXVlc3QpO1xuXG4gIC8vIEdldCBjb21wcmVzc2VkIGNvbnRleHQgZnJvbSBtZW1vcnlcbiAgY29uc3QgY29udGV4dFN1bW1hcnkgPSBhd2FpdCBtZW1vcnkuZ2V0Q29tcHJlc3NlZENvbnRleHQoc3RhdGUudXNlclJlcXVlc3QpO1xuICBjb25zdCBzZXNzaW9uRmlsZXMgPSBhd2FpdCBtZW1vcnkuZ2V0U2Vzc2lvbkZpbGVzKCk7XG5cbiAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGV4aXN0aW5nIGZpbGVzIC0gaWYgc28sIHRoaXMgaXMgYSBtb2RpZmljYXRpb24gcmVxdWVzdFxuICBjb25zdCBoYXNFeGlzdGluZ0ZpbGVzID0gT2JqZWN0LmtleXMoc3RhdGUuZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aCA+IDAgfHwgc2Vzc2lvbkZpbGVzLmxlbmd0aCA+IDA7XG5cbiAgbGV0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgc2VuaW9yIHNvZnR3YXJlIGFyY2hpdGVjdC4gQW5hbHl6ZSB0aGUgdXNlcidzIHJlcXVlc3QgYW5kIGNyZWF0ZSBhIGNsZWFyIHBsYW4uXG5cbiR7aGFzRXhpc3RpbmdGaWxlcyA/IGBcbklNUE9SVEFOVDogVGhlcmUgYXJlIEVYSVNUSU5HIEZJTEVTIGluIHRoaXMgc2Vzc2lvbi4gVGhlIHVzZXIgd2FudHMgdG8gTU9ESUZZIG9yIEVOSEFOQ0UgdGhlbS5cblNlc3Npb24gZmlsZXM6ICR7c2Vzc2lvbkZpbGVzLmxlbmd0aCA+IDAgPyBzZXNzaW9uRmlsZXMuam9pbignLCAnKSA6ICdOb25lJ31cbkN1cnJlbnQgc3RhdGUgZmlsZXM6ICR7T2JqZWN0LmtleXMoc3RhdGUuZ2VuZXJhdGVkRmlsZXMpLmpvaW4oJywgJyl9XG5cbllvdXIgcGxhbiBzaG91bGQgZm9jdXMgb24gTU9ESUZZSU5HIHRoZXNlIGV4aXN0aW5nIGZpbGVzLCBub3QgY3JlYXRpbmcgbmV3IHJhbmRvbSBmaWxlcy5cbmAgOiBgXG5UaGlzIGlzIGEgTkVXIHByb2plY3QuIENyZWF0ZSBhIHBsYW4gdG8gYnVpbGQgaXQgZnJvbSBzY3JhdGNoLlxuYH1cblxuJHtjb250ZXh0U3VtbWFyeSA/IGBcXG5SRUNFTlQgQ09OVEVYVDpcXG4ke3NtYXJ0VHJ1bmNhdGUoY29udGV4dFN1bW1hcnksIDgwMCl9YCA6ICcnfVxuXG4ke2dldFRvb2xEZWZpbml0aW9ucygpfVxuXG5PVVRQVVQgRk9STUFUOiBKdXN0IG51bWJlcmVkIHN0ZXBzIGxpa2U6XG4xLiBDcmVhdGUvTW9kaWZ5IFtzcGVjaWZpYyBmaWxlXSAtIFt3aGF0IHRvIGRvXVxuMi4gVXBkYXRlIFtzcGVjaWZpYyBmaWxlXSAtIFt3aGF0IHRvIGNoYW5nZV1cbjMuIEFkZCBbZmVhdHVyZV0gdG8gW2ZpbGVdXG5cblJVTEVTOlxuLSBNYXhpbXVtIDUgc3RlcHNcbi0gQmUgU1BFQ0lGSUMgYWJvdXQgd2hpY2ggZmlsZXMgdG8gY3JlYXRlL21vZGlmeVxuLSBJZiBtb2RpZnlpbmcsIHNheSBcIk1vZGlmeVwiIG9yIFwiVXBkYXRlXCIsIG5vdCBcIkNyZWF0ZVwiXG4tIEVhY2ggc3RlcCBzaG91bGQgcHJvZHVjZSB0YW5naWJsZSBjb2RlXG4tIEtlZXAgaXQgc2ltcGxlIGFuZCBhY3Rpb25hYmxlYDtcblxuICAvLyBPcHRpbWl6ZSB0aGUgc3lzdGVtIHByb21wdFxuICBzeXN0ZW1Qcm9tcHQgPSBwcm9tcHRPcHRpbWl6ZXIub3B0aW1pemVTeXN0ZW1Qcm9tcHQoc3lzdGVtUHJvbXB0LCBjb250ZXh0U3VtbWFyeSB8fCB1bmRlZmluZWQpO1xuXG4gIGxldCBjb250ZXh0SW5mbyA9IGBVc2VyIHJlcXVlc3Q6ICR7c3RhdGUudXNlclJlcXVlc3R9YDtcblxuICBpZiAoaGFzRXhpc3RpbmdGaWxlcykge1xuICAgIGNvbnN0IGFsbEZpbGVzID0gQXJyYXkuZnJvbShuZXcgU2V0KFsuLi5zZXNzaW9uRmlsZXMsIC4uLk9iamVjdC5rZXlzKHN0YXRlLmdlbmVyYXRlZEZpbGVzKV0pKTtcbiAgICBjb250ZXh0SW5mbyArPSBgXFxuXFxuRVhJU1RJTkcgUFJPSkVDVCBGSUxFUzpcXG4ke2FsbEZpbGVzLm1hcChmID0+IGAtICR7Zn1gKS5qb2luKCdcXG4nKX1gO1xuICAgIGNvbnRleHRJbmZvICs9IGBcXG5cXG5UaGUgdXNlciB3YW50cyB0byBtb2RpZnkvZW5oYW5jZSB0aGUgZXhpc3RpbmcgcHJvamVjdC4gQ3JlYXRlIGEgcGxhbiB0aGF0IHdvcmtzIFdJVEggdGhlc2UgZmlsZXMuYDtcbiAgfVxuXG4gIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgIG5ldyBTeXN0ZW1NZXNzYWdlKHN5c3RlbVByb21wdCksXG4gICAgbmV3IEh1bWFuTWVzc2FnZShjb250ZXh0SW5mbyksXG4gIF07XG5cbiAgLy8gVXNlIG1vZGVsLXNwZWNpZmljIExMTSBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBnbG9iYWwgbGxtXG4gIGNvbnN0IGxsbVRvVXNlID0gbW9kZWwgPyBjcmVhdGVMTE0obW9kZWwpIDogbGxtO1xuICBjb25zdCBzdHJlYW0gPSBhd2FpdCBsbG1Ub1VzZS5zdHJlYW0obWVzc2FnZXMpO1xuXG4gIGxldCBwbGFuVGV4dCA9ICcnO1xuICBsZXQgY2hhaW5PZlRob3VnaHQgPSAnJztcbiAgY29uc3QgY290TWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW107IC8vIENvbGxlY3QgQ09UIG1lc3NhZ2VzIGZvciBjaGF0XG5cbiAgLy8gUHJvY2VzcyB0aGUgc3RyZWFtaW5nIHJlc3BvbnNlXG4gIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgY29uc3QgY2h1bmtDb250ZW50ID0gY2h1bmsuY29udGVudDtcbiAgICBpZiAoY2h1bmtDb250ZW50KSB7XG4gICAgICBwbGFuVGV4dCArPSBjaHVua0NvbnRlbnQ7XG5cbiAgICAgIC8vIEV4dHJhY3QgY2hhaW4gb2YgdGhvdWdodCBmcm9tIHRoZSBhY2N1bXVsYXRpbmcgY29udGVudFxuICAgICAgY29uc3QgY290TWF0Y2ggPSBwbGFuVGV4dC5tYXRjaCgvQ2hhaW4gb2YgVGhvdWdodDpcXHMqKFtcXHNcXFNdKj8pKD89XFxkK1xcLnwkKS9pKTtcbiAgICAgIGlmIChjb3RNYXRjaCkge1xuICAgICAgICBjb25zdCBuZXdDb3QgPSBjb3RNYXRjaFsxXS50cmltKCk7XG4gICAgICAgIGlmIChuZXdDb3QgIT09IGNoYWluT2ZUaG91Z2h0KSB7XG4gICAgICAgICAgY29uc3QgcHJldmlvdXNMZW5ndGggPSBjaGFpbk9mVGhvdWdodC5sZW5ndGg7XG4gICAgICAgICAgY2hhaW5PZlRob3VnaHQgPSBuZXdDb3Q7XG5cbiAgICAgICAgICAvLyBFbWl0IHJlYWwtdGltZSBjaGFpbiBvZiB0aG91Z2h0IHVwZGF0ZXNcbiAgICAgICAgICBjb25zdCBuZXdSZWFzb25pbmcgPSBjaGFpbk9mVGhvdWdodC5zdWJzdHJpbmcocHJldmlvdXNMZW5ndGgpO1xuICAgICAgICAgIGlmIChuZXdSZWFzb25pbmcudHJpbSgpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UjSBSZWFsLXRpbWUgUGxhbm5lciBDT1Q6ICR7bmV3UmVhc29uaW5nLnN1YnN0cmluZygwLCAxMDApfSR7bmV3UmVhc29uaW5nLmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJyd9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCB0byBjaGF0IG1lc3NhZ2VzIGltbWVkaWF0ZWx5IGZvciByZWFsLXRpbWUgZGlzcGxheVxuICAgICAgICAgICAgY290TWVzc2FnZXMucHVzaChuZXcgQUlNZXNzYWdlKGDwn5SNICR7bmV3UmVhc29uaW5nLnRyaW0oKX1gKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgICAgICAgICAgdHlwZTogJ2NoYWluX29mX3Rob3VnaHQnLFxuICAgICAgICAgICAgICBzdGVwOiAncGxhbm5lcicsXG4gICAgICAgICAgICAgIHJlYXNvbmluZzogY2hhaW5PZlRob3VnaHQubGVuZ3RoID4gNTAwID8gY2hhaW5PZlRob3VnaHQuc3Vic3RyaW5nKDAsIDUwMCkgKyAnLi4uJyA6IGNoYWluT2ZUaG91Z2h0LFxuICAgICAgICAgICAgICBpc1BhcnRpYWw6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBBZGQgcGxhbiB0byBtZW1vcnlcbiAgYXdhaXQgbWVtb3J5LmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGBQbGFubmluZzogJHtwbGFuVGV4dC5zdWJzdHJpbmcoMCwgMjAwKX0uLi5gKTtcblxuICAvLyBQYXJzZSB0aGUgcGxhbiBpbnRvIHN0ZXBzXG4gIGNvbnN0IHBsYW5TdGVwcyA9IHBsYW5UZXh0XG4gICAgLnNwbGl0KCdcXG4nKVxuICAgIC5maWx0ZXIobGluZSA9PiAvXlxcZCtcXC4vLnRlc3QobGluZS50cmltKCkpKVxuICAgIC5tYXAobGluZSA9PiBsaW5lLnJlcGxhY2UoL15cXGQrXFwuXFxzKi8sICcnKS50cmltKCkpXG4gICAgLmZpbHRlcihzdGVwID0+IHN0ZXAubGVuZ3RoID4gMClcbiAgICAuc2xpY2UoMCwgNSk7IC8vIExpbWl0IHRvIDUgc3RlcHNcblxuICBjb25zb2xlLmxvZyhg8J+TiyBHZW5lcmF0ZWQgcGxhbiB3aXRoICR7cGxhblN0ZXBzLmxlbmd0aH0gc3RlcHM6YCwgcGxhblN0ZXBzKTtcblxuICAvLyBFbWl0IHBsYW4gdG8gY2xpZW50XG4gIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ3BsYW4nLCBwbGFuOiBwbGFuU3RlcHMgfSk7XG5cbiAgLy8gRW1pdCByZWFsLXRpbWUgbWVzc2FnZXMgZm9yIGNoYXQgZGlzcGxheVxuICBpZiAoY290TWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgIGNvdE1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UpID0+IHtcbiAgICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgICAgdHlwZTogJ2FnZW50X21lc3NhZ2UnLFxuICAgICAgICBjb250ZW50OiBtZXNzYWdlLmNvbnRlbnQudG9TdHJpbmcoKSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcGxhbjogcGxhblN0ZXBzLFxuICAgIG1lc3NhZ2VzOiBjb3RNZXNzYWdlcy5sZW5ndGggPiAwID8gY290TWVzc2FnZXMgOiAocGxhblRleHQgPyBbbmV3IEFJTWVzc2FnZShgUGxhbm5pbmc6ICR7cGxhblRleHQuc3Vic3RyaW5nKDAsIDUwMCl9JHtwbGFuVGV4dC5sZW5ndGggPiA1MDAgPyAnLi4uJyA6ICcnfWApXSA6IFtdKSwgLy8gSW5jbHVkZSByZWFsLXRpbWUgcGxhbm5pbmcgcmVhc29uaW5nIGluIGNoYXRcbiAgfTtcbn1cblxuLy8gU3RyZWFtaW5nIENvZGUgR2VuZXJhdG9yIEFnZW50OiBJbXBsZW1lbnRzIGVhY2ggc3RlcCBvZiB0aGUgcGxhblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0cmVhbWluZ0NvZGVHZW5lcmF0b3JBZ2VudChzdGF0ZTogQWdlbnRTdGF0ZVR5cGUsIHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8QWdlbnRTdGF0ZVR5cGU+PiB7XG4gIGNvbnN0IGN1cnJlbnRTdGVwID0gc3RhdGUuY3VycmVudEl0ZXJhdGlvbjtcbiAgY29uc3Qgc3RlcFRvSW1wbGVtZW50ID0gc3RhdGUucGxhbltjdXJyZW50U3RlcF07XG5cbiAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywge1xuICAgIHR5cGU6ICdzdGF0dXMnLFxuICAgIG1lc3NhZ2U6IGBHZW5lcmF0aW5nIGNvZGUgZm9yIHN0ZXAgJHtjdXJyZW50U3RlcCArIDF9OiAke3N0ZXBUb0ltcGxlbWVudD8uc3Vic3RyaW5nKDAsIDUwKX0uLi5gXG4gIH0pO1xuXG4gIGlmICghc3RlcFRvSW1wbGVtZW50KSB7XG4gICAgY29uc29sZS5sb2coJ+KaoO+4jyAgTm8gc3RlcCB0byBpbXBsZW1lbnQgYXQgaXRlcmF0aW9uJywgY3VycmVudFN0ZXApO1xuICAgIHJldHVybiB7IGlzQ29tcGxldGU6IHRydWUgfTtcbiAgfVxuXG4gIGNvbnN0IG1lbW9yeSA9IGdldE1lbW9yeSgpO1xuICBjb25zdCBjb250ZXh0U3VtbWFyeSA9IGF3YWl0IG1lbW9yeS5nZXRDb21wcmVzc2VkQ29udGV4dChzdGF0ZS51c2VyUmVxdWVzdCk7XG4gIGNvbnN0IHNlc3Npb25GaWxlcyA9IGF3YWl0IG1lbW9yeS5nZXRTZXNzaW9uRmlsZXMoKTtcblxuICAvLyBHZXQgZXhpc3RpbmcgZmlsZXMgZm9yIGNvbnRleHRcbiAgY29uc3QgZXhpc3RpbmdGaWxlcyA9IHsgLi4uc3RhdGUuZ2VuZXJhdGVkRmlsZXMgfTtcbiAgZm9yIChjb25zdCBmaWxlIG9mIHNlc3Npb25GaWxlcykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgaW1wb3J0KCdmcycpLnRoZW4oZnMgPT4gZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGYtOCcpKTtcbiAgICAgIGV4aXN0aW5nRmlsZXNbZmlsZV0gPSBjb250ZW50O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZWFkIGV4aXN0aW5nIGZpbGUgJHtmaWxlfTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgYW4gZXhwZXJ0IHNvZnR3YXJlIGVuZ2luZWVyLiBJbXBsZW1lbnQgdGhlIHNwZWNpZmllZCBzdGVwIHVzaW5nIHRoZSBhdmFpbGFibGUgdG9vbHMuXG5cbklNUE9SVEFOVCBSVUxFUzpcbi0gVXNlIHRoZSBwcm92aWRlZCB0b29scyB0byBjcmVhdGUvbW9kaWZ5IGZpbGVzXG4tIEVhY2ggdG9vbCBjYWxsIHNob3VsZCBiZSBwdXJwb3NlZnVsIGFuZCB0YXJnZXRlZFxuLSBSZWFkIGV4aXN0aW5nIGZpbGVzIGZpcnN0IHRvIHVuZGVyc3RhbmQgdGhlIGN1cnJlbnQgc3RhdGVcbi0gTWFrZSBpbmNyZW1lbnRhbCwgdGVzdGFibGUgY2hhbmdlc1xuLSBJbmNsdWRlIHByb3BlciBpbXBvcnRzIGFuZCBkZXBlbmRlbmNpZXNcbi0gRm9sbG93IHRoZSBleGlzdGluZyBjb2RlIHN0eWxlIGFuZCBwYXR0ZXJuc1xuLSBUZXN0IHlvdXIgY2hhbmdlcyBieSByZWFkaW5nIHRoZSBmaWxlcyBiYWNrXG5cbiR7Y29udGV4dFN1bW1hcnkgPyBgQ09OVEVYVDpcXG4ke3NtYXJ0VHJ1bmNhdGUoY29udGV4dFN1bW1hcnksIDYwMCl9XFxuXFxuYCA6ICcnfVxuXG4ke2dldFRvb2xEZWZpbml0aW9ucygpfVxuXG5PVVRQVVQgRk9STUFUOlxuQ2hhaW4gb2YgVGhvdWdodDogW1lvdXIgcmVhc29uaW5nIHByb2Nlc3NdXG5GaWxlczogW0xpc3Qgb2YgZmlsZXMgeW91J2xsIGNyZWF0ZS9tb2RpZnldXG5bVGhlbiB1c2UgdGhlIGFwcHJvcHJpYXRlIHRvb2xzIHRvIGltcGxlbWVudCB0aGUgY2hhbmdlc11cblxuVE9PTCBVU0FHRTpcbi0gVXNlIHRvb2xzIGJ5IGNhbGxpbmcgdGhlbSBkaXJlY3RseSBpbiB5b3VyIHJlc3BvbnNlXG4tIEVhY2ggdG9vbCBjYWxsIHNob3VsZCBiZSBhIHNlcGFyYXRlIGZ1bmN0aW9uIGNhbGwgd2l0aCBwcm9wZXIgSlNPTiBhcmd1bWVudHNcbi0gVG9vbHMgd2lsbCBhdXRvbWF0aWNhbGx5IGV4ZWN1dGUgYW5kIHByb3ZpZGUgcmVzdWx0c1xuLSBGb3JtYXQ6IENhbGwgdG9vbHMgbGlrZSBub3JtYWwgZnVuY3Rpb24gY2FsbHMgd2l0aCB0aGUgdG9vbCBuYW1lIGFuZCBhcmd1bWVudHNcbi0gRXhhbXBsZTogd3JpdGVfZmlsZSh7IFwiZmlsZVBhdGhcIjogXCJpbmRleC5odG1sXCIsIFwiY29udGVudFwiOiBcIjxodG1sPi4uLjwvaHRtbD5cIiB9KWA7XG5cbiAgY29uc3QgdXNlclByb21wdCA9IGBJbXBsZW1lbnQgdGhpcyBzdGVwOiBcIiR7c3RlcFRvSW1wbGVtZW50fVwiXG5cbkV4aXN0aW5nIHByb2plY3QgZmlsZXM6ICR7T2JqZWN0LmtleXMoZXhpc3RpbmdGaWxlcykuam9pbignLCAnKSB8fCAnTm9uZSd9XG5cbiR7c3RhdGUucmV2aWV3RmVlZGJhY2sgPyBgUHJldmlvdXMgcmV2aWV3IGZlZWRiYWNrIHRvIGFkZHJlc3M6ICR7c3RhdGUucmV2aWV3RmVlZGJhY2t9YCA6ICcnfWA7XG5cbiAgY29uc3QgbWVzc2FnZXMgPSBbXG4gICAgbmV3IFN5c3RlbU1lc3NhZ2Uoc3lzdGVtUHJvbXB0KSxcbiAgICBuZXcgSHVtYW5NZXNzYWdlKHVzZXJQcm9tcHQpLFxuICBdO1xuXG4gIC8vIFVzZSBtb2RlbC1zcGVjaWZpYyBMTE0gaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgZ2xvYmFsIGxsbVdpdGhUb29sc1xuICBjb25zdCBsbG1Ub1VzZSA9IG1vZGVsID8gY3JlYXRlTExNKG1vZGVsLCB0cnVlKSA6IGNyZWF0ZUxMTSh1bmRlZmluZWQsIHRydWUpOyAvLyBFbmFibGUgc3RyZWFtaW5nXG4gIGNvbnN0IGxsbVdpdGhUb29sc1RvVXNlID0gbW9kZWwgPyBsbG1Ub1VzZS5iaW5kVG9vbHModG9vbHMpIDogbGxtV2l0aFRvb2xzO1xuXG4gIC8vIFN0cmVhbSB0aGUgcmVzcG9uc2UgZm9yIHJlYWwtdGltZSBjaGFpbiBvZiB0aG91Z2h0XG4gIGNvbnN0IHN0cmVhbSA9IGF3YWl0IGxsbVdpdGhUb29sc1RvVXNlLnN0cmVhbShtZXNzYWdlcyk7XG5cbiAgLy8gRXh0cmFjdCBnZW5lcmF0ZWQgZmlsZXMgZnJvbSB0b29sIGNhbGxzIG9yIHJlc3BvbnNlIGNvbnRlbnRcbiAgY29uc3QgZ2VuZXJhdGVkRmlsZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgbGV0IGNoYWluT2ZUaG91Z2h0ID0gJyc7XG4gIGxldCBmdWxsQ29udGVudCA9ICcnO1xuICBsZXQgY3VycmVudENvdENodW5rID0gJyc7XG4gIGNvbnN0IGNvdE1lc3NhZ2VzOiBBSU1lc3NhZ2VbXSA9IFtdOyAvLyBDb2xsZWN0IENPVCBtZXNzYWdlcyBmb3IgY2hhdFxuXG4gIC8vIFByb2Nlc3MgdGhlIHN0cmVhbWluZyByZXNwb25zZVxuICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSkge1xuICAgIGNvbnN0IGNodW5rQ29udGVudCA9IGNodW5rLmNvbnRlbnQ7XG4gICAgaWYgKGNodW5rQ29udGVudCkge1xuICAgICAgZnVsbENvbnRlbnQgKz0gY2h1bmtDb250ZW50O1xuICAgICAgY3VycmVudENvdENodW5rICs9IGNodW5rQ29udGVudDtcblxuICAgICAgLy8gRXh0cmFjdCBjaGFpbiBvZiB0aG91Z2h0IGZyb20gdGhlIGFjY3VtdWxhdGluZyBjb250ZW50XG4gICAgICBjb25zdCBjb3RNYXRjaCA9IGZ1bGxDb250ZW50Lm1hdGNoKC9DaGFpbiBvZiBUaG91Z2h0OlxccyooW1xcc1xcU10qPykoPz1GaWxlczp8RklMRU5BTUU6fCQpL2kpO1xuICAgICAgaWYgKGNvdE1hdGNoKSB7XG4gICAgICAgIGNvbnN0IG5ld0NvdCA9IGNvdE1hdGNoWzFdLnRyaW0oKTtcbiAgICAgICAgaWYgKG5ld0NvdCAhPT0gY2hhaW5PZlRob3VnaHQpIHtcbiAgICAgICAgICBjb25zdCBwcmV2aW91c0xlbmd0aCA9IGNoYWluT2ZUaG91Z2h0Lmxlbmd0aDtcbiAgICAgICAgICBjaGFpbk9mVGhvdWdodCA9IG5ld0NvdDtcblxuICAgICAgICAgIC8vIEVtaXQgcmVhbC10aW1lIGNoYWluIG9mIHRob3VnaHQgdXBkYXRlcyAodHJ1bmNhdGVkIGxpa2UgR2VtaW5pKVxuICAgICAgICAgIGNvbnN0IG5ld1JlYXNvbmluZyA9IGNoYWluT2ZUaG91Z2h0LnN1YnN0cmluZyhwcmV2aW91c0xlbmd0aCk7XG4gICAgICAgICAgaWYgKG5ld1JlYXNvbmluZy50cmltKCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SNIFJlYWwtdGltZSBDT1QgU3RlcCAke2N1cnJlbnRTdGVwICsgMX06ICR7bmV3UmVhc29uaW5nLnN1YnN0cmluZygwLCAxMDApfSR7bmV3UmVhc29uaW5nLmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJyd9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCB0byBjaGF0IG1lc3NhZ2VzIGltbWVkaWF0ZWx5IGZvciByZWFsLXRpbWUgZGlzcGxheVxuICAgICAgICAgICAgY290TWVzc2FnZXMucHVzaChuZXcgQUlNZXNzYWdlKGDwn5SNICR7bmV3UmVhc29uaW5nLnRyaW0oKX1gKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgICAgICAgICAgdHlwZTogJ2NoYWluX29mX3Rob3VnaHQnLFxuICAgICAgICAgICAgICBzdGVwOiBjdXJyZW50U3RlcCArIDEsXG4gICAgICAgICAgICAgIHJlYXNvbmluZzogY2hhaW5PZlRob3VnaHQubGVuZ3RoID4gNTAwID8gY2hhaW5PZlRob3VnaHQuc3Vic3RyaW5nKDAsIDUwMCkgKyAnLi4uJyA6IGNoYWluT2ZUaG91Z2h0LFxuICAgICAgICAgICAgICBpc1BhcnRpYWw6IHRydWUsIC8vIEluZGljYXRlIHRoaXMgaXMgYSBzdHJlYW1pbmcgdXBkYXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgdG9vbCBjYWxscyBpbiBzdHJlYW1pbmcgKGlmIGFueSlcbiAgICBpZiAoY2h1bmsudG9vbF9jYWxscyAmJiBjaHVuay50b29sX2NhbGxzLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAoY29uc3QgdG9vbENhbGwgb2YgY2h1bmsudG9vbF9jYWxscykge1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+UpyBUb29sIGNhbGxlZDogJHt0b29sQ2FsbC5uYW1lfWAsIHRvb2xDYWxsLmFyZ3MpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gRmluZCB0aGUgdG9vbCBmdW5jdGlvblxuICAgICAgICAgIGNvbnN0IHRvb2wgPSB0b29scy5maW5kKHQgPT4gdC5uYW1lID09PSB0b29sQ2FsbC5uYW1lKTtcbiAgICAgICAgICBpZiAodG9vbCkge1xuICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgdG9vbCB3aXRoIGxvZ2dpbmcgd3JhcHBlclxuICAgICAgICAgICAgY29uc3Qgd3JhcHBlZFRvb2wgPSB3cmFwVG9vbFdpdGhMb2dnaW5nKHRvb2wsIHRvb2xDYWxsLm5hbWUpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgd3JhcHBlZFRvb2wodG9vbENhbGwuYXJncyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFRvb2wgJHt0b29sQ2FsbC5uYW1lfSBleGVjdXRlZCBzdWNjZXNzZnVsbHk6YCwgcmVzdWx0KTtcblxuICAgICAgICAgICAgLy8gSGFuZGxlIHNwZWNpZmljIHRvb2wgcmVzdWx0c1xuICAgICAgICAgICAgaWYgKHRvb2xDYWxsLm5hbWUgPT09ICdyZWFkX2ZpbGUnKSB7XG4gICAgICAgICAgICAgIC8vIFN0b3JlIHJlYWQgZmlsZSBjb250ZW50IGZvciBsYXRlciB1c2VcbiAgICAgICAgICAgICAgY29uc3QgYXJncyA9IHRvb2xDYWxsLmFyZ3MgYXMgYW55O1xuICAgICAgICAgICAgICBpZiAoYXJncy5maWxlUGF0aCAmJiB0eXBlb2YgcmVzdWx0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlZEZpbGVzW2FyZ3MuZmlsZVBhdGhdID0gcmVzdWx0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRvb2xDYWxsLm5hbWUgPT09ICd3cml0ZV9maWxlJyB8fCB0b29sQ2FsbC5uYW1lID09PSAnYXBwZW5kX3RvX2ZpbGUnKSB7XG4gICAgICAgICAgICAgIC8vIEV4dHJhY3QgZmlsZSBjb250ZW50IGZyb20gdG9vbCBjYWxsIGFyZ3MgZm9yIGdlbmVyYXRlZCBmaWxlc1xuICAgICAgICAgICAgICBjb25zdCBhcmdzID0gdG9vbENhbGwuYXJncyBhcyBhbnk7XG4gICAgICAgICAgICAgIGlmIChhcmdzLmZpbGVQYXRoICYmIGFyZ3MuY29udGVudCkge1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlZEZpbGVzW2FyZ3MuZmlsZVBhdGhdID0gYXJncy5jb250ZW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIFRvb2wgJHt0b29sQ2FsbC5uYW1lfSBub3QgZm91bmQgaW4gdG9vbHMgYXJyYXlgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIFRvb2wgJHt0b29sQ2FsbC5uYW1lfSBleGVjdXRpb24gZmFpbGVkOmAsIGVycm9yKTtcbiAgICAgICAgICAvLyBDb250aW51ZSBwcm9jZXNzaW5nIG90aGVyIHRvb2xzIGV2ZW4gaWYgb25lIGZhaWxzXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBGaW5hbCBwcm9jZXNzaW5nIGFmdGVyIHN0cmVhbWluZyBpcyBjb21wbGV0ZVxuICBjb25zb2xlLmxvZyhg8J+TiiBQcm9jZXNzZWQgc3RyZWFtaW5nIHJlc3BvbnNlYCk7XG5cbiAgLy8gRXh0cmFjdCBmaW5hbCBjaGFpbiBvZiB0aG91Z2h0XG4gIGNvbnN0IGZpbmFsQ290TWF0Y2ggPSBmdWxsQ29udGVudC5tYXRjaCgvQ2hhaW4gb2YgVGhvdWdodDpcXHMqKFtcXHNcXFNdKj8pKD89RmlsZXM6fEZJTEVOQU1FOnwkKS9pKTtcbiAgaWYgKGZpbmFsQ290TWF0Y2gpIHtcbiAgICBjaGFpbk9mVGhvdWdodCA9IGZpbmFsQ290TWF0Y2hbMV0udHJpbSgpO1xuICB9XG5cbiAgLy8gRmFsbGJhY2s6IHBhcnNlIGZpbGVzIGZyb20gYWNjdW11bGF0ZWQgY29udGVudCBpZiBubyB0b29sIGNhbGxzIGdlbmVyYXRlZCBmaWxlc1xuICBpZiAoT2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnN0IG5ld0ZpbGVzID0gcGFyc2VHZW5lcmF0ZWRGaWxlcyhmdWxsQ29udGVudCk7XG4gICAgT2JqZWN0LmFzc2lnbihnZW5lcmF0ZWRGaWxlcywgbmV3RmlsZXMpO1xuICB9XG5cbiAgLy8gQWRkIHRvIG1lbW9yeVxuICBhd2FpdCBtZW1vcnkuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgYFN0ZXAgJHtjdXJyZW50U3RlcCArIDF9OiAke2NoYWluT2ZUaG91Z2h0LnN1YnN0cmluZygwLCAyMDApfS4uLmApO1xuXG4gIC8vIEVtaXQgZmluYWwgY2hhaW4gb2YgdGhvdWdodCAoY29tcGxldGUpXG4gIGlmIChjaGFpbk9mVGhvdWdodCkge1xuICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgIHR5cGU6ICdjaGFpbl9vZl90aG91Z2h0JyxcbiAgICAgIHN0ZXA6IGN1cnJlbnRTdGVwICsgMSxcbiAgICAgIHJlYXNvbmluZzogY2hhaW5PZlRob3VnaHQubGVuZ3RoID4gMTAwMCA/IGNoYWluT2ZUaG91Z2h0LnN1YnN0cmluZygwLCAxMDAwKSArICcuLi4nIDogY2hhaW5PZlRob3VnaHQsXG4gICAgICBpc1BhcnRpYWw6IGZhbHNlLCAvLyBUaGlzIGlzIHRoZSBmaW5hbCBjb21wbGV0ZSByZWFzb25pbmdcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChPYmplY3Qua2V5cyhnZW5lcmF0ZWRGaWxlcykubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGZpbGVzID0gT2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpO1xuICAgIGNvbnNvbGUubG9nKGDwn5OBIFJlYWwtdGltZSBGaWxlcyBHZW5lcmF0ZWQ6ICR7ZmlsZXMuam9pbignLCAnKX1gKTtcbiAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgICB0eXBlOiAnZmlsZXNfZ2VuZXJhdGVkJyxcbiAgICAgIGZpbGVzOiBmaWxlcyxcbiAgICAgIHN0ZXA6IGN1cnJlbnRTdGVwICsgMVxuICAgIH0pO1xuICB9XG5cbiAgLy8gRW1pdCByZWFsLXRpbWUgbWVzc2FnZXMgZm9yIGNoYXQgZGlzcGxheVxuICBpZiAoY290TWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgIGNvdE1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UpID0+IHtcbiAgICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgICAgdHlwZTogJ2FnZW50X21lc3NhZ2UnLFxuICAgICAgICBjb250ZW50OiBtZXNzYWdlLmNvbnRlbnQudG9TdHJpbmcoKSxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZ2VuZXJhdGVkRmlsZXMsXG4gICAgY3VycmVudEl0ZXJhdGlvbjogY3VycmVudFN0ZXAgKyAxLFxuICAgIG1lc3NhZ2VzOiBjb3RNZXNzYWdlcy5sZW5ndGggPiAwID8gY290TWVzc2FnZXMgOiAoY2hhaW5PZlRob3VnaHQgPyBbbmV3IEFJTWVzc2FnZShjaGFpbk9mVGhvdWdodCldIDogW10pLCAvLyBJbmNsdWRlIHJlYWwtdGltZSBDaGFpbiBvZiBUaG91Z2h0IG1lc3NhZ2VzIGluIGNoYXRcbiAgfTtcbn1cblxuLy8gU3RyZWFtaW5nIFJldmlld2VyIEFnZW50OiBSZXZpZXdzIHRoZSBnZW5lcmF0ZWQgY29kZSBmb3IgcXVhbGl0eSBhbmQgY29tcGxldGVuZXNzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RyZWFtaW5nUmV2aWV3ZXJBZ2VudChzdGF0ZTogQWdlbnRTdGF0ZVR5cGUsIHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8QWdlbnRTdGF0ZVR5cGU+PiB7XG4gIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ3N0YXR1cycsIG1lc3NhZ2U6ICdSZXZpZXdpbmcgZ2VuZXJhdGVkIGNvZGUuLi4nIH0pO1xuXG4gIGNvbnN0IG1lbW9yeSA9IGdldE1lbW9yeSgpO1xuICBjb25zdCBhbGxGaWxlcyA9IHsgLi4uc3RhdGUuZ2VuZXJhdGVkRmlsZXMgfTtcblxuICAvLyBSZWFkIGN1cnJlbnQgc3RhdGUgb2YgYWxsIGZpbGVzIHVzaW5nIHRvb2xzXG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG5cbiAgLy8gVXNlIHRvb2xzIHRvIHJlYWQgdGhlIGFjdHVhbCBmaWxlIGNvbnRlbnRzXG4gIGZvciAoY29uc3QgZmlsZVBhdGggb2YgT2JqZWN0LmtleXMoYWxsRmlsZXMpKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRyeSB0byByZWFkIHRoZSBmaWxlIHVzaW5nIHRoZSByZWFkX2ZpbGUgdG9vbFxuICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gICAgICAvLyBJbXBvcnQgdGhlIHRvb2wgYW5kIGNhbGwgaXQgZGlyZWN0bHlcbiAgICAgIGNvbnN0IHsgcmVhZEZpbGVUb29sIH0gPSBhd2FpdCBpbXBvcnQoJy4vdG9vbHMnKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlYWRGaWxlVG9vbC5pbnZva2UoeyBmaWxlUGF0aDogZnVsbFBhdGggfSk7XG5cbiAgICAgIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycgJiYgcmVzdWx0LnN0YXJ0c1dpdGgoJ0ZpbGUgY29udGVudDonKSkge1xuICAgICAgICAvLyBFeHRyYWN0IHRoZSBhY3R1YWwgY29udGVudCBmcm9tIHRoZSB0b29sIHJlc3BvbnNlXG4gICAgICAgIGFsbEZpbGVzW2ZpbGVQYXRoXSA9IHJlc3VsdC5yZXBsYWNlKCdGaWxlIGNvbnRlbnQ6XFxuJywgJycpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBDb3VsZCBub3QgcmVhZCBmaWxlICR7ZmlsZVBhdGh9IHVzaW5nIHRvb2w7IHVzaW5nIGluLW1lbW9yeSBjb250ZW50YCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IHJlYWQgZmlsZSAke2ZpbGVQYXRofSBmb3IgcmV2aWV3OmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBhIHNlbmlvciBjb2RlIHJldmlld2VyLiBSZXZpZXcgdGhlIGdlbmVyYXRlZCBjb2RlIGZvciBxdWFsaXR5LCBjb21wbGV0ZW5lc3MsIGFuZCBjb3JyZWN0bmVzcy5cblxuRVZBTFVBVElPTiBDUklURVJJQTpcbi0gQ29kZSBxdWFsaXR5IGFuZCBiZXN0IHByYWN0aWNlc1xuLSBQcm9wZXIgaW1wb3J0cyBhbmQgZGVwZW5kZW5jaWVzXG4tIEVycm9yIGhhbmRsaW5nIGFuZCBlZGdlIGNhc2VzXG4tIFR5cGVTY3JpcHQgdHlwZXMgKGlmIGFwcGxpY2FibGUpXG4tIENvZGUgb3JnYW5pemF0aW9uIGFuZCByZWFkYWJpbGl0eVxuLSBDb21wbGV0ZW5lc3Mgb2YgaW1wbGVtZW50YXRpb25cbi0gSW50ZWdyYXRpb24gd2l0aCBleGlzdGluZyBjb2RlYmFzZVxuXG4ke2dldFRvb2xEZWZpbml0aW9ucygpfVxuXG5PVVRQVVQgRk9STUFUOlxuQ2hhaW4gb2YgVGhvdWdodDogW1lvdXIgc3RlcC1ieS1zdGVwIGFuYWx5c2lzXVxuQVBQUk9WRUQgb3IgTkVFRFMgSU1QUk9WRU1FTlRcblxuSWYgTkVFRFMgSU1QUk9WRU1FTlQsIHByb3ZpZGUgc3BlY2lmaWMsIGFjdGlvbmFibGUgZmVlZGJhY2suXG5JZiBBUFBST1ZFRCwgY29uZmlybSB0aGUgaW1wbGVtZW50YXRpb24gaXMgY29tcGxldGUgYW5kIHJlYWR5LlxuXG5CZSBjb25zdHJ1Y3RpdmUgYW5kIHNwZWNpZmljIGluIHlvdXIgZmVlZGJhY2suYDtcblxuICBjb25zdCBjb2RlU3VtbWFyeSA9IE9iamVjdC5lbnRyaWVzKGFsbEZpbGVzKVxuICAgIC5tYXAoKFtmaWxlLCBjb250ZW50XSkgPT4gYD09PSAke2ZpbGV9ID09PVxcbiR7Y29udGVudH1gKVxuICAgIC5qb2luKCdcXG5cXG4nKTtcblxuICBjb25zdCBtZXNzYWdlcyA9IFtcbiAgICBuZXcgU3lzdGVtTWVzc2FnZShzeXN0ZW1Qcm9tcHQpLFxuICAgIG5ldyBIdW1hbk1lc3NhZ2UoYFJldmlldyB0aGUgZm9sbG93aW5nIGdlbmVyYXRlZCBjb2RlOlxcblxcbiR7Y29kZVN1bW1hcnl9YCksXG4gIF07XG5cbiAgLy8gVXNlIG1vZGVsLXNwZWNpZmljIExMTSBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBnbG9iYWwgbGxtV2l0aFRvb2xzXG4gIGNvbnN0IGxsbVRvVXNlID0gbW9kZWwgPyBjcmVhdGVMTE0obW9kZWwsIHRydWUpIDogY3JlYXRlTExNKHVuZGVmaW5lZCwgdHJ1ZSk7IC8vIEVuYWJsZSBzdHJlYW1pbmdcbiAgY29uc3QgbGxtV2l0aFRvb2xzVG9Vc2UgPSBtb2RlbCA/IGxsbVRvVXNlLmJpbmRUb29scyh0b29scykgOiBsbG1XaXRoVG9vbHM7XG5cbiAgLy8gU3RyZWFtIHRoZSByZXNwb25zZSBmb3IgcmVhbC10aW1lIGNoYWluIG9mIHRob3VnaHRcbiAgY29uc3Qgc3RyZWFtID0gYXdhaXQgbGxtV2l0aFRvb2xzVG9Vc2Uuc3RyZWFtKG1lc3NhZ2VzKTtcblxuICBsZXQgY2hhaW5PZlRob3VnaHQgPSAnJztcbiAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gIGxldCByZXZpZXdSZXN1bHQgPSAnJztcbiAgY29uc3QgY290TWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW107IC8vIENvbGxlY3QgQ09UIG1lc3NhZ2VzIGZvciBjaGF0XG5cbiAgLy8gUHJvY2VzcyB0aGUgc3RyZWFtaW5nIHJlc3BvbnNlXG4gIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgY29uc3QgY2h1bmtDb250ZW50ID0gY2h1bmsuY29udGVudDtcbiAgICBpZiAoY2h1bmtDb250ZW50KSB7XG4gICAgICBmdWxsQ29udGVudCArPSBjaHVua0NvbnRlbnQ7XG5cbiAgICAgIC8vIEV4dHJhY3QgY2hhaW4gb2YgdGhvdWdodCBmcm9tIHRoZSBhY2N1bXVsYXRpbmcgY29udGVudFxuICAgICAgY29uc3QgY290TWF0Y2ggPSBmdWxsQ29udGVudC5tYXRjaCgvQ2hhaW4gb2YgVGhvdWdodDpcXHMqKFtcXHNcXFNdKj8pKD89QVBQUk9WRUR8TkVFRFMgSU1QUk9WRU1FTlR8JCkvaSk7XG4gICAgICBpZiAoY290TWF0Y2gpIHtcbiAgICAgICAgY29uc3QgbmV3Q290ID0gY290TWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICBpZiAobmV3Q290ICE9PSBjaGFpbk9mVGhvdWdodCkge1xuICAgICAgICAgIGNvbnN0IHByZXZpb3VzTGVuZ3RoID0gY2hhaW5PZlRob3VnaHQubGVuZ3RoO1xuICAgICAgICAgIGNoYWluT2ZUaG91Z2h0ID0gbmV3Q290O1xuXG4gICAgICAgICAgLy8gRW1pdCByZWFsLXRpbWUgY2hhaW4gb2YgdGhvdWdodCB1cGRhdGVzXG4gICAgICAgICAgY29uc3QgbmV3UmVhc29uaW5nID0gY2hhaW5PZlRob3VnaHQuc3Vic3RyaW5nKHByZXZpb3VzTGVuZ3RoKTtcbiAgICAgICAgICBpZiAobmV3UmVhc29uaW5nLnRyaW0oKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYPCflI0gUmVhbC10aW1lIENPVCAoUmV2aWV3KTogJHtuZXdSZWFzb25pbmcuc3Vic3RyaW5nKDAsIDEwMCl9JHtuZXdSZWFzb25pbmcubGVuZ3RoID4gMTAwID8gJy4uLicgOiAnJ31gKTtcblxuICAgICAgICAgICAgLy8gQWRkIHRvIGNoYXQgbWVzc2FnZXMgaW1tZWRpYXRlbHkgZm9yIHJlYWwtdGltZSBkaXNwbGF5XG4gICAgICAgICAgICBjb3RNZXNzYWdlcy5wdXNoKG5ldyBBSU1lc3NhZ2UoYPCflI0gJHtuZXdSZWFzb25pbmcudHJpbSgpfWApKTtcblxuICAgICAgICAgICAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywge1xuICAgICAgICAgICAgICB0eXBlOiAnY2hhaW5fb2ZfdGhvdWdodCcsXG4gICAgICAgICAgICAgIHN0ZXA6ICdyZXZpZXcnLFxuICAgICAgICAgICAgICByZWFzb25pbmc6IGNoYWluT2ZUaG91Z2h0Lmxlbmd0aCA+IDUwMCA/IGNoYWluT2ZUaG91Z2h0LnN1YnN0cmluZygwLCA1MDApICsgJy4uLicgOiBjaGFpbk9mVGhvdWdodCxcbiAgICAgICAgICAgICAgaXNQYXJ0aWFsOiB0cnVlLCAvLyBJbmRpY2F0ZSB0aGlzIGlzIGEgc3RyZWFtaW5nIHVwZGF0ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGZvciBmaW5hbCByZXN1bHRcbiAgICAgIGlmIChmdWxsQ29udGVudC5pbmNsdWRlcygnQVBQUk9WRUQnKSB8fCBmdWxsQ29udGVudC5pbmNsdWRlcygnTkVFRFMgSU1QUk9WRU1FTlQnKSkge1xuICAgICAgICByZXZpZXdSZXN1bHQgPSBmdWxsQ29udGVudDtcbiAgICAgICAgYnJlYWs7IC8vIFdlIGhhdmUgdGhlIGNvbXBsZXRlIHJldmlld1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEV4dHJhY3QgdGhlIGZpbmFsIGZlZWRiYWNrIGZyb20gdGhlIGNvbXBsZXRlIHJlc3BvbnNlXG4gIGNvbnN0IGZlZWRiYWNrID0gcmV2aWV3UmVzdWx0IHx8IGZ1bGxDb250ZW50O1xuXG4gIGNvbnN0IGlzQXBwcm92ZWQgPSBmZWVkYmFjay50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdBUFBST1ZFRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAhZmVlZGJhY2sudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbWlzc2luZycpICYmXG4gICAgICAgICAgICAgICAgICAgICAhZmVlZGJhY2sudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbm90IGltcGxlbWVudGVkJyk7XG5cbiAgY29uc29sZS5sb2coYPCflI0gUmV2aWV3IHJlc3VsdDogJHtpc0FwcHJvdmVkID8gJ0FQUFJPVkVEJyA6ICdORUVEUyBJTVBST1ZFTUVOVCd9YCk7XG4gIGNvbnNvbGUubG9nKGDwn5OdIEZlZWRiYWNrOiAke2ZlZWRiYWNrLnN1YnN0cmluZygwLCAxMDApfS4uLmApO1xuXG4gIC8vIEFkZCB0byBtZW1vcnlcbiAgYXdhaXQgbWVtb3J5LmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGBSZXZpZXc6ICR7ZmVlZGJhY2suc3Vic3RyaW5nKDAsIDIwMCl9Li4uYCk7XG5cbiAgLy8gRW1pdCByZXZpZXcgcmVzdWx0c1xuICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7IHR5cGU6ICdyZXZpZXcnLCBmZWVkYmFjazogZmVlZGJhY2sgfSk7XG5cbiAgaWYgKGlzQXBwcm92ZWQpIHtcbiAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7IHR5cGU6ICdjb21wbGV0ZScsIG1lc3NhZ2U6ICdDb2RlIGdlbmVyYXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseSEnIH0pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICByZXZpZXdGZWVkYmFjazogZmVlZGJhY2ssXG4gICAgaXNDb21wbGV0ZTogaXNBcHByb3ZlZCxcbiAgICByZXZpZXdJdGVyYXRpb25zOiAoc3RhdGUucmV2aWV3SXRlcmF0aW9ucyB8fCAwKSArIDEsXG4gICAgbWVzc2FnZXM6IGNvdE1lc3NhZ2VzLCAvLyBJbmNsdWRlIENPVCBtZXNzYWdlcyBpbiBjaGF0XG4gIH07XG59XG5cbi8vIFN0cmVhbWluZyBGaXhlciBBZ2VudDogQWRkcmVzc2VzIHJldmlldyBmZWVkYmFjayBieSBmaXhpbmcgaXNzdWVzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RyZWFtaW5nRml4ZXJBZ2VudChzdGF0ZTogQWdlbnRTdGF0ZVR5cGUsIHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8QWdlbnRTdGF0ZVR5cGU+PiB7XG4gIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ3N0YXR1cycsIG1lc3NhZ2U6ICdGaXhpbmcgaXNzdWVzIGJhc2VkIG9uIHJldmlldy4uLicgfSk7XG5cbiAgY29uc3QgbWVtb3J5ID0gZ2V0TWVtb3J5KCk7XG4gIGNvbnN0IGNvbnRleHRTdW1tYXJ5ID0gYXdhaXQgbWVtb3J5LmdldENvbXByZXNzZWRDb250ZXh0KHN0YXRlLnVzZXJSZXF1ZXN0KTtcblxuICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBhbiBleHBlcnQgc29mdHdhcmUgZW5naW5lZXIuIEZpeCB0aGUgaXNzdWVzIGlkZW50aWZpZWQgaW4gdGhlIHJldmlldyBmZWVkYmFjay5cblxuSU5TVFJVQ1RJT05TOlxuLSBBZGRyZXNzIGVhY2ggcG9pbnQgaW4gdGhlIHJldmlldyBmZWVkYmFja1xuLSBNYWtlIHRhcmdldGVkIGZpeGVzIHVzaW5nIHRoZSBhdmFpbGFibGUgdG9vbHNcbi0gVGVzdCB5b3VyIGNoYW5nZXMgYnkgcmVhZGluZyBmaWxlcyBiYWNrXG4tIEVuc3VyZSB0aGUgZml4ZXMgYXJlIGNvbXBsZXRlIGFuZCBjb3JyZWN0XG4tIE1haW50YWluIGNvZGUgcXVhbGl0eSBhbmQgY29uc2lzdGVuY3lcblxuJHtjb250ZXh0U3VtbWFyeSA/IGBDT05URVhUOlxcbiR7c21hcnRUcnVuY2F0ZShjb250ZXh0U3VtbWFyeSwgNDAwKX1cXG5cXG5gIDogJyd9XG5cbiR7Z2V0VG9vbERlZmluaXRpb25zKCl9XG5cblVzZSB0aGUgc2FtZSB0b29scyBhcyBiZWZvcmUgdG8gaW1wbGVtZW50IGZpeGVzLmA7XG5cbiAgY29uc3QgbWVzc2FnZXMgPSBbXG4gICAgbmV3IFN5c3RlbU1lc3NhZ2Uoc3lzdGVtUHJvbXB0KSxcbiAgICBuZXcgSHVtYW5NZXNzYWdlKGBSZXZpZXcgZmVlZGJhY2sgdG8gYWRkcmVzczogJHtzdGF0ZS5yZXZpZXdGZWVkYmFja31cblxuQ3VycmVudCBmaWxlczogJHtPYmplY3Qua2V5cyhzdGF0ZS5nZW5lcmF0ZWRGaWxlcykuam9pbignLCAnKX1cblxuUGxlYXNlIGZpeCB0aGUgaWRlbnRpZmllZCBpc3N1ZXMuYCksXG4gIF07XG5cbiAgLy8gVXNlIG1vZGVsLXNwZWNpZmljIExMTSBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBnbG9iYWwgbGxtV2l0aFRvb2xzXG4gIGNvbnN0IGxsbVRvVXNlID0gbW9kZWwgPyBjcmVhdGVMTE0obW9kZWwsIHRydWUpIDogY3JlYXRlTExNKHVuZGVmaW5lZCwgdHJ1ZSk7IC8vIEVuYWJsZSBzdHJlYW1pbmdcbiAgY29uc3QgbGxtV2l0aFRvb2xzVG9Vc2UgPSBtb2RlbCA/IGxsbVRvVXNlLmJpbmRUb29scyh0b29scykgOiBsbG1XaXRoVG9vbHM7XG5cbiAgLy8gU3RyZWFtIHRoZSByZXNwb25zZSBmb3IgcmVhbC10aW1lIGNoYWluIG9mIHRob3VnaHRcbiAgY29uc3Qgc3RyZWFtID0gYXdhaXQgbGxtV2l0aFRvb2xzVG9Vc2Uuc3RyZWFtKG1lc3NhZ2VzKTtcblxuICAvLyBFeHRyYWN0IGZpeGVkIGZpbGVzIGZyb20gdG9vbCBjYWxscyBvciByZXNwb25zZSBjb250ZW50XG4gIGNvbnN0IGdlbmVyYXRlZEZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGxldCBmdWxsQ29udGVudCA9ICcnO1xuICBsZXQgY2hhaW5PZlRob3VnaHQgPSAnJztcbiAgY29uc3QgY290TWVzc2FnZXM6IEFJTWVzc2FnZVtdID0gW107IC8vIENvbGxlY3QgQ09UIG1lc3NhZ2VzIGZvciBjaGF0XG5cbiAgLy8gUHJvY2VzcyB0aGUgc3RyZWFtaW5nIHJlc3BvbnNlXG4gIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2Ygc3RyZWFtKSB7XG4gICAgY29uc3QgY2h1bmtDb250ZW50ID0gY2h1bmsuY29udGVudDtcbiAgICBpZiAoY2h1bmtDb250ZW50KSB7XG4gICAgICBmdWxsQ29udGVudCArPSBjaHVua0NvbnRlbnQ7XG5cbiAgICAgIC8vIEV4dHJhY3QgY2hhaW4gb2YgdGhvdWdodCBmcm9tIHRoZSBhY2N1bXVsYXRpbmcgY29udGVudFxuICAgICAgY29uc3QgY290TWF0Y2ggPSBmdWxsQ29udGVudC5tYXRjaCgvQ2hhaW4gb2YgVGhvdWdodDpcXHMqKFtcXHNcXFNdKj8pKD89RmlsZXM6fEZJTEVOQU1FOnwkKS9pKTtcbiAgICAgIGlmIChjb3RNYXRjaCkge1xuICAgICAgICBjb25zdCBuZXdDb3QgPSBjb3RNYXRjaFsxXS50cmltKCk7XG4gICAgICAgIGlmIChuZXdDb3QgIT09IGNoYWluT2ZUaG91Z2h0KSB7XG4gICAgICAgICAgY29uc3QgcHJldmlvdXNMZW5ndGggPSBjaGFpbk9mVGhvdWdodC5sZW5ndGg7XG4gICAgICAgICAgY2hhaW5PZlRob3VnaHQgPSBuZXdDb3Q7XG5cbiAgICAgICAgICAvLyBFbWl0IHJlYWwtdGltZSBjaGFpbiBvZiB0aG91Z2h0IHVwZGF0ZXNcbiAgICAgICAgICBjb25zdCBuZXdSZWFzb25pbmcgPSBjaGFpbk9mVGhvdWdodC5zdWJzdHJpbmcocHJldmlvdXNMZW5ndGgpO1xuICAgICAgICAgIGlmIChuZXdSZWFzb25pbmcudHJpbSgpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UjSBSZWFsLXRpbWUgRml4ZXIgQ09UOiAke25ld1JlYXNvbmluZy5zdWJzdHJpbmcoMCwgMTAwKX0ke25ld1JlYXNvbmluZy5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnfWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgdG8gY2hhdCBtZXNzYWdlcyBpbW1lZGlhdGVseSBmb3IgcmVhbC10aW1lIGRpc3BsYXlcbiAgICAgICAgICAgIGNvdE1lc3NhZ2VzLnB1c2gobmV3IEFJTWVzc2FnZShg8J+UjSAke25ld1JlYXNvbmluZy50cmltKCl9YCkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgICAgICAgICAgIHR5cGU6ICdjaGFpbl9vZl90aG91Z2h0JyxcbiAgICAgICAgICAgICAgc3RlcDogJ2ZpeGVyJyxcbiAgICAgICAgICAgICAgcmVhc29uaW5nOiBjaGFpbk9mVGhvdWdodC5sZW5ndGggPiA1MDAgPyBjaGFpbk9mVGhvdWdodC5zdWJzdHJpbmcoMCwgNTAwKSArICcuLi4nIDogY2hhaW5PZlRob3VnaHQsXG4gICAgICAgICAgICAgIGlzUGFydGlhbDogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0b29sIGNhbGxzIGluIHN0cmVhbWluZyAoaWYgYW55KVxuICAgIGlmIChjaHVuay50b29sX2NhbGxzICYmIGNodW5rLnRvb2xfY2FsbHMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCB0b29sQ2FsbCBvZiBjaHVuay50b29sX2NhbGxzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SnIFRvb2wgY2FsbGVkOiAke3Rvb2xDYWxsLm5hbWV9YCwgdG9vbENhbGwuYXJncyk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBGaW5kIHRoZSB0b29sIGZ1bmN0aW9uXG4gICAgICAgICAgY29uc3QgdG9vbCA9IHRvb2xzLmZpbmQodCA9PiB0Lm5hbWUgPT09IHRvb2xDYWxsLm5hbWUpO1xuICAgICAgICAgIGlmICh0b29sKSB7XG4gICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSB0b29sIHdpdGggbG9nZ2luZyB3cmFwcGVyXG4gICAgICAgICAgICBjb25zdCB3cmFwcGVkVG9vbCA9IHdyYXBUb29sV2l0aExvZ2dpbmcodG9vbCwgdG9vbENhbGwubmFtZSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3cmFwcGVkVG9vbCh0b29sQ2FsbC5hcmdzKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgVG9vbCAke3Rvb2xDYWxsLm5hbWV9IGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseTpgLCByZXN1bHQpO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgc3BlY2lmaWMgdG9vbCByZXN1bHRzXG4gICAgICAgICAgICBpZiAodG9vbENhbGwubmFtZSA9PT0gJ3JlYWRfZmlsZScpIHtcbiAgICAgICAgICAgICAgLy8gU3RvcmUgcmVhZCBmaWxlIGNvbnRlbnQgZm9yIGxhdGVyIHVzZVxuICAgICAgICAgICAgICBjb25zdCBhcmdzID0gdG9vbENhbGwuYXJncyBhcyBhbnk7XG4gICAgICAgICAgICAgIGlmIChhcmdzLmZpbGVQYXRoICYmIHR5cGVvZiByZXN1bHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVkRmlsZXNbYXJncy5maWxlUGF0aF0gPSByZXN1bHQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9vbENhbGwubmFtZSA9PT0gJ3dyaXRlX2ZpbGUnIHx8IHRvb2xDYWxsLm5hbWUgPT09ICdhcHBlbmRfdG9fZmlsZScpIHtcbiAgICAgICAgICAgICAgLy8gRXh0cmFjdCBmaWxlIGNvbnRlbnQgZnJvbSB0b29sIGNhbGwgYXJncyBmb3IgZ2VuZXJhdGVkIGZpbGVzXG4gICAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSB0b29sQ2FsbC5hcmdzIGFzIGFueTtcbiAgICAgICAgICAgICAgaWYgKGFyZ3MuZmlsZVBhdGggJiYgYXJncy5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVkRmlsZXNbYXJncy5maWxlUGF0aF0gPSBhcmdzLmNvbnRlbnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gVG9vbCAke3Rvb2xDYWxsLm5hbWV9IG5vdCBmb3VuZCBpbiB0b29scyBhcnJheWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgVG9vbCAke3Rvb2xDYWxsLm5hbWV9IGV4ZWN1dGlvbiBmYWlsZWQ6YCwgZXJyb3IpO1xuICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3Npbmcgb3RoZXIgdG9vbHMgZXZlbiBpZiBvbmUgZmFpbHNcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEZpbmFsIHByb2Nlc3NpbmcgYWZ0ZXIgc3RyZWFtaW5nIGlzIGNvbXBsZXRlXG4gIGNvbnNvbGUubG9nKGDwn5OKIFByb2Nlc3NlZCBzdHJlYW1pbmcgZml4ZXIgcmVzcG9uc2VgKTtcblxuICAvLyBGYWxsYmFjazogcGFyc2UgZmlsZXMgZnJvbSBhY2N1bXVsYXRlZCBjb250ZW50IGlmIG5vIHRvb2wgY2FsbHMgZ2VuZXJhdGVkIGZpbGVzXG4gIGlmIChPYmplY3Qua2V5cyhnZW5lcmF0ZWRGaWxlcykubGVuZ3RoID09PSAwKSB7XG4gICAgY29uc3QgZml4ZWRGaWxlcyA9IHBhcnNlR2VuZXJhdGVkRmlsZXMoZnVsbENvbnRlbnQpO1xuICAgIE9iamVjdC5hc3NpZ24oZ2VuZXJhdGVkRmlsZXMsIGZpeGVkRmlsZXMpO1xuICB9XG5cbiAgLy8gQWRkIHRvIG1lbW9yeVxuICBhd2FpdCBtZW1vcnkuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgYEZpeGVkIGlzc3VlcyBiYXNlZCBvbiByZXZpZXcgZmVlZGJhY2suIFVwZGF0ZWQgJHtPYmplY3Qua2V5cyhnZW5lcmF0ZWRGaWxlcykubGVuZ3RofSBmaWxlcy5gKTtcblxuICAvLyBFbWl0IGZpeGVzXG4gIGlmIChPYmplY3Qua2V5cyhnZW5lcmF0ZWRGaWxlcykubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGZpbGVzID0gT2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpO1xuICAgIGNvbnNvbGUubG9nKGDwn5SnIFJlYWwtdGltZSBGaXhlcyBBcHBsaWVkOiAke2ZpbGVzLmpvaW4oJywgJyl9YCk7XG4gICAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywge1xuICAgICAgdHlwZTogJ2ZpbGVzX2ZpeGVkJyxcbiAgICAgIGZpbGVzOiBmaWxlcyxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEVtaXQgcmVhbC10aW1lIG1lc3NhZ2VzIGZvciBjaGF0IGRpc3BsYXlcbiAgaWYgKGNvdE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICBjb3RNZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlKSA9PiB7XG4gICAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgICAgIHR5cGU6ICdhZ2VudF9tZXNzYWdlJyxcbiAgICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LnRvU3RyaW5nKCksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdlbmVyYXRlZEZpbGVzLFxuICAgIGN1cnJlbnRJdGVyYXRpb246IHN0YXRlLnBsYW4ubGVuZ3RoLCAvLyBLZWVwIGF0IHBsYW4gbGVuZ3RoXG4gICAgcmV2aWV3RmVlZGJhY2s6ICcnLCAvLyBDbGVhciBmZWVkYmFjayBzbyBzaG91bGRDb250aW51ZSBnb2VzIHRvIGNvbXBsZXRpb24gY2hlY2tcbiAgICBtZXNzYWdlczogY290TWVzc2FnZXMubGVuZ3RoID4gMCA/IGNvdE1lc3NhZ2VzIDogKGZ1bGxDb250ZW50ID8gW25ldyBBSU1lc3NhZ2UoYEZpeGluZyBpc3N1ZXM6ICR7ZnVsbENvbnRlbnQuc3Vic3RyaW5nKDAsIDUwMCl9JHtmdWxsQ29udGVudC5sZW5ndGggPiA1MDAgPyAnLi4uJyA6ICcnfWApXSA6IFtdKSwgLy8gSW5jbHVkZSByZWFsLXRpbWUgZml4IHJlYXNvbmluZyBpbiBjaGF0XG4gIH07XG59XG5cbi8vIFN0cmVhbWluZyBDb21wbGV0aW9uIEFnZW50OiBFbnN1cmVzIGdlbmVyYXRlZCBjb2RlIGlzIGNvbXBsZXRlIGFuZCBmdW5jdGlvbmFsXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RyZWFtaW5nQ29tcGxldGlvbkFnZW50KHN0YXRlOiBBZ2VudFN0YXRlVHlwZSwgc2Vzc2lvbklkPzogc3RyaW5nLCBtb2RlbD86IHN0cmluZyk6IFByb21pc2U8UGFydGlhbDxBZ2VudFN0YXRlVHlwZT4+IHtcbiAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywgeyB0eXBlOiAnc3RhdHVzJywgbWVzc2FnZTogJ0Vuc3VyaW5nIGNvZGUgY29tcGxldGVuZXNzLi4uJyB9KTtcblxuICBjb25zdCBtZW1vcnkgPSBnZXRNZW1vcnkoKTtcbiAgY29uc3QgYWxsRmlsZXMgPSB7IC4uLnN0YXRlLmdlbmVyYXRlZEZpbGVzIH07XG5cbiAgLy8gUmVhZCBjdXJyZW50IHN0YXRlIG9mIGFsbCBmaWxlc1xuICBjb25zdCBzZXNzaW9uRmlsZXMgPSBhd2FpdCBtZW1vcnkuZ2V0U2Vzc2lvbkZpbGVzKCk7XG4gIGZvciAoY29uc3QgZmlsZVBhdGggb2YgT2JqZWN0LmtleXMoYWxsRmlsZXMpKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0KCdmcycpO1xuICAgICAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcblxuICAgICAgLy8gVHJ5IHRvIHJlYWQgdGhlIGFjdHVhbCBmaWxlIGNvbnRlbnRcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhjYW5kaWRhdGUpKSB7XG4gICAgICAgIGFsbEZpbGVzW2ZpbGVQYXRoXSA9IGZzLnJlYWRGaWxlU3luYyhjYW5kaWRhdGUsICd1dGYtOCcpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gVHJ5IHRvIGZpbmQgYnkgYmFzZW5hbWUgaW4gc2Vzc2lvbiBmaWxlc1xuICAgICAgY29uc3QgYmFzZSA9IHBhdGguYmFzZW5hbWUoZmlsZVBhdGgpO1xuICAgICAgY29uc3QgbWF0Y2ggPSBzZXNzaW9uRmlsZXMuZmluZChmID0+IHBhdGguYmFzZW5hbWUoZikgPT09IGJhc2UpO1xuICAgICAgaWYgKG1hdGNoICYmIGZzLmV4aXN0c1N5bmMobWF0Y2gpKSB7XG4gICAgICAgIGFsbEZpbGVzW2ZpbGVQYXRoXSA9IGZzLnJlYWRGaWxlU3luYyhtYXRjaCwgJ3V0Zi04Jyk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZWFkIGZpbGUgJHtmaWxlUGF0aH0gZm9yIGNvbXBsZXRpb24gY2hlY2s6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBzb2Z0d2FyZSBlbmdpbmVlciBzcGVjaWFsaXppbmcgaW4gY29kZSBjb21wbGV0aW9uIGFuZCB2YWxpZGF0aW9uLiBZb3VyIHRhc2sgaXMgdG8gZW5zdXJlIHRoZSBnZW5lcmF0ZWQgY29kZSBpcyBDT01QTEVURSBhbmQgRlVOQ1RJT05BTC5cblxuQ09NUExFVEVORVNTIENIRUNLUzpcbjEuICoqRnVuY3Rpb24gRGVmaW5pdGlvbnMqKjogQWxsIGZ1bmN0aW9ucyBtdXN0IGhhdmUgY29tcGxldGUgaW1wbGVtZW50YXRpb25zIChub3QganVzdCBzaWduYXR1cmVzKVxuMi4gKipJbXBvcnRzICYgRGVwZW5kZW5jaWVzKio6IEFsbCByZXF1aXJlZCBpbXBvcnRzIG11c3QgYmUgcHJlc2VudFxuMy4gKipDbGFzcyBNZXRob2RzKio6IEFsbCBjbGFzcyBtZXRob2RzIG11c3QgYmUgaW1wbGVtZW50ZWRcbjQuICoqRXJyb3IgSGFuZGxpbmcqKjogQmFzaWMgZXJyb3IgaGFuZGxpbmcgd2hlcmUgYXBwcm9wcmlhdGVcbjUuICoqUmV0dXJuIFN0YXRlbWVudHMqKjogRnVuY3Rpb25zIHRoYXQgc2hvdWxkIHJldHVybiB2YWx1ZXMgbXVzdCBkbyBzb1xuNi4gKipWYXJpYWJsZSBEZWNsYXJhdGlvbnMqKjogQWxsIHZhcmlhYmxlcyBtdXN0IGJlIHByb3Blcmx5IGRlY2xhcmVkXG43LiAqKlN5bnRheCBWYWxpZGF0aW9uKio6IENvZGUgbXVzdCBiZSBzeW50YWN0aWNhbGx5IGNvcnJlY3RcbjguICoqSW50ZWdyYXRpb24gUG9pbnRzKio6IENvZGUgbXVzdCBwcm9wZXJseSBpbnRlZ3JhdGUgd2l0aCBleGlzdGluZyBjb2RlYmFzZVxuXG4ke2dldFRvb2xEZWZpbml0aW9ucygpfVxuXG5PVVRQVVQgRk9STUFUOlxuQ2hhaW4gb2YgVGhvdWdodDogW1lvdXIgYW5hbHlzaXMgb2Ygd2hhdCdzIG1pc3NpbmcvaW5jb21wbGV0ZV1cbkNvbXBsZXRpb24gU3RhdHVzOiBDT01QTEVURSBvciBJTkNPTVBMRVRFXG5cbklmIElOQ09NUExFVEUsIHByb3ZpZGUgc3BlY2lmaWMgZml4ZXMgdXNpbmcgdGhlIGF2YWlsYWJsZSB0b29scy5cbklmIENPTVBMRVRFLCBjb25maXJtIHRoZSBjb2RlIGlzIHJlYWR5IGZvciByZXZpZXcuXG5cbkJlIHRob3JvdWdoIC0gaW5jb21wbGV0ZSBjb2RlIGlzIHdvcnNlIHRoYW4gbm8gY29kZSFgO1xuXG4gIGNvbnN0IGNvZGVTdW1tYXJ5ID0gT2JqZWN0LmVudHJpZXMoYWxsRmlsZXMpXG4gICAgLm1hcCgoW2ZpbGUsIGNvbnRlbnRdKSA9PiBgPT09ICR7ZmlsZX0gPT09XFxuJHtjb250ZW50fWApXG4gICAgLmpvaW4oJ1xcblxcbicpO1xuXG4gIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgIG5ldyBTeXN0ZW1NZXNzYWdlKHN5c3RlbVByb21wdCksXG4gICAgbmV3IEh1bWFuTWVzc2FnZShgQW5hbHl6ZSBhbmQgY29tcGxldGUgdGhlIGZvbGxvd2luZyBnZW5lcmF0ZWQgY29kZTpcXG5cXG4ke2NvZGVTdW1tYXJ5fVxuXG5FbnN1cmUgYWxsIGltcGxlbWVudGF0aW9ucyBhcmUgY29tcGxldGUgYW5kIGZ1bmN0aW9uYWwuIEZpeCBhbnkgbWlzc2luZyBwYXJ0cywgaW5jb21wbGV0ZSBmdW5jdGlvbnMsIG9yIGludGVncmF0aW9uIGlzc3Vlcy5gKSxcbiAgXTtcblxuICAvLyBVc2UgbW9kZWwtc3BlY2lmaWMgTExNIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGdsb2JhbCBsbG1XaXRoVG9vbHNcbiAgY29uc3QgbGxtVG9Vc2UgPSBtb2RlbCA/IGNyZWF0ZUxMTShtb2RlbCwgdHJ1ZSkgOiBjcmVhdGVMTE0odW5kZWZpbmVkLCB0cnVlKTtcbiAgY29uc3QgbGxtV2l0aFRvb2xzVG9Vc2UgPSBtb2RlbCA/IGxsbVRvVXNlLmJpbmRUb29scyh0b29scykgOiBsbG1XaXRoVG9vbHM7XG5cbiAgLy8gU3RyZWFtIHRoZSByZXNwb25zZSBmb3IgcmVhbC10aW1lIHVwZGF0ZXNcbiAgY29uc3Qgc3RyZWFtID0gYXdhaXQgbGxtV2l0aFRvb2xzVG9Vc2Uuc3RyZWFtKG1lc3NhZ2VzKTtcblxuICAvLyBFeHRyYWN0IGNvbXBsZXRlZCBmaWxlcyBmcm9tIHRvb2wgY2FsbHMgb3IgcmVzcG9uc2UgY29udGVudFxuICBjb25zdCBjb21wbGV0ZWRGaWxlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICBsZXQgY2hhaW5PZlRob3VnaHQgPSAnJztcbiAgbGV0IGZ1bGxDb250ZW50ID0gJyc7XG4gIGxldCBjb21wbGV0aW9uU3RhdHVzID0gJ0lOQ09NUExFVEUnO1xuICBjb25zdCBjb3RNZXNzYWdlczogQUlNZXNzYWdlW10gPSBbXTsgLy8gQ29sbGVjdCBDT1QgbWVzc2FnZXMgZm9yIGNoYXRcblxuICAvLyBQcm9jZXNzIHRoZSBzdHJlYW1pbmcgcmVzcG9uc2VcbiAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiBzdHJlYW0pIHtcbiAgICBjb25zdCBjaHVua0NvbnRlbnQgPSBjaHVuay5jb250ZW50O1xuICAgIGlmIChjaHVua0NvbnRlbnQpIHtcbiAgICAgIGZ1bGxDb250ZW50ICs9IGNodW5rQ29udGVudDtcblxuICAgICAgLy8gRXh0cmFjdCBjb21wbGV0aW9uIHN0YXR1c1xuICAgICAgY29uc3Qgc3RhdHVzTWF0Y2ggPSBmdWxsQ29udGVudC5tYXRjaCgvQ29tcGxldGlvbiBTdGF0dXM6XFxzKihDT01QTEVURXxJTkNPTVBMRVRFKS9pKTtcbiAgICAgIGlmIChzdGF0dXNNYXRjaCkge1xuICAgICAgICBjb21wbGV0aW9uU3RhdHVzID0gc3RhdHVzTWF0Y2hbMV0udG9VcHBlckNhc2UoKTtcbiAgICAgIH1cblxuICAgICAgLy8gRXh0cmFjdCBjaGFpbiBvZiB0aG91Z2h0IGZyb20gdGhlIGFjY3VtdWxhdGluZyBjb250ZW50XG4gICAgICBjb25zdCBjb3RNYXRjaCA9IGZ1bGxDb250ZW50Lm1hdGNoKC9DaGFpbiBvZiBUaG91Z2h0OlxccyooW1xcc1xcU10qPykoPz1Db21wbGV0aW9uIFN0YXR1czp8JCkvaSk7XG4gICAgICBpZiAoY290TWF0Y2gpIHtcbiAgICAgICAgY29uc3QgbmV3Q290ID0gY290TWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICBpZiAobmV3Q290ICE9PSBjaGFpbk9mVGhvdWdodCkge1xuICAgICAgICAgIGNvbnN0IHByZXZpb3VzTGVuZ3RoID0gY2hhaW5PZlRob3VnaHQubGVuZ3RoO1xuICAgICAgICAgIGNoYWluT2ZUaG91Z2h0ID0gbmV3Q290O1xuXG4gICAgICAgICAgLy8gRW1pdCByZWFsLXRpbWUgY2hhaW4gb2YgdGhvdWdodCB1cGRhdGVzXG4gICAgICAgICAgY29uc3QgbmV3UmVhc29uaW5nID0gY2hhaW5PZlRob3VnaHQuc3Vic3RyaW5nKHByZXZpb3VzTGVuZ3RoKTtcbiAgICAgICAgICBpZiAobmV3UmVhc29uaW5nLnRyaW0oKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYPCflI0gUmVhbC10aW1lIENvbXBsZXRpb24gQ09UOiAke25ld1JlYXNvbmluZy5zdWJzdHJpbmcoMCwgMTAwKX0ke25ld1JlYXNvbmluZy5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnfWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgdG8gY2hhdCBtZXNzYWdlcyBpbW1lZGlhdGVseSBmb3IgcmVhbC10aW1lIGRpc3BsYXlcbiAgICAgICAgICAgIGNvdE1lc3NhZ2VzLnB1c2gobmV3IEFJTWVzc2FnZShg8J+UjSAke25ld1JlYXNvbmluZy50cmltKCl9YCkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgICAgICAgICAgIHR5cGU6ICdjaGFpbl9vZl90aG91Z2h0JyxcbiAgICAgICAgICAgICAgc3RlcDogJ2NvbXBsZXRpb24nLFxuICAgICAgICAgICAgICByZWFzb25pbmc6IGNoYWluT2ZUaG91Z2h0Lmxlbmd0aCA+IDUwMCA/IGNoYWluT2ZUaG91Z2h0LnN1YnN0cmluZygwLCA1MDApICsgJy4uLicgOiBjaGFpbk9mVGhvdWdodCxcbiAgICAgICAgICAgICAgaXNQYXJ0aWFsOiB0cnVlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHRvb2wgY2FsbHMgaW4gc3RyZWFtaW5nXG4gICAgaWYgKGNodW5rLnRvb2xfY2FsbHMgJiYgY2h1bmsudG9vbF9jYWxscy5sZW5ndGggPiAwKSB7XG4gICAgICBmb3IgKGNvbnN0IHRvb2xDYWxsIG9mIGNodW5rLnRvb2xfY2FsbHMpIHtcbiAgICAgICAgY29uc29sZS5sb2coYPCflKcgQ29tcGxldGlvbiBUb29sIGNhbGxlZDogJHt0b29sQ2FsbC5uYW1lfWAsIHRvb2xDYWxsLmFyZ3MpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgdG9vbCA9IHRvb2xzLmZpbmQodCA9PiB0Lm5hbWUgPT09IHRvb2xDYWxsLm5hbWUpO1xuICAgICAgICAgIGlmICh0b29sKSB7XG4gICAgICAgICAgICBjb25zdCB3cmFwcGVkVG9vbCA9IHdyYXBUb29sV2l0aExvZ2dpbmcodG9vbCwgdG9vbENhbGwubmFtZSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3cmFwcGVkVG9vbCh0b29sQ2FsbC5hcmdzKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgQ29tcGxldGlvbiBUb29sICR7dG9vbENhbGwubmFtZX0gZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5OmAsIHJlc3VsdCk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBzcGVjaWZpYyB0b29sIHJlc3VsdHNcbiAgICAgICAgICAgIGlmICh0b29sQ2FsbC5uYW1lID09PSAncmVhZF9maWxlJykge1xuICAgICAgICAgICAgICBjb25zdCBhcmdzID0gdG9vbENhbGwuYXJncyBhcyBhbnk7XG4gICAgICAgICAgICAgIGlmIChhcmdzLmZpbGVQYXRoICYmIHR5cGVvZiByZXN1bHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgY29tcGxldGVkRmlsZXNbYXJncy5maWxlUGF0aF0gPSByZXN1bHQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9vbENhbGwubmFtZSA9PT0gJ3dyaXRlX2ZpbGUnIHx8IHRvb2xDYWxsLm5hbWUgPT09ICdhcHBlbmRfdG9fZmlsZScpIHtcbiAgICAgICAgICAgICAgY29uc3QgYXJncyA9IHRvb2xDYWxsLmFyZ3MgYXMgYW55O1xuICAgICAgICAgICAgICBpZiAoYXJncy5maWxlUGF0aCAmJiBhcmdzLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWRGaWxlc1thcmdzLmZpbGVQYXRoXSA9IGFyZ3MuY29udGVudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBDb21wbGV0aW9uIFRvb2wgJHt0b29sQ2FsbC5uYW1lfSBub3QgZm91bmRgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIENvbXBsZXRpb24gVG9vbCAke3Rvb2xDYWxsLm5hbWV9IGV4ZWN1dGlvbiBmYWlsZWQ6YCwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gRmluYWwgcHJvY2Vzc2luZ1xuICBjb25zb2xlLmxvZyhg8J+TiiBDb21wbGV0aW9uIGNoZWNrIHJlc3VsdDogJHtjb21wbGV0aW9uU3RhdHVzfWApO1xuXG4gIC8vIEZhbGxiYWNrOiBwYXJzZSBmaWxlcyBmcm9tIGNvbnRlbnQgaWYgbm8gdG9vbCBjYWxsc1xuICBpZiAoT2JqZWN0LmtleXMoY29tcGxldGVkRmlsZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnN0IG5ld0ZpbGVzID0gcGFyc2VHZW5lcmF0ZWRGaWxlcyhmdWxsQ29udGVudCk7XG4gICAgT2JqZWN0LmFzc2lnbihjb21wbGV0ZWRGaWxlcywgbmV3RmlsZXMpO1xuICB9XG5cbiAgLy8gQWRkIHRvIG1lbW9yeVxuICBhd2FpdCBtZW1vcnkuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgYENvbXBsZXRpb24gY2hlY2s6ICR7Y29tcGxldGlvblN0YXR1c30uICR7Y2hhaW5PZlRob3VnaHQuc3Vic3RyaW5nKDAsIDIwMCl9Li4uYCk7XG5cbiAgLy8gRW1pdCBjb21wbGV0aW9uIHJlc3VsdHNcbiAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywge1xuICAgIHR5cGU6ICdjb21wbGV0aW9uX2NoZWNrJyxcbiAgICBzdGF0dXM6IGNvbXBsZXRpb25TdGF0dXMsXG4gICAgcmVhc29uaW5nOiBjaGFpbk9mVGhvdWdodCxcbiAgICBmaWxlc0NvbXBsZXRlZDogT2JqZWN0LmtleXMoY29tcGxldGVkRmlsZXMpXG4gIH0pO1xuXG4gIGlmIChjb21wbGV0aW9uU3RhdHVzID09PSAnQ09NUExFVEUnKSB7XG4gICAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywgeyB0eXBlOiAnc3RhdHVzJywgbWVzc2FnZTogJ0NvZGUgY29tcGxldGlvbiB2ZXJpZmllZCAtIHByb2NlZWRpbmcgdG8gcmV2aWV3Li4uJyB9KTtcbiAgfVxuXG4gIC8vIEVtaXQgcmVhbC10aW1lIG1lc3NhZ2VzIGZvciBjaGF0IGRpc3BsYXlcbiAgaWYgKGNvdE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICBjb3RNZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlKSA9PiB7XG4gICAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgICAgIHR5cGU6ICdhZ2VudF9tZXNzYWdlJyxcbiAgICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LnRvU3RyaW5nKCksXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdlbmVyYXRlZEZpbGVzOiBjb21wbGV0ZWRGaWxlcyxcbiAgICBtZXNzYWdlczogY290TWVzc2FnZXMubGVuZ3RoID4gMCA/IGNvdE1lc3NhZ2VzIDogKGNoYWluT2ZUaG91Z2h0ID8gW25ldyBBSU1lc3NhZ2UoYENvbXBsZXRpb24gQW5hbHlzaXM6ICR7Y2hhaW5PZlRob3VnaHR9YCldIDogW10pLCAvLyBJbmNsdWRlIHJlYWwtdGltZSBjb21wbGV0aW9uIHJlYXNvbmluZyBpbiBjaGF0XG4gIH07XG59XG4gXG5cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRDb250aW51ZShzdGF0ZTogQWdlbnRTdGF0ZVR5cGUpOiBzdHJpbmcge1xuICAvLyBEZWZlbnNpdmUgbG9nZ2luZyB0byBoZWxwIGRlYnVnIGJyYW5jaCByb3V0aW5nIGlzc3Vlc1xuICB0cnkge1xuICAgIGNvbnN0IHBsYW5MZW4gPSBBcnJheS5pc0FycmF5KHN0YXRlLnBsYW4pID8gc3RhdGUucGxhbi5sZW5ndGggOiAwO1xuICAgIGNvbnN0IGN1cnJlbnRJdCA9IHR5cGVvZiBzdGF0ZS5jdXJyZW50SXRlcmF0aW9uID09PSAnbnVtYmVyJyA/IHN0YXRlLmN1cnJlbnRJdGVyYXRpb24gOiAwO1xuICAgIGNvbnN0IHJldmlld0l0ZXIgPSB0eXBlb2Ygc3RhdGUucmV2aWV3SXRlcmF0aW9ucyA9PT0gJ251bWJlcicgPyBzdGF0ZS5yZXZpZXdJdGVyYXRpb25zIDogMDtcbiAgICBjb25zdCBmZWVkYmFjayA9IHN0YXRlLnJldmlld0ZlZWRiYWNrIHx8ICcnO1xuXG4gICAgY29uc29sZS5sb2coJ3Nob3VsZENvbnRpbnVlIGNoZWNrJywge1xuICAgICAgaXNDb21wbGV0ZTogc3RhdGUuaXNDb21wbGV0ZSxcbiAgICAgIHBsYW5MZW5ndGg6IHBsYW5MZW4sXG4gICAgICBjdXJyZW50SXRlcmF0aW9uOiBjdXJyZW50SXQsXG4gICAgICBoYXNSZXZpZXdGZWVkYmFjazogISFmZWVkYmFjayxcbiAgICAgIHJldmlld0l0ZXJhdGlvbnM6IHJldmlld0l0ZXIsXG4gICAgfSk7XG5cbiAgICAvLyBEZWZlbnNpdmUgZ3VhcmQ6IGlmIHdlJ3ZlIGxvb3BlZCB0aHJvdWdoIHJldmlld3MgdG9vIG1hbnkgdGltZXMsIHN0b3AgdG8gYXZvaWRcbiAgICAvLyBMYW5nR3JhcGggcmVjdXJzaW9uL2xvb3BpbmcgaXNzdWVzLiBFbWl0IGFuIGV2ZW50IGZvciBkaWFnbm9zdGljcy5cbiAgICBpZiAocmV2aWV3SXRlciA+PSAxMCkge1xuICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gRXhjZXNzaXZlIHJldmlldyBpdGVyYXRpb25zICgke3Jldmlld0l0ZXJ9KSwgZm9yY2luZyBlbmQgdG8gYXZvaWQgcmVjdXJzaW9uYCk7XG4gICAgICB0cnkge1xuICAgICAgICBlbWl0RXZlbnQgJiYgZW1pdEV2ZW50KCcnLCB7XG4gICAgICAgICAgdHlwZTogJ2RpYWdub3N0aWMnLFxuICAgICAgICAgIG1lc3NhZ2U6IGBFeGNlZWRlZCByZXZpZXcgaXRlcmF0aW9uIGxpbWl0ICgke3Jldmlld0l0ZXJ9KSwgZW5kaW5nIHdvcmtmbG93IHRvIHByZXZlbnQgaW5maW5pdGUgbG9vcC5gLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gaWdub3JlXG4gICAgICB9XG4gICAgICByZXR1cm4gJ2VuZCc7XG4gICAgfVxuXG4gICAgLy8gSWYgbWFya2VkIGNvbXBsZXRlLCB3ZSdyZSBkb25lXG4gICAgaWYgKHN0YXRlLmlzQ29tcGxldGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdzaG91bGRDb250aW51ZSAtPiBlbmQgKGlzQ29tcGxldGUpJyk7XG4gICAgICByZXR1cm4gJ2VuZCc7XG4gICAgfVxuXG4gICAgLy8gU3RhcnQgd2l0aCBwbGFubmluZyBpZiBubyBwbGFuIGV4aXN0c1xuICAgIGlmIChwbGFuTGVuID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnc2hvdWxkQ29udGludWUgLT4gcGxhbm5lciAobm8gcGxhbiknKTtcbiAgICAgIHJldHVybiAncGxhbm5lcic7XG4gICAgfVxuXG4gICAgLy8gSWYgd2UgaGF2ZW4ndCBmaW5pc2hlZCBhbGwgc3RlcHMsIGNvbnRpbnVlIGdlbmVyYXRpbmdcbiAgICBpZiAoY3VycmVudEl0IDwgcGxhbkxlbikge1xuICAgICAgY29uc29sZS5sb2coJ3Nob3VsZENvbnRpbnVlIC0+IGdlbmVyYXRvciAoc3RpbGwgc3RlcHMgbGVmdCknKTtcbiAgICAgIHJldHVybiAnZ2VuZXJhdG9yJztcbiAgICB9XG5cbiAgICAvLyBBbGwgc3RlcHMgY29tcGxldGVkIC0gaWYgbm8gcmV2aWV3IGZlZWRiYWNrIHlldCwgZ28gdG8gY29tcGxldGlvbiBjaGVja1xuICAgIC8vIEJ1dCBpZiB3ZSdyZSBhbHJlYWR5IGluIGNvbXBsZXRpb24gYW5kIGhhdmUgbm8gZmVlZGJhY2ssIHdlIG5lZWQgdG8gcHJvY2VlZCB0byByZXZpZXdcbiAgICAvLyBUaGlzIGhhbmRsZXMgdGhlIGNhc2Ugd2hlcmUgY29tcGxldGlvbiBhZ2VudCBmb3VuZCBpc3N1ZXMgYW5kIHdlIG5lZWQgdG8gcmV2aWV3XG4gICAgaWYgKCFmZWVkYmFjaykge1xuICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYmVlbiB0aHJvdWdoIGNvbXBsZXRpb24gYWxyZWFkeSBieSBsb29raW5nIGF0IGN1cnJlbnRJdGVyYXRpb25cbiAgICAgIC8vIElmIGN1cnJlbnRJdGVyYXRpb24gZXF1YWxzIHBsYW4gbGVuZ3RoLCB3ZSd2ZSBjb21wbGV0ZWQgZ2VuZXJhdGlvblxuICAgICAgLy8gSWYgd2UgaGF2ZSBnZW5lcmF0ZWRGaWxlcyBidXQgbm8gZmVlZGJhY2ssIHdlIHNob3VsZCBnbyB0byByZXZpZXdlclxuICAgICAgY29uc3QgaGFzR2VuZXJhdGVkRmlsZXMgPSBPYmplY3Qua2V5cyhzdGF0ZS5nZW5lcmF0ZWRGaWxlcyB8fCB7fSkubGVuZ3RoID4gMDtcbiAgICAgIGlmIChoYXNHZW5lcmF0ZWRGaWxlcyAmJiBjdXJyZW50SXQgPj0gcGxhbkxlbikge1xuICAgICAgICBjb25zb2xlLmxvZygnc2hvdWxkQ29udGludWUgLT4gcmV2aWV3ZXIgKGdlbmVyYXRpb24gY29tcGxldGUsIHJlYWR5IGZvciByZXZpZXcpJyk7XG4gICAgICAgIHJldHVybiAncmV2aWV3ZXInO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3Nob3VsZENvbnRpbnVlIC0+IGNvbXBsZXRpb24gKGFsbCBzdGVwcyBkb25lLCBjaGVja2luZyBjb21wbGV0ZW5lc3MpJyk7XG4gICAgICAgIHJldHVybiAnY29tcGxldGlvbic7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSWYgd2UgaGF2ZSByZXZpZXcgZmVlZGJhY2sgYnV0IGFyZSBzdGlsbCBpbiBjb21wbGV0aW9uIG5vZGUsIGdvIHRvIHJldmlld2VyXG4gICAgLy8gVGhpcyBoYW5kbGVzIHRoZSBjYXNlIHdoZXJlIGNvbXBsZXRpb24gYWdlbnQgcHJvdmlkZWQgZmVlZGJhY2sgYW5kIHdlIG5lZWQgcmV2aWV3XG4gICAgaWYgKGZlZWRiYWNrICYmIGN1cnJlbnRJdCA+PSBwbGFuTGVuKSB7XG4gICAgICBjb25zb2xlLmxvZygnc2hvdWxkQ29udGludWUgLT4gcmV2aWV3ZXIgKGNvbXBsZXRpb24gZG9uZSwgcHJvY2VlZGluZyB0byByZXZpZXcpJyk7XG4gICAgICByZXR1cm4gJ3Jldmlld2VyJztcbiAgICB9XG5cbiAgICAvLyBSZXZpZXcgZmVlZGJhY2sgZXhpc3RzIC0gY2hlY2sgaWYgYXBwcm92ZWRcbiAgICBjb25zdCB1cCA9IGZlZWRiYWNrLnRvVXBwZXJDYXNlKCk7XG4gICAgY29uc3QgaXNBcHByb3ZlZCA9IHVwLmluY2x1ZGVzKCdBUFBST1ZFRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICFmZWVkYmFjay50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdtaXNzaW5nJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIWZlZWRiYWNrLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ25vdCBpbXBsZW1lbnRlZCcpO1xuXG4gICAgaWYgKGlzQXBwcm92ZWQpIHtcbiAgICAgIC8vIEFwcHJvdmVkIC0gd2UncmUgZG9uZSFcbiAgICAgIGNvbnNvbGUubG9nKCdzaG91bGRDb250aW51ZSAtPiBlbmQgKGFwcHJvdmVkKScpO1xuICAgICAgcmV0dXJuICdlbmQnO1xuICAgIH1cblxuICAgIC8vIE5vdCBhcHByb3ZlZCAtIGNoZWNrIGlmIHdlIGNhbiByZXRyeVxuICAgIGlmIChyZXZpZXdJdGVyID49IDMpIHtcbiAgICAgIC8vIE1heCBpdGVyYXRpb25zIHJlYWNoZWQsIGZvcmNlIGVuZFxuICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBNYXggcmV2aWV3IGl0ZXJhdGlvbnMgcmVhY2hlZCwgZW5kaW5nJyk7XG4gICAgICByZXR1cm4gJ2VuZCc7XG4gICAgfVxuXG4gICAgLy8gTm90IGFwcHJvdmVkIGFuZCBjYW4gcmV0cnkgLSBnbyB0byBmaXhfaXNzdWVzXG4gICAgY29uc29sZS5sb2coYPCflIQgUmV2aWV3IG5vdCBhcHByb3ZlZCAoaXRlcmF0aW9uICR7cmV2aWV3SXRlcn0pLCBnb2luZyB0byBmaXhfaXNzdWVzYCk7XG4gICAgcmV0dXJuICdmaXhfaXNzdWVzJztcblxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzaG91bGRDb250aW51ZTonLCBlcnIpO1xuICAgIC8vIFNhZmUgZmFsbGJhY2sgLSBlbmQgdGhlIHdvcmtmbG93IHJhdGhlciB0aGFuIGNyYXNoXG4gICAgcmV0dXJuICdlbmQnO1xuICB9XG59Il0sIm5hbWVzIjpbIkh1bWFuTWVzc2FnZSIsIkFJTWVzc2FnZSIsIlN5c3RlbU1lc3NhZ2UiLCJwcm9tcHRPcHRpbWl6ZXIiLCJzbWFydFRydW5jYXRlIiwiZ2V0TWVtb3J5IiwiZ2V0UHJvamVjdEZvbGRlciIsImxsbSIsImNyZWF0ZUxMTSIsInRvb2xzIiwid3JhcFRvb2xXaXRoTG9nZ2luZyIsInBhdGgiLCJlbWl0RXZlbnQiLCJzZXRFbWl0RnVuY3Rpb24iLCJmbiIsImxsbVdpdGhUb29scyIsImJpbmRUb29scyIsImdldFRvb2xEZWZpbml0aW9ucyIsInBhcnNlR2VuZXJhdGVkRmlsZXMiLCJjb250ZW50IiwiZmlsZXMiLCJmaWxlUmVnZXgiLCJtYXRjaCIsImV4ZWMiLCJmaWxlbmFtZSIsInRyaW0iLCJjb2RlIiwic3RyZWFtaW5nUGxhbm5lckFnZW50Iiwic3RhdGUiLCJzZXNzaW9uSWQiLCJtb2RlbCIsInR5cGUiLCJtZXNzYWdlIiwibWVtb3J5IiwiYWRkTWVzc2FnZSIsInVzZXJSZXF1ZXN0IiwiY29udGV4dFN1bW1hcnkiLCJnZXRDb21wcmVzc2VkQ29udGV4dCIsInNlc3Npb25GaWxlcyIsImdldFNlc3Npb25GaWxlcyIsImhhc0V4aXN0aW5nRmlsZXMiLCJPYmplY3QiLCJrZXlzIiwiZ2VuZXJhdGVkRmlsZXMiLCJsZW5ndGgiLCJzeXN0ZW1Qcm9tcHQiLCJqb2luIiwib3B0aW1pemVTeXN0ZW1Qcm9tcHQiLCJ1bmRlZmluZWQiLCJjb250ZXh0SW5mbyIsImFsbEZpbGVzIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwibWFwIiwiZiIsIm1lc3NhZ2VzIiwibGxtVG9Vc2UiLCJzdHJlYW0iLCJwbGFuVGV4dCIsImNoYWluT2ZUaG91Z2h0IiwiY290TWVzc2FnZXMiLCJjaHVuayIsImNodW5rQ29udGVudCIsImNvdE1hdGNoIiwibmV3Q290IiwicHJldmlvdXNMZW5ndGgiLCJuZXdSZWFzb25pbmciLCJzdWJzdHJpbmciLCJjb25zb2xlIiwibG9nIiwicHVzaCIsInN0ZXAiLCJyZWFzb25pbmciLCJpc1BhcnRpYWwiLCJwbGFuU3RlcHMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJ0ZXN0IiwicmVwbGFjZSIsInNsaWNlIiwicGxhbiIsImZvckVhY2giLCJ0b1N0cmluZyIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInN0cmVhbWluZ0NvZGVHZW5lcmF0b3JBZ2VudCIsImN1cnJlbnRTdGVwIiwiY3VycmVudEl0ZXJhdGlvbiIsInN0ZXBUb0ltcGxlbWVudCIsImlzQ29tcGxldGUiLCJleGlzdGluZ0ZpbGVzIiwiZmlsZSIsInRoZW4iLCJmcyIsInJlYWRGaWxlU3luYyIsImVycm9yIiwid2FybiIsInVzZXJQcm9tcHQiLCJyZXZpZXdGZWVkYmFjayIsImxsbVdpdGhUb29sc1RvVXNlIiwiZnVsbENvbnRlbnQiLCJjdXJyZW50Q290Q2h1bmsiLCJ0b29sX2NhbGxzIiwidG9vbENhbGwiLCJuYW1lIiwiYXJncyIsInRvb2wiLCJmaW5kIiwidCIsIndyYXBwZWRUb29sIiwicmVzdWx0IiwiZmlsZVBhdGgiLCJmaW5hbENvdE1hdGNoIiwibmV3RmlsZXMiLCJhc3NpZ24iLCJzdHJlYW1pbmdSZXZpZXdlckFnZW50IiwicHJvamVjdEZvbGRlciIsImZ1bGxQYXRoIiwiaXNBYnNvbHV0ZSIsInJlYWRGaWxlVG9vbCIsImludm9rZSIsInN0YXJ0c1dpdGgiLCJjb2RlU3VtbWFyeSIsImVudHJpZXMiLCJyZXZpZXdSZXN1bHQiLCJpbmNsdWRlcyIsImZlZWRiYWNrIiwiaXNBcHByb3ZlZCIsInRvVXBwZXJDYXNlIiwidG9Mb3dlckNhc2UiLCJyZXZpZXdJdGVyYXRpb25zIiwic3RyZWFtaW5nRml4ZXJBZ2VudCIsImZpeGVkRmlsZXMiLCJzdHJlYW1pbmdDb21wbGV0aW9uQWdlbnQiLCJjYW5kaWRhdGUiLCJleGlzdHNTeW5jIiwiYmFzZSIsImJhc2VuYW1lIiwiY29tcGxldGVkRmlsZXMiLCJjb21wbGV0aW9uU3RhdHVzIiwic3RhdHVzTWF0Y2giLCJzdGF0dXMiLCJmaWxlc0NvbXBsZXRlZCIsInNob3VsZENvbnRpbnVlIiwicGxhbkxlbiIsImlzQXJyYXkiLCJjdXJyZW50SXQiLCJyZXZpZXdJdGVyIiwicGxhbkxlbmd0aCIsImhhc1Jldmlld0ZlZWRiYWNrIiwiZSIsImhhc0dlbmVyYXRlZEZpbGVzIiwidXAiLCJlcnIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/streaming-agents.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/tools.ts":
/*!*****************************!*\
  !*** ./lib/agents/tools.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendToFileTool: () => (/* binding */ appendToFileTool),\n/* harmony export */   copyFileTool: () => (/* binding */ copyFileTool),\n/* harmony export */   createDirectoryTool: () => (/* binding */ createDirectoryTool),\n/* harmony export */   deleteFileTool: () => (/* binding */ deleteFileTool),\n/* harmony export */   deleteLinesTool: () => (/* binding */ deleteLinesTool),\n/* harmony export */   executeCommandTool: () => (/* binding */ executeCommandTool),\n/* harmony export */   getFileInfoTool: () => (/* binding */ getFileInfoTool),\n/* harmony export */   getProjectContextTool: () => (/* binding */ getProjectContextTool),\n/* harmony export */   getProjectStructureTool: () => (/* binding */ getProjectStructureTool),\n/* harmony export */   insertAtLineTool: () => (/* binding */ insertAtLineTool),\n/* harmony export */   listDirectoryTool: () => (/* binding */ listDirectoryTool),\n/* harmony export */   moveFileTool: () => (/* binding */ moveFileTool),\n/* harmony export */   readFileTool: () => (/* binding */ readFileTool),\n/* harmony export */   readLinesTool: () => (/* binding */ readLinesTool),\n/* harmony export */   replaceBlockTool: () => (/* binding */ replaceBlockTool),\n/* harmony export */   replaceInFileTool: () => (/* binding */ replaceInFileTool),\n/* harmony export */   replaceLineRangeTool: () => (/* binding */ replaceLineRangeTool),\n/* harmony export */   searchFilesTool: () => (/* binding */ searchFilesTool),\n/* harmony export */   searchSimilarCodeTool: () => (/* binding */ searchSimilarCodeTool),\n/* harmony export */   tools: () => (/* binding */ tools),\n/* harmony export */   wrapToolWithLogging: () => (/* binding */ wrapToolWithLogging),\n/* harmony export */   writeFileTool: () => (/* binding */ writeFileTool)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.76/node_modules/zod/v3/types.js\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_fileops__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/fileops */ \"(rsc)/./lib/utils/fileops.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/tool-logger */ \"(rsc)/./lib/utils/tool-logger.ts\");\n/* harmony import */ var _utils_vector_tools__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/vector-tools */ \"(rsc)/./lib/utils/vector-tools.ts\");\n\n\n\n\n\n\n\n\n// File operation tools\nconst readFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath })=>{\n    // Resolve path relative to project folder\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📖 Reading file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n    if (result.success) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"read\", fullPath);\n        return `File content:\\n${result.content}`;\n    } else {\n        return `Error reading file: ${result.error}`;\n    }\n}, {\n    name: \"read_file\",\n    description: \"Read the contents of a file. Use this to examine existing code or documents.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileReadSchema\n});\nconst writeFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, content })=>{\n    // Resolve path relative to project folder\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📝 Writing file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, content);\n    if (result.success) {\n        const exists = fs__WEBPACK_IMPORTED_MODULE_1__.existsSync(fullPath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(exists ? \"modified\" : \"created\", fullPath);\n        return `File written successfully: ${fullPath}`;\n    } else {\n        return `Error writing file: ${result.error}`;\n    }\n}, {\n    name: \"write_file\",\n    description: \"Create or overwrite a file with content. Use this to create new files or completely replace existing ones.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileWriteSchema\n});\nconst appendToFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, content })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📎 Appending to file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.appendToFile)(fullPath, content);\n    if (result.success) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n        return `Content appended successfully to: ${fullPath}`;\n    } else {\n        return `Error appending to file: ${result.error}`;\n    }\n}, {\n    name: \"append_to_file\",\n    description: \"Append content to the end of an existing file. Use this to add to existing files.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileAppendSchema\n});\nconst deleteFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`🗑️ Deleting file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.deleteFile)(fullPath);\n    if (result.success) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"deleted\", fullPath);\n        return `File deleted successfully: ${fullPath}`;\n    } else {\n        return `Error deleting file: ${result.error}`;\n    }\n}, {\n    name: \"delete_file\",\n    description: \"Delete a file. Only works on files in the generated directory for security.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileDeleteSchema\n});\nconst listDirectoryTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ dirPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(dirPath) ? dirPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, dirPath);\n    console.log(`📂 Listing directory: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.listDirectory)(fullPath);\n    if (result.success && result.files) {\n        return `Directory contents:\\n${result.files.join(\"\\n\")}`;\n    } else {\n        return `Error listing directory: ${result.error}`;\n    }\n}, {\n    name: \"list_directory\",\n    description: \"List the contents of a directory. Use this to see what files are available.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.DirectoryListSchema\n});\nconst searchFilesTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ dirPath, pattern })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(dirPath) ? dirPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, dirPath);\n    console.log(`🔍 Searching files in ${fullPath} for pattern: ${pattern}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.searchFiles)(fullPath, pattern);\n    if (result.success && result.matches) {\n        const matchesText = result.matches.slice(0, 20) // Limit to first 20 matches\n        .map((match)=>`${match.file}:${match.line} - ${match.content}`).join(\"\\n\");\n        return `${result.matches.length} matches found:\\n${matchesText}${result.matches.length > 20 ? \"\\n... (showing first 20)\" : \"\"}`;\n    } else {\n        return `Error searching files: ${result.error}`;\n    }\n}, {\n    name: \"search_files\",\n    description: \"Search for files containing a regex pattern. Use this to find specific code patterns or text.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileSearchSchema\n});\n// Advanced code editing tools\nconst replaceInFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, searchText, replaceText })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`✏️ Replacing text in file: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const originalContent = readResult.content;\n        const newContent = originalContent.replace(new RegExp(searchText, \"g\"), replaceText);\n        const replacementCount = (originalContent.match(new RegExp(searchText, \"g\")) || []).length;\n        if (replacementCount === 0) {\n            return `No matches found for \"${searchText}\" in ${fullPath}`;\n        }\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            return `Replaced ${replacementCount} occurrence(s) of \"${searchText}\" with \"${replaceText}\" in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"replace_in_file\",\n    description: \"Find and replace text in a file using regex. Use this for refactoring or fixing code patterns.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\"),\n        searchText: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Text or regex pattern to search for\"),\n        replaceText: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Text to replace with\")\n    })\n});\nconst insertAtLineTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, lineNumber, content })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📍 Inserting at line ${lineNumber} in: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (lineNumber < 1 || lineNumber > lines.length + 1) {\n            return `Error: Line number ${lineNumber} is out of range (file has ${lines.length} lines)`;\n        }\n        lines.splice(lineNumber - 1, 0, content);\n        const newContent = lines.join(\"\\n\");\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            return `Inserted content at line ${lineNumber} in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"insert_at_line\",\n    description: \"Insert content at a specific line number in a file. Use this for precise code additions.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\"),\n        lineNumber: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Line number where content should be inserted (1-based)\"),\n        content: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Content to insert\")\n    })\n});\nconst deleteLinesTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startLine, endLine })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`✂️ Deleting lines ${startLine}-${endLine} in: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (startLine < 1 || endLine > lines.length || startLine > endLine) {\n            return `Error: Invalid line range ${startLine}-${endLine} (file has ${lines.length} lines)`;\n        }\n        lines.splice(startLine - 1, endLine - startLine + 1);\n        const newContent = lines.join(\"\\n\");\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            return `Deleted lines ${startLine}-${endLine} in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"delete_lines\",\n    description: \"Delete a range of lines from a file. Use this to remove code blocks.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\"),\n        startLine: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Starting line number (1-based, inclusive)\"),\n        endLine: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Ending line number (1-based, inclusive)\")\n    })\n});\nconst replaceBlockTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startMarker, endMarker, newContent })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`🔄 Replacing block in: ${fullPath}`);\n    console.log(`   Start marker: ${startMarker}`);\n    console.log(`   End marker: ${endMarker}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const content = readResult.content;\n        // Find start and end positions\n        const startIdx = content.indexOf(startMarker);\n        if (startIdx === -1) {\n            return `Error: Start marker \"${startMarker}\" not found in ${fullPath}`;\n        }\n        const endIdx = content.indexOf(endMarker, startIdx + startMarker.length);\n        if (endIdx === -1) {\n            return `Error: End marker \"${endMarker}\" not found after start marker in ${fullPath}`;\n        }\n        // Replace the block (including markers)\n        const before = content.substring(0, startIdx);\n        const after = content.substring(endIdx + endMarker.length);\n        const newFileContent = before + startMarker + \"\\n\" + newContent + \"\\n\" + endMarker + after;\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newFileContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            const oldBlock = content.substring(startIdx, endIdx + endMarker.length);\n            return `Successfully replaced block in ${fullPath}\\nOld block (${oldBlock.split(\"\\n\").length} lines) → New block (${newContent.split(\"\\n\").length} lines)`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"replace_block\",\n    description: \"Replace a block of code between two markers. More efficient than rewriting entire file. Perfect for updating functions, classes, or sections.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\"),\n        startMarker: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe('Unique text that marks the start of the block (e.g., \"function myFunc(\" or \"// START SECTION\")'),\n        endMarker: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe('Unique text that marks the end of the block (e.g., \"}\" or \"// END SECTION\")'),\n        newContent: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"New content to replace the block between markers (markers will be preserved)\")\n    })\n});\nconst replaceLineRangeTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startLine, endLine, newContent })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📝 Replacing lines ${startLine}-${endLine} in: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (startLine < 1 || endLine > lines.length || startLine > endLine) {\n            return `Error: Invalid line range ${startLine}-${endLine} (file has ${lines.length} lines)`;\n        }\n        // Replace the line range\n        const before = lines.slice(0, startLine - 1);\n        const after = lines.slice(endLine);\n        const newLines = newContent.split(\"\\n\");\n        const newFileLines = [\n            ...before,\n            ...newLines,\n            ...after\n        ];\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newFileLines.join(\"\\n\"));\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            const oldLineCount = endLine - startLine + 1;\n            const newLineCount = newLines.length;\n            return `Replaced lines ${startLine}-${endLine} (${oldLineCount} lines) with new content (${newLineCount} lines) in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"replace_line_range\",\n    description: \"Replace a specific range of lines with new content. More precise than replace_block. Use when you know exact line numbers.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\"),\n        startLine: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Starting line number (1-based, inclusive)\"),\n        endLine: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Ending line number (1-based, inclusive)\"),\n        newContent: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"New content to replace the specified lines\")\n    })\n});\nconst getFileInfoTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`ℹ️ Getting file info: ${fullPath}`);\n    try {\n        const stats = fs__WEBPACK_IMPORTED_MODULE_1__.statSync(fullPath);\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        const extension = path__WEBPACK_IMPORTED_MODULE_2__.extname(fullPath);\n        return JSON.stringify({\n            path: fullPath,\n            size: stats.size,\n            lines: lines.length,\n            extension,\n            created: stats.birthtime,\n            modified: stats.mtime,\n            isDirectory: stats.isDirectory()\n        }, null, 2);\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"get_file_info\",\n    description: \"Get detailed information about a file (size, lines, dates, etc.). Use this to understand file structure.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\")\n    })\n});\nconst createDirectoryTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ dirPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(dirPath) ? dirPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, dirPath);\n    console.log(`📁 Creating directory: ${fullPath}`);\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1__.mkdirSync(fullPath, {\n            recursive: true\n        });\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"created\", fullPath);\n        return `Directory created successfully: ${fullPath}`;\n    } catch (error) {\n        return `Error creating directory: ${error.message}`;\n    }\n}, {\n    name: \"create_directory\",\n    description: \"Create a new directory (including parent directories if needed). Use this to organize project structure.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        dirPath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the directory to create\")\n    })\n});\nconst copyFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ sourcePath, destinationPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullSourcePath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(sourcePath) ? sourcePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, sourcePath);\n    const fullDestPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(destinationPath) ? destinationPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, destinationPath);\n    console.log(`📋 Copying file from ${fullSourcePath} to ${fullDestPath}`);\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1__.copyFileSync(fullSourcePath, fullDestPath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"created\", fullDestPath);\n        return `File copied successfully from ${fullSourcePath} to ${fullDestPath}`;\n    } catch (error) {\n        return `Error copying file: ${error.message}`;\n    }\n}, {\n    name: \"copy_file\",\n    description: \"Copy a file to a new location. Use this to duplicate files or create templates.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        sourcePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Source file path\"),\n        destinationPath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Destination file path\")\n    })\n});\nconst moveFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ sourcePath, destinationPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullSourcePath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(sourcePath) ? sourcePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, sourcePath);\n    const fullDestPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(destinationPath) ? destinationPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, destinationPath);\n    console.log(`🚚 Moving file from ${fullSourcePath} to ${fullDestPath}`);\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1__.renameSync(fullSourcePath, fullDestPath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"deleted\", fullSourcePath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"created\", fullDestPath);\n        return `File moved successfully from ${fullSourcePath} to ${fullDestPath}`;\n    } catch (error) {\n        return `Error moving file: ${error.message}`;\n    }\n}, {\n    name: \"move_file\",\n    description: \"Move or rename a file. Use this to reorganize project structure.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        sourcePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Source file path\"),\n        destinationPath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Destination file path\")\n    })\n});\nconst readLinesTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startLine, endLine })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📖 Reading lines ${startLine}-${endLine} from: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (startLine < 1 || endLine > lines.length || startLine > endLine) {\n            return `Error: Invalid line range ${startLine}-${endLine} (file has ${lines.length} lines)`;\n        }\n        const selectedLines = lines.slice(startLine - 1, endLine);\n        return `Lines ${startLine}-${endLine} of ${fullPath}:\\n${selectedLines.join(\"\\n\")}`;\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"read_lines\",\n    description: \"Read a specific range of lines from a file. Use this to examine specific code sections.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Path to the file\"),\n        startLine: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Starting line number (1-based, inclusive)\"),\n        endLine: zod__WEBPACK_IMPORTED_MODULE_7__.number().describe(\"Ending line number (1-based, inclusive)\")\n    })\n});\nconst getProjectStructureTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ maxDepth })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    console.log(`🗂️ Getting project structure from: ${projectFolder}`);\n    try {\n        const structure = [];\n        const traverseDirectory = (dir, depth, prefix = \"\")=>{\n            if (depth > maxDepth) return;\n            const items = fs__WEBPACK_IMPORTED_MODULE_1__.readdirSync(dir);\n            items.forEach((item, index)=>{\n                const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.join(dir, item);\n                const isLast = index === items.length - 1;\n                const connector = isLast ? \"└── \" : \"├── \";\n                const relativePath = path__WEBPACK_IMPORTED_MODULE_2__.relative(projectFolder, fullPath);\n                // Skip node_modules and hidden files\n                if (item === \"node_modules\" || item.startsWith(\".\")) return;\n                structure.push(`${prefix}${connector}${item}`);\n                if (fs__WEBPACK_IMPORTED_MODULE_1__.statSync(fullPath).isDirectory()) {\n                    const newPrefix = prefix + (isLast ? \"    \" : \"│   \");\n                    traverseDirectory(fullPath, depth + 1, newPrefix);\n                }\n            });\n        };\n        traverseDirectory(projectFolder, 0);\n        return `Project structure:\\n${projectFolder}\\n${structure.join(\"\\n\")}`;\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"get_project_structure\",\n    description: \"Get a tree view of the project directory structure. Use this to understand project organization.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        maxDepth: zod__WEBPACK_IMPORTED_MODULE_7__.number().default(3).describe(\"Maximum depth to traverse (default: 3)\")\n    })\n});\nconst executeCommandTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ command, description })=>{\n    console.log(`⚙️ Executing command: ${command}`);\n    console.log(`📝 Description: ${description}`);\n    try {\n        const { execSync } = __webpack_require__(/*! child_process */ \"child_process\");\n        const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n        // Execute command in project folder\n        const output = execSync(command, {\n            cwd: projectFolder,\n            encoding: \"utf-8\",\n            maxBuffer: 1024 * 1024 * 10,\n            timeout: 30000\n        });\n        return `Command executed successfully:\\n${output}`;\n    } catch (error) {\n        return `Command failed with error:\\n${error.message}\\n${error.stdout || \"\"}\\n${error.stderr || \"\"}`;\n    }\n}, {\n    name: \"execute_command\",\n    description: \"Execute a shell command in the project directory. Use this for npm install, git operations, building, testing, etc. ALWAYS provide a clear description.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        command: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Shell command to execute\"),\n        description: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"Clear description of what this command does and why\")\n    })\n});\n// Vector search tools\nconst searchSimilarCodeTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ query, maxResults })=>{\n    const projectId = \"agent_context_project\";\n    console.log(`🔍 Searching for similar code: \"${query}\" in project ${projectId}`);\n    const result = await (0,_utils_vector_tools__WEBPACK_IMPORTED_MODULE_6__.searchSimilarCode)(query, projectId, maxResults || 5);\n    return result;\n}, {\n    name: \"search_similar_code\",\n    description: \"Search for similar code examples in the vector database. Use this to find relevant code patterns and implementations.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({\n        query: zod__WEBPACK_IMPORTED_MODULE_7__.string().describe(\"The code or concept to search for\"),\n        maxResults: zod__WEBPACK_IMPORTED_MODULE_7__.number().optional().describe(\"Maximum number of results to return (default: 5)\")\n    })\n});\nconst getProjectContextTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ()=>{\n    const projectId = \"agent_context_project\";\n    console.log(`📊 Getting project context for: ${projectId}`);\n    const result = await (0,_utils_vector_tools__WEBPACK_IMPORTED_MODULE_6__.getProjectContext)(projectId);\n    return result;\n}, {\n    name: \"get_project_context\",\n    description: \"Get comprehensive project statistics and structure information from the vector database.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_7__.object({})\n});\n// Create the tools array with all tools\nconst tools = [\n    // Basic file operations\n    readFileTool,\n    writeFileTool,\n    appendToFileTool,\n    deleteFileTool,\n    listDirectoryTool,\n    searchFilesTool,\n    // Advanced editing tools\n    replaceInFileTool,\n    insertAtLineTool,\n    deleteLinesTool,\n    replaceBlockTool,\n    replaceLineRangeTool,\n    readLinesTool,\n    // File management\n    getFileInfoTool,\n    createDirectoryTool,\n    copyFileTool,\n    moveFileTool,\n    // Project tools\n    getProjectStructureTool,\n    executeCommandTool,\n    // Vector search tools\n    searchSimilarCodeTool,\n    getProjectContextTool\n];\n// Helper function to wrap tool execution with logging\nfunction wrapToolWithLogging(toolFn, toolName) {\n    return async (...args)=>{\n        const input = args[0] || {};\n        const callId = _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__.toolLogger.startCall(toolName, input);\n        try {\n            // Support multiple tool shapes returned by `tool()` or custom wrappers.\n            // Common possibilities:\n            // - a plain function: toolFn(argsObj)\n            // - an object with .call(argsObj)\n            // - an object with .invoke(argsObj)\n            // - an object with .run(argsObj)\n            let result;\n            if (typeof toolFn === \"function\") {\n                result = await toolFn(input);\n            } else if (toolFn && typeof toolFn.call === \"function\") {\n                result = await toolFn.call(input);\n            } else if (toolFn && typeof toolFn.invoke === \"function\") {\n                result = await toolFn.invoke(input);\n            } else if (toolFn && typeof toolFn.run === \"function\") {\n                result = await toolFn.run(input);\n            } else if (toolFn && typeof toolFn.execute === \"function\") {\n                result = await toolFn.execute(input);\n            } else {\n                throw new Error(\"Tool is not callable\");\n            }\n            _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__.toolLogger.endCall(callId, result, true);\n            return result;\n        } catch (error) {\n            const errorMsg = error?.message || String(error);\n            _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__.toolLogger.endCall(callId, errorMsg, false, errorMsg);\n            throw error;\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDUCxRQUFRdEksUUFBUTtZQUNuQyxPQUFPQTtRQUNULEVBQUUsT0FBT0ksT0FBWTtZQUNuQixNQUFNMEksV0FBVzFJLE9BQU9nQyxXQUFXMkcsT0FBTzNJO1lBQzFDZiwwREFBVUEsQ0FBQ3dKLE9BQU8sQ0FBQ1AsUUFBUVEsVUFBVSxPQUFPQTtZQUM1QyxNQUFNMUk7UUFDUjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi9hZ2VudHMvdG9vbHMudHM/MjA0MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0b29sIH0gZnJvbSAnQGxhbmdjaGFpbi9jb3JlL3Rvb2xzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7XG4gIHJlYWRGaWxlLFxuICB3cml0ZUZpbGUsXG4gIGFwcGVuZFRvRmlsZSxcbiAgZGVsZXRlRmlsZSxcbiAgbGlzdERpcmVjdG9yeSxcbiAgc2VhcmNoRmlsZXMsXG4gIEZpbGVSZWFkU2NoZW1hLFxuICBGaWxlV3JpdGVTY2hlbWEsXG4gIEZpbGVBcHBlbmRTY2hlbWEsXG4gIEZpbGVEZWxldGVTY2hlbWEsXG4gIERpcmVjdG9yeUxpc3RTY2hlbWEsXG4gIEZpbGVTZWFyY2hTY2hlbWFcbn0gZnJvbSAnLi4vdXRpbHMvZmlsZW9wcyc7XG5pbXBvcnQgeyBnZXRNZW1vcnksIGdldFByb2plY3RGb2xkZXIgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IHRvb2xMb2dnZXIgfSBmcm9tICcuLi91dGlscy90b29sLWxvZ2dlcic7XG5pbXBvcnQgeyBzZWFyY2hTaW1pbGFyQ29kZSwgZ2V0UHJvamVjdENvbnRleHQgfSBmcm9tICcuLi91dGlscy92ZWN0b3ItdG9vbHMnO1xuXG4vLyBGaWxlIG9wZXJhdGlvbiB0b29sc1xuZXhwb3J0IGNvbnN0IHJlYWRGaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGggfSkgPT4ge1xuICAvLyBSZXNvbHZlIHBhdGggcmVsYXRpdmUgdG8gcHJvamVjdCBmb2xkZXJcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OWIFJlYWRpbmcgZmlsZTogJHtmdWxsUGF0aH1gKTtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVhZEZpbGUoZnVsbFBhdGgpO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ3JlYWQnLCBmdWxsUGF0aCk7XG4gICAgcmV0dXJuIGBGaWxlIGNvbnRlbnQ6XFxuJHtyZXN1bHQuY29udGVudH1gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBgRXJyb3IgcmVhZGluZyBmaWxlOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdyZWFkX2ZpbGUnLFxuICBkZXNjcmlwdGlvbjogJ1JlYWQgdGhlIGNvbnRlbnRzIG9mIGEgZmlsZS4gVXNlIHRoaXMgdG8gZXhhbWluZSBleGlzdGluZyBjb2RlIG9yIGRvY3VtZW50cy4nLFxuICBzY2hlbWE6IEZpbGVSZWFkU2NoZW1hLFxufSk7XG5cbmV4cG9ydCBjb25zdCB3cml0ZUZpbGVUb29sID0gdG9vbChhc3luYyAoeyBmaWxlUGF0aCwgY29udGVudCB9KSA9PiB7XG4gIC8vIFJlc29sdmUgcGF0aCByZWxhdGl2ZSB0byBwcm9qZWN0IGZvbGRlclxuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk50gV3JpdGluZyBmaWxlOiAke2Z1bGxQYXRofWApO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIGNvbnRlbnQpO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIGNvbnN0IGV4aXN0cyA9IGZzLmV4aXN0c1N5bmMoZnVsbFBhdGgpO1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oZXhpc3RzID8gJ21vZGlmaWVkJyA6ICdjcmVhdGVkJywgZnVsbFBhdGgpO1xuICAgIHJldHVybiBgRmlsZSB3cml0dGVuIHN1Y2Nlc3NmdWxseTogJHtmdWxsUGF0aH1gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBgRXJyb3Igd3JpdGluZyBmaWxlOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICd3cml0ZV9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdDcmVhdGUgb3Igb3ZlcndyaXRlIGEgZmlsZSB3aXRoIGNvbnRlbnQuIFVzZSB0aGlzIHRvIGNyZWF0ZSBuZXcgZmlsZXMgb3IgY29tcGxldGVseSByZXBsYWNlIGV4aXN0aW5nIG9uZXMuJyxcbiAgc2NoZW1hOiBGaWxlV3JpdGVTY2hlbWEsXG59KTtcblxuZXhwb3J0IGNvbnN0IGFwcGVuZFRvRmlsZVRvb2wgPSB0b29sKGFzeW5jICh7IGZpbGVQYXRoLCBjb250ZW50IH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OOIEFwcGVuZGluZyB0byBmaWxlOiAke2Z1bGxQYXRofWApO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcHBlbmRUb0ZpbGUoZnVsbFBhdGgsIGNvbnRlbnQpO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ21vZGlmaWVkJywgZnVsbFBhdGgpO1xuICAgIHJldHVybiBgQ29udGVudCBhcHBlbmRlZCBzdWNjZXNzZnVsbHkgdG86ICR7ZnVsbFBhdGh9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYEVycm9yIGFwcGVuZGluZyB0byBmaWxlOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdhcHBlbmRfdG9fZmlsZScsXG4gIGRlc2NyaXB0aW9uOiAnQXBwZW5kIGNvbnRlbnQgdG8gdGhlIGVuZCBvZiBhbiBleGlzdGluZyBmaWxlLiBVc2UgdGhpcyB0byBhZGQgdG8gZXhpc3RpbmcgZmlsZXMuJyxcbiAgc2NoZW1hOiBGaWxlQXBwZW5kU2NoZW1hLFxufSk7XG5cbmV4cG9ydCBjb25zdCBkZWxldGVGaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGggfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfl5HvuI8gRGVsZXRpbmcgZmlsZTogJHtmdWxsUGF0aH1gKTtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGVsZXRlRmlsZShmdWxsUGF0aCk7XG5cbiAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignZGVsZXRlZCcsIGZ1bGxQYXRoKTtcbiAgICByZXR1cm4gYEZpbGUgZGVsZXRlZCBzdWNjZXNzZnVsbHk6ICR7ZnVsbFBhdGh9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYEVycm9yIGRlbGV0aW5nIGZpbGU6ICR7cmVzdWx0LmVycm9yfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2RlbGV0ZV9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdEZWxldGUgYSBmaWxlLiBPbmx5IHdvcmtzIG9uIGZpbGVzIGluIHRoZSBnZW5lcmF0ZWQgZGlyZWN0b3J5IGZvciBzZWN1cml0eS4nLFxuICBzY2hlbWE6IEZpbGVEZWxldGVTY2hlbWEsXG59KTtcblxuZXhwb3J0IGNvbnN0IGxpc3REaXJlY3RvcnlUb29sID0gdG9vbChhc3luYyAoeyBkaXJQYXRoIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZGlyUGF0aCkgPyBkaXJQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGRpclBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OCIExpc3RpbmcgZGlyZWN0b3J5OiAke2Z1bGxQYXRofWApO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBsaXN0RGlyZWN0b3J5KGZ1bGxQYXRoKTtcblxuICBpZiAocmVzdWx0LnN1Y2Nlc3MgJiYgcmVzdWx0LmZpbGVzKSB7XG4gICAgcmV0dXJuIGBEaXJlY3RvcnkgY29udGVudHM6XFxuJHtyZXN1bHQuZmlsZXMuam9pbignXFxuJyl9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYEVycm9yIGxpc3RpbmcgZGlyZWN0b3J5OiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdsaXN0X2RpcmVjdG9yeScsXG4gIGRlc2NyaXB0aW9uOiAnTGlzdCB0aGUgY29udGVudHMgb2YgYSBkaXJlY3RvcnkuIFVzZSB0aGlzIHRvIHNlZSB3aGF0IGZpbGVzIGFyZSBhdmFpbGFibGUuJyxcbiAgc2NoZW1hOiBEaXJlY3RvcnlMaXN0U2NoZW1hLFxufSk7XG5cbmV4cG9ydCBjb25zdCBzZWFyY2hGaWxlc1Rvb2wgPSB0b29sKGFzeW5jICh7IGRpclBhdGgsIHBhdHRlcm4gfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShkaXJQYXRoKSA/IGRpclBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZGlyUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCflI0gU2VhcmNoaW5nIGZpbGVzIGluICR7ZnVsbFBhdGh9IGZvciBwYXR0ZXJuOiAke3BhdHRlcm59YCk7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlYXJjaEZpbGVzKGZ1bGxQYXRoLCBwYXR0ZXJuKTtcblxuICBpZiAocmVzdWx0LnN1Y2Nlc3MgJiYgcmVzdWx0Lm1hdGNoZXMpIHtcbiAgICBjb25zdCBtYXRjaGVzVGV4dCA9IHJlc3VsdC5tYXRjaGVzXG4gICAgICAuc2xpY2UoMCwgMjApIC8vIExpbWl0IHRvIGZpcnN0IDIwIG1hdGNoZXNcbiAgICAgIC5tYXAobWF0Y2ggPT4gYCR7bWF0Y2guZmlsZX06JHttYXRjaC5saW5lfSAtICR7bWF0Y2guY29udGVudH1gKVxuICAgICAgLmpvaW4oJ1xcbicpO1xuXG4gICAgcmV0dXJuIGAke3Jlc3VsdC5tYXRjaGVzLmxlbmd0aH0gbWF0Y2hlcyBmb3VuZDpcXG4ke21hdGNoZXNUZXh0fSR7cmVzdWx0Lm1hdGNoZXMubGVuZ3RoID4gMjAgPyAnXFxuLi4uIChzaG93aW5nIGZpcnN0IDIwKScgOiAnJ31gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBgRXJyb3Igc2VhcmNoaW5nIGZpbGVzOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdzZWFyY2hfZmlsZXMnLFxuICBkZXNjcmlwdGlvbjogJ1NlYXJjaCBmb3IgZmlsZXMgY29udGFpbmluZyBhIHJlZ2V4IHBhdHRlcm4uIFVzZSB0aGlzIHRvIGZpbmQgc3BlY2lmaWMgY29kZSBwYXR0ZXJucyBvciB0ZXh0LicsXG4gIHNjaGVtYTogRmlsZVNlYXJjaFNjaGVtYSxcbn0pO1xuXG4vLyBBZHZhbmNlZCBjb2RlIGVkaXRpbmcgdG9vbHNcbmV4cG9ydCBjb25zdCByZXBsYWNlSW5GaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIHNlYXJjaFRleHQsIHJlcGxhY2VUZXh0IH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDinI/vuI8gUmVwbGFjaW5nIHRleHQgaW4gZmlsZTogJHtmdWxsUGF0aH1gKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlYWRSZXN1bHQgPSBhd2FpdCByZWFkRmlsZShmdWxsUGF0aCk7XG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gcmVhZFJlc3VsdC5jb250ZW50O1xuICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBvcmlnaW5hbENvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKHNlYXJjaFRleHQsICdnJyksIHJlcGxhY2VUZXh0KTtcbiAgICBjb25zdCByZXBsYWNlbWVudENvdW50ID0gKG9yaWdpbmFsQ29udGVudC5tYXRjaChuZXcgUmVnRXhwKHNlYXJjaFRleHQsICdnJykpIHx8IFtdKS5sZW5ndGg7XG5cbiAgICBpZiAocmVwbGFjZW1lbnRDb3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGBObyBtYXRjaGVzIGZvdW5kIGZvciBcIiR7c2VhcmNoVGV4dH1cIiBpbiAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0NvbnRlbnQpO1xuICAgIGlmICh3cml0ZVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdtb2RpZmllZCcsIGZ1bGxQYXRoKTtcbiAgICAgIHJldHVybiBgUmVwbGFjZWQgJHtyZXBsYWNlbWVudENvdW50fSBvY2N1cnJlbmNlKHMpIG9mIFwiJHtzZWFyY2hUZXh0fVwiIHdpdGggXCIke3JlcGxhY2VUZXh0fVwiIGluICR7ZnVsbFBhdGh9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGBFcnJvciB3cml0aW5nIGZpbGU6ICR7d3JpdGVSZXN1bHQuZXJyb3J9YDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAncmVwbGFjZV9pbl9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdGaW5kIGFuZCByZXBsYWNlIHRleHQgaW4gYSBmaWxlIHVzaW5nIHJlZ2V4LiBVc2UgdGhpcyBmb3IgcmVmYWN0b3Jpbmcgb3IgZml4aW5nIGNvZGUgcGF0dGVybnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgICBzZWFyY2hUZXh0OiB6LnN0cmluZygpLmRlc2NyaWJlKCdUZXh0IG9yIHJlZ2V4IHBhdHRlcm4gdG8gc2VhcmNoIGZvcicpLFxuICAgIHJlcGxhY2VUZXh0OiB6LnN0cmluZygpLmRlc2NyaWJlKCdUZXh0IHRvIHJlcGxhY2Ugd2l0aCcpLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0QXRMaW5lVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIGxpbmVOdW1iZXIsIGNvbnRlbnQgfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk40gSW5zZXJ0aW5nIGF0IGxpbmUgJHtsaW5lTnVtYmVyfSBpbjogJHtmdWxsUGF0aH1gKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlYWRSZXN1bHQgPSBhd2FpdCByZWFkRmlsZShmdWxsUGF0aCk7XG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSByZWFkUmVzdWx0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGlmIChsaW5lTnVtYmVyIDwgMSB8fCBsaW5lTnVtYmVyID4gbGluZXMubGVuZ3RoICsgMSkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogTGluZSBudW1iZXIgJHtsaW5lTnVtYmVyfSBpcyBvdXQgb2YgcmFuZ2UgKGZpbGUgaGFzICR7bGluZXMubGVuZ3RofSBsaW5lcylgO1xuICAgIH1cblxuICAgIGxpbmVzLnNwbGljZShsaW5lTnVtYmVyIC0gMSwgMCwgY29udGVudCk7XG4gICAgY29uc3QgbmV3Q29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0NvbnRlbnQpO1xuICAgIGlmICh3cml0ZVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdtb2RpZmllZCcsIGZ1bGxQYXRoKTtcbiAgICAgIHJldHVybiBgSW5zZXJ0ZWQgY29udGVudCBhdCBsaW5lICR7bGluZU51bWJlcn0gaW4gJHtmdWxsUGF0aH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYEVycm9yIHdyaXRpbmcgZmlsZTogJHt3cml0ZVJlc3VsdC5lcnJvcn1gO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdpbnNlcnRfYXRfbGluZScsXG4gIGRlc2NyaXB0aW9uOiAnSW5zZXJ0IGNvbnRlbnQgYXQgYSBzcGVjaWZpYyBsaW5lIG51bWJlciBpbiBhIGZpbGUuIFVzZSB0aGlzIGZvciBwcmVjaXNlIGNvZGUgYWRkaXRpb25zLicsXG4gIHNjaGVtYTogei5vYmplY3Qoe1xuICAgIGZpbGVQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBmaWxlJyksXG4gICAgbGluZU51bWJlcjogei5udW1iZXIoKS5kZXNjcmliZSgnTGluZSBudW1iZXIgd2hlcmUgY29udGVudCBzaG91bGQgYmUgaW5zZXJ0ZWQgKDEtYmFzZWQpJyksXG4gICAgY29udGVudDogei5zdHJpbmcoKS5kZXNjcmliZSgnQ29udGVudCB0byBpbnNlcnQnKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUxpbmVzVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIHN0YXJ0TGluZSwgZW5kTGluZSB9KSA9PiB7XG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG4gIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5pc0Fic29sdXRlKGZpbGVQYXRoKSA/IGZpbGVQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVQYXRoKTtcblxuICBjb25zb2xlLmxvZyhg4pyC77iPIERlbGV0aW5nIGxpbmVzICR7c3RhcnRMaW5lfS0ke2VuZExpbmV9IGluOiAke2Z1bGxQYXRofWApO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVhZFJlc3VsdCA9IGF3YWl0IHJlYWRGaWxlKGZ1bGxQYXRoKTtcbiAgICBpZiAoIXJlYWRSZXN1bHQuc3VjY2VzcyB8fCAhcmVhZFJlc3VsdC5jb250ZW50KSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBDb3VsZCBub3QgcmVhZCBmaWxlICR7ZnVsbFBhdGh9YDtcbiAgICB9XG5cbiAgICBjb25zdCBsaW5lcyA9IHJlYWRSZXN1bHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgaWYgKHN0YXJ0TGluZSA8IDEgfHwgZW5kTGluZSA+IGxpbmVzLmxlbmd0aCB8fCBzdGFydExpbmUgPiBlbmRMaW5lKSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBJbnZhbGlkIGxpbmUgcmFuZ2UgJHtzdGFydExpbmV9LSR7ZW5kTGluZX0gKGZpbGUgaGFzICR7bGluZXMubGVuZ3RofSBsaW5lcylgO1xuICAgIH1cblxuICAgIGxpbmVzLnNwbGljZShzdGFydExpbmUgLSAxLCBlbmRMaW5lIC0gc3RhcnRMaW5lICsgMSk7XG4gICAgY29uc3QgbmV3Q29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0NvbnRlbnQpO1xuICAgIGlmICh3cml0ZVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdtb2RpZmllZCcsIGZ1bGxQYXRoKTtcbiAgICAgIHJldHVybiBgRGVsZXRlZCBsaW5lcyAke3N0YXJ0TGluZX0tJHtlbmRMaW5lfSBpbiAke2Z1bGxQYXRofWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgRXJyb3Igd3JpdGluZyBmaWxlOiAke3dyaXRlUmVzdWx0LmVycm9yfWA7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2RlbGV0ZV9saW5lcycsXG4gIGRlc2NyaXB0aW9uOiAnRGVsZXRlIGEgcmFuZ2Ugb2YgbGluZXMgZnJvbSBhIGZpbGUuIFVzZSB0aGlzIHRvIHJlbW92ZSBjb2RlIGJsb2Nrcy4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBmaWxlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB0byB0aGUgZmlsZScpLFxuICAgIHN0YXJ0TGluZTogei5udW1iZXIoKS5kZXNjcmliZSgnU3RhcnRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgICBlbmRMaW5lOiB6Lm51bWJlcigpLmRlc2NyaWJlKCdFbmRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IHJlcGxhY2VCbG9ja1Rvb2wgPSB0b29sKGFzeW5jICh7IGZpbGVQYXRoLCBzdGFydE1hcmtlciwgZW5kTWFya2VyLCBuZXdDb250ZW50IH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5SEIFJlcGxhY2luZyBibG9jayBpbjogJHtmdWxsUGF0aH1gKTtcbiAgY29uc29sZS5sb2coYCAgIFN0YXJ0IG1hcmtlcjogJHtzdGFydE1hcmtlcn1gKTtcbiAgY29uc29sZS5sb2coYCAgIEVuZCBtYXJrZXI6ICR7ZW5kTWFya2VyfWApO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVhZFJlc3VsdCA9IGF3YWl0IHJlYWRGaWxlKGZ1bGxQYXRoKTtcbiAgICBpZiAoIXJlYWRSZXN1bHQuc3VjY2VzcyB8fCAhcmVhZFJlc3VsdC5jb250ZW50KSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBDb3VsZCBub3QgcmVhZCBmaWxlICR7ZnVsbFBhdGh9YDtcbiAgICB9XG5cbiAgICBjb25zdCBjb250ZW50ID0gcmVhZFJlc3VsdC5jb250ZW50O1xuXG4gICAgLy8gRmluZCBzdGFydCBhbmQgZW5kIHBvc2l0aW9uc1xuICAgIGNvbnN0IHN0YXJ0SWR4ID0gY29udGVudC5pbmRleE9mKHN0YXJ0TWFya2VyKTtcbiAgICBpZiAoc3RhcnRJZHggPT09IC0xKSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBTdGFydCBtYXJrZXIgXCIke3N0YXJ0TWFya2VyfVwiIG5vdCBmb3VuZCBpbiAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgZW5kSWR4ID0gY29udGVudC5pbmRleE9mKGVuZE1hcmtlciwgc3RhcnRJZHggKyBzdGFydE1hcmtlci5sZW5ndGgpO1xuICAgIGlmIChlbmRJZHggPT09IC0xKSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBFbmQgbWFya2VyIFwiJHtlbmRNYXJrZXJ9XCIgbm90IGZvdW5kIGFmdGVyIHN0YXJ0IG1hcmtlciBpbiAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgLy8gUmVwbGFjZSB0aGUgYmxvY2sgKGluY2x1ZGluZyBtYXJrZXJzKVxuICAgIGNvbnN0IGJlZm9yZSA9IGNvbnRlbnQuc3Vic3RyaW5nKDAsIHN0YXJ0SWR4KTtcbiAgICBjb25zdCBhZnRlciA9IGNvbnRlbnQuc3Vic3RyaW5nKGVuZElkeCArIGVuZE1hcmtlci5sZW5ndGgpO1xuICAgIGNvbnN0IG5ld0ZpbGVDb250ZW50ID0gYmVmb3JlICsgc3RhcnRNYXJrZXIgKyAnXFxuJyArIG5ld0NvbnRlbnQgKyAnXFxuJyArIGVuZE1hcmtlciArIGFmdGVyO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0ZpbGVDb250ZW50KTtcbiAgICBpZiAod3JpdGVSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignbW9kaWZpZWQnLCBmdWxsUGF0aCk7XG4gICAgICBjb25zdCBvbGRCbG9jayA9IGNvbnRlbnQuc3Vic3RyaW5nKHN0YXJ0SWR4LCBlbmRJZHggKyBlbmRNYXJrZXIubGVuZ3RoKTtcbiAgICAgIHJldHVybiBgU3VjY2Vzc2Z1bGx5IHJlcGxhY2VkIGJsb2NrIGluICR7ZnVsbFBhdGh9XFxuT2xkIGJsb2NrICgke29sZEJsb2NrLnNwbGl0KCdcXG4nKS5sZW5ndGh9IGxpbmVzKSDihpIgTmV3IGJsb2NrICgke25ld0NvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aH0gbGluZXMpYDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGBFcnJvciB3cml0aW5nIGZpbGU6ICR7d3JpdGVSZXN1bHQuZXJyb3J9YDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAncmVwbGFjZV9ibG9jaycsXG4gIGRlc2NyaXB0aW9uOiAnUmVwbGFjZSBhIGJsb2NrIG9mIGNvZGUgYmV0d2VlbiB0d28gbWFya2Vycy4gTW9yZSBlZmZpY2llbnQgdGhhbiByZXdyaXRpbmcgZW50aXJlIGZpbGUuIFBlcmZlY3QgZm9yIHVwZGF0aW5nIGZ1bmN0aW9ucywgY2xhc3Nlcywgb3Igc2VjdGlvbnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgICBzdGFydE1hcmtlcjogei5zdHJpbmcoKS5kZXNjcmliZSgnVW5pcXVlIHRleHQgdGhhdCBtYXJrcyB0aGUgc3RhcnQgb2YgdGhlIGJsb2NrIChlLmcuLCBcImZ1bmN0aW9uIG15RnVuYyhcIiBvciBcIi8vIFNUQVJUIFNFQ1RJT05cIiknKSxcbiAgICBlbmRNYXJrZXI6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1VuaXF1ZSB0ZXh0IHRoYXQgbWFya3MgdGhlIGVuZCBvZiB0aGUgYmxvY2sgKGUuZy4sIFwifVwiIG9yIFwiLy8gRU5EIFNFQ1RJT05cIiknKSxcbiAgICBuZXdDb250ZW50OiB6LnN0cmluZygpLmRlc2NyaWJlKCdOZXcgY29udGVudCB0byByZXBsYWNlIHRoZSBibG9jayBiZXR3ZWVuIG1hcmtlcnMgKG1hcmtlcnMgd2lsbCBiZSBwcmVzZXJ2ZWQpJyksXG4gIH0pLFxufSk7XG5cbmV4cG9ydCBjb25zdCByZXBsYWNlTGluZVJhbmdlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIHN0YXJ0TGluZSwgZW5kTGluZSwgbmV3Q29udGVudCB9KSA9PiB7XG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG4gIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5pc0Fic29sdXRlKGZpbGVQYXRoKSA/IGZpbGVQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVQYXRoKTtcblxuICBjb25zb2xlLmxvZyhg8J+TnSBSZXBsYWNpbmcgbGluZXMgJHtzdGFydExpbmV9LSR7ZW5kTGluZX0gaW46ICR7ZnVsbFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZWFkUmVzdWx0ID0gYXdhaXQgcmVhZEZpbGUoZnVsbFBhdGgpO1xuICAgIGlmICghcmVhZFJlc3VsdC5zdWNjZXNzIHx8ICFyZWFkUmVzdWx0LmNvbnRlbnQpIHtcbiAgICAgIHJldHVybiBgRXJyb3I6IENvdWxkIG5vdCByZWFkIGZpbGUgJHtmdWxsUGF0aH1gO1xuICAgIH1cblxuICAgIGNvbnN0IGxpbmVzID0gcmVhZFJlc3VsdC5jb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBpZiAoc3RhcnRMaW5lIDwgMSB8fCBlbmRMaW5lID4gbGluZXMubGVuZ3RoIHx8IHN0YXJ0TGluZSA+IGVuZExpbmUpIHtcbiAgICAgIHJldHVybiBgRXJyb3I6IEludmFsaWQgbGluZSByYW5nZSAke3N0YXJ0TGluZX0tJHtlbmRMaW5lfSAoZmlsZSBoYXMgJHtsaW5lcy5sZW5ndGh9IGxpbmVzKWA7XG4gICAgfVxuXG4gICAgLy8gUmVwbGFjZSB0aGUgbGluZSByYW5nZVxuICAgIGNvbnN0IGJlZm9yZSA9IGxpbmVzLnNsaWNlKDAsIHN0YXJ0TGluZSAtIDEpO1xuICAgIGNvbnN0IGFmdGVyID0gbGluZXMuc2xpY2UoZW5kTGluZSk7XG4gICAgY29uc3QgbmV3TGluZXMgPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBuZXdGaWxlTGluZXMgPSBbLi4uYmVmb3JlLCAuLi5uZXdMaW5lcywgLi4uYWZ0ZXJdO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0ZpbGVMaW5lcy5qb2luKCdcXG4nKSk7XG4gICAgaWYgKHdyaXRlUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ21vZGlmaWVkJywgZnVsbFBhdGgpO1xuICAgICAgY29uc3Qgb2xkTGluZUNvdW50ID0gZW5kTGluZSAtIHN0YXJ0TGluZSArIDE7XG4gICAgICBjb25zdCBuZXdMaW5lQ291bnQgPSBuZXdMaW5lcy5sZW5ndGg7XG4gICAgICByZXR1cm4gYFJlcGxhY2VkIGxpbmVzICR7c3RhcnRMaW5lfS0ke2VuZExpbmV9ICgke29sZExpbmVDb3VudH0gbGluZXMpIHdpdGggbmV3IGNvbnRlbnQgKCR7bmV3TGluZUNvdW50fSBsaW5lcykgaW4gJHtmdWxsUGF0aH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYEVycm9yIHdyaXRpbmcgZmlsZTogJHt3cml0ZVJlc3VsdC5lcnJvcn1gO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdyZXBsYWNlX2xpbmVfcmFuZ2UnLFxuICBkZXNjcmlwdGlvbjogJ1JlcGxhY2UgYSBzcGVjaWZpYyByYW5nZSBvZiBsaW5lcyB3aXRoIG5ldyBjb250ZW50LiBNb3JlIHByZWNpc2UgdGhhbiByZXBsYWNlX2Jsb2NrLiBVc2Ugd2hlbiB5b3Uga25vdyBleGFjdCBsaW5lIG51bWJlcnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgICBzdGFydExpbmU6IHoubnVtYmVyKCkuZGVzY3JpYmUoJ1N0YXJ0aW5nIGxpbmUgbnVtYmVyICgxLWJhc2VkLCBpbmNsdXNpdmUpJyksXG4gICAgZW5kTGluZTogei5udW1iZXIoKS5kZXNjcmliZSgnRW5kaW5nIGxpbmUgbnVtYmVyICgxLWJhc2VkLCBpbmNsdXNpdmUpJyksXG4gICAgbmV3Q29udGVudDogei5zdHJpbmcoKS5kZXNjcmliZSgnTmV3IGNvbnRlbnQgdG8gcmVwbGFjZSB0aGUgc3BlY2lmaWVkIGxpbmVzJyksXG4gIH0pLFxufSk7XG5cbmV4cG9ydCBjb25zdCBnZXRGaWxlSW5mb1Rvb2wgPSB0b29sKGFzeW5jICh7IGZpbGVQYXRoIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDihLnvuI8gR2V0dGluZyBmaWxlIGluZm86ICR7ZnVsbFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzdGF0cyA9IGZzLnN0YXRTeW5jKGZ1bGxQYXRoKTtcbiAgICBjb25zdCByZWFkUmVzdWx0ID0gYXdhaXQgcmVhZEZpbGUoZnVsbFBhdGgpO1xuXG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSByZWFkUmVzdWx0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGV4dGVuc2lvbiA9IHBhdGguZXh0bmFtZShmdWxsUGF0aCk7XG5cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcGF0aDogZnVsbFBhdGgsXG4gICAgICBzaXplOiBzdGF0cy5zaXplLFxuICAgICAgbGluZXM6IGxpbmVzLmxlbmd0aCxcbiAgICAgIGV4dGVuc2lvbixcbiAgICAgIGNyZWF0ZWQ6IHN0YXRzLmJpcnRodGltZSxcbiAgICAgIG1vZGlmaWVkOiBzdGF0cy5tdGltZSxcbiAgICAgIGlzRGlyZWN0b3J5OiBzdGF0cy5pc0RpcmVjdG9yeSgpLFxuICAgIH0sIG51bGwsIDIpO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2dldF9maWxlX2luZm8nLFxuICBkZXNjcmlwdGlvbjogJ0dldCBkZXRhaWxlZCBpbmZvcm1hdGlvbiBhYm91dCBhIGZpbGUgKHNpemUsIGxpbmVzLCBkYXRlcywgZXRjLikuIFVzZSB0aGlzIHRvIHVuZGVyc3RhbmQgZmlsZSBzdHJ1Y3R1cmUuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZURpcmVjdG9yeVRvb2wgPSB0b29sKGFzeW5jICh7IGRpclBhdGggfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShkaXJQYXRoKSA/IGRpclBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZGlyUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk4EgQ3JlYXRpbmcgZGlyZWN0b3J5OiAke2Z1bGxQYXRofWApO1xuXG4gIHRyeSB7XG4gICAgZnMubWtkaXJTeW5jKGZ1bGxQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdjcmVhdGVkJywgZnVsbFBhdGgpO1xuICAgIHJldHVybiBgRGlyZWN0b3J5IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5OiAke2Z1bGxQYXRofWA7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yIGNyZWF0aW5nIGRpcmVjdG9yeTogJHtlcnJvci5tZXNzYWdlfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2NyZWF0ZV9kaXJlY3RvcnknLFxuICBkZXNjcmlwdGlvbjogJ0NyZWF0ZSBhIG5ldyBkaXJlY3RvcnkgKGluY2x1ZGluZyBwYXJlbnQgZGlyZWN0b3JpZXMgaWYgbmVlZGVkKS4gVXNlIHRoaXMgdG8gb3JnYW5pemUgcHJvamVjdCBzdHJ1Y3R1cmUuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZGlyUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB0byB0aGUgZGlyZWN0b3J5IHRvIGNyZWF0ZScpLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgY29uc3QgY29weUZpbGVUb29sID0gdG9vbChhc3luYyAoeyBzb3VyY2VQYXRoLCBkZXN0aW5hdGlvblBhdGggfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsU291cmNlUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShzb3VyY2VQYXRoKSA/IHNvdXJjZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgc291cmNlUGF0aCk7XG4gIGNvbnN0IGZ1bGxEZXN0UGF0aCA9IHBhdGguaXNBYnNvbHV0ZShkZXN0aW5hdGlvblBhdGgpID8gZGVzdGluYXRpb25QYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGRlc3RpbmF0aW9uUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk4sgQ29weWluZyBmaWxlIGZyb20gJHtmdWxsU291cmNlUGF0aH0gdG8gJHtmdWxsRGVzdFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBmcy5jb3B5RmlsZVN5bmMoZnVsbFNvdXJjZVBhdGgsIGZ1bGxEZXN0UGF0aCk7XG4gICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignY3JlYXRlZCcsIGZ1bGxEZXN0UGF0aCk7XG4gICAgcmV0dXJuIGBGaWxlIGNvcGllZCBzdWNjZXNzZnVsbHkgZnJvbSAke2Z1bGxTb3VyY2VQYXRofSB0byAke2Z1bGxEZXN0UGF0aH1gO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBFcnJvciBjb3B5aW5nIGZpbGU6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdjb3B5X2ZpbGUnLFxuICBkZXNjcmlwdGlvbjogJ0NvcHkgYSBmaWxlIHRvIGEgbmV3IGxvY2F0aW9uLiBVc2UgdGhpcyB0byBkdXBsaWNhdGUgZmlsZXMgb3IgY3JlYXRlIHRlbXBsYXRlcy4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBzb3VyY2VQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdTb3VyY2UgZmlsZSBwYXRoJyksXG4gICAgZGVzdGluYXRpb25QYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdEZXN0aW5hdGlvbiBmaWxlIHBhdGgnKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IG1vdmVGaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgc291cmNlUGF0aCwgZGVzdGluYXRpb25QYXRoIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFNvdXJjZVBhdGggPSBwYXRoLmlzQWJzb2x1dGUoc291cmNlUGF0aCkgPyBzb3VyY2VQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIHNvdXJjZVBhdGgpO1xuICBjb25zdCBmdWxsRGVzdFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZGVzdGluYXRpb25QYXRoKSA/IGRlc3RpbmF0aW9uUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBkZXN0aW5hdGlvblBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5qaIE1vdmluZyBmaWxlIGZyb20gJHtmdWxsU291cmNlUGF0aH0gdG8gJHtmdWxsRGVzdFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBmcy5yZW5hbWVTeW5jKGZ1bGxTb3VyY2VQYXRoLCBmdWxsRGVzdFBhdGgpO1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ2RlbGV0ZWQnLCBmdWxsU291cmNlUGF0aCk7XG4gICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignY3JlYXRlZCcsIGZ1bGxEZXN0UGF0aCk7XG4gICAgcmV0dXJuIGBGaWxlIG1vdmVkIHN1Y2Nlc3NmdWxseSBmcm9tICR7ZnVsbFNvdXJjZVBhdGh9IHRvICR7ZnVsbERlc3RQYXRofWA7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yIG1vdmluZyBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAnbW92ZV9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdNb3ZlIG9yIHJlbmFtZSBhIGZpbGUuIFVzZSB0aGlzIHRvIHJlb3JnYW5pemUgcHJvamVjdCBzdHJ1Y3R1cmUuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgc291cmNlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnU291cmNlIGZpbGUgcGF0aCcpLFxuICAgIGRlc3RpbmF0aW9uUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnRGVzdGluYXRpb24gZmlsZSBwYXRoJyksXG4gIH0pLFxufSk7XG5cbmV4cG9ydCBjb25zdCByZWFkTGluZXNUb29sID0gdG9vbChhc3luYyAoeyBmaWxlUGF0aCwgc3RhcnRMaW5lLCBlbmRMaW5lIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OWIFJlYWRpbmcgbGluZXMgJHtzdGFydExpbmV9LSR7ZW5kTGluZX0gZnJvbTogJHtmdWxsUGF0aH1gKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlYWRSZXN1bHQgPSBhd2FpdCByZWFkRmlsZShmdWxsUGF0aCk7XG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSByZWFkUmVzdWx0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGlmIChzdGFydExpbmUgPCAxIHx8IGVuZExpbmUgPiBsaW5lcy5sZW5ndGggfHwgc3RhcnRMaW5lID4gZW5kTGluZSkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogSW52YWxpZCBsaW5lIHJhbmdlICR7c3RhcnRMaW5lfS0ke2VuZExpbmV9IChmaWxlIGhhcyAke2xpbmVzLmxlbmd0aH0gbGluZXMpYDtcbiAgICB9XG5cbiAgICBjb25zdCBzZWxlY3RlZExpbmVzID0gbGluZXMuc2xpY2Uoc3RhcnRMaW5lIC0gMSwgZW5kTGluZSk7XG4gICAgcmV0dXJuIGBMaW5lcyAke3N0YXJ0TGluZX0tJHtlbmRMaW5lfSBvZiAke2Z1bGxQYXRofTpcXG4ke3NlbGVjdGVkTGluZXMuam9pbignXFxuJyl9YDtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdyZWFkX2xpbmVzJyxcbiAgZGVzY3JpcHRpb246ICdSZWFkIGEgc3BlY2lmaWMgcmFuZ2Ugb2YgbGluZXMgZnJvbSBhIGZpbGUuIFVzZSB0aGlzIHRvIGV4YW1pbmUgc3BlY2lmaWMgY29kZSBzZWN0aW9ucy4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBmaWxlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB0byB0aGUgZmlsZScpLFxuICAgIHN0YXJ0TGluZTogei5udW1iZXIoKS5kZXNjcmliZSgnU3RhcnRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgICBlbmRMaW5lOiB6Lm51bWJlcigpLmRlc2NyaWJlKCdFbmRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGdldFByb2plY3RTdHJ1Y3R1cmVUb29sID0gdG9vbChhc3luYyAoeyBtYXhEZXB0aCB9KSA9PiB7XG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG5cbiAgY29uc29sZS5sb2coYPCfl4LvuI8gR2V0dGluZyBwcm9qZWN0IHN0cnVjdHVyZSBmcm9tOiAke3Byb2plY3RGb2xkZXJ9YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzdHJ1Y3R1cmU6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdCB0cmF2ZXJzZURpcmVjdG9yeSA9IChkaXI6IHN0cmluZywgZGVwdGg6IG51bWJlciwgcHJlZml4OiBzdHJpbmcgPSAnJykgPT4ge1xuICAgICAgaWYgKGRlcHRoID4gbWF4RGVwdGgpIHJldHVybjtcblxuICAgICAgY29uc3QgaXRlbXMgPSBmcy5yZWFkZGlyU3luYyhkaXIpO1xuICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmpvaW4oZGlyLCBpdGVtKTtcbiAgICAgICAgY29uc3QgaXNMYXN0ID0gaW5kZXggPT09IGl0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgIGNvbnN0IGNvbm5lY3RvciA9IGlzTGFzdCA/ICfilJTilIDilIAgJyA6ICfilJzilIDilIAgJztcbiAgICAgICAgY29uc3QgcmVsYXRpdmVQYXRoID0gcGF0aC5yZWxhdGl2ZShwcm9qZWN0Rm9sZGVyLCBmdWxsUGF0aCk7XG5cbiAgICAgICAgLy8gU2tpcCBub2RlX21vZHVsZXMgYW5kIGhpZGRlbiBmaWxlc1xuICAgICAgICBpZiAoaXRlbSA9PT0gJ25vZGVfbW9kdWxlcycgfHwgaXRlbS5zdGFydHNXaXRoKCcuJykpIHJldHVybjtcblxuICAgICAgICBzdHJ1Y3R1cmUucHVzaChgJHtwcmVmaXh9JHtjb25uZWN0b3J9JHtpdGVtfWApO1xuXG4gICAgICAgIGlmIChmcy5zdGF0U3luYyhmdWxsUGF0aCkuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgIGNvbnN0IG5ld1ByZWZpeCA9IHByZWZpeCArIChpc0xhc3QgPyAnICAgICcgOiAn4pSCICAgJyk7XG4gICAgICAgICAgdHJhdmVyc2VEaXJlY3RvcnkoZnVsbFBhdGgsIGRlcHRoICsgMSwgbmV3UHJlZml4KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRyYXZlcnNlRGlyZWN0b3J5KHByb2plY3RGb2xkZXIsIDApO1xuICAgIHJldHVybiBgUHJvamVjdCBzdHJ1Y3R1cmU6XFxuJHtwcm9qZWN0Rm9sZGVyfVxcbiR7c3RydWN0dXJlLmpvaW4oJ1xcbicpfWA7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAnZ2V0X3Byb2plY3Rfc3RydWN0dXJlJyxcbiAgZGVzY3JpcHRpb246ICdHZXQgYSB0cmVlIHZpZXcgb2YgdGhlIHByb2plY3QgZGlyZWN0b3J5IHN0cnVjdHVyZS4gVXNlIHRoaXMgdG8gdW5kZXJzdGFuZCBwcm9qZWN0IG9yZ2FuaXphdGlvbi4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBtYXhEZXB0aDogei5udW1iZXIoKS5kZWZhdWx0KDMpLmRlc2NyaWJlKCdNYXhpbXVtIGRlcHRoIHRvIHRyYXZlcnNlIChkZWZhdWx0OiAzKScpLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgY29uc3QgZXhlY3V0ZUNvbW1hbmRUb29sID0gdG9vbChhc3luYyAoeyBjb21tYW5kLCBkZXNjcmlwdGlvbiB9KSA9PiB7XG4gIGNvbnNvbGUubG9nKGDimpnvuI8gRXhlY3V0aW5nIGNvbW1hbmQ6ICR7Y29tbWFuZH1gKTtcbiAgY29uc29sZS5sb2coYPCfk50gRGVzY3JpcHRpb246ICR7ZGVzY3JpcHRpb259YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IGV4ZWNTeW5jIH0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG4gICAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcblxuICAgIC8vIEV4ZWN1dGUgY29tbWFuZCBpbiBwcm9qZWN0IGZvbGRlclxuICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKGNvbW1hbmQsIHtcbiAgICAgIGN3ZDogcHJvamVjdEZvbGRlcixcbiAgICAgIGVuY29kaW5nOiAndXRmLTgnLFxuICAgICAgbWF4QnVmZmVyOiAxMDI0ICogMTAyNCAqIDEwLCAvLyAxME1CXG4gICAgICB0aW1lb3V0OiAzMDAwMCwgLy8gMzAgc2Vjb25kc1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGBDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseTpcXG4ke291dHB1dH1gO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBDb21tYW5kIGZhaWxlZCB3aXRoIGVycm9yOlxcbiR7ZXJyb3IubWVzc2FnZX1cXG4ke2Vycm9yLnN0ZG91dCB8fCAnJ31cXG4ke2Vycm9yLnN0ZGVyciB8fCAnJ31gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdleGVjdXRlX2NvbW1hbmQnLFxuICBkZXNjcmlwdGlvbjogJ0V4ZWN1dGUgYSBzaGVsbCBjb21tYW5kIGluIHRoZSBwcm9qZWN0IGRpcmVjdG9yeS4gVXNlIHRoaXMgZm9yIG5wbSBpbnN0YWxsLCBnaXQgb3BlcmF0aW9ucywgYnVpbGRpbmcsIHRlc3RpbmcsIGV0Yy4gQUxXQVlTIHByb3ZpZGUgYSBjbGVhciBkZXNjcmlwdGlvbi4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBjb21tYW5kOiB6LnN0cmluZygpLmRlc2NyaWJlKCdTaGVsbCBjb21tYW5kIHRvIGV4ZWN1dGUnKSxcbiAgICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5kZXNjcmliZSgnQ2xlYXIgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGlzIGNvbW1hbmQgZG9lcyBhbmQgd2h5JyksXG4gIH0pLFxufSk7XG5cbi8vIFZlY3RvciBzZWFyY2ggdG9vbHNcbmV4cG9ydCBjb25zdCBzZWFyY2hTaW1pbGFyQ29kZVRvb2wgPSB0b29sKGFzeW5jICh7IHF1ZXJ5LCBtYXhSZXN1bHRzIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdElkID0gJ2FnZW50X2NvbnRleHRfcHJvamVjdCc7XG4gIGNvbnNvbGUubG9nKGDwn5SNIFNlYXJjaGluZyBmb3Igc2ltaWxhciBjb2RlOiBcIiR7cXVlcnl9XCIgaW4gcHJvamVjdCAke3Byb2plY3RJZH1gKTtcblxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZWFyY2hTaW1pbGFyQ29kZShxdWVyeSwgcHJvamVjdElkLCBtYXhSZXN1bHRzIHx8IDUpO1xuICByZXR1cm4gcmVzdWx0O1xufSwge1xuICBuYW1lOiAnc2VhcmNoX3NpbWlsYXJfY29kZScsXG4gIGRlc2NyaXB0aW9uOiAnU2VhcmNoIGZvciBzaW1pbGFyIGNvZGUgZXhhbXBsZXMgaW4gdGhlIHZlY3RvciBkYXRhYmFzZS4gVXNlIHRoaXMgdG8gZmluZCByZWxldmFudCBjb2RlIHBhdHRlcm5zIGFuZCBpbXBsZW1lbnRhdGlvbnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgcXVlcnk6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1RoZSBjb2RlIG9yIGNvbmNlcHQgdG8gc2VhcmNoIGZvcicpLFxuICAgIG1heFJlc3VsdHM6IHoubnVtYmVyKCkub3B0aW9uYWwoKS5kZXNjcmliZSgnTWF4aW11bSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4gKGRlZmF1bHQ6IDUpJylcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGdldFByb2plY3RDb250ZXh0VG9vbCA9IHRvb2woYXN5bmMgKCkgPT4ge1xuICBjb25zdCBwcm9qZWN0SWQgPSAnYWdlbnRfY29udGV4dF9wcm9qZWN0JztcbiAgY29uc29sZS5sb2coYPCfk4ogR2V0dGluZyBwcm9qZWN0IGNvbnRleHQgZm9yOiAke3Byb2plY3RJZH1gKTtcblxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRQcm9qZWN0Q29udGV4dChwcm9qZWN0SWQpO1xuICByZXR1cm4gcmVzdWx0O1xufSwge1xuICBuYW1lOiAnZ2V0X3Byb2plY3RfY29udGV4dCcsXG4gIGRlc2NyaXB0aW9uOiAnR2V0IGNvbXByZWhlbnNpdmUgcHJvamVjdCBzdGF0aXN0aWNzIGFuZCBzdHJ1Y3R1cmUgaW5mb3JtYXRpb24gZnJvbSB0aGUgdmVjdG9yIGRhdGFiYXNlLicsXG4gIHNjaGVtYTogei5vYmplY3Qoe30pLFxufSk7XG5cbi8vIENyZWF0ZSB0aGUgdG9vbHMgYXJyYXkgd2l0aCBhbGwgdG9vbHNcbmV4cG9ydCBjb25zdCB0b29scyA9IFtcbiAgLy8gQmFzaWMgZmlsZSBvcGVyYXRpb25zXG4gIHJlYWRGaWxlVG9vbCxcbiAgd3JpdGVGaWxlVG9vbCxcbiAgYXBwZW5kVG9GaWxlVG9vbCxcbiAgZGVsZXRlRmlsZVRvb2wsXG4gIGxpc3REaXJlY3RvcnlUb29sLFxuICBzZWFyY2hGaWxlc1Rvb2wsXG4gIC8vIEFkdmFuY2VkIGVkaXRpbmcgdG9vbHNcbiAgcmVwbGFjZUluRmlsZVRvb2wsXG4gIGluc2VydEF0TGluZVRvb2wsXG4gIGRlbGV0ZUxpbmVzVG9vbCxcbiAgcmVwbGFjZUJsb2NrVG9vbCxcbiAgcmVwbGFjZUxpbmVSYW5nZVRvb2wsXG4gIHJlYWRMaW5lc1Rvb2wsXG4gIC8vIEZpbGUgbWFuYWdlbWVudFxuICBnZXRGaWxlSW5mb1Rvb2wsXG4gIGNyZWF0ZURpcmVjdG9yeVRvb2wsXG4gIGNvcHlGaWxlVG9vbCxcbiAgbW92ZUZpbGVUb29sLFxuICAvLyBQcm9qZWN0IHRvb2xzXG4gIGdldFByb2plY3RTdHJ1Y3R1cmVUb29sLFxuICBleGVjdXRlQ29tbWFuZFRvb2wsXG4gIC8vIFZlY3RvciBzZWFyY2ggdG9vbHNcbiAgc2VhcmNoU2ltaWxhckNvZGVUb29sLFxuICBnZXRQcm9qZWN0Q29udGV4dFRvb2wsXG5dO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gd3JhcCB0b29sIGV4ZWN1dGlvbiB3aXRoIGxvZ2dpbmdcbmV4cG9ydCBmdW5jdGlvbiB3cmFwVG9vbFdpdGhMb2dnaW5nKHRvb2xGbjogYW55LCB0b29sTmFtZTogc3RyaW5nKSB7XG4gIHJldHVybiBhc3luYyAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGFyZ3NbMF0gfHwge307XG4gICAgY29uc3QgY2FsbElkID0gdG9vbExvZ2dlci5zdGFydENhbGwodG9vbE5hbWUsIGlucHV0KTtcbiAgICB0cnkge1xuICAgICAgLy8gU3VwcG9ydCBtdWx0aXBsZSB0b29sIHNoYXBlcyByZXR1cm5lZCBieSBgdG9vbCgpYCBvciBjdXN0b20gd3JhcHBlcnMuXG4gICAgICAvLyBDb21tb24gcG9zc2liaWxpdGllczpcbiAgICAgIC8vIC0gYSBwbGFpbiBmdW5jdGlvbjogdG9vbEZuKGFyZ3NPYmopXG4gICAgICAvLyAtIGFuIG9iamVjdCB3aXRoIC5jYWxsKGFyZ3NPYmopXG4gICAgICAvLyAtIGFuIG9iamVjdCB3aXRoIC5pbnZva2UoYXJnc09iailcbiAgICAgIC8vIC0gYW4gb2JqZWN0IHdpdGggLnJ1bihhcmdzT2JqKVxuICAgICAgbGV0IHJlc3VsdDogYW55O1xuXG4gICAgICBpZiAodHlwZW9mIHRvb2xGbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXN1bHQgPSBhd2FpdCB0b29sRm4oaW5wdXQpO1xuICAgICAgfSBlbHNlIGlmICh0b29sRm4gJiYgdHlwZW9mIHRvb2xGbi5jYWxsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IHRvb2xGbi5jYWxsKGlucHV0KTtcbiAgICAgIH0gZWxzZSBpZiAodG9vbEZuICYmIHR5cGVvZiB0b29sRm4uaW52b2tlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IHRvb2xGbi5pbnZva2UoaW5wdXQpO1xuICAgICAgfSBlbHNlIGlmICh0b29sRm4gJiYgdHlwZW9mIHRvb2xGbi5ydW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdG9vbEZuLnJ1bihpbnB1dCk7XG4gICAgICB9IGVsc2UgaWYgKHRvb2xGbiAmJiB0eXBlb2YgdG9vbEZuLmV4ZWN1dGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdG9vbEZuLmV4ZWN1dGUoaW5wdXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUb29sIGlzIG5vdCBjYWxsYWJsZScpO1xuICAgICAgfVxuXG4gICAgICB0b29sTG9nZ2VyLmVuZENhbGwoY2FsbElkLCByZXN1bHQsIHRydWUpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zdCBlcnJvck1zZyA9IGVycm9yPy5tZXNzYWdlIHx8IFN0cmluZyhlcnJvcik7XG4gICAgICB0b29sTG9nZ2VyLmVuZENhbGwoY2FsbElkLCBlcnJvck1zZywgZmFsc2UsIGVycm9yTXNnKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfTtcbn0iXSwibmFtZXMiOlsidG9vbCIsInoiLCJmcyIsInBhdGgiLCJyZWFkRmlsZSIsIndyaXRlRmlsZSIsImFwcGVuZFRvRmlsZSIsImRlbGV0ZUZpbGUiLCJsaXN0RGlyZWN0b3J5Iiwic2VhcmNoRmlsZXMiLCJGaWxlUmVhZFNjaGVtYSIsIkZpbGVXcml0ZVNjaGVtYSIsIkZpbGVBcHBlbmRTY2hlbWEiLCJGaWxlRGVsZXRlU2NoZW1hIiwiRGlyZWN0b3J5TGlzdFNjaGVtYSIsIkZpbGVTZWFyY2hTY2hlbWEiLCJnZXRNZW1vcnkiLCJnZXRQcm9qZWN0Rm9sZGVyIiwidG9vbExvZ2dlciIsInNlYXJjaFNpbWlsYXJDb2RlIiwiZ2V0UHJvamVjdENvbnRleHQiLCJyZWFkRmlsZVRvb2wiLCJmaWxlUGF0aCIsInByb2plY3RGb2xkZXIiLCJmdWxsUGF0aCIsImlzQWJzb2x1dGUiLCJqb2luIiwiY29uc29sZSIsImxvZyIsInJlc3VsdCIsInN1Y2Nlc3MiLCJhZGRGaWxlT3BlcmF0aW9uIiwiY29udGVudCIsImVycm9yIiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2NoZW1hIiwid3JpdGVGaWxlVG9vbCIsImV4aXN0cyIsImV4aXN0c1N5bmMiLCJhcHBlbmRUb0ZpbGVUb29sIiwiZGVsZXRlRmlsZVRvb2wiLCJsaXN0RGlyZWN0b3J5VG9vbCIsImRpclBhdGgiLCJmaWxlcyIsInNlYXJjaEZpbGVzVG9vbCIsInBhdHRlcm4iLCJtYXRjaGVzIiwibWF0Y2hlc1RleHQiLCJzbGljZSIsIm1hcCIsIm1hdGNoIiwiZmlsZSIsImxpbmUiLCJsZW5ndGgiLCJyZXBsYWNlSW5GaWxlVG9vbCIsInNlYXJjaFRleHQiLCJyZXBsYWNlVGV4dCIsInJlYWRSZXN1bHQiLCJvcmlnaW5hbENvbnRlbnQiLCJuZXdDb250ZW50IiwicmVwbGFjZSIsIlJlZ0V4cCIsInJlcGxhY2VtZW50Q291bnQiLCJ3cml0ZVJlc3VsdCIsIm1lc3NhZ2UiLCJvYmplY3QiLCJzdHJpbmciLCJkZXNjcmliZSIsImluc2VydEF0TGluZVRvb2wiLCJsaW5lTnVtYmVyIiwibGluZXMiLCJzcGxpdCIsInNwbGljZSIsIm51bWJlciIsImRlbGV0ZUxpbmVzVG9vbCIsInN0YXJ0TGluZSIsImVuZExpbmUiLCJyZXBsYWNlQmxvY2tUb29sIiwic3RhcnRNYXJrZXIiLCJlbmRNYXJrZXIiLCJzdGFydElkeCIsImluZGV4T2YiLCJlbmRJZHgiLCJiZWZvcmUiLCJzdWJzdHJpbmciLCJhZnRlciIsIm5ld0ZpbGVDb250ZW50Iiwib2xkQmxvY2siLCJyZXBsYWNlTGluZVJhbmdlVG9vbCIsIm5ld0xpbmVzIiwibmV3RmlsZUxpbmVzIiwib2xkTGluZUNvdW50IiwibmV3TGluZUNvdW50IiwiZ2V0RmlsZUluZm9Ub29sIiwic3RhdHMiLCJzdGF0U3luYyIsImV4dGVuc2lvbiIsImV4dG5hbWUiLCJKU09OIiwic3RyaW5naWZ5Iiwic2l6ZSIsImNyZWF0ZWQiLCJiaXJ0aHRpbWUiLCJtb2RpZmllZCIsIm10aW1lIiwiaXNEaXJlY3RvcnkiLCJjcmVhdGVEaXJlY3RvcnlUb29sIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiY29weUZpbGVUb29sIiwic291cmNlUGF0aCIsImRlc3RpbmF0aW9uUGF0aCIsImZ1bGxTb3VyY2VQYXRoIiwiZnVsbERlc3RQYXRoIiwiY29weUZpbGVTeW5jIiwibW92ZUZpbGVUb29sIiwicmVuYW1lU3luYyIsInJlYWRMaW5lc1Rvb2wiLCJzZWxlY3RlZExpbmVzIiwiZ2V0UHJvamVjdFN0cnVjdHVyZVRvb2wiLCJtYXhEZXB0aCIsInN0cnVjdHVyZSIsInRyYXZlcnNlRGlyZWN0b3J5IiwiZGlyIiwiZGVwdGgiLCJwcmVmaXgiLCJpdGVtcyIsInJlYWRkaXJTeW5jIiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsImlzTGFzdCIsImNvbm5lY3RvciIsInJlbGF0aXZlUGF0aCIsInJlbGF0aXZlIiwic3RhcnRzV2l0aCIsInB1c2giLCJuZXdQcmVmaXgiLCJkZWZhdWx0IiwiZXhlY3V0ZUNvbW1hbmRUb29sIiwiY29tbWFuZCIsImV4ZWNTeW5jIiwicmVxdWlyZSIsIm91dHB1dCIsImN3ZCIsImVuY29kaW5nIiwibWF4QnVmZmVyIiwidGltZW91dCIsInN0ZG91dCIsInN0ZGVyciIsInNlYXJjaFNpbWlsYXJDb2RlVG9vbCIsInF1ZXJ5IiwibWF4UmVzdWx0cyIsInByb2plY3RJZCIsIm9wdGlvbmFsIiwiZ2V0UHJvamVjdENvbnRleHRUb29sIiwidG9vbHMiLCJ3cmFwVG9vbFdpdGhMb2dnaW5nIiwidG9vbEZuIiwidG9vbE5hbWUiLCJhcmdzIiwiaW5wdXQiLCJjYWxsSWQiLCJzdGFydENhbGwiLCJjYWxsIiwiaW52b2tlIiwicnVuIiwiZXhlY3V0ZSIsIkVycm9yIiwiZW5kQ2FsbCIsImVycm9yTXNnIiwiU3RyaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/tools.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/utils.ts":
/*!*****************************!*\
  !*** ./lib/agents/utils.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getMemory: () => (/* binding */ getMemory),\n/* harmony export */   getProjectFolder: () => (/* binding */ getProjectFolder),\n/* harmony export */   setSessionMemory: () => (/* binding */ setSessionMemory),\n/* harmony export */   validateFileContent: () => (/* binding */ validateFileContent)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_memory_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/memory-db */ \"(rsc)/./lib/utils/memory-db.ts\");\n\n\n\n// Global memory instance for current session\nlet currentMemory = null;\nlet currentProjectFolder = null;\nlet sessionToFolderMap = new Map();\nfunction setSessionMemory(sessionId) {\n    // Check if this session already has a project folder\n    if (sessionToFolderMap.has(sessionId)) {\n        currentProjectFolder = sessionToFolderMap.get(sessionId);\n    } else {\n        // Create new project folder for this session\n        currentProjectFolder = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"generated\", sessionId);\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(currentProjectFolder)) {\n            fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(currentProjectFolder, {\n                recursive: true\n            });\n        }\n        sessionToFolderMap.set(sessionId, currentProjectFolder);\n    }\n    // Create memory with project folder\n    currentMemory = (0,_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__.getSessionMemory)(sessionId, currentProjectFolder);\n}\nfunction getMemory() {\n    if (!currentMemory) {\n        // Fallback to default session if not set\n        const defaultFolder = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"generated\", \"default_project\");\n        currentMemory = (0,_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__.getSessionMemory)(\"default\", defaultFolder);\n    }\n    return currentMemory;\n}\nfunction getProjectFolder() {\n    if (!currentProjectFolder) {\n        // Fallback to default project folder\n        const defaultFolder = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"generated\", \"default_project\");\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(defaultFolder)) {\n            fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(defaultFolder, {\n                recursive: true\n            });\n        }\n        currentProjectFolder = defaultFolder;\n    }\n    return currentProjectFolder;\n}\n// Helper: Validate file content\nfunction validateFileContent(filename, content) {\n    const trimmed = content.trim();\n    // Check for placeholders\n    if (content.includes(\"...\") || content.toLowerCase().includes(\"todo\") || content.includes(\"placeholder\")) {\n        return {\n            isValid: false,\n            reason: \"Contains placeholders or TODO comments\"\n        };\n    }\n    // Check for empty or very short files\n    if (trimmed.length < 10) {\n        return {\n            isValid: false,\n            reason: \"File is too short or empty\"\n        };\n    }\n    // Check for incomplete code patterns\n    if (filename.endsWith(\".ts\") || filename.endsWith(\".js\")) {\n        if (!trimmed.includes(\"export\") && !trimmed.includes(\"function\") && !trimmed.includes(\"class\") && !trimmed.includes(\"const\") && !trimmed.includes(\"let\")) {\n            return {\n                isValid: false,\n                reason: \"No valid code constructs found\"\n            };\n        }\n    }\n    return {\n        isValid: true,\n        reason: \"Valid content\"\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWdlbnRzL3V0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF5QjtBQUNJO0FBQzZDO0FBRTFFLDZDQUE2QztBQUM3QyxJQUFJRyxnQkFBMkM7QUFDL0MsSUFBSUMsdUJBQXNDO0FBQzFDLElBQUlDLHFCQUFxQixJQUFJQztBQUV0QixTQUFTQyxpQkFBaUJDLFNBQWlCO0lBQ2hELHFEQUFxRDtJQUNyRCxJQUFJSCxtQkFBbUJJLEdBQUcsQ0FBQ0QsWUFBWTtRQUNyQ0osdUJBQXVCQyxtQkFBbUJLLEdBQUcsQ0FBQ0Y7SUFDaEQsT0FBTztRQUNMLDZDQUE2QztRQUM3Q0osdUJBQXVCSCxzQ0FBUyxDQUFDVyxRQUFRQyxHQUFHLElBQUksYUFBYUw7UUFDN0QsSUFBSSxDQUFDUiwwQ0FBYSxDQUFDSSx1QkFBdUI7WUFDeENKLHlDQUFZLENBQUNJLHNCQUFzQjtnQkFBRVksV0FBVztZQUFLO1FBQ3ZEO1FBQ0FYLG1CQUFtQlksR0FBRyxDQUFDVCxXQUFXSjtJQUNwQztJQUVBLG9DQUFvQztJQUNwQ0QsZ0JBQWdCRCxrRUFBZ0JBLENBQUNNLFdBQVdKO0FBQzlDO0FBRU8sU0FBU2M7SUFDZCxJQUFJLENBQUNmLGVBQWU7UUFDbEIseUNBQXlDO1FBQ3pDLE1BQU1nQixnQkFBZ0JsQixzQ0FBUyxDQUFDVyxRQUFRQyxHQUFHLElBQUksYUFBYTtRQUM1RFYsZ0JBQWdCRCxrRUFBZ0JBLENBQUMsV0FBV2lCO0lBQzlDO0lBQ0EsT0FBT2hCO0FBQ1Q7QUFFTyxTQUFTaUI7SUFDZCxJQUFJLENBQUNoQixzQkFBc0I7UUFDekIscUNBQXFDO1FBQ3JDLE1BQU1lLGdCQUFnQmxCLHNDQUFTLENBQUNXLFFBQVFDLEdBQUcsSUFBSSxhQUFhO1FBQzVELElBQUksQ0FBQ2IsMENBQWEsQ0FBQ21CLGdCQUFnQjtZQUNqQ25CLHlDQUFZLENBQUNtQixlQUFlO2dCQUFFSCxXQUFXO1lBQUs7UUFDaEQ7UUFDQVosdUJBQXVCZTtJQUN6QjtJQUNBLE9BQU9mO0FBQ1Q7QUFFQSxnQ0FBZ0M7QUFDekIsU0FBU2lCLG9CQUFvQkMsUUFBZ0IsRUFBRUMsT0FBZTtJQUNuRSxNQUFNQyxVQUFVRCxRQUFRRSxJQUFJO0lBRTVCLHlCQUF5QjtJQUN6QixJQUFJRixRQUFRRyxRQUFRLENBQUMsVUFBVUgsUUFBUUksV0FBVyxHQUFHRCxRQUFRLENBQUMsV0FBV0gsUUFBUUcsUUFBUSxDQUFDLGdCQUFnQjtRQUN4RyxPQUFPO1lBQUVFLFNBQVM7WUFBT0MsUUFBUTtRQUF5QztJQUM1RTtJQUVBLHNDQUFzQztJQUN0QyxJQUFJTCxRQUFRTSxNQUFNLEdBQUcsSUFBSTtRQUN2QixPQUFPO1lBQUVGLFNBQVM7WUFBT0MsUUFBUTtRQUE2QjtJQUNoRTtJQUVBLHFDQUFxQztJQUNyQyxJQUFJUCxTQUFTUyxRQUFRLENBQUMsVUFBVVQsU0FBU1MsUUFBUSxDQUFDLFFBQVE7UUFDeEQsSUFBSSxDQUFDUCxRQUFRRSxRQUFRLENBQUMsYUFBYSxDQUFDRixRQUFRRSxRQUFRLENBQUMsZUFBZSxDQUFDRixRQUFRRSxRQUFRLENBQUMsWUFBWSxDQUFDRixRQUFRRSxRQUFRLENBQUMsWUFBWSxDQUFDRixRQUFRRSxRQUFRLENBQUMsUUFBUTtZQUN4SixPQUFPO2dCQUFFRSxTQUFTO2dCQUFPQyxRQUFRO1lBQWlDO1FBQ3BFO0lBQ0Y7SUFFQSxPQUFPO1FBQUVELFNBQVM7UUFBTUMsUUFBUTtJQUFnQjtBQUNsRCIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2FnZW50cy91dGlscy50cz8zMGM5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NZW1vcnksIGdldFNlc3Npb25NZW1vcnkgfSBmcm9tICcuLi91dGlscy9tZW1vcnktZGInO1xuXG4vLyBHbG9iYWwgbWVtb3J5IGluc3RhbmNlIGZvciBjdXJyZW50IHNlc3Npb25cbmxldCBjdXJyZW50TWVtb3J5OiBDb252ZXJzYXRpb25NZW1vcnkgfCBudWxsID0gbnVsbDtcbmxldCBjdXJyZW50UHJvamVjdEZvbGRlcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5sZXQgc2Vzc2lvblRvRm9sZGVyTWFwID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNldFNlc3Npb25NZW1vcnkoc2Vzc2lvbklkOiBzdHJpbmcpIHtcbiAgLy8gQ2hlY2sgaWYgdGhpcyBzZXNzaW9uIGFscmVhZHkgaGFzIGEgcHJvamVjdCBmb2xkZXJcbiAgaWYgKHNlc3Npb25Ub0ZvbGRlck1hcC5oYXMoc2Vzc2lvbklkKSkge1xuICAgIGN1cnJlbnRQcm9qZWN0Rm9sZGVyID0gc2Vzc2lvblRvRm9sZGVyTWFwLmdldChzZXNzaW9uSWQpITtcbiAgfSBlbHNlIHtcbiAgICAvLyBDcmVhdGUgbmV3IHByb2plY3QgZm9sZGVyIGZvciB0aGlzIHNlc3Npb25cbiAgICBjdXJyZW50UHJvamVjdEZvbGRlciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZ2VuZXJhdGVkJywgc2Vzc2lvbklkKTtcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoY3VycmVudFByb2plY3RGb2xkZXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoY3VycmVudFByb2plY3RGb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBzZXNzaW9uVG9Gb2xkZXJNYXAuc2V0KHNlc3Npb25JZCwgY3VycmVudFByb2plY3RGb2xkZXIpO1xuICB9XG5cbiAgLy8gQ3JlYXRlIG1lbW9yeSB3aXRoIHByb2plY3QgZm9sZGVyXG4gIGN1cnJlbnRNZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KHNlc3Npb25JZCwgY3VycmVudFByb2plY3RGb2xkZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVtb3J5KCk6IENvbnZlcnNhdGlvbk1lbW9yeSB7XG4gIGlmICghY3VycmVudE1lbW9yeSkge1xuICAgIC8vIEZhbGxiYWNrIHRvIGRlZmF1bHQgc2Vzc2lvbiBpZiBub3Qgc2V0XG4gICAgY29uc3QgZGVmYXVsdEZvbGRlciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZ2VuZXJhdGVkJywgJ2RlZmF1bHRfcHJvamVjdCcpO1xuICAgIGN1cnJlbnRNZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KCdkZWZhdWx0JywgZGVmYXVsdEZvbGRlcik7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRNZW1vcnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9qZWN0Rm9sZGVyKCk6IHN0cmluZyB7XG4gIGlmICghY3VycmVudFByb2plY3RGb2xkZXIpIHtcbiAgICAvLyBGYWxsYmFjayB0byBkZWZhdWx0IHByb2plY3QgZm9sZGVyXG4gICAgY29uc3QgZGVmYXVsdEZvbGRlciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZ2VuZXJhdGVkJywgJ2RlZmF1bHRfcHJvamVjdCcpO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkZWZhdWx0Rm9sZGVyKSkge1xuICAgICAgZnMubWtkaXJTeW5jKGRlZmF1bHRGb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBjdXJyZW50UHJvamVjdEZvbGRlciA9IGRlZmF1bHRGb2xkZXI7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRQcm9qZWN0Rm9sZGVyO1xufVxuXG4vLyBIZWxwZXI6IFZhbGlkYXRlIGZpbGUgY29udGVudFxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRmlsZUNvbnRlbnQoZmlsZW5hbWU6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogeyBpc1ZhbGlkOiBib29sZWFuOyByZWFzb246IHN0cmluZyB9IHtcbiAgY29uc3QgdHJpbW1lZCA9IGNvbnRlbnQudHJpbSgpO1xuXG4gIC8vIENoZWNrIGZvciBwbGFjZWhvbGRlcnNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJy4uLicpIHx8IGNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndG9kbycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3BsYWNlaG9sZGVyJykpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgcmVhc29uOiAnQ29udGFpbnMgcGxhY2Vob2xkZXJzIG9yIFRPRE8gY29tbWVudHMnIH07XG4gIH1cblxuICAvLyBDaGVjayBmb3IgZW1wdHkgb3IgdmVyeSBzaG9ydCBmaWxlc1xuICBpZiAodHJpbW1lZC5sZW5ndGggPCAxMCkge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCByZWFzb246ICdGaWxlIGlzIHRvbyBzaG9ydCBvciBlbXB0eScgfTtcbiAgfVxuXG4gIC8vIENoZWNrIGZvciBpbmNvbXBsZXRlIGNvZGUgcGF0dGVybnNcbiAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcudHMnKSB8fCBmaWxlbmFtZS5lbmRzV2l0aCgnLmpzJykpIHtcbiAgICBpZiAoIXRyaW1tZWQuaW5jbHVkZXMoJ2V4cG9ydCcpICYmICF0cmltbWVkLmluY2x1ZGVzKCdmdW5jdGlvbicpICYmICF0cmltbWVkLmluY2x1ZGVzKCdjbGFzcycpICYmICF0cmltbWVkLmluY2x1ZGVzKCdjb25zdCcpICYmICF0cmltbWVkLmluY2x1ZGVzKCdsZXQnKSkge1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIHJlYXNvbjogJ05vIHZhbGlkIGNvZGUgY29uc3RydWN0cyBmb3VuZCcgfTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCByZWFzb246ICdWYWxpZCBjb250ZW50JyB9O1xufSJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJnZXRTZXNzaW9uTWVtb3J5IiwiY3VycmVudE1lbW9yeSIsImN1cnJlbnRQcm9qZWN0Rm9sZGVyIiwic2Vzc2lvblRvRm9sZGVyTWFwIiwiTWFwIiwic2V0U2Vzc2lvbk1lbW9yeSIsInNlc3Npb25JZCIsImhhcyIsImdldCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsInNldCIsImdldE1lbW9yeSIsImRlZmF1bHRGb2xkZXIiLCJnZXRQcm9qZWN0Rm9sZGVyIiwidmFsaWRhdGVGaWxlQ29udGVudCIsImZpbGVuYW1lIiwiY29udGVudCIsInRyaW1tZWQiLCJ0cmltIiwiaW5jbHVkZXMiLCJ0b0xvd2VyQ2FzZSIsImlzVmFsaWQiLCJyZWFzb24iLCJsZW5ndGgiLCJlbmRzV2l0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/chroma.ts":
/*!**************************!*\
  !*** ./lib/db/chroma.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chromaManager: () => (/* binding */ chromaManager),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   generateChunkId: () => (/* binding */ generateChunkId),\n/* harmony export */   generatePromptId: () => (/* binding */ generatePromptId)\n/* harmony export */ });\n/* harmony import */ var _langchain_google_genai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/google-genai */ \"(rsc)/./node_modules/.pnpm/@langchain+google-genai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__/node_modules/@langchain/google-genai/dist/index.js\");\n/* harmony import */ var _langchain_community_vectorstores_chroma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/community/vectorstores/chroma */ \"(rsc)/./node_modules/.pnpm/@langchain+community@1.0.0_@browserbasehq+sdk@2.6.0_@browserbasehq+stagehand@1.14.0_@pl_472eda21cf5c5c16bfc96c15f0b8aab9/node_modules/@langchain/community/dist/vectorstores/chroma.js\");\n/* harmony import */ var _langchain_core_documents__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/core/documents */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/documents/index.js\");\n\n\n\n// ChromaDB-based vector store implementation using LangChain for efficient similarity search\nclass ChromaVectorStore {\n    constructor(collectionName, embeddings){\n        this.vectorStore = null;\n        this.collectionName = collectionName;\n        this.embeddings = embeddings;\n    }\n    async ensureVectorStore() {\n        if (!this.vectorStore) {\n            try {\n                // Try to load existing collection\n                this.vectorStore = await _langchain_community_vectorstores_chroma__WEBPACK_IMPORTED_MODULE_1__.Chroma.fromExistingCollection(this.embeddings, {\n                    collectionName: this.collectionName\n                });\n                console.log(`✅ Loaded existing ChromaDB collection: ${this.collectionName}`);\n            } catch (error) {\n                // Collection doesn't exist, create new one\n                this.vectorStore = new _langchain_community_vectorstores_chroma__WEBPACK_IMPORTED_MODULE_1__.Chroma(this.embeddings, {\n                    collectionName: this.collectionName,\n                    url: \"http://localhost:8000\" // Default ChromaDB server URL\n                });\n                console.log(`✅ Created new ChromaDB collection: ${this.collectionName}`);\n            }\n        }\n        return this.vectorStore;\n    }\n    async addDocuments(docs) {\n        if (docs.length === 0) return;\n        const vectorStore = await this.ensureVectorStore();\n        // Convert to LangChain documents\n        const documents = docs.map((doc)=>new _langchain_core_documents__WEBPACK_IMPORTED_MODULE_2__.Document({\n                pageContent: doc.pageContent,\n                metadata: doc.metadata || {}\n            }));\n        // Add documents to vector store\n        await vectorStore.addDocuments(documents);\n        console.log(`✅ Added ${docs.length} documents to ChromaDB collection: ${this.collectionName}`);\n    }\n    async similaritySearchWithScore(query, k = 5) {\n        const vectorStore = await this.ensureVectorStore();\n        // Use LangChain's similarity search with scores\n        const results = await vectorStore.similaritySearchWithScore(query, k);\n        console.log(`✅ Found ${results.length} results from ChromaDB query`);\n        return results;\n    }\n}\n// Configuration\nconst EMBEDDING_MODEL = \"text-embedding-004\";\nconst EMBEDDING_DIMENSIONS = 3072; // Google Gemini embedding dimensions\nvar VectorStorageProvider;\n// Storage provider enum for future extensions\n(function(VectorStorageProvider) {\n    VectorStorageProvider[\"CHROMA\"] = \"chroma\";\n    VectorStorageProvider[\"MEMORY\"] = \"memory\";\n})(VectorStorageProvider || (VectorStorageProvider = {}));\n// Current storage provider - ChromaDB is now primary\nconst CURRENT_STORAGE_PROVIDER = \"chroma\";\n// Project storage keys\nconst STORAGE_KEYS = {\n    PROJECT_CODE: (projectId)=>`project_${projectId}_code`,\n    PROJECT_PROMPTS: (projectId)=>`project_${projectId}_prompts`,\n    PROJECT_STRUCTURE: (projectId)=>`project_${projectId}_structure`\n};\n// Unified Vector Store Manager with ChromaDB implementation\nclass VectorStoreManager {\n    constructor(){\n        this.store = new Map();\n        this.chunkCounts = new Map();\n        // Use LangChain's Google Generative AI embeddings - Gemini 3072 dimensions\n        this.embeddings = new _langchain_google_genai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAIEmbeddings({\n            modelName: \"text-embedding-004\",\n            apiKey: process.env.GEMINI_API_KEY || process.env.GOOGLE_API_KEY\n        });\n    }\n    // Get or create a project collection (ChromaDB collections)\n    async getProjectStore(collectionName) {\n        if (!this.store.has(collectionName)) {\n            this.store.set(collectionName, new ChromaVectorStore(collectionName, this.embeddings));\n        }\n        return this.store.get(collectionName);\n    }\n    // Initialize collections for a project (ChromaDB handles this automatically)\n    async initializeProjectCollections(projectId) {\n        console.log(`✅ Initialized ChromaDB collections for project: ${projectId}`);\n    // ChromaDB creates collections on demand\n    }\n    // Generate embeddings for text content\n    async generateEmbeddings(texts) {\n        try {\n            const embeddings = await this.embeddings.embedDocuments(texts);\n            return embeddings;\n        } catch (error) {\n            console.error(\"❌ Failed to generate embeddings:\", error);\n            throw error;\n        }\n    }\n    // Add code chunks to project collection\n    async addCodeChunks(projectId, chunks) {\n        try {\n            if (chunks.length === 0) return;\n            const collectionName = STORAGE_KEYS.PROJECT_CODE(projectId);\n            const store = await this.getProjectStore(collectionName);\n            // Add chunks to MeMemo store\n            await store.addDocuments(chunks.map((chunk)=>({\n                    pageContent: chunk.content,\n                    metadata: chunk.metadata\n                })));\n            // Track count\n            this.chunkCounts.set(collectionName, (this.chunkCounts.get(collectionName) || 0) + chunks.length);\n            console.log(`� Added ${chunks.length} code chunks to project ${projectId} (collection: ${collectionName})`);\n        } catch (error) {\n            console.error(\"❌ Failed to add code chunks:\", error);\n            throw error;\n        }\n    }\n    // Add prompt chunks to project collection\n    async addPromptChunks(projectId, chunks) {\n        try {\n            if (chunks.length === 0) return;\n            const collectionName = STORAGE_KEYS.PROJECT_PROMPTS(projectId);\n            const store = await this.getProjectStore(collectionName);\n            // Add chunks to MeMemo store\n            await store.addDocuments(chunks.map((chunk)=>({\n                    pageContent: chunk.content,\n                    metadata: chunk.metadata\n                })));\n            // Track count\n            this.chunkCounts.set(collectionName, (this.chunkCounts.get(collectionName) || 0) + chunks.length);\n            console.log(`💬 Added ${chunks.length} prompt chunks to project ${projectId}`);\n        } catch (error) {\n            console.error(\"❌ Failed to add prompt chunks:\", error);\n            throw error;\n        }\n    }\n    // Add project structure embeddings\n    async addStructureChunks(projectId, chunks) {\n        try {\n            if (chunks.length === 0) return;\n            const collectionName = STORAGE_KEYS.PROJECT_STRUCTURE(projectId);\n            const store = await this.getProjectStore(collectionName);\n            // Add chunks to MeMemo store\n            await store.addDocuments(chunks.map((chunk)=>({\n                    pageContent: chunk.content,\n                    metadata: chunk.metadata\n                })));\n            // Track count\n            this.chunkCounts.set(collectionName, (this.chunkCounts.get(collectionName) || 0) + chunks.length);\n            console.log(`🏗️ Added ${chunks.length} structure chunks to project ${projectId}`);\n        } catch (error) {\n            console.error(\"❌ Failed to add structure chunks:\", error);\n            throw error;\n        }\n    }\n    // Search for similar code patterns\n    async searchCode(projectId, query, nResults = 5) {\n        try {\n            const collectionName = STORAGE_KEYS.PROJECT_CODE(projectId);\n            const store = await this.getProjectStore(collectionName);\n            const results = await store.similaritySearchWithScore(query, nResults);\n            return results.map(([doc, score])=>({\n                    id: doc.metadata.id || `search_${Date.now()}`,\n                    content: doc.pageContent,\n                    score: 1 - score / 2,\n                    metadata: doc.metadata\n                }));\n        } catch (error) {\n            console.error(\"❌ Failed to search code:\", error);\n            return [];\n        }\n    }\n    // Search across all project collections\n    async searchProject(projectId, query, nResults = 10) {\n        try {\n            const results = [];\n            // Search code collection\n            const codeResults = await this.searchCode(projectId, query, nResults);\n            results.push(...codeResults.map((r)=>({\n                    ...r,\n                    type: \"code\"\n                })));\n            // Search prompts collection\n            try {\n                const promptsCollectionName = STORAGE_KEYS.PROJECT_PROMPTS(projectId);\n                const promptsStore = await this.getProjectStore(promptsCollectionName);\n                const promptsResults = await promptsStore.similaritySearchWithScore(query, Math.ceil(nResults / 3));\n                promptsResults.forEach(([doc, score])=>{\n                    results.push({\n                        type: \"prompt\",\n                        id: doc.metadata.id || `prompt_${Date.now()}`,\n                        content: doc.pageContent,\n                        score: 1 - score / 2,\n                        metadata: doc.metadata\n                    });\n                });\n            } catch (error) {\n            // Prompts collection might not exist yet - skip\n            }\n            // Search structure collection\n            try {\n                const structCollectionName = STORAGE_KEYS.PROJECT_STRUCTURE(projectId);\n                const structStore = await this.getProjectStore(structCollectionName);\n                const structResults = await structStore.similaritySearchWithScore(query, Math.ceil(nResults / 3));\n                structResults.forEach(([doc, score])=>{\n                    results.push({\n                        type: \"structure\",\n                        id: doc.metadata.id || `struct_${Date.now()}`,\n                        content: doc.pageContent,\n                        score: 1 - score / 2,\n                        metadata: doc.metadata\n                    });\n                });\n            } catch (error) {\n            // Structure collection might not exist yet - skip\n            }\n            // Sort by score and return top results\n            return results.sort((a, b)=>b.score - a.score).slice(0, nResults);\n        } catch (error) {\n            console.error(\"❌ Failed to search project:\", error);\n            return [];\n        }\n    }\n    // Get project statistics\n    async getProjectStats(projectId) {\n        try {\n            const stats = {\n                project_id: projectId,\n                total_chunks: 0,\n                code_chunks: this.chunkCounts.get(STORAGE_KEYS.PROJECT_CODE(projectId)) || 0,\n                prompt_chunks: this.chunkCounts.get(STORAGE_KEYS.PROJECT_PROMPTS(projectId)) || 0,\n                structure_chunks: this.chunkCounts.get(STORAGE_KEYS.PROJECT_STRUCTURE(projectId)) || 0,\n                dependency_chunks: 0,\n                created_at: new Date().toISOString(),\n                last_updated: new Date().toISOString()\n            };\n            stats.total_chunks = stats.code_chunks + stats.prompt_chunks + stats.structure_chunks;\n            return stats;\n        } catch (error) {\n            console.error(\"❌ Failed to get project stats:\", error);\n            return null;\n        }\n    }\n    // Delete project collections\n    async deleteProject(projectId) {\n        try {\n            // Remove stores from memory\n            this.store.delete(STORAGE_KEYS.PROJECT_CODE(projectId));\n            this.store.delete(STORAGE_KEYS.PROJECT_PROMPTS(projectId));\n            this.store.delete(STORAGE_KEYS.PROJECT_STRUCTURE(projectId));\n            // Remove counts\n            this.chunkCounts.delete(STORAGE_KEYS.PROJECT_CODE(projectId));\n            this.chunkCounts.delete(STORAGE_KEYS.PROJECT_PROMPTS(projectId));\n            this.chunkCounts.delete(STORAGE_KEYS.PROJECT_STRUCTURE(projectId));\n            console.log(`🗑️ Deleted ChromaDB collections for project: ${projectId}`);\n        } catch (error) {\n            console.error(\"❌ Failed to delete project:\", error);\n            throw error;\n        }\n    }\n    // Health check (ChromaDB via LangChain is always available)\n    async healthCheck() {\n        try {\n            // LangChain handles ChromaDB connection internally\n            // Simple check - verify embeddings are working\n            await this.embeddings.embedQuery(\"test\");\n            return true;\n        } catch (error) {\n            console.error(\"❌ ChromaDB health check failed:\", error);\n            return false;\n        }\n    }\n}\n// Backward compatibility - rename class to ChromaDBManager for existing imports\nconst ChromaDBManager = VectorStoreManager;\n// Export singleton instance\nconst chromaManager = new VectorStoreManager();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (chromaManager);\n// Utility functions\nfunction generateChunkId(projectId, filename, lines, type) {\n    return `${projectId}_${filename}_${lines[0]}-${lines[1]}_${type}_${Date.now()}`;\n}\nfunction generatePromptId(projectId, sessionId, messageIndex) {\n    return `${projectId}_${sessionId}_prompt_${messageIndex}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvY2hyb21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBdUU7QUFDTDtBQUNiO0FBRXJELDZGQUE2RjtBQUM3RixNQUFNRztJQUtKQyxZQUFZQyxjQUFzQixFQUFFQyxVQUF3QyxDQUFFO2FBSnRFQyxjQUE2QjtRQUtuQyxJQUFJLENBQUNGLGNBQWMsR0FBR0E7UUFDdEIsSUFBSSxDQUFDQyxVQUFVLEdBQUdBO0lBQ3BCO0lBRUEsTUFBY0Usb0JBQXFDO1FBQ2pELElBQUksQ0FBQyxJQUFJLENBQUNELFdBQVcsRUFBRTtZQUNyQixJQUFJO2dCQUNGLGtDQUFrQztnQkFDbEMsSUFBSSxDQUFDQSxXQUFXLEdBQUcsTUFBTU4sNEVBQU1BLENBQUNRLHNCQUFzQixDQUNwRCxJQUFJLENBQUNILFVBQVUsRUFDZjtvQkFBRUQsZ0JBQWdCLElBQUksQ0FBQ0EsY0FBYztnQkFBQztnQkFFeENLLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHVDQUF1QyxFQUFFLElBQUksQ0FBQ04sY0FBYyxDQUFDLENBQUM7WUFDN0UsRUFBRSxPQUFPTyxPQUFPO2dCQUNkLDJDQUEyQztnQkFDM0MsSUFBSSxDQUFDTCxXQUFXLEdBQUcsSUFBSU4sNEVBQU1BLENBQUMsSUFBSSxDQUFDSyxVQUFVLEVBQUU7b0JBQzdDRCxnQkFBZ0IsSUFBSSxDQUFDQSxjQUFjO29CQUNuQ1EsS0FBSyx3QkFBd0IsOEJBQThCO2dCQUM3RDtnQkFDQUgsUUFBUUMsR0FBRyxDQUFDLENBQUMsbUNBQW1DLEVBQUUsSUFBSSxDQUFDTixjQUFjLENBQUMsQ0FBQztZQUN6RTtRQUNGO1FBQ0EsT0FBTyxJQUFJLENBQUNFLFdBQVc7SUFDekI7SUFFQSxNQUFNTyxhQUFhQyxJQUFvRCxFQUFFO1FBQ3ZFLElBQUlBLEtBQUtDLE1BQU0sS0FBSyxHQUFHO1FBRXZCLE1BQU1ULGNBQWMsTUFBTSxJQUFJLENBQUNDLGlCQUFpQjtRQUVoRCxpQ0FBaUM7UUFDakMsTUFBTVMsWUFBWUYsS0FBS0csR0FBRyxDQUFDQyxDQUFBQSxNQUN6QixJQUFJakIsK0RBQVFBLENBQUM7Z0JBQ1hrQixhQUFhRCxJQUFJQyxXQUFXO2dCQUM1QkMsVUFBVUYsSUFBSUUsUUFBUSxJQUFJLENBQUM7WUFDN0I7UUFHRixnQ0FBZ0M7UUFDaEMsTUFBTWQsWUFBWU8sWUFBWSxDQUFDRztRQUMvQlAsUUFBUUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFSSxLQUFLQyxNQUFNLENBQUMsbUNBQW1DLEVBQUUsSUFBSSxDQUFDWCxjQUFjLENBQUMsQ0FBQztJQUMvRjtJQUVBLE1BQU1pQiwwQkFBMEJDLEtBQWEsRUFBRUMsSUFBWSxDQUFDLEVBQXNDO1FBQ2hHLE1BQU1qQixjQUFjLE1BQU0sSUFBSSxDQUFDQyxpQkFBaUI7UUFFaEQsZ0RBQWdEO1FBQ2hELE1BQU1pQixVQUFVLE1BQU1sQixZQUFZZSx5QkFBeUIsQ0FBQ0MsT0FBT0M7UUFFbkVkLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRWMsUUFBUVQsTUFBTSxDQUFDLDRCQUE0QixDQUFDO1FBRW5FLE9BQU9TO0lBQ1Q7QUFDRjtBQWdEQSxnQkFBZ0I7QUFDaEIsTUFBTUMsa0JBQWtCO0FBQ3hCLE1BQU1DLHVCQUF1QixNQUFNLHFDQUFxQzs7QUFFeEUsOENBQThDO1VBQ3pDQzs7O0dBQUFBLDBCQUFBQTtBQUtMLHFEQUFxRDtBQUNyRCxNQUFNQztBQUVOLHVCQUF1QjtBQUN2QixNQUFNQyxlQUFlO0lBQ25CQyxjQUFjLENBQUNDLFlBQXNCLENBQUMsUUFBUSxFQUFFQSxVQUFVLEtBQUssQ0FBQztJQUNoRUMsaUJBQWlCLENBQUNELFlBQXNCLENBQUMsUUFBUSxFQUFFQSxVQUFVLFFBQVEsQ0FBQztJQUN0RUUsbUJBQW1CLENBQUNGLFlBQXNCLENBQUMsUUFBUSxFQUFFQSxVQUFVLFVBQVUsQ0FBQztBQUM1RTtBQUVBLDREQUE0RDtBQUM1RCxNQUFNRztJQUtKL0IsYUFBYzthQUpOZ0MsUUFBd0MsSUFBSUM7YUFDNUNDLGNBQW1DLElBQUlEO1FBSTdDLDJFQUEyRTtRQUMzRSxJQUFJLENBQUMvQixVQUFVLEdBQUcsSUFBSU4saUZBQTRCQSxDQUFDO1lBQ2pEdUMsV0FBVztZQUNYQyxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGNBQWMsSUFBSUYsUUFBUUMsR0FBRyxDQUFDRSxjQUFjO1FBQ2xFO0lBQ0Y7SUFFQSw0REFBNEQ7SUFDNUQsTUFBY0MsZ0JBQWdCeEMsY0FBc0IsRUFBOEI7UUFDaEYsSUFBSSxDQUFDLElBQUksQ0FBQytCLEtBQUssQ0FBQ1UsR0FBRyxDQUFDekMsaUJBQWlCO1lBQ25DLElBQUksQ0FBQytCLEtBQUssQ0FBQ1csR0FBRyxDQUFDMUMsZ0JBQWdCLElBQUlGLGtCQUFrQkUsZ0JBQWdCLElBQUksQ0FBQ0MsVUFBVTtRQUN0RjtRQUNBLE9BQU8sSUFBSSxDQUFDOEIsS0FBSyxDQUFDWSxHQUFHLENBQUMzQztJQUN4QjtJQUVBLDZFQUE2RTtJQUM3RSxNQUFNNEMsNkJBQTZCakIsU0FBaUIsRUFBaUI7UUFDbkV0QixRQUFRQyxHQUFHLENBQUMsQ0FBQyxnREFBZ0QsRUFBRXFCLFVBQVUsQ0FBQztJQUMxRSx5Q0FBeUM7SUFDM0M7SUFFQSx1Q0FBdUM7SUFDdkMsTUFBTWtCLG1CQUFtQkMsS0FBZSxFQUF1QjtRQUM3RCxJQUFJO1lBQ0YsTUFBTTdDLGFBQWEsTUFBTSxJQUFJLENBQUNBLFVBQVUsQ0FBQzhDLGNBQWMsQ0FBQ0Q7WUFDeEQsT0FBTzdDO1FBQ1QsRUFBRSxPQUFPTSxPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQyxvQ0FBb0NBO1lBQ2xELE1BQU1BO1FBQ1I7SUFDRjtJQUVBLHdDQUF3QztJQUN4QyxNQUFNeUMsY0FBY3JCLFNBQWlCLEVBQUVzQixNQUFtQixFQUFpQjtRQUN6RSxJQUFJO1lBQ0YsSUFBSUEsT0FBT3RDLE1BQU0sS0FBSyxHQUFHO1lBRXpCLE1BQU1YLGlCQUFpQnlCLGFBQWFDLFlBQVksQ0FBQ0M7WUFDakQsTUFBTUksUUFBUSxNQUFNLElBQUksQ0FBQ1MsZUFBZSxDQUFDeEM7WUFFekMsNkJBQTZCO1lBQzdCLE1BQU0rQixNQUFNdEIsWUFBWSxDQUN0QndDLE9BQU9wQyxHQUFHLENBQUNxQyxDQUFBQSxRQUFVO29CQUNuQm5DLGFBQWFtQyxNQUFNQyxPQUFPO29CQUMxQm5DLFVBQVVrQyxNQUFNbEMsUUFBUTtnQkFDMUI7WUFHRixjQUFjO1lBQ2QsSUFBSSxDQUFDaUIsV0FBVyxDQUFDUyxHQUFHLENBQUMxQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUNpQyxXQUFXLENBQUNVLEdBQUcsQ0FBQzNDLG1CQUFtQixLQUFLaUQsT0FBT3RDLE1BQU07WUFDaEdOLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRTJDLE9BQU90QyxNQUFNLENBQUMsd0JBQXdCLEVBQUVnQixVQUFVLGNBQWMsRUFBRTNCLGVBQWUsQ0FBQyxDQUFDO1FBQzVHLEVBQUUsT0FBT08sT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsZ0NBQWdDQTtZQUM5QyxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSwwQ0FBMEM7SUFDMUMsTUFBTTZDLGdCQUFnQnpCLFNBQWlCLEVBQUVzQixNQUl2QyxFQUFpQjtRQUNqQixJQUFJO1lBQ0YsSUFBSUEsT0FBT3RDLE1BQU0sS0FBSyxHQUFHO1lBRXpCLE1BQU1YLGlCQUFpQnlCLGFBQWFHLGVBQWUsQ0FBQ0Q7WUFDcEQsTUFBTUksUUFBUSxNQUFNLElBQUksQ0FBQ1MsZUFBZSxDQUFDeEM7WUFFekMsNkJBQTZCO1lBQzdCLE1BQU0rQixNQUFNdEIsWUFBWSxDQUN0QndDLE9BQU9wQyxHQUFHLENBQUNxQyxDQUFBQSxRQUFVO29CQUNuQm5DLGFBQWFtQyxNQUFNQyxPQUFPO29CQUMxQm5DLFVBQVVrQyxNQUFNbEMsUUFBUTtnQkFDMUI7WUFHRixjQUFjO1lBQ2QsSUFBSSxDQUFDaUIsV0FBVyxDQUFDUyxHQUFHLENBQUMxQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUNpQyxXQUFXLENBQUNVLEdBQUcsQ0FBQzNDLG1CQUFtQixLQUFLaUQsT0FBT3RDLE1BQU07WUFDaEdOLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRTJDLE9BQU90QyxNQUFNLENBQUMsMEJBQTBCLEVBQUVnQixVQUFVLENBQUM7UUFDL0UsRUFBRSxPQUFPcEIsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsa0NBQWtDQTtZQUNoRCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxtQ0FBbUM7SUFDbkMsTUFBTThDLG1CQUFtQjFCLFNBQWlCLEVBQUVzQixNQUkxQyxFQUFpQjtRQUNqQixJQUFJO1lBQ0YsSUFBSUEsT0FBT3RDLE1BQU0sS0FBSyxHQUFHO1lBRXpCLE1BQU1YLGlCQUFpQnlCLGFBQWFJLGlCQUFpQixDQUFDRjtZQUN0RCxNQUFNSSxRQUFRLE1BQU0sSUFBSSxDQUFDUyxlQUFlLENBQUN4QztZQUV6Qyw2QkFBNkI7WUFDN0IsTUFBTStCLE1BQU10QixZQUFZLENBQ3RCd0MsT0FBT3BDLEdBQUcsQ0FBQ3FDLENBQUFBLFFBQVU7b0JBQ25CbkMsYUFBYW1DLE1BQU1DLE9BQU87b0JBQzFCbkMsVUFBVWtDLE1BQU1sQyxRQUFRO2dCQUMxQjtZQUdGLGNBQWM7WUFDZCxJQUFJLENBQUNpQixXQUFXLENBQUNTLEdBQUcsQ0FBQzFDLGdCQUFnQixDQUFDLElBQUksQ0FBQ2lDLFdBQVcsQ0FBQ1UsR0FBRyxDQUFDM0MsbUJBQW1CLEtBQUtpRCxPQUFPdEMsTUFBTTtZQUNoR04sUUFBUUMsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFMkMsT0FBT3RDLE1BQU0sQ0FBQyw2QkFBNkIsRUFBRWdCLFVBQVUsQ0FBQztRQUNuRixFQUFFLE9BQU9wQixPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQyxxQ0FBcUNBO1lBQ25ELE1BQU1BO1FBQ1I7SUFDRjtJQUVBLG1DQUFtQztJQUNuQyxNQUFNK0MsV0FBVzNCLFNBQWlCLEVBQUVULEtBQWEsRUFBRXFDLFdBQW1CLENBQUMsRUFLbkU7UUFDRixJQUFJO1lBQ0YsTUFBTXZELGlCQUFpQnlCLGFBQWFDLFlBQVksQ0FBQ0M7WUFDakQsTUFBTUksUUFBUSxNQUFNLElBQUksQ0FBQ1MsZUFBZSxDQUFDeEM7WUFFekMsTUFBTW9CLFVBQVUsTUFBTVcsTUFBTWQseUJBQXlCLENBQUNDLE9BQU9xQztZQUU3RCxPQUFPbkMsUUFBUVAsR0FBRyxDQUFDLENBQUMsQ0FBQ0MsS0FBSzBDLE1BQXFCLEdBQU07b0JBQ25EQyxJQUFJM0MsSUFBSUUsUUFBUSxDQUFDeUMsRUFBRSxJQUFjLENBQUMsT0FBTyxFQUFFQyxLQUFLQyxHQUFHLEdBQUcsQ0FBQztvQkFDdkRSLFNBQVNyQyxJQUFJQyxXQUFXO29CQUN4QnlDLE9BQU8sSUFBS0EsUUFBUTtvQkFDcEJ4QyxVQUFVRixJQUFJRSxRQUFRO2dCQUN4QjtRQUNGLEVBQUUsT0FBT1QsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsNEJBQTRCQTtZQUMxQyxPQUFPLEVBQUU7UUFDWDtJQUNGO0lBRUEsd0NBQXdDO0lBQ3hDLE1BQU1xRCxjQUFjakMsU0FBaUIsRUFBRVQsS0FBYSxFQUFFcUMsV0FBbUIsRUFBRSxFQU12RTtRQUNGLElBQUk7WUFDRixNQUFNbkMsVUFNRCxFQUFFO1lBRVAseUJBQXlCO1lBQ3pCLE1BQU15QyxjQUFjLE1BQU0sSUFBSSxDQUFDUCxVQUFVLENBQUMzQixXQUFXVCxPQUFPcUM7WUFDNURuQyxRQUFRMEMsSUFBSSxJQUFJRCxZQUFZaEQsR0FBRyxDQUFDa0QsQ0FBQUEsSUFBTTtvQkFBRSxHQUFHQSxDQUFDO29CQUFFQyxNQUFNO2dCQUFnQjtZQUVwRSw0QkFBNEI7WUFDNUIsSUFBSTtnQkFDRixNQUFNQyx3QkFBd0J4QyxhQUFhRyxlQUFlLENBQUNEO2dCQUMzRCxNQUFNdUMsZUFBZSxNQUFNLElBQUksQ0FBQzFCLGVBQWUsQ0FBQ3lCO2dCQUNoRCxNQUFNRSxpQkFBaUIsTUFBTUQsYUFBYWpELHlCQUF5QixDQUFDQyxPQUFPa0QsS0FBS0MsSUFBSSxDQUFDZCxXQUFXO2dCQUVoR1ksZUFBZUcsT0FBTyxDQUFDLENBQUMsQ0FBQ3hELEtBQUswQyxNQUFxQjtvQkFDakRwQyxRQUFRMEMsSUFBSSxDQUFDO3dCQUNYRSxNQUFNO3dCQUNOUCxJQUFJM0MsSUFBSUUsUUFBUSxDQUFDeUMsRUFBRSxJQUFjLENBQUMsT0FBTyxFQUFFQyxLQUFLQyxHQUFHLEdBQUcsQ0FBQzt3QkFDdkRSLFNBQVNyQyxJQUFJQyxXQUFXO3dCQUN4QnlDLE9BQU8sSUFBS0EsUUFBUTt3QkFDcEJ4QyxVQUFVRixJQUFJRSxRQUFRO29CQUN4QjtnQkFDRjtZQUNGLEVBQUUsT0FBT1QsT0FBTztZQUNkLGdEQUFnRDtZQUNsRDtZQUVBLDhCQUE4QjtZQUM5QixJQUFJO2dCQUNGLE1BQU1nRSx1QkFBdUI5QyxhQUFhSSxpQkFBaUIsQ0FBQ0Y7Z0JBQzVELE1BQU02QyxjQUFjLE1BQU0sSUFBSSxDQUFDaEMsZUFBZSxDQUFDK0I7Z0JBQy9DLE1BQU1FLGdCQUFnQixNQUFNRCxZQUFZdkQseUJBQXlCLENBQUNDLE9BQU9rRCxLQUFLQyxJQUFJLENBQUNkLFdBQVc7Z0JBRTlGa0IsY0FBY0gsT0FBTyxDQUFDLENBQUMsQ0FBQ3hELEtBQUswQyxNQUFxQjtvQkFDaERwQyxRQUFRMEMsSUFBSSxDQUFDO3dCQUNYRSxNQUFNO3dCQUNOUCxJQUFJM0MsSUFBSUUsUUFBUSxDQUFDeUMsRUFBRSxJQUFjLENBQUMsT0FBTyxFQUFFQyxLQUFLQyxHQUFHLEdBQUcsQ0FBQzt3QkFDdkRSLFNBQVNyQyxJQUFJQyxXQUFXO3dCQUN4QnlDLE9BQU8sSUFBS0EsUUFBUTt3QkFDcEJ4QyxVQUFVRixJQUFJRSxRQUFRO29CQUN4QjtnQkFDRjtZQUNGLEVBQUUsT0FBT1QsT0FBTztZQUNkLGtEQUFrRDtZQUNwRDtZQUVBLHVDQUF1QztZQUN2QyxPQUFPYSxRQUFRc0QsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1BLEVBQUVwQixLQUFLLEdBQUdtQixFQUFFbkIsS0FBSyxFQUFFcUIsS0FBSyxDQUFDLEdBQUd0QjtRQUM1RCxFQUFFLE9BQU9oRCxPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQywrQkFBK0JBO1lBQzdDLE9BQU8sRUFBRTtRQUNYO0lBQ0Y7SUFFQSx5QkFBeUI7SUFDekIsTUFBTXVFLGdCQUFnQm5ELFNBQWlCLEVBQXFDO1FBQzFFLElBQUk7WUFDRixNQUFNb0QsUUFBMkI7Z0JBQy9CQyxZQUFZckQ7Z0JBQ1pzRCxjQUFjO2dCQUNkQyxhQUFhLElBQUksQ0FBQ2pELFdBQVcsQ0FBQ1UsR0FBRyxDQUFDbEIsYUFBYUMsWUFBWSxDQUFDQyxlQUFlO2dCQUMzRXdELGVBQWUsSUFBSSxDQUFDbEQsV0FBVyxDQUFDVSxHQUFHLENBQUNsQixhQUFhRyxlQUFlLENBQUNELGVBQWU7Z0JBQ2hGeUQsa0JBQWtCLElBQUksQ0FBQ25ELFdBQVcsQ0FBQ1UsR0FBRyxDQUFDbEIsYUFBYUksaUJBQWlCLENBQUNGLGVBQWU7Z0JBQ3JGMEQsbUJBQW1CO2dCQUNuQkMsWUFBWSxJQUFJNUIsT0FBTzZCLFdBQVc7Z0JBQ2xDQyxjQUFjLElBQUk5QixPQUFPNkIsV0FBVztZQUN0QztZQUVBUixNQUFNRSxZQUFZLEdBQUdGLE1BQU1HLFdBQVcsR0FBR0gsTUFBTUksYUFBYSxHQUFHSixNQUFNSyxnQkFBZ0I7WUFDckYsT0FBT0w7UUFDVCxFQUFFLE9BQU94RSxPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQyxrQ0FBa0NBO1lBQ2hELE9BQU87UUFDVDtJQUNGO0lBRUEsNkJBQTZCO0lBQzdCLE1BQU1rRixjQUFjOUQsU0FBaUIsRUFBaUI7UUFDcEQsSUFBSTtZQUNGLDRCQUE0QjtZQUM1QixJQUFJLENBQUNJLEtBQUssQ0FBQzJELE1BQU0sQ0FBQ2pFLGFBQWFDLFlBQVksQ0FBQ0M7WUFDNUMsSUFBSSxDQUFDSSxLQUFLLENBQUMyRCxNQUFNLENBQUNqRSxhQUFhRyxlQUFlLENBQUNEO1lBQy9DLElBQUksQ0FBQ0ksS0FBSyxDQUFDMkQsTUFBTSxDQUFDakUsYUFBYUksaUJBQWlCLENBQUNGO1lBRWpELGdCQUFnQjtZQUNoQixJQUFJLENBQUNNLFdBQVcsQ0FBQ3lELE1BQU0sQ0FBQ2pFLGFBQWFDLFlBQVksQ0FBQ0M7WUFDbEQsSUFBSSxDQUFDTSxXQUFXLENBQUN5RCxNQUFNLENBQUNqRSxhQUFhRyxlQUFlLENBQUNEO1lBQ3JELElBQUksQ0FBQ00sV0FBVyxDQUFDeUQsTUFBTSxDQUFDakUsYUFBYUksaUJBQWlCLENBQUNGO1lBRXZEdEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsOENBQThDLEVBQUVxQixVQUFVLENBQUM7UUFDMUUsRUFBRSxPQUFPcEIsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsK0JBQStCQTtZQUM3QyxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSw0REFBNEQ7SUFDNUQsTUFBTW9GLGNBQWdDO1FBQ3BDLElBQUk7WUFDRixtREFBbUQ7WUFDbkQsK0NBQStDO1lBQy9DLE1BQU0sSUFBSSxDQUFDMUYsVUFBVSxDQUFDMkYsVUFBVSxDQUFDO1lBQ2pDLE9BQU87UUFDVCxFQUFFLE9BQU9yRixPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQyxtQ0FBbUNBO1lBQ2pELE9BQU87UUFDVDtJQUNGO0FBQ0Y7QUFFQSxnRkFBZ0Y7QUFDaEYsTUFBTXNGLGtCQUFrQi9EO0FBRXhCLDRCQUE0QjtBQUNyQixNQUFNZ0UsZ0JBQWdCLElBQUloRSxxQkFBcUI7QUFDdEQsaUVBQWVnRSxhQUFhQSxFQUFDO0FBRTdCLG9CQUFvQjtBQUNiLFNBQVNDLGdCQUFnQnBFLFNBQWlCLEVBQUVxRSxRQUFnQixFQUFFQyxLQUF1QixFQUFFakMsSUFBWTtJQUN4RyxPQUFPLENBQUMsRUFBRXJDLFVBQVUsQ0FBQyxFQUFFcUUsU0FBUyxDQUFDLEVBQUVDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFQSxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRWpDLEtBQUssQ0FBQyxFQUFFTixLQUFLQyxHQUFHLEdBQUcsQ0FBQztBQUNqRjtBQUVPLFNBQVN1QyxpQkFBaUJ2RSxTQUFpQixFQUFFd0UsU0FBaUIsRUFBRUMsWUFBb0I7SUFDekYsT0FBTyxDQUFDLEVBQUV6RSxVQUFVLENBQUMsRUFBRXdFLFVBQVUsUUFBUSxFQUFFQyxhQUFhLENBQUM7QUFDM0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi9kYi9jaHJvbWEudHM/N2RmZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdzIH0gZnJvbSAnQGxhbmdjaGFpbi9nb29nbGUtZ2VuYWknO1xuaW1wb3J0IHsgQ2hyb21hIH0gZnJvbSAnQGxhbmdjaGFpbi9jb21tdW5pdHkvdmVjdG9yc3RvcmVzL2Nocm9tYSc7XG5pbXBvcnQgeyBEb2N1bWVudCB9IGZyb20gJ0BsYW5nY2hhaW4vY29yZS9kb2N1bWVudHMnO1xuXG4vLyBDaHJvbWFEQi1iYXNlZCB2ZWN0b3Igc3RvcmUgaW1wbGVtZW50YXRpb24gdXNpbmcgTGFuZ0NoYWluIGZvciBlZmZpY2llbnQgc2ltaWxhcml0eSBzZWFyY2hcbmNsYXNzIENocm9tYVZlY3RvclN0b3JlIHtcbiAgcHJpdmF0ZSB2ZWN0b3JTdG9yZTogQ2hyb21hIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgY29sbGVjdGlvbk5hbWU6IHN0cmluZztcbiAgcHJpdmF0ZSBlbWJlZGRpbmdzOiBHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdzO1xuXG4gIGNvbnN0cnVjdG9yKGNvbGxlY3Rpb25OYW1lOiBzdHJpbmcsIGVtYmVkZGluZ3M6IEdvb2dsZUdlbmVyYXRpdmVBSUVtYmVkZGluZ3MpIHtcbiAgICB0aGlzLmNvbGxlY3Rpb25OYW1lID0gY29sbGVjdGlvbk5hbWU7XG4gICAgdGhpcy5lbWJlZGRpbmdzID0gZW1iZWRkaW5ncztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZW5zdXJlVmVjdG9yU3RvcmUoKTogUHJvbWlzZTxDaHJvbWE+IHtcbiAgICBpZiAoIXRoaXMudmVjdG9yU3RvcmUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFRyeSB0byBsb2FkIGV4aXN0aW5nIGNvbGxlY3Rpb25cbiAgICAgICAgdGhpcy52ZWN0b3JTdG9yZSA9IGF3YWl0IENocm9tYS5mcm9tRXhpc3RpbmdDb2xsZWN0aW9uKFxuICAgICAgICAgIHRoaXMuZW1iZWRkaW5ncyxcbiAgICAgICAgICB7IGNvbGxlY3Rpb25OYW1lOiB0aGlzLmNvbGxlY3Rpb25OYW1lIH1cbiAgICAgICAgKTtcbiAgICAgICAgY29uc29sZS5sb2coYOKchSBMb2FkZWQgZXhpc3RpbmcgQ2hyb21hREIgY29sbGVjdGlvbjogJHt0aGlzLmNvbGxlY3Rpb25OYW1lfWApO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gQ29sbGVjdGlvbiBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgbmV3IG9uZVxuICAgICAgICB0aGlzLnZlY3RvclN0b3JlID0gbmV3IENocm9tYSh0aGlzLmVtYmVkZGluZ3MsIHtcbiAgICAgICAgICBjb2xsZWN0aW9uTmFtZTogdGhpcy5jb2xsZWN0aW9uTmFtZSxcbiAgICAgICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDo4MDAwXCIgLy8gRGVmYXVsdCBDaHJvbWFEQiBzZXJ2ZXIgVVJMXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhg4pyFIENyZWF0ZWQgbmV3IENocm9tYURCIGNvbGxlY3Rpb246ICR7dGhpcy5jb2xsZWN0aW9uTmFtZX1gKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudmVjdG9yU3RvcmU7XG4gIH1cblxuICBhc3luYyBhZGREb2N1bWVudHMoZG9jczogQXJyYXk8eyBwYWdlQ29udGVudDogc3RyaW5nOyBtZXRhZGF0YT86IGFueSB9Pikge1xuICAgIGlmIChkb2NzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgdmVjdG9yU3RvcmUgPSBhd2FpdCB0aGlzLmVuc3VyZVZlY3RvclN0b3JlKCk7XG5cbiAgICAvLyBDb252ZXJ0IHRvIExhbmdDaGFpbiBkb2N1bWVudHNcbiAgICBjb25zdCBkb2N1bWVudHMgPSBkb2NzLm1hcChkb2MgPT5cbiAgICAgIG5ldyBEb2N1bWVudCh7XG4gICAgICAgIHBhZ2VDb250ZW50OiBkb2MucGFnZUNvbnRlbnQsXG4gICAgICAgIG1ldGFkYXRhOiBkb2MubWV0YWRhdGEgfHwge31cbiAgICAgIH0pXG4gICAgKTtcblxuICAgIC8vIEFkZCBkb2N1bWVudHMgdG8gdmVjdG9yIHN0b3JlXG4gICAgYXdhaXQgdmVjdG9yU3RvcmUuYWRkRG9jdW1lbnRzKGRvY3VtZW50cyk7XG4gICAgY29uc29sZS5sb2coYOKchSBBZGRlZCAke2RvY3MubGVuZ3RofSBkb2N1bWVudHMgdG8gQ2hyb21hREIgY29sbGVjdGlvbjogJHt0aGlzLmNvbGxlY3Rpb25OYW1lfWApO1xuICB9XG5cbiAgYXN5bmMgc2ltaWxhcml0eVNlYXJjaFdpdGhTY29yZShxdWVyeTogc3RyaW5nLCBrOiBudW1iZXIgPSA1KTogUHJvbWlzZTxBcnJheTxbRG9jdW1lbnQsIG51bWJlcl0+PiB7XG4gICAgY29uc3QgdmVjdG9yU3RvcmUgPSBhd2FpdCB0aGlzLmVuc3VyZVZlY3RvclN0b3JlKCk7XG5cbiAgICAvLyBVc2UgTGFuZ0NoYWluJ3Mgc2ltaWxhcml0eSBzZWFyY2ggd2l0aCBzY29yZXNcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgdmVjdG9yU3RvcmUuc2ltaWxhcml0eVNlYXJjaFdpdGhTY29yZShxdWVyeSwgayk7XG5cbiAgICBjb25zb2xlLmxvZyhg4pyFIEZvdW5kICR7cmVzdWx0cy5sZW5ndGh9IHJlc3VsdHMgZnJvbSBDaHJvbWFEQiBxdWVyeWApO1xuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cbn1cblxuLy8gRmxleGlibGUgbWV0YWRhdGEgdHlwZSBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAtIHN1cHBvcnRzIGJvdGggQ2hyb21hREIgYW5kIG5ldyBmb3JtYXRzXG5leHBvcnQgdHlwZSBWZWN0b3JNZXRhZGF0YSA9IHtcbiAgLy8gQ29tbW9uIGZpZWxkc1xuICBwcm9qZWN0X2lkPzogc3RyaW5nO1xuICB0eXBlPzogJ2NvZGUnIHwgJ3Byb21wdCcgfCAnc3RydWN0dXJlJyB8ICdkZXBlbmRlbmN5JztcbiAgdGltZXN0YW1wPzogc3RyaW5nO1xuICBpZD86IHN0cmluZztcblxuICAvLyBDb2RlLXNwZWNpZmljIGZpZWxkc1xuICBmaWxlbmFtZT86IHN0cmluZztcbiAgbGFuZ3VhZ2U/OiBzdHJpbmc7XG4gIGxpbmVzX3N0YXJ0PzogbnVtYmVyO1xuICBsaW5lc19lbmQ/OiBudW1iZXI7XG4gIGRlcGVuZGVuY2llcz86IHN0cmluZyB8IG51bGw7XG4gIHBhcmVudF9mdW5jdGlvbnM/OiBzdHJpbmcgfCBudWxsO1xuICBjb250ZW50X2hhc2g/OiBzdHJpbmc7XG5cbiAgLy8gUHJvbXB0LXNwZWNpZmljIGZpZWxkc1xuICBzZXNzaW9uX2lkPzogc3RyaW5nO1xuICBtZXNzYWdlX2luZGV4PzogbnVtYmVyO1xuICByb2xlPzogc3RyaW5nO1xuXG4gIC8vIEFsbG93IGFkZGl0aW9uYWwgcHJvcGVydGllcyBmb3IgZmxleGliaWxpdHlcbiAgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IG51bGwgfCB1bmRlZmluZWQ7XG59O1xuXG4vLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IGFsaWFzXG5leHBvcnQgdHlwZSBDaHJvbWFNZXRhZGF0YSA9IFZlY3Rvck1ldGFkYXRhO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvZGVDaHVuayB7XG4gIGlkOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgbWV0YWRhdGE6IFZlY3Rvck1ldGFkYXRhO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByb2plY3RFbWJlZGRpbmdzIHtcbiAgcHJvamVjdF9pZDogc3RyaW5nO1xuICB0b3RhbF9jaHVua3M6IG51bWJlcjtcbiAgY29kZV9jaHVua3M6IG51bWJlcjtcbiAgcHJvbXB0X2NodW5rczogbnVtYmVyO1xuICBzdHJ1Y3R1cmVfY2h1bmtzOiBudW1iZXI7XG4gIGRlcGVuZGVuY3lfY2h1bmtzOiBudW1iZXI7XG4gIGNyZWF0ZWRfYXQ6IHN0cmluZztcbiAgbGFzdF91cGRhdGVkOiBzdHJpbmc7XG59XG5cbi8vIENvbmZpZ3VyYXRpb25cbmNvbnN0IEVNQkVERElOR19NT0RFTCA9ICd0ZXh0LWVtYmVkZGluZy0wMDQnO1xuY29uc3QgRU1CRURESU5HX0RJTUVOU0lPTlMgPSAzMDcyOyAvLyBHb29nbGUgR2VtaW5pIGVtYmVkZGluZyBkaW1lbnNpb25zXG5cbi8vIFN0b3JhZ2UgcHJvdmlkZXIgZW51bSBmb3IgZnV0dXJlIGV4dGVuc2lvbnNcbmVudW0gVmVjdG9yU3RvcmFnZVByb3ZpZGVyIHtcbiAgQ0hST01BID0gJ2Nocm9tYScsICAgICAgLy8gVXNlIENocm9tYURCIChjdXJyZW50IHByaW1hcnkpXG4gIE1FTU9SWSA9ICdtZW1vcnknLCAgICAgIC8vIFVzZSBpbi1tZW1vcnkgZmFsbGJhY2sgKGZ1dHVyZSlcbn1cblxuLy8gQ3VycmVudCBzdG9yYWdlIHByb3ZpZGVyIC0gQ2hyb21hREIgaXMgbm93IHByaW1hcnlcbmNvbnN0IENVUlJFTlRfU1RPUkFHRV9QUk9WSURFUiA9IFZlY3RvclN0b3JhZ2VQcm92aWRlci5DSFJPTUE7XG5cbi8vIFByb2plY3Qgc3RvcmFnZSBrZXlzXG5jb25zdCBTVE9SQUdFX0tFWVMgPSB7XG4gIFBST0pFQ1RfQ09ERTogKHByb2plY3RJZDogc3RyaW5nKSA9PiBgcHJvamVjdF8ke3Byb2plY3RJZH1fY29kZWAsXG4gIFBST0pFQ1RfUFJPTVBUUzogKHByb2plY3RJZDogc3RyaW5nKSA9PiBgcHJvamVjdF8ke3Byb2plY3RJZH1fcHJvbXB0c2AsXG4gIFBST0pFQ1RfU1RSVUNUVVJFOiAocHJvamVjdElkOiBzdHJpbmcpID0+IGBwcm9qZWN0XyR7cHJvamVjdElkfV9zdHJ1Y3R1cmVgLFxufTtcblxuLy8gVW5pZmllZCBWZWN0b3IgU3RvcmUgTWFuYWdlciB3aXRoIENocm9tYURCIGltcGxlbWVudGF0aW9uXG5jbGFzcyBWZWN0b3JTdG9yZU1hbmFnZXIge1xuICBwcml2YXRlIHN0b3JlOiBNYXA8c3RyaW5nLCBDaHJvbWFWZWN0b3JTdG9yZT4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgY2h1bmtDb3VudHM6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgZW1iZWRkaW5nczogR29vZ2xlR2VuZXJhdGl2ZUFJRW1iZWRkaW5ncztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBVc2UgTGFuZ0NoYWluJ3MgR29vZ2xlIEdlbmVyYXRpdmUgQUkgZW1iZWRkaW5ncyAtIEdlbWluaSAzMDcyIGRpbWVuc2lvbnNcbiAgICB0aGlzLmVtYmVkZGluZ3MgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJRW1iZWRkaW5ncyh7XG4gICAgICBtb2RlbE5hbWU6ICd0ZXh0LWVtYmVkZGluZy0wMDQnLFxuICAgICAgYXBpS2V5OiBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWSB8fCBwcm9jZXNzLmVudi5HT09HTEVfQVBJX0tFWSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEdldCBvciBjcmVhdGUgYSBwcm9qZWN0IGNvbGxlY3Rpb24gKENocm9tYURCIGNvbGxlY3Rpb25zKVxuICBwcml2YXRlIGFzeW5jIGdldFByb2plY3RTdG9yZShjb2xsZWN0aW9uTmFtZTogc3RyaW5nKTogUHJvbWlzZTxDaHJvbWFWZWN0b3JTdG9yZT4ge1xuICAgIGlmICghdGhpcy5zdG9yZS5oYXMoY29sbGVjdGlvbk5hbWUpKSB7XG4gICAgICB0aGlzLnN0b3JlLnNldChjb2xsZWN0aW9uTmFtZSwgbmV3IENocm9tYVZlY3RvclN0b3JlKGNvbGxlY3Rpb25OYW1lLCB0aGlzLmVtYmVkZGluZ3MpKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc3RvcmUuZ2V0KGNvbGxlY3Rpb25OYW1lKSE7XG4gIH1cblxuICAvLyBJbml0aWFsaXplIGNvbGxlY3Rpb25zIGZvciBhIHByb2plY3QgKENocm9tYURCIGhhbmRsZXMgdGhpcyBhdXRvbWF0aWNhbGx5KVxuICBhc3luYyBpbml0aWFsaXplUHJvamVjdENvbGxlY3Rpb25zKHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coYOKchSBJbml0aWFsaXplZCBDaHJvbWFEQiBjb2xsZWN0aW9ucyBmb3IgcHJvamVjdDogJHtwcm9qZWN0SWR9YCk7XG4gICAgLy8gQ2hyb21hREIgY3JlYXRlcyBjb2xsZWN0aW9ucyBvbiBkZW1hbmRcbiAgfVxuXG4gIC8vIEdlbmVyYXRlIGVtYmVkZGluZ3MgZm9yIHRleHQgY29udGVudFxuICBhc3luYyBnZW5lcmF0ZUVtYmVkZGluZ3ModGV4dHM6IHN0cmluZ1tdKTogUHJvbWlzZTxudW1iZXJbXVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVtYmVkZGluZ3MgPSBhd2FpdCB0aGlzLmVtYmVkZGluZ3MuZW1iZWREb2N1bWVudHModGV4dHMpO1xuICAgICAgcmV0dXJuIGVtYmVkZGluZ3M7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gZ2VuZXJhdGUgZW1iZWRkaW5nczonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyBBZGQgY29kZSBjaHVua3MgdG8gcHJvamVjdCBjb2xsZWN0aW9uXG4gIGFzeW5jIGFkZENvZGVDaHVua3MocHJvamVjdElkOiBzdHJpbmcsIGNodW5rczogQ29kZUNodW5rW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGNodW5rcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgICAgY29uc3QgY29sbGVjdGlvbk5hbWUgPSBTVE9SQUdFX0tFWVMuUFJPSkVDVF9DT0RFKHByb2plY3RJZCk7XG4gICAgICBjb25zdCBzdG9yZSA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdFN0b3JlKGNvbGxlY3Rpb25OYW1lKTtcblxuICAgICAgLy8gQWRkIGNodW5rcyB0byBNZU1lbW8gc3RvcmVcbiAgICAgIGF3YWl0IHN0b3JlLmFkZERvY3VtZW50cyhcbiAgICAgICAgY2h1bmtzLm1hcChjaHVuayA9PiAoe1xuICAgICAgICAgIHBhZ2VDb250ZW50OiBjaHVuay5jb250ZW50LFxuICAgICAgICAgIG1ldGFkYXRhOiBjaHVuay5tZXRhZGF0YSxcbiAgICAgICAgfSkpXG4gICAgICApO1xuXG4gICAgICAvLyBUcmFjayBjb3VudFxuICAgICAgdGhpcy5jaHVua0NvdW50cy5zZXQoY29sbGVjdGlvbk5hbWUsICh0aGlzLmNodW5rQ291bnRzLmdldChjb2xsZWN0aW9uTmFtZSkgfHwgMCkgKyBjaHVua3MubGVuZ3RoKTtcbiAgICAgIGNvbnNvbGUubG9nKGDvv70gQWRkZWQgJHtjaHVua3MubGVuZ3RofSBjb2RlIGNodW5rcyB0byBwcm9qZWN0ICR7cHJvamVjdElkfSAoY29sbGVjdGlvbjogJHtjb2xsZWN0aW9uTmFtZX0pYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gYWRkIGNvZGUgY2h1bmtzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFkZCBwcm9tcHQgY2h1bmtzIHRvIHByb2plY3QgY29sbGVjdGlvblxuICBhc3luYyBhZGRQcm9tcHRDaHVua3MocHJvamVjdElkOiBzdHJpbmcsIGNodW5rczogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIG1ldGFkYXRhOiBWZWN0b3JNZXRhZGF0YTtcbiAgfT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGNodW5rcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgICAgY29uc3QgY29sbGVjdGlvbk5hbWUgPSBTVE9SQUdFX0tFWVMuUFJPSkVDVF9QUk9NUFRTKHByb2plY3RJZCk7XG4gICAgICBjb25zdCBzdG9yZSA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdFN0b3JlKGNvbGxlY3Rpb25OYW1lKTtcblxuICAgICAgLy8gQWRkIGNodW5rcyB0byBNZU1lbW8gc3RvcmVcbiAgICAgIGF3YWl0IHN0b3JlLmFkZERvY3VtZW50cyhcbiAgICAgICAgY2h1bmtzLm1hcChjaHVuayA9PiAoe1xuICAgICAgICAgIHBhZ2VDb250ZW50OiBjaHVuay5jb250ZW50LFxuICAgICAgICAgIG1ldGFkYXRhOiBjaHVuay5tZXRhZGF0YSxcbiAgICAgICAgfSkpXG4gICAgICApO1xuXG4gICAgICAvLyBUcmFjayBjb3VudFxuICAgICAgdGhpcy5jaHVua0NvdW50cy5zZXQoY29sbGVjdGlvbk5hbWUsICh0aGlzLmNodW5rQ291bnRzLmdldChjb2xsZWN0aW9uTmFtZSkgfHwgMCkgKyBjaHVua3MubGVuZ3RoKTtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5KsIEFkZGVkICR7Y2h1bmtzLmxlbmd0aH0gcHJvbXB0IGNodW5rcyB0byBwcm9qZWN0ICR7cHJvamVjdElkfWApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGFkZCBwcm9tcHQgY2h1bmtzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFkZCBwcm9qZWN0IHN0cnVjdHVyZSBlbWJlZGRpbmdzXG4gIGFzeW5jIGFkZFN0cnVjdHVyZUNodW5rcyhwcm9qZWN0SWQ6IHN0cmluZywgY2h1bmtzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgbWV0YWRhdGE6IFZlY3Rvck1ldGFkYXRhO1xuICB9Pik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoY2h1bmtzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgICBjb25zdCBjb2xsZWN0aW9uTmFtZSA9IFNUT1JBR0VfS0VZUy5QUk9KRUNUX1NUUlVDVFVSRShwcm9qZWN0SWQpO1xuICAgICAgY29uc3Qgc3RvcmUgPSBhd2FpdCB0aGlzLmdldFByb2plY3RTdG9yZShjb2xsZWN0aW9uTmFtZSk7XG5cbiAgICAgIC8vIEFkZCBjaHVua3MgdG8gTWVNZW1vIHN0b3JlXG4gICAgICBhd2FpdCBzdG9yZS5hZGREb2N1bWVudHMoXG4gICAgICAgIGNodW5rcy5tYXAoY2h1bmsgPT4gKHtcbiAgICAgICAgICBwYWdlQ29udGVudDogY2h1bmsuY29udGVudCxcbiAgICAgICAgICBtZXRhZGF0YTogY2h1bmsubWV0YWRhdGEsXG4gICAgICAgIH0pKVxuICAgICAgKTtcblxuICAgICAgLy8gVHJhY2sgY291bnRcbiAgICAgIHRoaXMuY2h1bmtDb3VudHMuc2V0KGNvbGxlY3Rpb25OYW1lLCAodGhpcy5jaHVua0NvdW50cy5nZXQoY29sbGVjdGlvbk5hbWUpIHx8IDApICsgY2h1bmtzLmxlbmd0aCk7XG4gICAgICBjb25zb2xlLmxvZyhg8J+Pl++4jyBBZGRlZCAke2NodW5rcy5sZW5ndGh9IHN0cnVjdHVyZSBjaHVua3MgdG8gcHJvamVjdCAke3Byb2plY3RJZH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBhZGQgc3RydWN0dXJlIGNodW5rczonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyBTZWFyY2ggZm9yIHNpbWlsYXIgY29kZSBwYXR0ZXJuc1xuICBhc3luYyBzZWFyY2hDb2RlKHByb2plY3RJZDogc3RyaW5nLCBxdWVyeTogc3RyaW5nLCBuUmVzdWx0czogbnVtYmVyID0gNSk6IFByb21pc2U8QXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIHNjb3JlOiBudW1iZXI7XG4gICAgbWV0YWRhdGE6IFZlY3Rvck1ldGFkYXRhO1xuICB9Pj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb2xsZWN0aW9uTmFtZSA9IFNUT1JBR0VfS0VZUy5QUk9KRUNUX0NPREUocHJvamVjdElkKTtcbiAgICAgIGNvbnN0IHN0b3JlID0gYXdhaXQgdGhpcy5nZXRQcm9qZWN0U3RvcmUoY29sbGVjdGlvbk5hbWUpO1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgc3RvcmUuc2ltaWxhcml0eVNlYXJjaFdpdGhTY29yZShxdWVyeSwgblJlc3VsdHMpO1xuXG4gICAgICByZXR1cm4gcmVzdWx0cy5tYXAoKFtkb2MsIHNjb3JlXTogW2FueSwgbnVtYmVyXSkgPT4gKHtcbiAgICAgICAgaWQ6IGRvYy5tZXRhZGF0YS5pZCBhcyBzdHJpbmcgfHwgYHNlYXJjaF8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgY29udGVudDogZG9jLnBhZ2VDb250ZW50LFxuICAgICAgICBzY29yZTogMSAtIChzY29yZSAvIDIpLCAvLyBOb3JtYWxpemUgc2NvcmUgKE1lTWVtbyB1c2VzIGRpc3RhbmNlLCB3ZSB3YW50IHNpbWlsYXJpdHkpXG4gICAgICAgIG1ldGFkYXRhOiBkb2MubWV0YWRhdGEgYXMgVmVjdG9yTWV0YWRhdGFcbiAgICAgIH0pKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBzZWFyY2ggY29kZTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLy8gU2VhcmNoIGFjcm9zcyBhbGwgcHJvamVjdCBjb2xsZWN0aW9uc1xuICBhc3luYyBzZWFyY2hQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBxdWVyeTogc3RyaW5nLCBuUmVzdWx0czogbnVtYmVyID0gMTApOiBQcm9taXNlPEFycmF5PHtcbiAgICB0eXBlOiAnY29kZScgfCAncHJvbXB0JyB8ICdzdHJ1Y3R1cmUnO1xuICAgIGlkOiBzdHJpbmc7XG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIHNjb3JlOiBudW1iZXI7XG4gICAgbWV0YWRhdGE6IFZlY3Rvck1ldGFkYXRhO1xuICB9Pj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHRzOiBBcnJheTx7XG4gICAgICAgIHR5cGU6ICdjb2RlJyB8ICdwcm9tcHQnIHwgJ3N0cnVjdHVyZSc7XG4gICAgICAgIGlkOiBzdHJpbmc7XG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICAgICAgc2NvcmU6IG51bWJlcjtcbiAgICAgICAgbWV0YWRhdGE6IFZlY3Rvck1ldGFkYXRhO1xuICAgICAgfT4gPSBbXTtcblxuICAgICAgLy8gU2VhcmNoIGNvZGUgY29sbGVjdGlvblxuICAgICAgY29uc3QgY29kZVJlc3VsdHMgPSBhd2FpdCB0aGlzLnNlYXJjaENvZGUocHJvamVjdElkLCBxdWVyeSwgblJlc3VsdHMpO1xuICAgICAgcmVzdWx0cy5wdXNoKC4uLmNvZGVSZXN1bHRzLm1hcChyID0+ICh7IC4uLnIsIHR5cGU6ICdjb2RlJyBhcyBjb25zdCB9KSkpO1xuXG4gICAgICAvLyBTZWFyY2ggcHJvbXB0cyBjb2xsZWN0aW9uXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwcm9tcHRzQ29sbGVjdGlvbk5hbWUgPSBTVE9SQUdFX0tFWVMuUFJPSkVDVF9QUk9NUFRTKHByb2plY3RJZCk7XG4gICAgICAgIGNvbnN0IHByb21wdHNTdG9yZSA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdFN0b3JlKHByb21wdHNDb2xsZWN0aW9uTmFtZSk7XG4gICAgICAgIGNvbnN0IHByb21wdHNSZXN1bHRzID0gYXdhaXQgcHJvbXB0c1N0b3JlLnNpbWlsYXJpdHlTZWFyY2hXaXRoU2NvcmUocXVlcnksIE1hdGguY2VpbChuUmVzdWx0cyAvIDMpKTtcblxuICAgICAgICBwcm9tcHRzUmVzdWx0cy5mb3JFYWNoKChbZG9jLCBzY29yZV06IFthbnksIG51bWJlcl0pID0+IHtcbiAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ3Byb21wdCcsXG4gICAgICAgICAgICBpZDogZG9jLm1ldGFkYXRhLmlkIGFzIHN0cmluZyB8fCBgcHJvbXB0XyR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgICAgY29udGVudDogZG9jLnBhZ2VDb250ZW50LFxuICAgICAgICAgICAgc2NvcmU6IDEgLSAoc2NvcmUgLyAyKSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiBkb2MubWV0YWRhdGEgYXMgVmVjdG9yTWV0YWRhdGFcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAvLyBQcm9tcHRzIGNvbGxlY3Rpb24gbWlnaHQgbm90IGV4aXN0IHlldCAtIHNraXBcbiAgICAgIH1cblxuICAgICAgLy8gU2VhcmNoIHN0cnVjdHVyZSBjb2xsZWN0aW9uXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzdHJ1Y3RDb2xsZWN0aW9uTmFtZSA9IFNUT1JBR0VfS0VZUy5QUk9KRUNUX1NUUlVDVFVSRShwcm9qZWN0SWQpO1xuICAgICAgICBjb25zdCBzdHJ1Y3RTdG9yZSA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdFN0b3JlKHN0cnVjdENvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgY29uc3Qgc3RydWN0UmVzdWx0cyA9IGF3YWl0IHN0cnVjdFN0b3JlLnNpbWlsYXJpdHlTZWFyY2hXaXRoU2NvcmUocXVlcnksIE1hdGguY2VpbChuUmVzdWx0cyAvIDMpKTtcblxuICAgICAgICBzdHJ1Y3RSZXN1bHRzLmZvckVhY2goKFtkb2MsIHNjb3JlXTogW2FueSwgbnVtYmVyXSkgPT4ge1xuICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc3RydWN0dXJlJyxcbiAgICAgICAgICAgIGlkOiBkb2MubWV0YWRhdGEuaWQgYXMgc3RyaW5nIHx8IGBzdHJ1Y3RfJHtEYXRlLm5vdygpfWAsXG4gICAgICAgICAgICBjb250ZW50OiBkb2MucGFnZUNvbnRlbnQsXG4gICAgICAgICAgICBzY29yZTogMSAtIChzY29yZSAvIDIpLFxuICAgICAgICAgICAgbWV0YWRhdGE6IGRvYy5tZXRhZGF0YSBhcyBWZWN0b3JNZXRhZGF0YVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIFN0cnVjdHVyZSBjb2xsZWN0aW9uIG1pZ2h0IG5vdCBleGlzdCB5ZXQgLSBza2lwXG4gICAgICB9XG5cbiAgICAgIC8vIFNvcnQgYnkgc2NvcmUgYW5kIHJldHVybiB0b3AgcmVzdWx0c1xuICAgICAgcmV0dXJuIHJlc3VsdHMuc29ydCgoYSwgYikgPT4gYi5zY29yZSAtIGEuc2NvcmUpLnNsaWNlKDAsIG5SZXN1bHRzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBzZWFyY2ggcHJvamVjdDonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHByb2plY3Qgc3RhdGlzdGljc1xuICBhc3luYyBnZXRQcm9qZWN0U3RhdHMocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPFByb2plY3RFbWJlZGRpbmdzIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGF0czogUHJvamVjdEVtYmVkZGluZ3MgPSB7XG4gICAgICAgIHByb2plY3RfaWQ6IHByb2plY3RJZCxcbiAgICAgICAgdG90YWxfY2h1bmtzOiAwLFxuICAgICAgICBjb2RlX2NodW5rczogdGhpcy5jaHVua0NvdW50cy5nZXQoU1RPUkFHRV9LRVlTLlBST0pFQ1RfQ09ERShwcm9qZWN0SWQpKSB8fCAwLFxuICAgICAgICBwcm9tcHRfY2h1bmtzOiB0aGlzLmNodW5rQ291bnRzLmdldChTVE9SQUdFX0tFWVMuUFJPSkVDVF9QUk9NUFRTKHByb2plY3RJZCkpIHx8IDAsXG4gICAgICAgIHN0cnVjdHVyZV9jaHVua3M6IHRoaXMuY2h1bmtDb3VudHMuZ2V0KFNUT1JBR0VfS0VZUy5QUk9KRUNUX1NUUlVDVFVSRShwcm9qZWN0SWQpKSB8fCAwLFxuICAgICAgICBkZXBlbmRlbmN5X2NodW5rczogMCxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBsYXN0X3VwZGF0ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcblxuICAgICAgc3RhdHMudG90YWxfY2h1bmtzID0gc3RhdHMuY29kZV9jaHVua3MgKyBzdGF0cy5wcm9tcHRfY2h1bmtzICsgc3RhdHMuc3RydWN0dXJlX2NodW5rcztcbiAgICAgIHJldHVybiBzdGF0cztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBnZXQgcHJvamVjdCBzdGF0czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvLyBEZWxldGUgcHJvamVjdCBjb2xsZWN0aW9uc1xuICBhc3luYyBkZWxldGVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJlbW92ZSBzdG9yZXMgZnJvbSBtZW1vcnlcbiAgICAgIHRoaXMuc3RvcmUuZGVsZXRlKFNUT1JBR0VfS0VZUy5QUk9KRUNUX0NPREUocHJvamVjdElkKSk7XG4gICAgICB0aGlzLnN0b3JlLmRlbGV0ZShTVE9SQUdFX0tFWVMuUFJPSkVDVF9QUk9NUFRTKHByb2plY3RJZCkpO1xuICAgICAgdGhpcy5zdG9yZS5kZWxldGUoU1RPUkFHRV9LRVlTLlBST0pFQ1RfU1RSVUNUVVJFKHByb2plY3RJZCkpO1xuXG4gICAgICAvLyBSZW1vdmUgY291bnRzXG4gICAgICB0aGlzLmNodW5rQ291bnRzLmRlbGV0ZShTVE9SQUdFX0tFWVMuUFJPSkVDVF9DT0RFKHByb2plY3RJZCkpO1xuICAgICAgdGhpcy5jaHVua0NvdW50cy5kZWxldGUoU1RPUkFHRV9LRVlTLlBST0pFQ1RfUFJPTVBUUyhwcm9qZWN0SWQpKTtcbiAgICAgIHRoaXMuY2h1bmtDb3VudHMuZGVsZXRlKFNUT1JBR0VfS0VZUy5QUk9KRUNUX1NUUlVDVFVSRShwcm9qZWN0SWQpKTtcblxuICAgICAgY29uc29sZS5sb2coYPCfl5HvuI8gRGVsZXRlZCBDaHJvbWFEQiBjb2xsZWN0aW9ucyBmb3IgcHJvamVjdDogJHtwcm9qZWN0SWR9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gZGVsZXRlIHByb2plY3Q6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLy8gSGVhbHRoIGNoZWNrIChDaHJvbWFEQiB2aWEgTGFuZ0NoYWluIGlzIGFsd2F5cyBhdmFpbGFibGUpXG4gIGFzeW5jIGhlYWx0aENoZWNrKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBMYW5nQ2hhaW4gaGFuZGxlcyBDaHJvbWFEQiBjb25uZWN0aW9uIGludGVybmFsbHlcbiAgICAgIC8vIFNpbXBsZSBjaGVjayAtIHZlcmlmeSBlbWJlZGRpbmdzIGFyZSB3b3JraW5nXG4gICAgICBhd2FpdCB0aGlzLmVtYmVkZGluZ3MuZW1iZWRRdWVyeShcInRlc3RcIik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIENocm9tYURCIGhlYWx0aCBjaGVjayBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG4vLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IC0gcmVuYW1lIGNsYXNzIHRvIENocm9tYURCTWFuYWdlciBmb3IgZXhpc3RpbmcgaW1wb3J0c1xuY29uc3QgQ2hyb21hREJNYW5hZ2VyID0gVmVjdG9yU3RvcmVNYW5hZ2VyO1xuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgY2hyb21hTWFuYWdlciA9IG5ldyBWZWN0b3JTdG9yZU1hbmFnZXIoKTtcbmV4cG9ydCBkZWZhdWx0IGNocm9tYU1hbmFnZXI7XG5cbi8vIFV0aWxpdHkgZnVuY3Rpb25zXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVDaHVua0lkKHByb2plY3RJZDogc3RyaW5nLCBmaWxlbmFtZTogc3RyaW5nLCBsaW5lczogW251bWJlciwgbnVtYmVyXSwgdHlwZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke3Byb2plY3RJZH1fJHtmaWxlbmFtZX1fJHtsaW5lc1swXX0tJHtsaW5lc1sxXX1fJHt0eXBlfV8ke0RhdGUubm93KCl9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlUHJvbXB0SWQocHJvamVjdElkOiBzdHJpbmcsIHNlc3Npb25JZDogc3RyaW5nLCBtZXNzYWdlSW5kZXg6IG51bWJlcik6IHN0cmluZyB7XG4gIHJldHVybiBgJHtwcm9qZWN0SWR9XyR7c2Vzc2lvbklkfV9wcm9tcHRfJHttZXNzYWdlSW5kZXh9YDtcbn1cbiJdLCJuYW1lcyI6WyJHb29nbGVHZW5lcmF0aXZlQUlFbWJlZGRpbmdzIiwiQ2hyb21hIiwiRG9jdW1lbnQiLCJDaHJvbWFWZWN0b3JTdG9yZSIsImNvbnN0cnVjdG9yIiwiY29sbGVjdGlvbk5hbWUiLCJlbWJlZGRpbmdzIiwidmVjdG9yU3RvcmUiLCJlbnN1cmVWZWN0b3JTdG9yZSIsImZyb21FeGlzdGluZ0NvbGxlY3Rpb24iLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJ1cmwiLCJhZGREb2N1bWVudHMiLCJkb2NzIiwibGVuZ3RoIiwiZG9jdW1lbnRzIiwibWFwIiwiZG9jIiwicGFnZUNvbnRlbnQiLCJtZXRhZGF0YSIsInNpbWlsYXJpdHlTZWFyY2hXaXRoU2NvcmUiLCJxdWVyeSIsImsiLCJyZXN1bHRzIiwiRU1CRURESU5HX01PREVMIiwiRU1CRURESU5HX0RJTUVOU0lPTlMiLCJWZWN0b3JTdG9yYWdlUHJvdmlkZXIiLCJDVVJSRU5UX1NUT1JBR0VfUFJPVklERVIiLCJTVE9SQUdFX0tFWVMiLCJQUk9KRUNUX0NPREUiLCJwcm9qZWN0SWQiLCJQUk9KRUNUX1BST01QVFMiLCJQUk9KRUNUX1NUUlVDVFVSRSIsIlZlY3RvclN0b3JlTWFuYWdlciIsInN0b3JlIiwiTWFwIiwiY2h1bmtDb3VudHMiLCJtb2RlbE5hbWUiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiR0VNSU5JX0FQSV9LRVkiLCJHT09HTEVfQVBJX0tFWSIsImdldFByb2plY3RTdG9yZSIsImhhcyIsInNldCIsImdldCIsImluaXRpYWxpemVQcm9qZWN0Q29sbGVjdGlvbnMiLCJnZW5lcmF0ZUVtYmVkZGluZ3MiLCJ0ZXh0cyIsImVtYmVkRG9jdW1lbnRzIiwiYWRkQ29kZUNodW5rcyIsImNodW5rcyIsImNodW5rIiwiY29udGVudCIsImFkZFByb21wdENodW5rcyIsImFkZFN0cnVjdHVyZUNodW5rcyIsInNlYXJjaENvZGUiLCJuUmVzdWx0cyIsInNjb3JlIiwiaWQiLCJEYXRlIiwibm93Iiwic2VhcmNoUHJvamVjdCIsImNvZGVSZXN1bHRzIiwicHVzaCIsInIiLCJ0eXBlIiwicHJvbXB0c0NvbGxlY3Rpb25OYW1lIiwicHJvbXB0c1N0b3JlIiwicHJvbXB0c1Jlc3VsdHMiLCJNYXRoIiwiY2VpbCIsImZvckVhY2giLCJzdHJ1Y3RDb2xsZWN0aW9uTmFtZSIsInN0cnVjdFN0b3JlIiwic3RydWN0UmVzdWx0cyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwiZ2V0UHJvamVjdFN0YXRzIiwic3RhdHMiLCJwcm9qZWN0X2lkIiwidG90YWxfY2h1bmtzIiwiY29kZV9jaHVua3MiLCJwcm9tcHRfY2h1bmtzIiwic3RydWN0dXJlX2NodW5rcyIsImRlcGVuZGVuY3lfY2h1bmtzIiwiY3JlYXRlZF9hdCIsInRvSVNPU3RyaW5nIiwibGFzdF91cGRhdGVkIiwiZGVsZXRlUHJvamVjdCIsImRlbGV0ZSIsImhlYWx0aENoZWNrIiwiZW1iZWRRdWVyeSIsIkNocm9tYURCTWFuYWdlciIsImNocm9tYU1hbmFnZXIiLCJnZW5lcmF0ZUNodW5rSWQiLCJmaWxlbmFtZSIsImxpbmVzIiwiZ2VuZXJhdGVQcm9tcHRJZCIsInNlc3Npb25JZCIsIm1lc3NhZ2VJbmRleCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/chroma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/database.ts":
/*!****************************!*\
  !*** ./lib/db/database.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addConversation: () => (/* binding */ addConversation),\n/* harmony export */   addProjectFile: () => (/* binding */ addProjectFile),\n/* harmony export */   cleanupOldSessions: () => (/* binding */ cleanupOldSessions),\n/* harmony export */   createProject: () => (/* binding */ createProject),\n/* harmony export */   getConversations: () => (/* binding */ getConversations),\n/* harmony export */   getCurrentProject: () => (/* binding */ getCurrentProject),\n/* harmony export */   getFileOperations: () => (/* binding */ getFileOperations),\n/* harmony export */   getOrCreateSession: () => (/* binding */ getOrCreateSession),\n/* harmony export */   getProjectFiles: () => (/* binding */ getProjectFiles),\n/* harmony export */   getProjectsBySession: () => (/* binding */ getProjectsBySession),\n/* harmony export */   getRecentConversations: () => (/* binding */ getRecentConversations),\n/* harmony export */   getSessionStats: () => (/* binding */ getSessionStats),\n/* harmony export */   trackFileOperation: () => (/* binding */ trackFileOperation),\n/* harmony export */   updateProject: () => (/* binding */ updateProject),\n/* harmony export */   updateSessionFolder: () => (/* binding */ updateSessionFolder)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/db/prisma.ts\");\n\n/**\n * Session Management\n */ async function getOrCreateSession(sessionId, projectFolder) {\n    let session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        },\n        include: {\n            conversations: {\n                orderBy: {\n                    timestamp: \"asc\"\n                }\n            },\n            projects: {\n                include: {\n                    files: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            }\n        }\n    });\n    if (!session) {\n        session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.create({\n            data: {\n                sessionId,\n                projectFolder\n            },\n            include: {\n                conversations: true,\n                projects: {\n                    include: {\n                        files: true\n                    }\n                }\n            }\n        });\n    }\n    return session;\n}\nasync function updateSessionFolder(sessionId, projectFolder) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            sessionId\n        },\n        data: {\n            projectFolder\n        }\n    });\n}\n/**\n * Conversation Management\n */ async function addConversation(sessionId, role, content) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        throw new Error(`Session not found: ${sessionId}`);\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.conversation.create({\n        data: {\n            sessionId: session.id,\n            role,\n            content\n        }\n    });\n}\nasync function getConversations(sessionId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        return [];\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.conversation.findMany({\n        where: {\n            sessionId: session.id\n        },\n        orderBy: {\n            timestamp: \"asc\"\n        }\n    });\n}\nasync function getRecentConversations(sessionId, limit = 10) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        return [];\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.conversation.findMany({\n        where: {\n            sessionId: session.id\n        },\n        orderBy: {\n            timestamp: \"desc\"\n        },\n        take: limit\n    });\n}\n/**\n * Project Management\n */ async function createProject(sessionId, projectFolder, userRequest, plan) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        throw new Error(`Session not found: ${sessionId}`);\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.project.create({\n        data: {\n            sessionId: session.id,\n            projectFolder,\n            userRequest,\n            plan\n        },\n        include: {\n            files: true\n        }\n    });\n}\nasync function updateProject(projectId, data) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.project.update({\n        where: {\n            id: projectId\n        },\n        data\n    });\n}\nasync function getProjectsBySession(sessionId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        return [];\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.project.findMany({\n        where: {\n            sessionId: session.id\n        },\n        include: {\n            files: true\n        },\n        orderBy: {\n            createdAt: \"desc\"\n        }\n    });\n}\nasync function getCurrentProject(sessionId) {\n    const projects = await getProjectsBySession(sessionId);\n    return projects[0] || null;\n}\n/**\n * File Management\n */ async function addProjectFile(projectId, filename, content, operation) {\n    // Check if file already exists\n    const existing = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.findFirst({\n        where: {\n            projectId,\n            filename\n        }\n    });\n    if (existing) {\n        // Update existing file\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.update({\n            where: {\n                id: existing.id\n            },\n            data: {\n                content,\n                operation\n            }\n        });\n    }\n    // Create new file\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.create({\n        data: {\n            projectId,\n            filename,\n            content,\n            operation\n        }\n    });\n}\nasync function getProjectFiles(projectId) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.findMany({\n        where: {\n            projectId\n        },\n        orderBy: {\n            updatedAt: \"desc\"\n        }\n    });\n}\n/**\n * File Operations Tracking\n */ async function trackFileOperation(sessionId, operation, filePath) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.fileOperation.create({\n        data: {\n            sessionId,\n            operation,\n            filePath\n        }\n    });\n}\nasync function getFileOperations(sessionId, limit = 50) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.fileOperation.findMany({\n        where: {\n            sessionId\n        },\n        orderBy: {\n            timestamp: \"desc\"\n        },\n        take: limit\n    });\n}\n/**\n * Utility Functions\n */ async function getSessionStats(sessionId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        },\n        include: {\n            _count: {\n                select: {\n                    conversations: true,\n                    projects: true\n                }\n            }\n        }\n    });\n    if (!session) {\n        return null;\n    }\n    const fileOperations = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.fileOperation.count({\n        where: {\n            sessionId\n        }\n    });\n    return {\n        sessionId: session.sessionId,\n        projectFolder: session.projectFolder,\n        conversationCount: session._count.conversations,\n        projectCount: session._count.projects,\n        fileOperationCount: fileOperations,\n        createdAt: session.createdAt,\n        updatedAt: session.updatedAt\n    };\n}\nasync function cleanupOldSessions(daysOld = 7) {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - daysOld);\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.deleteMany({\n        where: {\n            updatedAt: {\n                lt: cutoffDate\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVLE1BQU1KLDJDQUFNQSxDQUFDSSxPQUFPLENBQUNDLFVBQVUsQ0FBQztRQUM5Q0MsT0FBTztZQUFFSjtRQUFVO1FBQ25CSyxTQUFTO1lBQ1AyQyxRQUFRO2dCQUNOQyxRQUFRO29CQUNOM0MsZUFBZTtvQkFDZkcsVUFBVTtnQkFDWjtZQUNGO1FBQ0Y7SUFDRjtJQUVBLElBQUksQ0FBQ1AsU0FBUztRQUNaLE9BQU87SUFDVDtJQUVBLE1BQU1nRCxpQkFBaUIsTUFBTXBELDJDQUFNQSxDQUFDK0MsYUFBYSxDQUFDTSxLQUFLLENBQUM7UUFDdEQvQyxPQUFPO1lBQUVKO1FBQVU7SUFDckI7SUFFQSxPQUFPO1FBQ0xBLFdBQVdFLFFBQVFGLFNBQVM7UUFDNUJDLGVBQWVDLFFBQVFELGFBQWE7UUFDcENtRCxtQkFBbUJsRCxRQUFROEMsTUFBTSxDQUFDMUMsYUFBYTtRQUMvQytDLGNBQWNuRCxRQUFROEMsTUFBTSxDQUFDdkMsUUFBUTtRQUNyQzZDLG9CQUFvQko7UUFDcEJ2QyxXQUFXVCxRQUFRUyxTQUFTO1FBQzVCK0IsV0FBV3hDLFFBQVF3QyxTQUFTO0lBQzlCO0FBQ0Y7QUFFTyxlQUFlYSxtQkFBbUJDLFVBQWtCLENBQUM7SUFDMUQsTUFBTUMsYUFBYSxJQUFJQztJQUN2QkQsV0FBV0UsT0FBTyxDQUFDRixXQUFXRyxPQUFPLEtBQUtKO0lBRTFDLE9BQU8sTUFBTTFELDJDQUFNQSxDQUFDSSxPQUFPLENBQUMyRCxVQUFVLENBQUM7UUFDckN6RCxPQUFPO1lBQ0xzQyxXQUFXO2dCQUNUb0IsSUFBSUw7WUFDTjtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2RiL2RhdGFiYXNlLnRzPzIzMjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi9wcmlzbWEnO1xuXG4vKipcbiAqIFNlc3Npb24gTWFuYWdlbWVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3JDcmVhdGVTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nLCBwcm9qZWN0Rm9sZGVyOiBzdHJpbmcpIHtcbiAgbGV0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBzZXNzaW9uSWQgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBjb252ZXJzYXRpb25zOiB7XG4gICAgICAgIG9yZGVyQnk6IHsgdGltZXN0YW1wOiAnYXNjJyB9LFxuICAgICAgfSxcbiAgICAgIHByb2plY3RzOiB7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBmaWxlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc2Vzc2lvbklkLFxuICAgICAgICBwcm9qZWN0Rm9sZGVyLFxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgY29udmVyc2F0aW9uczogdHJ1ZSxcbiAgICAgICAgcHJvamVjdHM6IHtcbiAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBmaWxlczogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBzZXNzaW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2Vzc2lvbkZvbGRlcihzZXNzaW9uSWQ6IHN0cmluZywgcHJvamVjdEZvbGRlcjogc3RyaW5nKSB7XG4gIHJldHVybiBhd2FpdCBwcmlzbWEuc2Vzc2lvbi51cGRhdGUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICAgIGRhdGE6IHsgcHJvamVjdEZvbGRlciB9LFxuICB9KTtcbn1cblxuLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlbWVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkQ29udmVyc2F0aW9uKHNlc3Npb25JZDogc3RyaW5nLCByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgY29udGVudDogc3RyaW5nKSB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBzZXNzaW9uSWQgfSxcbiAgfSk7XG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBTZXNzaW9uIG5vdCBmb3VuZDogJHtzZXNzaW9uSWR9YCk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcHJpc21hLmNvbnZlcnNhdGlvbi5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5pZCxcbiAgICAgIHJvbGUsXG4gICAgICBjb250ZW50LFxuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udmVyc2F0aW9ucyhzZXNzaW9uSWQ6IHN0cmluZykge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkIH0sXG4gIH0pO1xuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBwcmlzbWEuY29udmVyc2F0aW9uLmZpbmRNYW55KHtcbiAgICB3aGVyZTogeyBzZXNzaW9uSWQ6IHNlc3Npb24uaWQgfSxcbiAgICBvcmRlckJ5OiB7IHRpbWVzdGFtcDogJ2FzYycgfSxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSZWNlbnRDb252ZXJzYXRpb25zKHNlc3Npb25JZDogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTApIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHByaXNtYS5zZXNzaW9uLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcHJpc21hLmNvbnZlcnNhdGlvbi5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkOiBzZXNzaW9uLmlkIH0sXG4gICAgb3JkZXJCeTogeyB0aW1lc3RhbXA6ICdkZXNjJyB9LFxuICAgIHRha2U6IGxpbWl0LFxuICB9KTtcbn1cblxuLyoqXG4gKiBQcm9qZWN0IE1hbmFnZW1lbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QoXG4gIHNlc3Npb25JZDogc3RyaW5nLFxuICBwcm9qZWN0Rm9sZGVyOiBzdHJpbmcsXG4gIHVzZXJSZXF1ZXN0OiBzdHJpbmcsXG4gIHBsYW46IHN0cmluZ1tdXG4pIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHByaXNtYS5zZXNzaW9uLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFNlc3Npb24gbm90IGZvdW5kOiAke3Nlc3Npb25JZH1gKTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBwcmlzbWEucHJvamVjdC5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5pZCxcbiAgICAgIHByb2plY3RGb2xkZXIsXG4gICAgICB1c2VyUmVxdWVzdCxcbiAgICAgIHBsYW4sXG4gICAgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBmaWxlczogdHJ1ZSxcbiAgICB9LFxuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2plY3QoXG4gIHByb2plY3RJZDogc3RyaW5nLFxuICBkYXRhOiB7XG4gICAgcGxhbj86IHN0cmluZ1tdO1xuICAgIGlzQ29tcGxldGU/OiBib29sZWFuO1xuICB9XG4pIHtcbiAgcmV0dXJuIGF3YWl0IHByaXNtYS5wcm9qZWN0LnVwZGF0ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHByb2plY3RJZCB9LFxuICAgIGRhdGEsXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdHNCeVNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHByaXNtYS5zZXNzaW9uLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcHJpc21hLnByb2plY3QuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZDogc2Vzc2lvbi5pZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIGZpbGVzOiB0cnVlLFxuICAgIH0sXG4gICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRQcm9qZWN0KHNlc3Npb25JZDogc3RyaW5nKSB7XG4gIGNvbnN0IHByb2plY3RzID0gYXdhaXQgZ2V0UHJvamVjdHNCeVNlc3Npb24oc2Vzc2lvbklkKTtcbiAgcmV0dXJuIHByb2plY3RzWzBdIHx8IG51bGw7XG59XG5cbi8qKlxuICogRmlsZSBNYW5hZ2VtZW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRQcm9qZWN0RmlsZShcbiAgcHJvamVjdElkOiBzdHJpbmcsXG4gIGZpbGVuYW1lOiBzdHJpbmcsXG4gIGNvbnRlbnQ6IHN0cmluZyxcbiAgb3BlcmF0aW9uOiAnY3JlYXRlZCcgfCAnbW9kaWZpZWQnIHwgJ2RlbGV0ZWQnXG4pIHtcbiAgLy8gQ2hlY2sgaWYgZmlsZSBhbHJlYWR5IGV4aXN0c1xuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS5wcm9qZWN0RmlsZS5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwcm9qZWN0SWQsXG4gICAgICBmaWxlbmFtZSxcbiAgICB9LFxuICB9KTtcblxuICBpZiAoZXhpc3RpbmcpIHtcbiAgICAvLyBVcGRhdGUgZXhpc3RpbmcgZmlsZVxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEucHJvamVjdEZpbGUudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZy5pZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBjb250ZW50LFxuICAgICAgICBvcGVyYXRpb24sXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLy8gQ3JlYXRlIG5ldyBmaWxlXG4gIHJldHVybiBhd2FpdCBwcmlzbWEucHJvamVjdEZpbGUuY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICBwcm9qZWN0SWQsXG4gICAgICBmaWxlbmFtZSxcbiAgICAgIGNvbnRlbnQsXG4gICAgICBvcGVyYXRpb24sXG4gICAgfSxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9qZWN0RmlsZXMocHJvamVjdElkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGF3YWl0IHByaXNtYS5wcm9qZWN0RmlsZS5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgcHJvamVjdElkIH0sXG4gICAgb3JkZXJCeTogeyB1cGRhdGVkQXQ6ICdkZXNjJyB9LFxuICB9KTtcbn1cblxuLyoqXG4gKiBGaWxlIE9wZXJhdGlvbnMgVHJhY2tpbmdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRyYWNrRmlsZU9wZXJhdGlvbihcbiAgc2Vzc2lvbklkOiBzdHJpbmcsXG4gIG9wZXJhdGlvbjogJ2NyZWF0ZWQnIHwgJ21vZGlmaWVkJyB8ICdkZWxldGVkJyB8ICdyZWFkJyxcbiAgZmlsZVBhdGg6IHN0cmluZ1xuKSB7XG4gIHJldHVybiBhd2FpdCBwcmlzbWEuZmlsZU9wZXJhdGlvbi5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb25JZCxcbiAgICAgIG9wZXJhdGlvbixcbiAgICAgIGZpbGVQYXRoLFxuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsZU9wZXJhdGlvbnMoc2Vzc2lvbklkOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSA1MCkge1xuICByZXR1cm4gYXdhaXQgcHJpc21hLmZpbGVPcGVyYXRpb24uZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICAgIG9yZGVyQnk6IHsgdGltZXN0YW1wOiAnZGVzYycgfSxcbiAgICB0YWtlOiBsaW1pdCxcbiAgfSk7XG59XG5cbi8qKlxuICogVXRpbGl0eSBGdW5jdGlvbnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb25TdGF0cyhzZXNzaW9uSWQ6IHN0cmluZykge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkIH0sXG4gICAgaW5jbHVkZToge1xuICAgICAgX2NvdW50OiB7XG4gICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgIGNvbnZlcnNhdGlvbnM6IHRydWUsXG4gICAgICAgICAgcHJvamVjdHM6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgZmlsZU9wZXJhdGlvbnMgPSBhd2FpdCBwcmlzbWEuZmlsZU9wZXJhdGlvbi5jb3VudCh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkIH0sXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgc2Vzc2lvbklkOiBzZXNzaW9uLnNlc3Npb25JZCxcbiAgICBwcm9qZWN0Rm9sZGVyOiBzZXNzaW9uLnByb2plY3RGb2xkZXIsXG4gICAgY29udmVyc2F0aW9uQ291bnQ6IHNlc3Npb24uX2NvdW50LmNvbnZlcnNhdGlvbnMsXG4gICAgcHJvamVjdENvdW50OiBzZXNzaW9uLl9jb3VudC5wcm9qZWN0cyxcbiAgICBmaWxlT3BlcmF0aW9uQ291bnQ6IGZpbGVPcGVyYXRpb25zLFxuICAgIGNyZWF0ZWRBdDogc2Vzc2lvbi5jcmVhdGVkQXQsXG4gICAgdXBkYXRlZEF0OiBzZXNzaW9uLnVwZGF0ZWRBdCxcbiAgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFudXBPbGRTZXNzaW9ucyhkYXlzT2xkOiBudW1iZXIgPSA3KSB7XG4gIGNvbnN0IGN1dG9mZkRhdGUgPSBuZXcgRGF0ZSgpO1xuICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBkYXlzT2xkKTtcblxuICByZXR1cm4gYXdhaXQgcHJpc21hLnNlc3Npb24uZGVsZXRlTWFueSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICBsdDogY3V0b2ZmRGF0ZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiZ2V0T3JDcmVhdGVTZXNzaW9uIiwic2Vzc2lvbklkIiwicHJvamVjdEZvbGRlciIsInNlc3Npb24iLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpbmNsdWRlIiwiY29udmVyc2F0aW9ucyIsIm9yZGVyQnkiLCJ0aW1lc3RhbXAiLCJwcm9qZWN0cyIsImZpbGVzIiwiY3JlYXRlZEF0IiwiY3JlYXRlIiwiZGF0YSIsInVwZGF0ZVNlc3Npb25Gb2xkZXIiLCJ1cGRhdGUiLCJhZGRDb252ZXJzYXRpb24iLCJyb2xlIiwiY29udGVudCIsIkVycm9yIiwiY29udmVyc2F0aW9uIiwiaWQiLCJnZXRDb252ZXJzYXRpb25zIiwiZmluZE1hbnkiLCJnZXRSZWNlbnRDb252ZXJzYXRpb25zIiwibGltaXQiLCJ0YWtlIiwiY3JlYXRlUHJvamVjdCIsInVzZXJSZXF1ZXN0IiwicGxhbiIsInByb2plY3QiLCJ1cGRhdGVQcm9qZWN0IiwicHJvamVjdElkIiwiZ2V0UHJvamVjdHNCeVNlc3Npb24iLCJnZXRDdXJyZW50UHJvamVjdCIsImFkZFByb2plY3RGaWxlIiwiZmlsZW5hbWUiLCJvcGVyYXRpb24iLCJleGlzdGluZyIsInByb2plY3RGaWxlIiwiZmluZEZpcnN0IiwiZ2V0UHJvamVjdEZpbGVzIiwidXBkYXRlZEF0IiwidHJhY2tGaWxlT3BlcmF0aW9uIiwiZmlsZVBhdGgiLCJmaWxlT3BlcmF0aW9uIiwiZ2V0RmlsZU9wZXJhdGlvbnMiLCJnZXRTZXNzaW9uU3RhdHMiLCJfY291bnQiLCJzZWxlY3QiLCJmaWxlT3BlcmF0aW9ucyIsImNvdW50IiwiY29udmVyc2F0aW9uQ291bnQiLCJwcm9qZWN0Q291bnQiLCJmaWxlT3BlcmF0aW9uQ291bnQiLCJjbGVhbnVwT2xkU2Vzc2lvbnMiLCJkYXlzT2xkIiwiY3V0b2ZmRGF0ZSIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRlbGV0ZU1hbnkiLCJsdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/database.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/prisma.ts":
/*!**************************!*\
  !*** ./lib/db/prisma.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"error\",\n        \"warn\"\n    ]\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxDQUFDO0lBQy9ESSxLQUFLO1FBQUM7UUFBUztLQUFPO0FBQ3hCLEdBQUc7QUFFSCxJQUFJQyxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi9kYi9wcmlzbWEudHM/MDk2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCh7XG4gIGxvZzogWydlcnJvcicsICd3YXJuJ10sXG59KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7XG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/fileops.ts":
/*!******************************!*\
  !*** ./lib/utils/fileops.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DirectoryListSchema: () => (/* binding */ DirectoryListSchema),\n/* harmony export */   FileAppendSchema: () => (/* binding */ FileAppendSchema),\n/* harmony export */   FileDeleteSchema: () => (/* binding */ FileDeleteSchema),\n/* harmony export */   FileReadSchema: () => (/* binding */ FileReadSchema),\n/* harmony export */   FileSearchSchema: () => (/* binding */ FileSearchSchema),\n/* harmony export */   FileWriteSchema: () => (/* binding */ FileWriteSchema),\n/* harmony export */   appendToFile: () => (/* binding */ appendToFile),\n/* harmony export */   deleteFile: () => (/* binding */ deleteFile),\n/* harmony export */   fileExists: () => (/* binding */ fileExists),\n/* harmony export */   listDirectory: () => (/* binding */ listDirectory),\n/* harmony export */   readFile: () => (/* binding */ readFile),\n/* harmony export */   searchFiles: () => (/* binding */ searchFiles),\n/* harmony export */   writeFile: () => (/* binding */ writeFile)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.76/node_modules/zod/v3/types.js\");\n\n\n\n// Configuration for safe file operations\nconst SAFE_DIRECTORIES = [\n    \"./generated\",\n    \"./workspace\",\n    \"./temp\"\n];\nconst ALLOWED_EXTENSIONS = [\n    \".ts\",\n    \".tsx\",\n    \".js\",\n    \".jsx\",\n    \".json\",\n    \".css\",\n    \".html\",\n    \".md\",\n    \".txt\",\n    \".yaml\",\n    \".yml\",\n    \".xml\",\n    \".sql\",\n    \".py\",\n    \".rs\",\n    \".go\",\n    \".java\",\n    \".c\",\n    \".cpp\",\n    \"Dockerfile\",\n    \".gitignore\",\n    \".env.example\"\n];\nfunction isPathSafe(filePath) {\n    const normalizedPath = path__WEBPACK_IMPORTED_MODULE_1__.resolve(filePath);\n    const cwd = process.cwd();\n    // Check if path is within allowed directories\n    const allowed = SAFE_DIRECTORIES.some((dir)=>{\n        const resolvedDir = path__WEBPACK_IMPORTED_MODULE_1__.resolve(path__WEBPACK_IMPORTED_MODULE_1__.join(cwd, dir));\n        return normalizedPath.startsWith(resolvedDir);\n    });\n    // Check file extension\n    const ext = path__WEBPACK_IMPORTED_MODULE_1__.extname(filePath);\n    const extAllowed = ALLOWED_EXTENSIONS.includes(ext) || ext === \"\" || filePath.includes(\"Dockerfile\");\n    return allowed && extAllowed && !filePath.includes(\"..\");\n}\n// File read operation\nasync function readFile(filePath) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(filePath)) {\n            return {\n                success: false,\n                error: \"File does not exist\"\n            };\n        }\n        const content = fs__WEBPACK_IMPORTED_MODULE_0__.readFileSync(filePath, \"utf-8\");\n        return {\n            success: true,\n            content\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error reading file\"\n        };\n    }\n}\n// File write operation\nasync function writeFile(filePath, content) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        // Ensure directory exists\n        const dir = path__WEBPACK_IMPORTED_MODULE_1__.dirname(filePath);\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(dir)) {\n            fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(dir, {\n                recursive: true\n            });\n        }\n        fs__WEBPACK_IMPORTED_MODULE_0__.writeFileSync(filePath, content, \"utf-8\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error writing file\"\n        };\n    }\n}\n// File modification (append)\nasync function appendToFile(filePath, content) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        fs__WEBPACK_IMPORTED_MODULE_0__.appendFileSync(filePath, content, \"utf-8\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error appending to file\"\n        };\n    }\n}\n// File deletion\nasync function deleteFile(filePath) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(filePath)) {\n            return {\n                success: false,\n                error: \"File does not exist\"\n            };\n        }\n        // Only allow deletion of generated files\n        const isInGenerated = filePath.startsWith(path__WEBPACK_IMPORTED_MODULE_1__.resolve(\"./generated\"));\n        if (!isInGenerated) {\n            return {\n                success: false,\n                error: \"Deletion only allowed for generated files\"\n            };\n        }\n        fs__WEBPACK_IMPORTED_MODULE_0__.unlinkSync(filePath);\n        return {\n            success: true\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error deleting file\"\n        };\n    }\n}\n// List directory\nasync function listDirectory(dirPath) {\n    try {\n        if (!isPathSafe(dirPath) && !SAFE_DIRECTORIES.some((dir)=>dirPath.includes(dir))) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(dirPath)) {\n            return {\n                success: false,\n                error: \"Directory does not exist\"\n            };\n        }\n        const files = fs__WEBPACK_IMPORTED_MODULE_0__.readdirSync(dirPath);\n        return {\n            success: true,\n            files\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error listing directory\"\n        };\n    }\n}\n// Check if file exists\nasync function fileExists(filePath) {\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(filePath);\n    } catch  {\n        return false;\n    }\n}\n// Helper function for recursive directory search\nfunction searchDirectory(currentPath, pattern, matches) {\n    try {\n        const items = fs__WEBPACK_IMPORTED_MODULE_0__.readdirSync(currentPath);\n        for (const item of items){\n            const fullPath = path__WEBPACK_IMPORTED_MODULE_1__.join(currentPath, item);\n            const stat = fs__WEBPACK_IMPORTED_MODULE_0__.statSync(fullPath);\n            if (stat.isDirectory()) {\n                // Skip node_modules and .git\n                if (item !== \"node_modules\" && item !== \".git\" && item !== \".next\") {\n                    searchDirectory(fullPath, pattern, matches);\n                }\n            } else if (stat.isFile()) {\n                // Check if file extension is allowed\n                const ext = path__WEBPACK_IMPORTED_MODULE_1__.extname(item);\n                if (ALLOWED_EXTENSIONS.includes(ext) || ext === \"\" || item.includes(\"Dockerfile\")) {\n                    try {\n                        const content = fs__WEBPACK_IMPORTED_MODULE_0__.readFileSync(fullPath, \"utf-8\");\n                        const lines = content.split(\"\\n\");\n                        lines.forEach((line, index)=>{\n                            if (new RegExp(pattern, \"i\").test(line)) {\n                                matches.push({\n                                    file: fullPath,\n                                    content: line.trim(),\n                                    line: index + 1\n                                });\n                            }\n                        });\n                    } catch (error) {\n                        continue;\n                    }\n                }\n            }\n        }\n    } catch (error) {\n        // Skip directories we can't read\n        return;\n    }\n}\n// Regex file search operation\nasync function searchFiles(dirPath, pattern) {\n    try {\n        if (!isPathSafe(dirPath) && !SAFE_DIRECTORIES.some((dir)=>dirPath.includes(dir))) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        // Ensure base directory exists\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(dirPath)) {\n            return {\n                success: false,\n                error: \"Directory does not exist\"\n            };\n        }\n        const matches = [];\n        searchDirectory(dirPath, pattern, matches);\n        return {\n            success: true,\n            matches\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error during file search\"\n        };\n    }\n}\n// Schema definitions for tool calls\nconst FileReadSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the file to read\")\n});\nconst FileWriteSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path where to create/modify the file\"),\n    content: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Content to write to the file\")\n});\nconst FileAppendSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the file to append to\"),\n    content: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Content to append to the file\")\n});\nconst FileDeleteSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the file to delete\")\n});\nconst DirectoryListSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    dirPath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the directory to list\")\n});\nconst FileSearchSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    dirPath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Directory to search in\"),\n    pattern: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Regex pattern to search for (JavaScript regex syntax)\")\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFHbUUsUUFBUSxDQUFDO0FBQ2hDLEdBQUc7QUFFSSxNQUFNSSxzQkFBc0J2RSx1Q0FBUSxDQUFDO0lBQzFDc0MsU0FBU3RDLHVDQUFRLEdBQUdtRSxRQUFRLENBQUM7QUFDL0IsR0FBRztBQUVJLE1BQU1LLG1CQUFtQnhFLHVDQUFRLENBQUM7SUFDdkNzQyxTQUFTdEMsdUNBQVEsR0FBR21FLFFBQVEsQ0FBQztJQUM3QnZCLFNBQVM1Qyx1Q0FBUSxHQUFHbUUsUUFBUSxDQUFDO0FBQy9CLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi91dGlscy9maWxlb3BzLnRzP2Q2NjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vLyBDb25maWd1cmF0aW9uIGZvciBzYWZlIGZpbGUgb3BlcmF0aW9uc1xuY29uc3QgU0FGRV9ESVJFQ1RPUklFUyA9IFtcbiAgJy4vZ2VuZXJhdGVkJyxcbiAgJy4vd29ya3NwYWNlJyxcbiAgJy4vdGVtcCcsXG5dO1xuXG5jb25zdCBBTExPV0VEX0VYVEVOU0lPTlMgPSBbXG4gICcudHMnLCAnLnRzeCcsICcuanMnLCAnLmpzeCcsICcuanNvbicsICcuY3NzJywgJy5odG1sJywgJy5tZCcsICcudHh0JyxcbiAgJy55YW1sJywgJy55bWwnLCAnLnhtbCcsICcuc3FsJywgJy5weScsICcucnMnLCAnLmdvJywgJy5qYXZhJywgJy5jJywgJy5jcHAnLFxuICAnRG9ja2VyZmlsZScsICcuZ2l0aWdub3JlJywgJy5lbnYuZXhhbXBsZSdcbl07XG5cbmZ1bmN0aW9uIGlzUGF0aFNhZmUoZmlsZVBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBub3JtYWxpemVkUGF0aCA9IHBhdGgucmVzb2x2ZShmaWxlUGF0aCk7XG4gIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKCk7XG5cbiAgLy8gQ2hlY2sgaWYgcGF0aCBpcyB3aXRoaW4gYWxsb3dlZCBkaXJlY3Rvcmllc1xuICBjb25zdCBhbGxvd2VkID0gU0FGRV9ESVJFQ1RPUklFUy5zb21lKGRpciA9PiB7XG4gICAgY29uc3QgcmVzb2x2ZWREaXIgPSBwYXRoLnJlc29sdmUocGF0aC5qb2luKGN3ZCwgZGlyKSk7XG4gICAgcmV0dXJuIG5vcm1hbGl6ZWRQYXRoLnN0YXJ0c1dpdGgocmVzb2x2ZWREaXIpO1xuICB9KTtcblxuICAvLyBDaGVjayBmaWxlIGV4dGVuc2lvblxuICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZVBhdGgpO1xuICBjb25zdCBleHRBbGxvd2VkID0gQUxMT1dFRF9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dCkgfHwgZXh0ID09PSAnJyB8fCBmaWxlUGF0aC5pbmNsdWRlcygnRG9ja2VyZmlsZScpO1xuXG4gIHJldHVybiBhbGxvd2VkICYmIGV4dEFsbG93ZWQgJiYgIWZpbGVQYXRoLmluY2x1ZGVzKCcuLicpO1xufVxuXG4vLyBGaWxlIHJlYWQgb3BlcmF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVhZEZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW4sIGNvbnRlbnQ/OiBzdHJpbmcsIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmlsZSBkb2VzIG5vdCBleGlzdCd9O1xuICAgIH1cblxuICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgsICd1dGYtOCcpO1xuICAgIHJldHVybiB7c3VjY2VzczogdHJ1ZSwgY29udGVudH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgcmVhZGluZyBmaWxlJ1xuICAgIH07XG4gIH1cbn1cblxuLy8gRmlsZSB3cml0ZSBvcGVyYXRpb25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3cml0ZUZpbGUoZmlsZVBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx7c3VjY2VzczogYm9vbGVhbiwgZXJyb3I/OiBzdHJpbmd9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFpc1BhdGhTYWZlKGZpbGVQYXRoKSkge1xuICAgICAgcmV0dXJuIHtzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdQYXRoIG5vdCBhbGxvd2VkIGZvciBzZWN1cml0eSByZWFzb25zJ307XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIGRpcmVjdG9yeSBleGlzdHNcbiAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoZmlsZVBhdGgpO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBjb250ZW50LCAndXRmLTgnKTtcbiAgICByZXR1cm4ge3N1Y2Nlc3M6IHRydWV9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIHdyaXRpbmcgZmlsZSdcbiAgICB9O1xuICB9XG59XG5cbi8vIEZpbGUgbW9kaWZpY2F0aW9uIChhcHBlbmQpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kVG9GaWxlKGZpbGVQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGZzLmFwcGVuZEZpbGVTeW5jKGZpbGVQYXRoLCBjb250ZW50LCAndXRmLTgnKTtcbiAgICByZXR1cm4ge3N1Y2Nlc3M6IHRydWV9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGFwcGVuZGluZyB0byBmaWxlJ1xuICAgIH07XG4gIH1cbn1cblxuLy8gRmlsZSBkZWxldGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmlsZSBkb2VzIG5vdCBleGlzdCd9O1xuICAgIH1cblxuICAgIC8vIE9ubHkgYWxsb3cgZGVsZXRpb24gb2YgZ2VuZXJhdGVkIGZpbGVzXG4gICAgY29uc3QgaXNJbkdlbmVyYXRlZCA9IGZpbGVQYXRoLnN0YXJ0c1dpdGgocGF0aC5yZXNvbHZlKCcuL2dlbmVyYXRlZCcpKTtcbiAgICBpZiAoIWlzSW5HZW5lcmF0ZWQpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnRGVsZXRpb24gb25seSBhbGxvd2VkIGZvciBnZW5lcmF0ZWQgZmlsZXMnfTtcbiAgICB9XG5cbiAgICBmcy51bmxpbmtTeW5jKGZpbGVQYXRoKTtcbiAgICByZXR1cm4ge3N1Y2Nlc3M6IHRydWV9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGRlbGV0aW5nIGZpbGUnXG4gICAgfTtcbiAgfVxufVxuXG4vLyBMaXN0IGRpcmVjdG9yeVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3REaXJlY3RvcnkoZGlyUGF0aDogc3RyaW5nKTogUHJvbWlzZTx7c3VjY2VzczogYm9vbGVhbiwgZmlsZXM/OiBzdHJpbmdbXSwgZXJyb3I/OiBzdHJpbmd9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFpc1BhdGhTYWZlKGRpclBhdGgpICYmICFTQUZFX0RJUkVDVE9SSUVTLnNvbWUoZGlyID0+IGRpclBhdGguaW5jbHVkZXMoZGlyKSkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXJQYXRoKSkge1xuICAgICAgcmV0dXJuIHtzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdEaXJlY3RvcnkgZG9lcyBub3QgZXhpc3QnfTtcbiAgICB9XG5cbiAgICBjb25zdCBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKGRpclBhdGgpO1xuICAgIHJldHVybiB7c3VjY2VzczogdHJ1ZSwgZmlsZXN9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGxpc3RpbmcgZGlyZWN0b3J5J1xuICAgIH07XG4gIH1cbn1cblxuLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaWxlRXhpc3RzKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZnMuZXhpc3RzU3luYyhmaWxlUGF0aCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb24gZm9yIHJlY3Vyc2l2ZSBkaXJlY3Rvcnkgc2VhcmNoXG5mdW5jdGlvbiBzZWFyY2hEaXJlY3RvcnkoY3VycmVudFBhdGg6IHN0cmluZywgcGF0dGVybjogc3RyaW5nLCBtYXRjaGVzOiBBcnJheTx7ZmlsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcsIGxpbmU6IG51bWJlcn0+KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgaXRlbXMgPSBmcy5yZWFkZGlyU3luYyhjdXJyZW50UGF0aCk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKGN1cnJlbnRQYXRoLCBpdGVtKTtcbiAgICAgIGNvbnN0IHN0YXQgPSBmcy5zdGF0U3luYyhmdWxsUGF0aCk7XG5cbiAgICAgIGlmIChzdGF0LmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgLy8gU2tpcCBub2RlX21vZHVsZXMgYW5kIC5naXRcbiAgICAgICAgaWYgKGl0ZW0gIT09ICdub2RlX21vZHVsZXMnICYmIGl0ZW0gIT09ICcuZ2l0JyAmJiBpdGVtICE9PSAnLm5leHQnKSB7XG4gICAgICAgICAgc2VhcmNoRGlyZWN0b3J5KGZ1bGxQYXRoLCBwYXR0ZXJuLCBtYXRjaGVzKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChzdGF0LmlzRmlsZSgpKSB7XG4gICAgICAgIC8vIENoZWNrIGlmIGZpbGUgZXh0ZW5zaW9uIGlzIGFsbG93ZWRcbiAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGl0ZW0pO1xuICAgICAgICBpZiAoQUxMT1dFRF9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dCkgfHwgZXh0ID09PSAnJyB8fCBpdGVtLmluY2x1ZGVzKCdEb2NrZXJmaWxlJykpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhmdWxsUGF0aCwgJ3V0Zi04Jyk7XG4gICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXG4gICAgICAgICAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChwYXR0ZXJuLCAnaScpLnRlc3QobGluZSkpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgZmlsZTogZnVsbFBhdGgsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiBsaW5lLnRyaW0oKSxcbiAgICAgICAgICAgICAgICAgIGxpbmU6IGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIFNraXAgZmlsZXMgdGhhdCBjYW4ndCBiZSByZWFkIChiaW5hcnkgZmlsZXMsIGV0Yy4pXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gU2tpcCBkaXJlY3RvcmllcyB3ZSBjYW4ndCByZWFkXG4gICAgcmV0dXJuO1xuICB9XG59XG5cbi8vIFJlZ2V4IGZpbGUgc2VhcmNoIG9wZXJhdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEZpbGVzKGRpclBhdGg6IHN0cmluZywgcGF0dGVybjogc3RyaW5nKTogUHJvbWlzZTx7c3VjY2VzczogYm9vbGVhbiwgbWF0Y2hlcz86IEFycmF5PHtmaWxlOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZywgbGluZTogbnVtYmVyfT4sIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShkaXJQYXRoKSAmJiAhU0FGRV9ESVJFQ1RPUklFUy5zb21lKGRpciA9PiBkaXJQYXRoLmluY2x1ZGVzKGRpcikpKSB7XG4gICAgICByZXR1cm4ge3N1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1BhdGggbm90IGFsbG93ZWQgZm9yIHNlY3VyaXR5IHJlYXNvbnMnfTtcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgYmFzZSBkaXJlY3RvcnkgZXhpc3RzXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGRpclBhdGgpKSB7XG4gICAgICByZXR1cm4ge3N1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0RpcmVjdG9yeSBkb2VzIG5vdCBleGlzdCd9O1xuICAgIH1cblxuICAgIGNvbnN0IG1hdGNoZXM6IEFycmF5PHtmaWxlOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZywgbGluZTogbnVtYmVyfT4gPSBbXTtcblxuICAgIHNlYXJjaERpcmVjdG9yeShkaXJQYXRoLCBwYXR0ZXJuLCBtYXRjaGVzKTtcblxuICAgIHJldHVybiB7c3VjY2VzczogdHJ1ZSwgbWF0Y2hlc307XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgZHVyaW5nIGZpbGUgc2VhcmNoJ1xuICAgIH07XG4gIH1cbn1cblxuLy8gU2NoZW1hIGRlZmluaXRpb25zIGZvciB0b29sIGNhbGxzXG5leHBvcnQgY29uc3QgRmlsZVJlYWRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGZpbGVQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBmaWxlIHRvIHJlYWQnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgRmlsZVdyaXRlU2NoZW1hID0gei5vYmplY3Qoe1xuICBmaWxlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB3aGVyZSB0byBjcmVhdGUvbW9kaWZ5IHRoZSBmaWxlJyksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ0NvbnRlbnQgdG8gd3JpdGUgdG8gdGhlIGZpbGUnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgRmlsZUFwcGVuZFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUgdG8gYXBwZW5kIHRvJyksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ0NvbnRlbnQgdG8gYXBwZW5kIHRvIHRoZSBmaWxlJyksXG59KTtcblxuZXhwb3J0IGNvbnN0IEZpbGVEZWxldGVTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGZpbGVQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBmaWxlIHRvIGRlbGV0ZScpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBEaXJlY3RvcnlMaXN0U2NoZW1hID0gei5vYmplY3Qoe1xuICBkaXJQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBkaXJlY3RvcnkgdG8gbGlzdCcpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBGaWxlU2VhcmNoU2NoZW1hID0gei5vYmplY3Qoe1xuICBkaXJQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdEaXJlY3RvcnkgdG8gc2VhcmNoIGluJyksXG4gIHBhdHRlcm46IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1JlZ2V4IHBhdHRlcm4gdG8gc2VhcmNoIGZvciAoSmF2YVNjcmlwdCByZWdleCBzeW50YXgpJyksXG59KTtcbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJ6IiwiU0FGRV9ESVJFQ1RPUklFUyIsIkFMTE9XRURfRVhURU5TSU9OUyIsImlzUGF0aFNhZmUiLCJmaWxlUGF0aCIsIm5vcm1hbGl6ZWRQYXRoIiwicmVzb2x2ZSIsImN3ZCIsInByb2Nlc3MiLCJhbGxvd2VkIiwic29tZSIsImRpciIsInJlc29sdmVkRGlyIiwiam9pbiIsInN0YXJ0c1dpdGgiLCJleHQiLCJleHRuYW1lIiwiZXh0QWxsb3dlZCIsImluY2x1ZGVzIiwicmVhZEZpbGUiLCJzdWNjZXNzIiwiZXJyb3IiLCJleGlzdHNTeW5jIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsIkVycm9yIiwibWVzc2FnZSIsIndyaXRlRmlsZSIsImRpcm5hbWUiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJ3cml0ZUZpbGVTeW5jIiwiYXBwZW5kVG9GaWxlIiwiYXBwZW5kRmlsZVN5bmMiLCJkZWxldGVGaWxlIiwiaXNJbkdlbmVyYXRlZCIsInVubGlua1N5bmMiLCJsaXN0RGlyZWN0b3J5IiwiZGlyUGF0aCIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJmaWxlRXhpc3RzIiwic2VhcmNoRGlyZWN0b3J5IiwiY3VycmVudFBhdGgiLCJwYXR0ZXJuIiwibWF0Y2hlcyIsIml0ZW1zIiwiaXRlbSIsImZ1bGxQYXRoIiwic3RhdCIsInN0YXRTeW5jIiwiaXNEaXJlY3RvcnkiLCJpc0ZpbGUiLCJsaW5lcyIsInNwbGl0IiwiZm9yRWFjaCIsImxpbmUiLCJpbmRleCIsIlJlZ0V4cCIsInRlc3QiLCJwdXNoIiwiZmlsZSIsInRyaW0iLCJzZWFyY2hGaWxlcyIsIkZpbGVSZWFkU2NoZW1hIiwib2JqZWN0Iiwic3RyaW5nIiwiZGVzY3JpYmUiLCJGaWxlV3JpdGVTY2hlbWEiLCJGaWxlQXBwZW5kU2NoZW1hIiwiRmlsZURlbGV0ZVNjaGVtYSIsIkRpcmVjdG9yeUxpc3RTY2hlbWEiLCJGaWxlU2VhcmNoU2NoZW1hIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/fileops.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/memory-db.ts":
/*!********************************!*\
  !*** ./lib/utils/memory-db.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConversationMemory: () => (/* binding */ ConversationMemory),\n/* harmony export */   getSessionMemory: () => (/* binding */ getSessionMemory),\n/* harmony export */   setupSessionCleanup: () => (/* binding */ setupSessionCleanup)\n/* harmony export */ });\n/* harmony import */ var _db_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../db/database */ \"(rsc)/./lib/db/database.ts\");\n/* harmony import */ var _summarizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./summarizer */ \"(rsc)/./lib/utils/summarizer.ts\");\n\n\n// Configuration\nconst MAX_MESSAGES_BEFORE_SUMMARIZATION = 20;\nconst SUMMARIZATION_INTERVAL_MINUTES = 30;\n// In-memory cache for summarized history to avoid repeated DB queries\nconst summarizationCache = new Map();\nclass ConversationMemory {\n    constructor(sessionId, projectFolder){\n        this.sessionId = sessionId;\n        this.projectFolder = projectFolder;\n        this.initSession();\n    }\n    async initSession() {\n        await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getOrCreateSession)(this.sessionId, this.projectFolder);\n    }\n    // Add a message to memory (now persisted to database)\n    async addMessage(role, content) {\n        const message = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.addConversation)(this.sessionId, role, content);\n        // Check if we need to summarize\n        await this.checkAndSummarize();\n        return {\n            id: message.id,\n            role: message.role,\n            content: message.content,\n            timestamp: message.timestamp\n        };\n    }\n    // Add a file operation to memory (now persisted)\n    async addFileOperation(type, filename) {\n        const operation = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.trackFileOperation)(this.sessionId, type, filename);\n        return {\n            type: operation.operation,\n            filename: operation.filePath,\n            timestamp: operation.timestamp,\n            sessionId: operation.sessionId\n        };\n    }\n    // Get conversation history from database\n    async getMessages(limit) {\n        const conversations = limit ? await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getRecentConversations)(this.sessionId, limit) : await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getConversations)(this.sessionId);\n        return conversations.map((c)=>({\n                id: c.id,\n                role: c.role,\n                content: c.content,\n                timestamp: c.timestamp\n            }));\n    }\n    // Get recent file operations from database\n    async getRecentFileOperations(limit = 10) {\n        const operations = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getFileOperations)(this.sessionId, limit);\n        return operations.map((op)=>({\n                type: op.operation,\n                filename: op.filePath,\n                timestamp: op.timestamp,\n                sessionId: op.sessionId\n            }));\n    }\n    // Get all file operations related to a specific file\n    async getSessionFiles() {\n        const operations = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getFileOperations)(this.sessionId, 1000);\n        const fileSet = new Set();\n        operations.forEach((op)=>{\n            if (op.operation !== \"deleted\") {\n                fileSet.add(op.filePath);\n            } else {\n                fileSet.delete(op.filePath);\n            }\n        });\n        return Array.from(fileSet);\n    }\n    // Search messages by content\n    async searchMessages(query) {\n        const messages = await this.getMessages();\n        const lowerQuery = query.toLowerCase();\n        return messages.filter((msg)=>msg.content.toLowerCase().includes(lowerQuery));\n    }\n    // Get a context summary for the agent\n    async getContextSummary() {\n        const messages = await this.getMessages();\n        if (messages.length === 0) {\n            return null;\n        }\n        // Check cache first\n        const cached = summarizationCache.get(this.sessionId);\n        if (cached && messages.length < MAX_MESSAGES_BEFORE_SUMMARIZATION) {\n            const age = Date.now() - cached.timestamp.getTime();\n            if (age < SUMMARIZATION_INTERVAL_MINUTES * 60 * 1000) {\n                return cached.summary;\n            }\n        }\n        const recentMessages = messages.slice(-10);\n        const conversationText = recentMessages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\");\n        const files = await this.getSessionFiles();\n        const filesList = files.length > 0 ? `\\nFiles in project: ${files.join(\", \")}` : \"\";\n        return `Previous conversation context:\\n${conversationText}${filesList}`;\n    }\n    // Get compressed context for token efficiency\n    async getCompressedContext(userRequest = \"\") {\n        const messages = await this.getMessages();\n        if (messages.length === 0) {\n            return null;\n        }\n        // Use cached summary if available and recent\n        const cached = summarizationCache.get(this.sessionId);\n        if (cached) {\n            const age = Date.now() - cached.timestamp.getTime();\n            if (age < SUMMARIZATION_INTERVAL_MINUTES * 60 * 1000) {\n                return cached.summary;\n            }\n        }\n        // Generate new summary\n        const messageArray = messages.map((m)=>({\n                role: m.role,\n                content: m.content\n            }));\n        const result = await (0,_summarizer__WEBPACK_IMPORTED_MODULE_1__.compressContext)({\n            userRequest: userRequest || \"Continue working on the project\",\n            conversationHistory: messageArray\n        });\n        const compressed = result.compressedContext;\n        // Cache the result\n        summarizationCache.set(this.sessionId, {\n            summary: compressed,\n            timestamp: new Date()\n        });\n        return compressed;\n    }\n    // Check if summarization is needed\n    async checkAndSummarize() {\n        const messages = await this.getMessages();\n        if (messages.length < MAX_MESSAGES_BEFORE_SUMMARIZATION) {\n            return;\n        }\n        const cached = summarizationCache.get(this.sessionId);\n        if (cached) {\n            const age = Date.now() - cached.timestamp.getTime();\n            if (age < SUMMARIZATION_INTERVAL_MINUTES * 60 * 1000) {\n                return; // Recent summary exists\n            }\n        }\n        // Generate summary\n        await this.summarizeHistory();\n    }\n    // Summarize conversation history\n    async summarizeHistory() {\n        const messages = await this.getMessages();\n        if (messages.length < 5) {\n            return null;\n        }\n        const messageArray = messages.map((m)=>({\n                role: m.role,\n                content: m.content\n            }));\n        const result = await (0,_summarizer__WEBPACK_IMPORTED_MODULE_1__.summarizeConversation)(messageArray);\n        // Cache the summary\n        summarizationCache.set(this.sessionId, {\n            summary: result.summary,\n            timestamp: new Date()\n        });\n        console.log(`📝 Summarized ${messages.length} messages for session ${this.sessionId}`);\n        return result.summary;\n    }\n    // Get token estimate for current context\n    async getTokenEstimate() {\n        const context = await this.getContextSummary();\n        if (!context) return 0;\n        // Rough estimate: ~4 characters per token\n        return Math.ceil(context.length / 4);\n    }\n    // Get session statistics\n    async getStats() {\n        return await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getSessionStats)(this.sessionId);\n    }\n    // Clear session cache (useful for testing or memory management)\n    clearCache() {\n        summarizationCache.delete(this.sessionId);\n    }\n}\n// Global session memory instances\nconst sessionMemories = new Map();\nfunction getSessionMemory(sessionId, projectFolder = \"\") {\n    if (!sessionMemories.has(sessionId)) {\n        const memory = new ConversationMemory(sessionId, projectFolder);\n        sessionMemories.set(sessionId, memory);\n    }\n    return sessionMemories.get(sessionId);\n}\n// Clean up old sessions periodically\nfunction setupSessionCleanup(intervalHours = 24) {\n    setInterval(()=>{\n        const cutoffTime = Date.now() - intervalHours * 60 * 60 * 1000;\n        Array.from(sessionMemories.entries()).forEach(([sessionId, memory])=>{\n            memory.getStats().then((stats)=>{\n                if (stats && new Date(stats.updatedAt).getTime() < cutoffTime) {\n                    sessionMemories.delete(sessionId);\n                    console.log(`🧹 Cleaned up inactive session: ${sessionId}`);\n                }\n            });\n        });\n    }, intervalHours * 60 * 60 * 1000);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzdDO0lBRUEsZ0VBQWdFO0lBQ2hFdUUsYUFBYTtRQUNYM0UsbUJBQW1CZ0MsTUFBTSxDQUFDLElBQUksQ0FBQzVCLFNBQVM7SUFDMUM7QUFDRjtBQUVBLGtDQUFrQztBQUNsQyxNQUFNd0Usa0JBQWtCLElBQUkzRTtBQUVyQixTQUFTNEUsaUJBQWlCekUsU0FBaUIsRUFBRUMsZ0JBQXdCLEVBQUU7SUFDNUUsSUFBSSxDQUFDdUUsZ0JBQWdCRSxHQUFHLENBQUMxRSxZQUFZO1FBQ25DLE1BQU0yRSxTQUFTLElBQUk3RSxtQkFBbUJFLFdBQVdDO1FBQ2pEdUUsZ0JBQWdCVixHQUFHLENBQUM5RCxXQUFXMkU7SUFDakM7SUFDQSxPQUFPSCxnQkFBZ0I5QixHQUFHLENBQUMxQztBQUM3QjtBQUVBLHFDQUFxQztBQUM5QixTQUFTNEUsb0JBQW9CQyxnQkFBd0IsRUFBRTtJQUM1REMsWUFBWTtRQUNWLE1BQU1DLGFBQWFuQyxLQUFLQyxHQUFHLEtBQU1nQyxnQkFBZ0IsS0FBSyxLQUFLO1FBRTNEaEQsTUFBTUMsSUFBSSxDQUFDMEMsZ0JBQWdCUSxPQUFPLElBQUl0RCxPQUFPLENBQUMsQ0FBQyxDQUFDMUIsV0FBVzJFLE9BQU87WUFDaEVBLE9BQU9MLFFBQVEsR0FBR1csSUFBSSxDQUFDLENBQUNDO2dCQUN0QixJQUFJQSxTQUFTLElBQUl0QyxLQUFLc0MsTUFBTUMsU0FBUyxFQUFFckMsT0FBTyxLQUFLaUMsWUFBWTtvQkFDN0RQLGdCQUFnQjVDLE1BQU0sQ0FBQzVCO29CQUN2QmdFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdDQUFnQyxFQUFFakUsVUFBVSxDQUFDO2dCQUM1RDtZQUNGO1FBQ0Y7SUFDRixHQUFHNkUsZ0JBQWdCLEtBQUssS0FBSztBQUMvQiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL3V0aWxzL21lbW9yeS1kYi50cz9jN2RhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGdldE9yQ3JlYXRlU2Vzc2lvbixcbiAgYWRkQ29udmVyc2F0aW9uLFxuICBnZXRDb252ZXJzYXRpb25zLFxuICBnZXRSZWNlbnRDb252ZXJzYXRpb25zLFxuICB0cmFja0ZpbGVPcGVyYXRpb24sXG4gIGdldEZpbGVPcGVyYXRpb25zLFxuICBnZXRTZXNzaW9uU3RhdHMsXG59IGZyb20gJy4uL2RiL2RhdGFiYXNlJztcbmltcG9ydCB7IGNvbXByZXNzQ29udGV4dCwgc3VtbWFyaXplQ29udmVyc2F0aW9uIH0gZnJvbSAnLi9zdW1tYXJpemVyJztcblxuaW50ZXJmYWNlIENvbnZlcnNhdGlvbk1lc3NhZ2Uge1xuICBpZDogc3RyaW5nO1xuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgY29udGVudDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmludGVyZmFjZSBGaWxlT3BlcmF0aW9uIHtcbiAgdHlwZTogJ2NyZWF0ZWQnIHwgJ21vZGlmaWVkJyB8ICdyZWFkJyB8ICdkZWxldGVkJztcbiAgZmlsZW5hbWU6IHN0cmluZztcbiAgdGltZXN0YW1wOiBEYXRlO1xuICBzZXNzaW9uSWQ6IHN0cmluZztcbn1cblxuLy8gQ29uZmlndXJhdGlvblxuY29uc3QgTUFYX01FU1NBR0VTX0JFRk9SRV9TVU1NQVJJWkFUSU9OID0gMjA7XG5jb25zdCBTVU1NQVJJWkFUSU9OX0lOVEVSVkFMX01JTlVURVMgPSAzMDtcblxuLy8gSW4tbWVtb3J5IGNhY2hlIGZvciBzdW1tYXJpemVkIGhpc3RvcnkgdG8gYXZvaWQgcmVwZWF0ZWQgREIgcXVlcmllc1xuY29uc3Qgc3VtbWFyaXphdGlvbkNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHtcbiAgc3VtbWFyeTogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59PigpO1xuXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uTWVtb3J5IHtcbiAgcHJpdmF0ZSBzZXNzaW9uSWQ6IHN0cmluZztcbiAgcHJpdmF0ZSBwcm9qZWN0Rm9sZGVyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3Ioc2Vzc2lvbklkOiBzdHJpbmcsIHByb2plY3RGb2xkZXI6IHN0cmluZykge1xuICAgIHRoaXMuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgIHRoaXMucHJvamVjdEZvbGRlciA9IHByb2plY3RGb2xkZXI7XG4gICAgdGhpcy5pbml0U2Vzc2lvbigpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0U2Vzc2lvbigpIHtcbiAgICBhd2FpdCBnZXRPckNyZWF0ZVNlc3Npb24odGhpcy5zZXNzaW9uSWQsIHRoaXMucHJvamVjdEZvbGRlcik7XG4gIH1cblxuICAvLyBBZGQgYSBtZXNzYWdlIHRvIG1lbW9yeSAobm93IHBlcnNpc3RlZCB0byBkYXRhYmFzZSlcbiAgYXN5bmMgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgY29udGVudDogc3RyaW5nKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IGFkZENvbnZlcnNhdGlvbih0aGlzLnNlc3Npb25JZCwgcm9sZSwgY29udGVudCk7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byBzdW1tYXJpemVcbiAgICBhd2FpdCB0aGlzLmNoZWNrQW5kU3VtbWFyaXplKCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBtZXNzYWdlLmlkLFxuICAgICAgcm9sZTogbWVzc2FnZS5yb2xlIGFzICd1c2VyJyB8ICdhc3Npc3RhbnQnLFxuICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LFxuICAgICAgdGltZXN0YW1wOiBtZXNzYWdlLnRpbWVzdGFtcCxcbiAgICB9O1xuICB9XG5cbiAgLy8gQWRkIGEgZmlsZSBvcGVyYXRpb24gdG8gbWVtb3J5IChub3cgcGVyc2lzdGVkKVxuICBhc3luYyBhZGRGaWxlT3BlcmF0aW9uKHR5cGU6ICdjcmVhdGVkJyB8ICdtb2RpZmllZCcgfCAncmVhZCcgfCAnZGVsZXRlZCcsIGZpbGVuYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBvcGVyYXRpb24gPSBhd2FpdCB0cmFja0ZpbGVPcGVyYXRpb24odGhpcy5zZXNzaW9uSWQsIHR5cGUsIGZpbGVuYW1lKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogb3BlcmF0aW9uLm9wZXJhdGlvbiBhcyAnY3JlYXRlZCcgfCAnbW9kaWZpZWQnIHwgJ3JlYWQnIHwgJ2RlbGV0ZWQnLFxuICAgICAgZmlsZW5hbWU6IG9wZXJhdGlvbi5maWxlUGF0aCxcbiAgICAgIHRpbWVzdGFtcDogb3BlcmF0aW9uLnRpbWVzdGFtcCxcbiAgICAgIHNlc3Npb25JZDogb3BlcmF0aW9uLnNlc3Npb25JZCxcbiAgICB9O1xuICB9XG5cbiAgLy8gR2V0IGNvbnZlcnNhdGlvbiBoaXN0b3J5IGZyb20gZGF0YWJhc2VcbiAgYXN5bmMgZ2V0TWVzc2FnZXMobGltaXQ/OiBudW1iZXIpOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2VbXT4ge1xuICAgIGNvbnN0IGNvbnZlcnNhdGlvbnMgPSBsaW1pdCBcbiAgICAgID8gYXdhaXQgZ2V0UmVjZW50Q29udmVyc2F0aW9ucyh0aGlzLnNlc3Npb25JZCwgbGltaXQpXG4gICAgICA6IGF3YWl0IGdldENvbnZlcnNhdGlvbnModGhpcy5zZXNzaW9uSWQpO1xuICAgIFxuICAgIHJldHVybiBjb252ZXJzYXRpb25zLm1hcChjID0+ICh7XG4gICAgICBpZDogYy5pZCxcbiAgICAgIHJvbGU6IGMucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JyxcbiAgICAgIGNvbnRlbnQ6IGMuY29udGVudCxcbiAgICAgIHRpbWVzdGFtcDogYy50aW1lc3RhbXAsXG4gICAgfSkpO1xuICB9XG5cbiAgLy8gR2V0IHJlY2VudCBmaWxlIG9wZXJhdGlvbnMgZnJvbSBkYXRhYmFzZVxuICBhc3luYyBnZXRSZWNlbnRGaWxlT3BlcmF0aW9ucyhsaW1pdCA9IDEwKTogUHJvbWlzZTxGaWxlT3BlcmF0aW9uW10+IHtcbiAgICBjb25zdCBvcGVyYXRpb25zID0gYXdhaXQgZ2V0RmlsZU9wZXJhdGlvbnModGhpcy5zZXNzaW9uSWQsIGxpbWl0KTtcbiAgICBcbiAgICByZXR1cm4gb3BlcmF0aW9ucy5tYXAob3AgPT4gKHtcbiAgICAgIHR5cGU6IG9wLm9wZXJhdGlvbiBhcyAnY3JlYXRlZCcgfCAnbW9kaWZpZWQnIHwgJ3JlYWQnIHwgJ2RlbGV0ZWQnLFxuICAgICAgZmlsZW5hbWU6IG9wLmZpbGVQYXRoLFxuICAgICAgdGltZXN0YW1wOiBvcC50aW1lc3RhbXAsXG4gICAgICBzZXNzaW9uSWQ6IG9wLnNlc3Npb25JZCxcbiAgICB9KSk7XG4gIH1cblxuICAvLyBHZXQgYWxsIGZpbGUgb3BlcmF0aW9ucyByZWxhdGVkIHRvIGEgc3BlY2lmaWMgZmlsZVxuICBhc3luYyBnZXRTZXNzaW9uRmlsZXMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBhd2FpdCBnZXRGaWxlT3BlcmF0aW9ucyh0aGlzLnNlc3Npb25JZCwgMTAwMCk7XG4gICAgY29uc3QgZmlsZVNldCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIFxuICAgIG9wZXJhdGlvbnMuZm9yRWFjaChvcCA9PiB7XG4gICAgICBpZiAob3Aub3BlcmF0aW9uICE9PSAnZGVsZXRlZCcpIHtcbiAgICAgICAgZmlsZVNldC5hZGQob3AuZmlsZVBhdGgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmlsZVNldC5kZWxldGUob3AuZmlsZVBhdGgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBBcnJheS5mcm9tKGZpbGVTZXQpO1xuICB9XG5cbiAgLy8gU2VhcmNoIG1lc3NhZ2VzIGJ5IGNvbnRlbnRcbiAgYXN5bmMgc2VhcmNoTWVzc2FnZXMocXVlcnk6IHN0cmluZyk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZVtdPiB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKCk7XG4gICAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgcmV0dXJuIG1lc3NhZ2VzLmZpbHRlcihtc2cgPT5cbiAgICAgIG1zZy5jb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSlcbiAgICApO1xuICB9XG5cbiAgLy8gR2V0IGEgY29udGV4dCBzdW1tYXJ5IGZvciB0aGUgYWdlbnRcbiAgYXN5bmMgZ2V0Q29udGV4dFN1bW1hcnkoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKCk7XG4gICAgXG4gICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcbiAgICBjb25zdCBjYWNoZWQgPSBzdW1tYXJpemF0aW9uQ2FjaGUuZ2V0KHRoaXMuc2Vzc2lvbklkKTtcbiAgICBpZiAoY2FjaGVkICYmIG1lc3NhZ2VzLmxlbmd0aCA8IE1BWF9NRVNTQUdFU19CRUZPUkVfU1VNTUFSSVpBVElPTikge1xuICAgICAgY29uc3QgYWdlID0gRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAuZ2V0VGltZSgpO1xuICAgICAgaWYgKGFnZSA8IFNVTU1BUklaQVRJT05fSU5URVJWQUxfTUlOVVRFUyAqIDYwICogMTAwMCkge1xuICAgICAgICByZXR1cm4gY2FjaGVkLnN1bW1hcnk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVjZW50TWVzc2FnZXMgPSBtZXNzYWdlcy5zbGljZSgtMTApO1xuICAgIGNvbnN0IGNvbnZlcnNhdGlvblRleHQgPSByZWNlbnRNZXNzYWdlc1xuICAgICAgLm1hcChtID0+IGAke20ucm9sZX06ICR7bS5jb250ZW50fWApXG4gICAgICAuam9pbignXFxuJyk7XG5cbiAgICBjb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuZ2V0U2Vzc2lvbkZpbGVzKCk7XG4gICAgY29uc3QgZmlsZXNMaXN0ID0gZmlsZXMubGVuZ3RoID4gMFxuICAgICAgPyBgXFxuRmlsZXMgaW4gcHJvamVjdDogJHtmaWxlcy5qb2luKCcsICcpfWBcbiAgICAgIDogJyc7XG5cbiAgICByZXR1cm4gYFByZXZpb3VzIGNvbnZlcnNhdGlvbiBjb250ZXh0OlxcbiR7Y29udmVyc2F0aW9uVGV4dH0ke2ZpbGVzTGlzdH1gO1xuICB9XG5cbiAgLy8gR2V0IGNvbXByZXNzZWQgY29udGV4dCBmb3IgdG9rZW4gZWZmaWNpZW5jeVxuICBhc3luYyBnZXRDb21wcmVzc2VkQ29udGV4dCh1c2VyUmVxdWVzdDogc3RyaW5nID0gJycpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMuZ2V0TWVzc2FnZXMoKTtcbiAgICBcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBVc2UgY2FjaGVkIHN1bW1hcnkgaWYgYXZhaWxhYmxlIGFuZCByZWNlbnRcbiAgICBjb25zdCBjYWNoZWQgPSBzdW1tYXJpemF0aW9uQ2FjaGUuZ2V0KHRoaXMuc2Vzc2lvbklkKTtcbiAgICBpZiAoY2FjaGVkKSB7XG4gICAgICBjb25zdCBhZ2UgPSBEYXRlLm5vdygpIC0gY2FjaGVkLnRpbWVzdGFtcC5nZXRUaW1lKCk7XG4gICAgICBpZiAoYWdlIDwgU1VNTUFSSVpBVElPTl9JTlRFUlZBTF9NSU5VVEVTICogNjAgKiAxMDAwKSB7XG4gICAgICAgIHJldHVybiBjYWNoZWQuc3VtbWFyeTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBuZXcgc3VtbWFyeVxuICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VzLm1hcChtID0+ICh7IHJvbGU6IG0ucm9sZSwgY29udGVudDogbS5jb250ZW50IH0pKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21wcmVzc0NvbnRleHQoe1xuICAgICAgdXNlclJlcXVlc3Q6IHVzZXJSZXF1ZXN0IHx8ICdDb250aW51ZSB3b3JraW5nIG9uIHRoZSBwcm9qZWN0JyxcbiAgICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IG1lc3NhZ2VBcnJheSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbXByZXNzZWQgPSByZXN1bHQuY29tcHJlc3NlZENvbnRleHQ7XG5cbiAgICAvLyBDYWNoZSB0aGUgcmVzdWx0XG4gICAgc3VtbWFyaXphdGlvbkNhY2hlLnNldCh0aGlzLnNlc3Npb25JZCwge1xuICAgICAgc3VtbWFyeTogY29tcHJlc3NlZCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICB9KTtcblxuICAgIHJldHVybiBjb21wcmVzc2VkO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgc3VtbWFyaXphdGlvbiBpcyBuZWVkZWRcbiAgcHJpdmF0ZSBhc3luYyBjaGVja0FuZFN1bW1hcml6ZSgpIHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMuZ2V0TWVzc2FnZXMoKTtcbiAgICBcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoIDwgTUFYX01FU1NBR0VTX0JFRk9SRV9TVU1NQVJJWkFUSU9OKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgY2FjaGVkID0gc3VtbWFyaXphdGlvbkNhY2hlLmdldCh0aGlzLnNlc3Npb25JZCk7XG4gICAgaWYgKGNhY2hlZCkge1xuICAgICAgY29uc3QgYWdlID0gRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAuZ2V0VGltZSgpO1xuICAgICAgaWYgKGFnZSA8IFNVTU1BUklaQVRJT05fSU5URVJWQUxfTUlOVVRFUyAqIDYwICogMTAwMCkge1xuICAgICAgICByZXR1cm47IC8vIFJlY2VudCBzdW1tYXJ5IGV4aXN0c1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIHN1bW1hcnlcbiAgICBhd2FpdCB0aGlzLnN1bW1hcml6ZUhpc3RvcnkoKTtcbiAgfVxuXG4gIC8vIFN1bW1hcml6ZSBjb252ZXJzYXRpb24gaGlzdG9yeVxuICBwcml2YXRlIGFzeW5jIHN1bW1hcml6ZUhpc3RvcnkoKSB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKCk7XG4gICAgXG4gICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA8IDUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VzLm1hcChtID0+ICh7IHJvbGU6IG0ucm9sZSwgY29udGVudDogbS5jb250ZW50IH0pKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdW1tYXJpemVDb252ZXJzYXRpb24obWVzc2FnZUFycmF5KTtcbiAgICBcbiAgICAvLyBDYWNoZSB0aGUgc3VtbWFyeVxuICAgIHN1bW1hcml6YXRpb25DYWNoZS5zZXQodGhpcy5zZXNzaW9uSWQsIHtcbiAgICAgIHN1bW1hcnk6IHJlc3VsdC5zdW1tYXJ5LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYPCfk50gU3VtbWFyaXplZCAke21lc3NhZ2VzLmxlbmd0aH0gbWVzc2FnZXMgZm9yIHNlc3Npb24gJHt0aGlzLnNlc3Npb25JZH1gKTtcbiAgICByZXR1cm4gcmVzdWx0LnN1bW1hcnk7XG4gIH1cblxuICAvLyBHZXQgdG9rZW4gZXN0aW1hdGUgZm9yIGN1cnJlbnQgY29udGV4dFxuICBhc3luYyBnZXRUb2tlbkVzdGltYXRlKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0Q29udGV4dFN1bW1hcnkoKTtcbiAgICBpZiAoIWNvbnRleHQpIHJldHVybiAwO1xuICAgIFxuICAgIC8vIFJvdWdoIGVzdGltYXRlOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgIHJldHVybiBNYXRoLmNlaWwoY29udGV4dC5sZW5ndGggLyA0KTtcbiAgfVxuXG4gIC8vIEdldCBzZXNzaW9uIHN0YXRpc3RpY3NcbiAgYXN5bmMgZ2V0U3RhdHMoKSB7XG4gICAgcmV0dXJuIGF3YWl0IGdldFNlc3Npb25TdGF0cyh0aGlzLnNlc3Npb25JZCk7XG4gIH1cblxuICAvLyBDbGVhciBzZXNzaW9uIGNhY2hlICh1c2VmdWwgZm9yIHRlc3Rpbmcgb3IgbWVtb3J5IG1hbmFnZW1lbnQpXG4gIGNsZWFyQ2FjaGUoKSB7XG4gICAgc3VtbWFyaXphdGlvbkNhY2hlLmRlbGV0ZSh0aGlzLnNlc3Npb25JZCk7XG4gIH1cbn1cblxuLy8gR2xvYmFsIHNlc3Npb24gbWVtb3J5IGluc3RhbmNlc1xuY29uc3Qgc2Vzc2lvbk1lbW9yaWVzID0gbmV3IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbk1lbW9yeT4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlc3Npb25NZW1vcnkoc2Vzc2lvbklkOiBzdHJpbmcsIHByb2plY3RGb2xkZXI6IHN0cmluZyA9ICcnKTogQ29udmVyc2F0aW9uTWVtb3J5IHtcbiAgaWYgKCFzZXNzaW9uTWVtb3JpZXMuaGFzKHNlc3Npb25JZCkpIHtcbiAgICBjb25zdCBtZW1vcnkgPSBuZXcgQ29udmVyc2F0aW9uTWVtb3J5KHNlc3Npb25JZCwgcHJvamVjdEZvbGRlcik7XG4gICAgc2Vzc2lvbk1lbW9yaWVzLnNldChzZXNzaW9uSWQsIG1lbW9yeSk7XG4gIH1cbiAgcmV0dXJuIHNlc3Npb25NZW1vcmllcy5nZXQoc2Vzc2lvbklkKSE7XG59XG5cbi8vIENsZWFuIHVwIG9sZCBzZXNzaW9ucyBwZXJpb2RpY2FsbHlcbmV4cG9ydCBmdW5jdGlvbiBzZXR1cFNlc3Npb25DbGVhbnVwKGludGVydmFsSG91cnM6IG51bWJlciA9IDI0KSB7XG4gIHNldEludGVydmFsKCgpID0+IHtcbiAgICBjb25zdCBjdXRvZmZUaW1lID0gRGF0ZS5ub3coKSAtIChpbnRlcnZhbEhvdXJzICogNjAgKiA2MCAqIDEwMDApO1xuICAgIFxuICAgIEFycmF5LmZyb20oc2Vzc2lvbk1lbW9yaWVzLmVudHJpZXMoKSkuZm9yRWFjaCgoW3Nlc3Npb25JZCwgbWVtb3J5XSkgPT4ge1xuICAgICAgbWVtb3J5LmdldFN0YXRzKCkudGhlbigoc3RhdHM6IGFueSkgPT4ge1xuICAgICAgICBpZiAoc3RhdHMgJiYgbmV3IERhdGUoc3RhdHMudXBkYXRlZEF0KS5nZXRUaW1lKCkgPCBjdXRvZmZUaW1lKSB7XG4gICAgICAgICAgc2Vzc2lvbk1lbW9yaWVzLmRlbGV0ZShzZXNzaW9uSWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDwn6e5IENsZWFuZWQgdXAgaW5hY3RpdmUgc2Vzc2lvbjogJHtzZXNzaW9uSWR9YCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LCBpbnRlcnZhbEhvdXJzICogNjAgKiA2MCAqIDEwMDApO1xufVxuIl0sIm5hbWVzIjpbImdldE9yQ3JlYXRlU2Vzc2lvbiIsImFkZENvbnZlcnNhdGlvbiIsImdldENvbnZlcnNhdGlvbnMiLCJnZXRSZWNlbnRDb252ZXJzYXRpb25zIiwidHJhY2tGaWxlT3BlcmF0aW9uIiwiZ2V0RmlsZU9wZXJhdGlvbnMiLCJnZXRTZXNzaW9uU3RhdHMiLCJjb21wcmVzc0NvbnRleHQiLCJzdW1tYXJpemVDb252ZXJzYXRpb24iLCJNQVhfTUVTU0FHRVNfQkVGT1JFX1NVTU1BUklaQVRJT04iLCJTVU1NQVJJWkFUSU9OX0lOVEVSVkFMX01JTlVURVMiLCJzdW1tYXJpemF0aW9uQ2FjaGUiLCJNYXAiLCJDb252ZXJzYXRpb25NZW1vcnkiLCJjb25zdHJ1Y3RvciIsInNlc3Npb25JZCIsInByb2plY3RGb2xkZXIiLCJpbml0U2Vzc2lvbiIsImFkZE1lc3NhZ2UiLCJyb2xlIiwiY29udGVudCIsIm1lc3NhZ2UiLCJjaGVja0FuZFN1bW1hcml6ZSIsImlkIiwidGltZXN0YW1wIiwiYWRkRmlsZU9wZXJhdGlvbiIsInR5cGUiLCJmaWxlbmFtZSIsIm9wZXJhdGlvbiIsImZpbGVQYXRoIiwiZ2V0TWVzc2FnZXMiLCJsaW1pdCIsImNvbnZlcnNhdGlvbnMiLCJtYXAiLCJjIiwiZ2V0UmVjZW50RmlsZU9wZXJhdGlvbnMiLCJvcGVyYXRpb25zIiwib3AiLCJnZXRTZXNzaW9uRmlsZXMiLCJmaWxlU2V0IiwiU2V0IiwiZm9yRWFjaCIsImFkZCIsImRlbGV0ZSIsIkFycmF5IiwiZnJvbSIsInNlYXJjaE1lc3NhZ2VzIiwicXVlcnkiLCJtZXNzYWdlcyIsImxvd2VyUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsImZpbHRlciIsIm1zZyIsImluY2x1ZGVzIiwiZ2V0Q29udGV4dFN1bW1hcnkiLCJsZW5ndGgiLCJjYWNoZWQiLCJnZXQiLCJhZ2UiLCJEYXRlIiwibm93IiwiZ2V0VGltZSIsInN1bW1hcnkiLCJyZWNlbnRNZXNzYWdlcyIsInNsaWNlIiwiY29udmVyc2F0aW9uVGV4dCIsIm0iLCJqb2luIiwiZmlsZXMiLCJmaWxlc0xpc3QiLCJnZXRDb21wcmVzc2VkQ29udGV4dCIsInVzZXJSZXF1ZXN0IiwibWVzc2FnZUFycmF5IiwicmVzdWx0IiwiY29udmVyc2F0aW9uSGlzdG9yeSIsImNvbXByZXNzZWQiLCJjb21wcmVzc2VkQ29udGV4dCIsInNldCIsInN1bW1hcml6ZUhpc3RvcnkiLCJjb25zb2xlIiwibG9nIiwiZ2V0VG9rZW5Fc3RpbWF0ZSIsImNvbnRleHQiLCJNYXRoIiwiY2VpbCIsImdldFN0YXRzIiwiY2xlYXJDYWNoZSIsInNlc3Npb25NZW1vcmllcyIsImdldFNlc3Npb25NZW1vcnkiLCJoYXMiLCJtZW1vcnkiLCJzZXR1cFNlc3Npb25DbGVhbnVwIiwiaW50ZXJ2YWxIb3VycyIsInNldEludGVydmFsIiwiY3V0b2ZmVGltZSIsImVudHJpZXMiLCJ0aGVuIiwic3RhdHMiLCJ1cGRhdGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/memory-db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/project-embeddings.ts":
/*!*****************************************!*\
  !*** ./lib/utils/project-embeddings.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ProjectEmbeddingService: () => (/* binding */ ProjectEmbeddingService),\n/* harmony export */   embedConversation: () => (/* binding */ embedConversation),\n/* harmony export */   embedProject: () => (/* binding */ embedProject)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _db_chroma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../db/chroma */ \"(rsc)/./lib/db/chroma.ts\");\n\n\n\n\n// Supported languages and their file extensions\nconst SUPPORTED_LANGUAGES = {\n    typescript: [\n        \".ts\",\n        \".tsx\"\n    ],\n    javascript: [\n        \".js\",\n        \".jsx\"\n    ],\n    python: [\n        \".py\"\n    ],\n    java: [\n        \".java\"\n    ],\n    csharp: [\n        \".cs\"\n    ],\n    go: [\n        \".go\"\n    ],\n    rust: [\n        \".rs\"\n    ],\n    cpp: [\n        \".cpp\",\n        \".cc\",\n        \".cxx\"\n    ],\n    c: [\n        \".c\",\n        \".h\"\n    ],\n    php: [\n        \".php\"\n    ],\n    ruby: [\n        \".rb\"\n    ],\n    swift: [\n        \".swift\"\n    ],\n    kotlin: [\n        \".kt\"\n    ],\n    scala: [\n        \".scala\"\n    ],\n    json: [\n        \".json\"\n    ],\n    yaml: [\n        \".yaml\",\n        \".yml\"\n    ],\n    xml: [\n        \".xml\"\n    ],\n    html: [\n        \".html\"\n    ],\n    css: [\n        \".css\",\n        \".scss\",\n        \".sass\"\n    ],\n    markdown: [\n        \".md\"\n    ],\n    dockerfile: [\n        \"Dockerfile\",\n        \".dockerfile\"\n    ],\n    shell: [\n        \".sh\",\n        \".bash\",\n        \".zsh\"\n    ],\n    sql: [\n        \".sql\"\n    ],\n    makefile: [\n        \"Makefile\",\n        \"makefile\"\n    ]\n};\n// Code separators for semantic chunking\nconst CODE_SEPARATORS = {\n    typescript: /\\b(class|function|interface|type|const|let|var|export|import|if|for|while|switch|try|catch)\\b/g,\n    javascript: /\\b(class|function|const|let|var|export|import|if|for|while|switch|try|catch)\\b/g,\n    python: /\\b(class|def|if|for|while|try|except|with|import|from)\\b/g,\n    java: /\\b(class|interface|public|private|protected|static|final|void|String|int|boolean)\\b/g,\n    go: /\\b(func|type|struct|interface|package|import|var|const|if|for|switch|select)\\b/g,\n    rust: /\\b(fn|struct|enum|impl|trait|let|const|fn|if|for|while|match|use)\\b/g,\n    php: /\\b(class|function|public|private|protected|static|final|abstract|interface)\\b/g,\n    csharp: /\\b(class|interface|public|private|protected|static|void|string|int|bool|using|namespace)\\b/g\n};\nclass ProjectEmbeddingService {\n    constructor(projectId, sourceDir = \"./generated\"){\n        this.projectId = projectId;\n        this.sourceDir = sourceDir;\n    }\n    // Main method to embed entire project\n    async embedProject() {\n        console.log(`🎯 Starting project embedding for: ${this.projectId}`);\n        try {\n            // Initialize ChromaDB collections\n            await _db_chroma__WEBPACK_IMPORTED_MODULE_3__.chromaManager.initializeProjectCollections(this.projectId);\n            // Scan and process all files\n            const files = await this.scanProjectFiles();\n            console.log(`📂 Found ${files.length} files in project`);\n            // Process different types of content\n            const codeChunks = await this.processCodeFiles(files);\n            const structureChunks = await this.createStructureEmbeddings(files);\n            // Store in ChromaDB\n            await _db_chroma__WEBPACK_IMPORTED_MODULE_3__.chromaManager.addCodeChunks(this.projectId, codeChunks);\n            await _db_chroma__WEBPACK_IMPORTED_MODULE_3__.chromaManager.addStructureChunks(this.projectId, structureChunks);\n            console.log(`✅ Successfully embedded project: ${this.projectId}`);\n        } catch (error) {\n            console.error(\"❌ Failed to embed project:\", error);\n            throw error;\n        }\n    }\n    // Scan all files in the project directory\n    async scanProjectFiles() {\n        const files = [];\n        const self = this;\n        function scanDirectory(dirPath) {\n            try {\n                const items = fs__WEBPACK_IMPORTED_MODULE_0__.readdirSync(dirPath);\n                for (const item of items){\n                    const fullPath = path__WEBPACK_IMPORTED_MODULE_1__.join(dirPath, item);\n                    const stat = fs__WEBPACK_IMPORTED_MODULE_0__.statSync(fullPath);\n                    if (stat.isDirectory()) {\n                        // Skip common directories\n                        if (![\n                            \"node_modules\",\n                            \".git\",\n                            \".next\",\n                            \"dist\",\n                            \"build\",\n                            \"target\"\n                        ].includes(item)) {\n                            scanDirectory(fullPath);\n                        }\n                    } else if (stat.isFile()) {\n                        const ext = path__WEBPACK_IMPORTED_MODULE_1__.extname(item);\n                        const language = self.detectLanguage(ext);\n                        if (language && stat.size < 1024 * 1024) {\n                            try {\n                                const content = fs__WEBPACK_IMPORTED_MODULE_0__.readFileSync(fullPath, \"utf-8\");\n                                files.push({\n                                    filename: path__WEBPACK_IMPORTED_MODULE_1__.relative(self.sourceDir, fullPath),\n                                    content,\n                                    language,\n                                    size: stat.size,\n                                    lastModified: stat.mtime\n                                });\n                            } catch (error) {\n                                continue;\n                            }\n                        }\n                    }\n                }\n            } catch (error) {\n                console.warn(`⚠️ Could not scan directory: ${dirPath}`);\n            }\n        }\n        scanDirectory(this.sourceDir);\n        return files;\n    }\n    // Detect programming language from file extension\n    detectLanguage(extension) {\n        for (const [language, extensions] of Object.entries(SUPPORTED_LANGUAGES)){\n            if (extensions.some((ext)=>extension === ext || extension.toLowerCase() === ext)) {\n                return language;\n            }\n        }\n        return null;\n    }\n    // Process code files and create semantic chunks\n    async processCodeFiles(files) {\n        const chunks = [];\n        for (const file of files){\n            const fileChunks = await this.createCodeChunks(file);\n            chunks.push(...fileChunks);\n        }\n        return chunks;\n    }\n    // Create semantic code chunks\n    async createCodeChunks(file) {\n        const chunks = [];\n        const lines = file.content.split(\"\\n\");\n        const separators = CODE_SEPARATORS[file.language];\n        if (!separators) {\n            // Simple line-based chunking for unsupported languages\n            return this.createLineBasedChunks(file);\n        }\n        // Find semantic boundaries\n        const boundaries = [\n            0\n        ];\n        let currentIndex = 0;\n        separators.lastIndex = 0; // Reset regex state\n        let match;\n        while((match = separators.exec(file.content)) !== null){\n            const lineStart = file.content.substr(0, match.index).split(\"\\n\").length - 1;\n            if (lineStart - currentIndex > 5) {\n                boundaries.push(lineStart);\n                currentIndex = lineStart;\n                if (boundaries.length >= 10) break; // Limit chunks per file\n            }\n        }\n        boundaries.push(lines.length);\n        // Create chunks between boundaries\n        for(let i = 0; i < boundaries.length - 1; i++){\n            const startLine = boundaries[i];\n            const endLine = boundaries[i + 1];\n            const chunkContent = lines.slice(startLine, endLine).join(\"\\n\");\n            if (chunkContent.trim().length > 50) {\n                const chunkId = (0,_db_chroma__WEBPACK_IMPORTED_MODULE_3__.generateChunkId)(this.projectId, file.filename, [\n                    startLine,\n                    endLine\n                ], \"code\");\n                const contentHash = crypto__WEBPACK_IMPORTED_MODULE_2__.createHash(\"sha256\").update(chunkContent).digest(\"hex\");\n                const metadata = {\n                    project_id: this.projectId,\n                    type: \"code\",\n                    filename: file.filename,\n                    language: file.language,\n                    lines_start: startLine,\n                    lines_end: endLine,\n                    dependencies: this.extractDependencies(chunkContent, file.language),\n                    parent_functions: this.extractParentFunctions(chunkContent, file.language),\n                    content_hash: contentHash,\n                    timestamp: new Date().toISOString()\n                };\n                chunks.push({\n                    id: chunkId,\n                    content: chunkContent.trim(),\n                    metadata\n                });\n            }\n        }\n        return chunks;\n    }\n    // Fallback line-based chunking for unsupported languages\n    createLineBasedChunks(file) {\n        const chunks = [];\n        const lines = file.content.split(\"\\n\");\n        const chunkSize = 20; // Lines per chunk\n        for(let i = 0; i < lines.length; i += chunkSize){\n            const chunkLines = lines.slice(i, i + chunkSize);\n            const chunkContent = chunkLines.join(\"\\n\");\n            if (chunkContent.trim().length > 0) {\n                const chunkId = (0,_db_chroma__WEBPACK_IMPORTED_MODULE_3__.generateChunkId)(this.projectId, file.filename, [\n                    i,\n                    i + chunkSize\n                ], \"code\");\n                const contentHash = crypto__WEBPACK_IMPORTED_MODULE_2__.createHash(\"sha256\").update(chunkContent).digest(\"hex\");\n                const metadata = {\n                    project_id: this.projectId,\n                    type: \"code\",\n                    filename: file.filename,\n                    language: file.language,\n                    lines_start: i,\n                    lines_end: i + chunkSize,\n                    dependencies: this.extractDependencies(chunkContent, file.language),\n                    parent_functions: this.extractParentFunctions(chunkContent, file.language),\n                    content_hash: contentHash,\n                    timestamp: new Date().toISOString()\n                };\n                chunks.push({\n                    id: chunkId,\n                    content: chunkContent.trim(),\n                    metadata\n                });\n            }\n        }\n        return chunks;\n    }\n    // Extract dependencies from code\n    extractDependencies(content, language) {\n        const imports = [];\n        try {\n            if ([\n                \"typescript\",\n                \"javascript\"\n            ].includes(language)) {\n                const importMatches = content.match(/import\\s+.*?\\s+from\\s+['\"](.+?)['\"]/g) || [];\n                const requireMatches = content.match(/require\\s*\\(\\s*['\"](.+?)['\"]\\s*\\)/g) || [];\n                [\n                    ...importMatches,\n                    ...requireMatches\n                ].forEach((match)=>{\n                    if (/^['\"`]/.test(match)) {\n                        const dep = match.match(/['\"](.+?)['\"]/)?.[1];\n                        if (dep && !dep.startsWith(\".\")) imports.push(dep.split(\"/\")[0]);\n                    }\n                });\n            } else if (language === \"python\") {\n                const matches = content.match(/^(?:from\\s+(.+?)\\s+import|import\\s+(.+))/gm) || [];\n                matches.forEach((match)=>{\n                    const dep = (match.includes(\"from\") ? match.split(\"from\")[1].split(\"import\")[0] : match.split(\"import\")[1]).trim().split(\".\")[0];\n                    if (!dep.startsWith(\".\")) imports.push(dep);\n                });\n            } else if (language === \"go\") {\n                const matches = content.match(/^\\s*import\\s*\\(/gm) && content.match(/(?:\"([^\"]+)\")/g) || [];\n                matches.forEach((match)=>{\n                    const dep = match.replace(/\"/g, \"\");\n                    if (!dep.startsWith(\"./\")) imports.push(dep.split(\"/\")[1]);\n                });\n            }\n        } catch (error) {\n        // Skip dependency extraction errors\n        }\n        return imports.length > 0 ? imports.slice(0, 3).join(\", \") : null; // Limit to 3 deps\n    }\n    // Extract parent function/class context\n    extractParentFunctions(content, language) {\n        const functions = [];\n        try {\n            if ([\n                \"typescript\",\n                \"javascript\"\n            ].includes(language)) {\n                // Extract function and class names\n                const funcMatches = content.match(/\\b(function|class|const|let|var)\\s+(\\w+)/g) || [];\n                funcMatches.forEach((match)=>{\n                    const parts = match.split(/\\s+/);\n                    if (parts.length >= 3) functions.push(parts[2]);\n                });\n                // Arrow functions and methods\n                const arrowMatches = content.match(/(\\w+)\\s*=>/g) || [];\n                arrowMatches.forEach((match)=>{\n                    functions.push(match.split(\"=>\")[0].trim());\n                });\n            } else if (language === \"python\") {\n                const matches = content.match(/\\b(?:def|class)\\s+(\\w+)/g) || [];\n                matches.forEach((match)=>{\n                    functions.push(match.split(/\\s+/)[1]);\n                });\n            } else if (language === \"java\") {\n                const matches = content.match(/\\b(?:public|private|protected|static|final|class|interface|void|String|int|boolean)\\s+\\w+/g) || [];\n                matches.forEach((match)=>{\n                    const words = match.split(/\\s+/);\n                    if (words.length >= 2) functions.push(words[words.length - 1]);\n                });\n            }\n        } catch (error) {\n        // Skip function extraction errors\n        }\n        return functions.length > 0 ? functions.slice(0, 3).join(\", \") : null;\n    }\n    // Create project structure embeddings\n    async createStructureEmbeddings(files) {\n        const chunks = [];\n        // Directory structure\n        const dirStructure = this.buildDirectoryTree(files);\n        chunks.push({\n            id: `structure_dirs_${this.projectId}_${Date.now()}`,\n            content: `Project directory structure:\\n${dirStructure}`,\n            metadata: {\n                project_id: this.projectId,\n                type: \"structure\",\n                filename: \"DIRECTORY_STRUCTURE\",\n                language: \"structure\",\n                timestamp: new Date().toISOString()\n            }\n        });\n        // File types summary\n        const fileTypes = this.summarizeFileTypes(files);\n        chunks.push({\n            id: `structure_types_${this.projectId}_${Date.now()}`,\n            content: `File types in project:\\n${fileTypes}`,\n            metadata: {\n                project_id: this.projectId,\n                type: \"structure\",\n                filename: \"FILE_TYPES\",\n                language: \"structure\",\n                timestamp: new Date().toISOString()\n            }\n        });\n        return chunks;\n    }\n    // Build ASCII directory tree\n    buildDirectoryTree(files) {\n        const tree = {};\n        files.forEach((file)=>{\n            const dir = path__WEBPACK_IMPORTED_MODULE_1__.dirname(file.filename);\n            if (!tree[dir]) tree[dir] = [];\n            tree[dir].push(file);\n        });\n        let result = \"\";\n        const sortedDirs = Object.keys(tree).sort();\n        sortedDirs.forEach((dir)=>{\n            result += `${dir}/\\n`;\n            tree[dir].forEach((file)=>{\n                result += `  └── ${path__WEBPACK_IMPORTED_MODULE_1__.basename(file.filename)} (${file.language}, ${(file.content.length / 1024).toFixed(1)}KB)\\n`;\n            });\n        });\n        return result;\n    }\n    // Summarize file types\n    summarizeFileTypes(files) {\n        const summary = {};\n        files.forEach((file)=>{\n            if (!summary[file.language]) {\n                summary[file.language] = {\n                    count: 0,\n                    totalSize: 0\n                };\n            }\n            summary[file.language].count++;\n            summary[file.language].totalSize += file.size;\n        });\n        let result = \"\";\n        Object.entries(summary).forEach(([lang, stats])=>{\n            result += `${lang}: ${stats.count} files (${(stats.totalSize / 1024).toFixed(1)}KB total)\\n`;\n        });\n        return result;\n    }\n    // Embed conversation history\n    async embedConversation(sessionId) {\n        try {\n            const { getSessionMemory } = await __webpack_require__.e(/*! import() */ \"_rsc_lib_utils_memory_ts\").then(__webpack_require__.bind(__webpack_require__, /*! ./memory */ \"(rsc)/./lib/utils/memory.ts\"));\n            const memory = getSessionMemory(sessionId);\n            const messages = memory.getMessages(); // Get last 10 messages\n            const recentMessages = messages.slice(-10);\n            if (recentMessages.length === 0) return;\n            // Create prompt chunks\n            const promptChunks = recentMessages.map((msg, index)=>({\n                    id: `conversation_${this.projectId}_${sessionId}_${index}`,\n                    content: `${msg.role}: ${msg.content}`,\n                    metadata: {\n                        project_id: this.projectId,\n                        session_id: sessionId,\n                        type: \"prompt\",\n                        message_index: index,\n                        role: msg.role,\n                        timestamp: msg.timestamp.toISOString()\n                    }\n                }));\n            await _db_chroma__WEBPACK_IMPORTED_MODULE_3__.chromaManager.addPromptChunks(this.projectId, promptChunks);\n            console.log(`💬 Embedded ${promptChunks.length} conversation messages for project ${this.projectId}`);\n        } catch (error) {\n            console.error(\"❌ Failed to embed conversation:\", error);\n        }\n    }\n}\n// Export utility function to embed a project\nasync function embedProject(projectId, sourceDir = \"./generated\") {\n    const embedder = new ProjectEmbeddingService(projectId, sourceDir);\n    await embedder.embedProject();\n}\n// Export utility function to embed conversation\nasync function embedConversation(projectId, sessionId) {\n    const embedder = new ProjectEmbeddingService(projectId);\n    await embedder.embedConversation(sessionId);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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IndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi91dGlscy9wcm9qZWN0LWVtYmVkZGluZ3MudHM/NGY2NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgeyBjaHJvbWFNYW5hZ2VyLCBDaHJvbWFNZXRhZGF0YSwgQ29kZUNodW5rLCBnZW5lcmF0ZUNodW5rSWQgfSBmcm9tICcuLi9kYi9jaHJvbWEnO1xuXG5pbnRlcmZhY2UgUHJvamVjdEZpbGUge1xuICBmaWxlbmFtZTogc3RyaW5nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIGxhbmd1YWdlOiBzdHJpbmc7XG4gIHNpemU6IG51bWJlcjtcbiAgbGFzdE1vZGlmaWVkOiBEYXRlO1xufVxuXG4vLyBTdXBwb3J0ZWQgbGFuZ3VhZ2VzIGFuZCB0aGVpciBmaWxlIGV4dGVuc2lvbnNcbmNvbnN0IFNVUFBPUlRFRF9MQU5HVUFHRVMgPSB7XG4gIHR5cGVzY3JpcHQ6IFsnLnRzJywgJy50c3gnXSxcbiAgamF2YXNjcmlwdDogWycuanMnLCAnLmpzeCddLFxuICBweXRob246IFsnLnB5J10sXG4gIGphdmE6IFsnLmphdmEnXSxcbiAgY3NoYXJwOiBbJy5jcyddLFxuICBnbzogWycuZ28nXSxcbiAgcnVzdDogWycucnMnXSxcbiAgY3BwOiBbJy5jcHAnLCAnLmNjJywgJy5jeHgnXSxcbiAgYzogWycuYycsICcuaCddLFxuICBwaHA6IFsnLnBocCddLFxuICBydWJ5OiBbJy5yYiddLFxuICBzd2lmdDogWycuc3dpZnQnXSxcbiAga290bGluOiBbJy5rdCddLFxuICBzY2FsYTogWycuc2NhbGEnXSxcbiAganNvbjogWycuanNvbiddLFxuICB5YW1sOiBbJy55YW1sJywgJy55bWwnXSxcbiAgeG1sOiBbJy54bWwnXSxcbiAgaHRtbDogWycuaHRtbCddLFxuICBjc3M6IFsnLmNzcycsICcuc2NzcycsICcuc2FzcyddLFxuICBtYXJrZG93bjogWycubWQnXSxcbiAgZG9ja2VyZmlsZTogWydEb2NrZXJmaWxlJywgJy5kb2NrZXJmaWxlJ10sXG4gIHNoZWxsOiBbJy5zaCcsICcuYmFzaCcsICcuenNoJ10sXG4gIHNxbDogWycuc3FsJ10sXG4gIG1ha2VmaWxlOiBbJ01ha2VmaWxlJywgJ21ha2VmaWxlJ11cbn07XG5cbi8vIENvZGUgc2VwYXJhdG9ycyBmb3Igc2VtYW50aWMgY2h1bmtpbmdcbmNvbnN0IENPREVfU0VQQVJBVE9SUyA9IHtcbiAgdHlwZXNjcmlwdDogL1xcYihjbGFzc3xmdW5jdGlvbnxpbnRlcmZhY2V8dHlwZXxjb25zdHxsZXR8dmFyfGV4cG9ydHxpbXBvcnR8aWZ8Zm9yfHdoaWxlfHN3aXRjaHx0cnl8Y2F0Y2gpXFxiL2csXG4gIGphdmFzY3JpcHQ6IC9cXGIoY2xhc3N8ZnVuY3Rpb258Y29uc3R8bGV0fHZhcnxleHBvcnR8aW1wb3J0fGlmfGZvcnx3aGlsZXxzd2l0Y2h8dHJ5fGNhdGNoKVxcYi9nLFxuICBweXRob246IC9cXGIoY2xhc3N8ZGVmfGlmfGZvcnx3aGlsZXx0cnl8ZXhjZXB0fHdpdGh8aW1wb3J0fGZyb20pXFxiL2csXG4gIGphdmE6IC9cXGIoY2xhc3N8aW50ZXJmYWNlfHB1YmxpY3xwcml2YXRlfHByb3RlY3RlZHxzdGF0aWN8ZmluYWx8dm9pZHxTdHJpbmd8aW50fGJvb2xlYW4pXFxiL2csXG4gIGdvOiAvXFxiKGZ1bmN8dHlwZXxzdHJ1Y3R8aW50ZXJmYWNlfHBhY2thZ2V8aW1wb3J0fHZhcnxjb25zdHxpZnxmb3J8c3dpdGNofHNlbGVjdClcXGIvZyxcbiAgcnVzdDogL1xcYihmbnxzdHJ1Y3R8ZW51bXxpbXBsfHRyYWl0fGxldHxjb25zdHxmbnxpZnxmb3J8d2hpbGV8bWF0Y2h8dXNlKVxcYi9nLFxuICBwaHA6IC9cXGIoY2xhc3N8ZnVuY3Rpb258cHVibGljfHByaXZhdGV8cHJvdGVjdGVkfHN0YXRpY3xmaW5hbHxhYnN0cmFjdHxpbnRlcmZhY2UpXFxiL2csXG4gIGNzaGFycDogL1xcYihjbGFzc3xpbnRlcmZhY2V8cHVibGljfHByaXZhdGV8cHJvdGVjdGVkfHN0YXRpY3x2b2lkfHN0cmluZ3xpbnR8Ym9vbHx1c2luZ3xuYW1lc3BhY2UpXFxiL2dcbn07XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0RW1iZWRkaW5nU2VydmljZSB7XG4gIHByaXZhdGUgcHJvamVjdElkOiBzdHJpbmc7XG4gIHByaXZhdGUgc291cmNlRGlyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IocHJvamVjdElkOiBzdHJpbmcsIHNvdXJjZURpcjogc3RyaW5nID0gJy4vZ2VuZXJhdGVkJykge1xuICAgIHRoaXMucHJvamVjdElkID0gcHJvamVjdElkO1xuICAgIHRoaXMuc291cmNlRGlyID0gc291cmNlRGlyO1xuICB9XG5cbiAgLy8gTWFpbiBtZXRob2QgdG8gZW1iZWQgZW50aXJlIHByb2plY3RcbiAgYXN5bmMgZW1iZWRQcm9qZWN0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnNvbGUubG9nKGDwn46vIFN0YXJ0aW5nIHByb2plY3QgZW1iZWRkaW5nIGZvcjogJHt0aGlzLnByb2plY3RJZH1gKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBJbml0aWFsaXplIENocm9tYURCIGNvbGxlY3Rpb25zXG4gICAgICBhd2FpdCBjaHJvbWFNYW5hZ2VyLmluaXRpYWxpemVQcm9qZWN0Q29sbGVjdGlvbnModGhpcy5wcm9qZWN0SWQpO1xuXG4gICAgICAvLyBTY2FuIGFuZCBwcm9jZXNzIGFsbCBmaWxlc1xuICAgICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLnNjYW5Qcm9qZWN0RmlsZXMoKTtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OCIEZvdW5kICR7ZmlsZXMubGVuZ3RofSBmaWxlcyBpbiBwcm9qZWN0YCk7XG5cbiAgICAgIC8vIFByb2Nlc3MgZGlmZmVyZW50IHR5cGVzIG9mIGNvbnRlbnRcbiAgICAgIGNvbnN0IGNvZGVDaHVua3MgPSBhd2FpdCB0aGlzLnByb2Nlc3NDb2RlRmlsZXMoZmlsZXMpO1xuICAgICAgY29uc3Qgc3RydWN0dXJlQ2h1bmtzID0gYXdhaXQgdGhpcy5jcmVhdGVTdHJ1Y3R1cmVFbWJlZGRpbmdzKGZpbGVzKTtcblxuICAgICAgLy8gU3RvcmUgaW4gQ2hyb21hREJcbiAgICAgIGF3YWl0IGNocm9tYU1hbmFnZXIuYWRkQ29kZUNodW5rcyh0aGlzLnByb2plY3RJZCwgY29kZUNodW5rcyk7XG4gICAgICBhd2FpdCBjaHJvbWFNYW5hZ2VyLmFkZFN0cnVjdHVyZUNodW5rcyh0aGlzLnByb2plY3RJZCwgc3RydWN0dXJlQ2h1bmtzKTtcblxuICAgICAgY29uc29sZS5sb2coYOKchSBTdWNjZXNzZnVsbHkgZW1iZWRkZWQgcHJvamVjdDogJHt0aGlzLnByb2plY3RJZH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBlbWJlZCBwcm9qZWN0OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8vIFNjYW4gYWxsIGZpbGVzIGluIHRoZSBwcm9qZWN0IGRpcmVjdG9yeVxuICBwcml2YXRlIGFzeW5jIHNjYW5Qcm9qZWN0RmlsZXMoKTogUHJvbWlzZTxQcm9qZWN0RmlsZVtdPiB7XG4gICAgY29uc3QgZmlsZXM6IFByb2plY3RGaWxlW10gPSBbXTtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgIGZ1bmN0aW9uIHNjYW5EaXJlY3RvcnkoZGlyUGF0aDogc3RyaW5nKTogdm9pZCB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpdGVtcyA9IGZzLnJlYWRkaXJTeW5jKGRpclBhdGgpO1xuXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKGRpclBhdGgsIGl0ZW0pO1xuICAgICAgICAgIGNvbnN0IHN0YXQgPSBmcy5zdGF0U3luYyhmdWxsUGF0aCk7XG5cbiAgICAgICAgICBpZiAoc3RhdC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICAvLyBTa2lwIGNvbW1vbiBkaXJlY3Rvcmllc1xuICAgICAgICAgICAgaWYgKCFbJ25vZGVfbW9kdWxlcycsICcuZ2l0JywgJy5uZXh0JywgJ2Rpc3QnLCAnYnVpbGQnLCAndGFyZ2V0J10uaW5jbHVkZXMoaXRlbSkpIHtcbiAgICAgICAgICAgICAgc2NhbkRpcmVjdG9yeShmdWxsUGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChzdGF0LmlzRmlsZSgpKSB7XG4gICAgICAgICAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoaXRlbSk7XG4gICAgICAgICAgICBjb25zdCBsYW5ndWFnZSA9IHNlbGYuZGV0ZWN0TGFuZ3VhZ2UoZXh0KTtcblxuICAgICAgICAgICAgaWYgKGxhbmd1YWdlICYmIHN0YXQuc2l6ZSA8IDEwMjQgKiAxMDI0KSB7IC8vIFNraXAgZmlsZXMgPiAxTUJcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZ1bGxQYXRoLCAndXRmLTgnKTtcbiAgICAgICAgICAgICAgICBmaWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBwYXRoLnJlbGF0aXZlKHNlbGYuc291cmNlRGlyLCBmdWxsUGF0aCksXG4gICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2UsXG4gICAgICAgICAgICAgICAgICBzaXplOiBzdGF0LnNpemUsXG4gICAgICAgICAgICAgICAgICBsYXN0TW9kaWZpZWQ6IHN0YXQubXRpbWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBTa2lwIGJpbmFyeSBvciB1bnJlYWRhYmxlIGZpbGVzXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIENvdWxkIG5vdCBzY2FuIGRpcmVjdG9yeTogJHtkaXJQYXRofWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHNjYW5EaXJlY3RvcnkodGhpcy5zb3VyY2VEaXIpO1xuICAgIHJldHVybiBmaWxlcztcbiAgfVxuXG4gIC8vIERldGVjdCBwcm9ncmFtbWluZyBsYW5ndWFnZSBmcm9tIGZpbGUgZXh0ZW5zaW9uXG4gIHByaXZhdGUgZGV0ZWN0TGFuZ3VhZ2UoZXh0ZW5zaW9uOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBmb3IgKGNvbnN0IFtsYW5ndWFnZSwgZXh0ZW5zaW9uc10gb2YgT2JqZWN0LmVudHJpZXMoU1VQUE9SVEVEX0xBTkdVQUdFUykpIHtcbiAgICAgIGlmIChleHRlbnNpb25zLnNvbWUoZXh0ID0+IGV4dGVuc2lvbiA9PT0gZXh0IHx8IGV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpID09PSBleHQpKSB7XG4gICAgICAgIHJldHVybiBsYW5ndWFnZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvLyBQcm9jZXNzIGNvZGUgZmlsZXMgYW5kIGNyZWF0ZSBzZW1hbnRpYyBjaHVua3NcbiAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzQ29kZUZpbGVzKGZpbGVzOiBQcm9qZWN0RmlsZVtdKTogUHJvbWlzZTxDb2RlQ2h1bmtbXT4ge1xuICAgIGNvbnN0IGNodW5rczogQ29kZUNodW5rW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgY29uc3QgZmlsZUNodW5rcyA9IGF3YWl0IHRoaXMuY3JlYXRlQ29kZUNodW5rcyhmaWxlKTtcbiAgICAgIGNodW5rcy5wdXNoKC4uLmZpbGVDaHVua3MpO1xuICAgIH1cblxuICAgIHJldHVybiBjaHVua3M7XG4gIH1cblxuICAvLyBDcmVhdGUgc2VtYW50aWMgY29kZSBjaHVua3NcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVDb2RlQ2h1bmtzKGZpbGU6IFByb2plY3RGaWxlKTogUHJvbWlzZTxDb2RlQ2h1bmtbXT4ge1xuICAgIGNvbnN0IGNodW5rczogQ29kZUNodW5rW10gPSBbXTtcbiAgICBjb25zdCBsaW5lcyA9IGZpbGUuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgY29uc3Qgc2VwYXJhdG9ycyA9IENPREVfU0VQQVJBVE9SU1tmaWxlLmxhbmd1YWdlIGFzIGtleW9mIHR5cGVvZiBDT0RFX1NFUEFSQVRPUlNdO1xuXG4gICAgaWYgKCFzZXBhcmF0b3JzKSB7XG4gICAgICAvLyBTaW1wbGUgbGluZS1iYXNlZCBjaHVua2luZyBmb3IgdW5zdXBwb3J0ZWQgbGFuZ3VhZ2VzXG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVMaW5lQmFzZWRDaHVua3MoZmlsZSk7XG4gICAgfVxuXG4gICAgLy8gRmluZCBzZW1hbnRpYyBib3VuZGFyaWVzXG4gICAgY29uc3QgYm91bmRhcmllczogbnVtYmVyW10gPSBbMF07XG4gICAgbGV0IGN1cnJlbnRJbmRleCA9IDA7XG5cbiAgICBzZXBhcmF0b3JzLmxhc3RJbmRleCA9IDA7IC8vIFJlc2V0IHJlZ2V4IHN0YXRlXG4gICAgbGV0IG1hdGNoO1xuICAgIHdoaWxlICgobWF0Y2ggPSBzZXBhcmF0b3JzLmV4ZWMoZmlsZS5jb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IGxpbmVTdGFydCA9IGZpbGUuY29udGVudC5zdWJzdHIoMCwgbWF0Y2guaW5kZXgpLnNwbGl0KCdcXG4nKS5sZW5ndGggLSAxO1xuICAgICAgaWYgKGxpbmVTdGFydCAtIGN1cnJlbnRJbmRleCA+IDUpIHsgLy8gTWluaW11bSBjaHVuayBzaXplXG4gICAgICAgIGJvdW5kYXJpZXMucHVzaChsaW5lU3RhcnQpO1xuICAgICAgICBjdXJyZW50SW5kZXggPSBsaW5lU3RhcnQ7XG5cbiAgICAgICAgaWYgKGJvdW5kYXJpZXMubGVuZ3RoID49IDEwKSBicmVhazsgLy8gTGltaXQgY2h1bmtzIHBlciBmaWxlXG4gICAgICB9XG4gICAgfVxuXG4gICAgYm91bmRhcmllcy5wdXNoKGxpbmVzLmxlbmd0aCk7XG5cbiAgICAvLyBDcmVhdGUgY2h1bmtzIGJldHdlZW4gYm91bmRhcmllc1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm91bmRhcmllcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IGJvdW5kYXJpZXNbaV07XG4gICAgICBjb25zdCBlbmRMaW5lID0gYm91bmRhcmllc1tpICsgMV07XG4gICAgICBjb25zdCBjaHVua0NvbnRlbnQgPSBsaW5lcy5zbGljZShzdGFydExpbmUsIGVuZExpbmUpLmpvaW4oJ1xcbicpO1xuXG4gICAgICBpZiAoY2h1bmtDb250ZW50LnRyaW0oKS5sZW5ndGggPiA1MCkgeyAvLyBTa2lwIHZlcnkgc21hbGwgY2h1bmtzXG4gICAgICAgIGNvbnN0IGNodW5rSWQgPSBnZW5lcmF0ZUNodW5rSWQodGhpcy5wcm9qZWN0SWQsIGZpbGUuZmlsZW5hbWUsIFtzdGFydExpbmUsIGVuZExpbmVdLCAnY29kZScpO1xuICAgICAgICBjb25zdCBjb250ZW50SGFzaCA9IGNyeXB0by5jcmVhdGVIYXNoKCdzaGEyNTYnKS51cGRhdGUoY2h1bmtDb250ZW50KS5kaWdlc3QoJ2hleCcpO1xuXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhOiBDaHJvbWFNZXRhZGF0YSA9IHtcbiAgICAgICAgICBwcm9qZWN0X2lkOiB0aGlzLnByb2plY3RJZCxcbiAgICAgICAgICB0eXBlOiAnY29kZScsXG4gICAgICAgICAgZmlsZW5hbWU6IGZpbGUuZmlsZW5hbWUsXG4gICAgICAgICAgbGFuZ3VhZ2U6IGZpbGUubGFuZ3VhZ2UsXG4gICAgICAgICAgbGluZXNfc3RhcnQ6IHN0YXJ0TGluZSxcbiAgICAgICAgICBsaW5lc19lbmQ6IGVuZExpbmUsXG4gICAgICAgICAgZGVwZW5kZW5jaWVzOiB0aGlzLmV4dHJhY3REZXBlbmRlbmNpZXMoY2h1bmtDb250ZW50LCBmaWxlLmxhbmd1YWdlKSxcbiAgICAgICAgICBwYXJlbnRfZnVuY3Rpb25zOiB0aGlzLmV4dHJhY3RQYXJlbnRGdW5jdGlvbnMoY2h1bmtDb250ZW50LCBmaWxlLmxhbmd1YWdlKSxcbiAgICAgICAgICBjb250ZW50X2hhc2g6IGNvbnRlbnRIYXNoLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH07XG5cbiAgICAgICAgY2h1bmtzLnB1c2goe1xuICAgICAgICAgIGlkOiBjaHVua0lkLFxuICAgICAgICAgIGNvbnRlbnQ6IGNodW5rQ29udGVudC50cmltKCksXG4gICAgICAgICAgbWV0YWRhdGFcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNodW5rcztcbiAgfVxuXG4gIC8vIEZhbGxiYWNrIGxpbmUtYmFzZWQgY2h1bmtpbmcgZm9yIHVuc3VwcG9ydGVkIGxhbmd1YWdlc1xuICBwcml2YXRlIGNyZWF0ZUxpbmVCYXNlZENodW5rcyhmaWxlOiBQcm9qZWN0RmlsZSk6IENvZGVDaHVua1tdIHtcbiAgICBjb25zdCBjaHVua3M6IENvZGVDaHVua1tdID0gW107XG4gICAgY29uc3QgbGluZXMgPSBmaWxlLmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGNodW5rU2l6ZSA9IDIwOyAvLyBMaW5lcyBwZXIgY2h1bmtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuICAgICAgY29uc3QgY2h1bmtMaW5lcyA9IGxpbmVzLnNsaWNlKGksIGkgKyBjaHVua1NpemUpO1xuICAgICAgY29uc3QgY2h1bmtDb250ZW50ID0gY2h1bmtMaW5lcy5qb2luKCdcXG4nKTtcblxuICAgICAgaWYgKGNodW5rQ29udGVudC50cmltKCkubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBjaHVua0lkID0gZ2VuZXJhdGVDaHVua0lkKHRoaXMucHJvamVjdElkLCBmaWxlLmZpbGVuYW1lLCBbaSwgaSArIGNodW5rU2l6ZV0sICdjb2RlJyk7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRIYXNoID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShjaHVua0NvbnRlbnQpLmRpZ2VzdCgnaGV4Jyk7XG5cbiAgICAgICAgY29uc3QgbWV0YWRhdGE6IENocm9tYU1ldGFkYXRhID0ge1xuICAgICAgICAgIHByb2plY3RfaWQ6IHRoaXMucHJvamVjdElkLFxuICAgICAgICAgIHR5cGU6ICdjb2RlJyxcbiAgICAgICAgICBmaWxlbmFtZTogZmlsZS5maWxlbmFtZSxcbiAgICAgICAgICBsYW5ndWFnZTogZmlsZS5sYW5ndWFnZSxcbiAgICAgICAgICBsaW5lc19zdGFydDogaSxcbiAgICAgICAgICBsaW5lc19lbmQ6IGkgKyBjaHVua1NpemUsXG4gICAgICAgICAgZGVwZW5kZW5jaWVzOiB0aGlzLmV4dHJhY3REZXBlbmRlbmNpZXMoY2h1bmtDb250ZW50LCBmaWxlLmxhbmd1YWdlKSxcbiAgICAgICAgICBwYXJlbnRfZnVuY3Rpb25zOiB0aGlzLmV4dHJhY3RQYXJlbnRGdW5jdGlvbnMoY2h1bmtDb250ZW50LCBmaWxlLmxhbmd1YWdlKSxcbiAgICAgICAgICBjb250ZW50X2hhc2g6IGNvbnRlbnRIYXNoLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH07XG5cbiAgICAgICAgY2h1bmtzLnB1c2goe1xuICAgICAgICAgIGlkOiBjaHVua0lkLFxuICAgICAgICAgIGNvbnRlbnQ6IGNodW5rQ29udGVudC50cmltKCksXG4gICAgICAgICAgbWV0YWRhdGFcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNodW5rcztcbiAgfVxuXG4gIC8vIEV4dHJhY3QgZGVwZW5kZW5jaWVzIGZyb20gY29kZVxuICBwcml2YXRlIGV4dHJhY3REZXBlbmRlbmNpZXMoY29udGVudDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3QgaW1wb3J0czogc3RyaW5nW10gPSBbXTtcblxuICAgIHRyeSB7XG4gICAgICBpZiAoWyd0eXBlc2NyaXB0JywgJ2phdmFzY3JpcHQnXS5pbmNsdWRlcyhsYW5ndWFnZSkpIHtcbiAgICAgICAgY29uc3QgaW1wb3J0TWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL2ltcG9ydFxccysuKj9cXHMrZnJvbVxccytbJ1wiXSguKz8pWydcIl0vZykgfHwgW107XG4gICAgICAgIGNvbnN0IHJlcXVpcmVNYXRjaGVzID0gY29udGVudC5tYXRjaCgvcmVxdWlyZVxccypcXChcXHMqWydcIl0oLis/KVsnXCJdXFxzKlxcKS9nKSB8fCBbXTtcblxuICAgICAgICBbLi4uaW1wb3J0TWF0Y2hlcywgLi4ucmVxdWlyZU1hdGNoZXNdLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgIGlmICgvXlsnXCJgXS8udGVzdChtYXRjaCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlcCA9IG1hdGNoLm1hdGNoKC9bJ1wiXSguKz8pWydcIl0vKT8uWzFdO1xuICAgICAgICAgICAgaWYgKGRlcCAmJiAhZGVwLnN0YXJ0c1dpdGgoJy4nKSkgaW1wb3J0cy5wdXNoKGRlcC5zcGxpdCgnLycpWzBdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChsYW5ndWFnZSA9PT0gJ3B5dGhvbicpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL14oPzpmcm9tXFxzKyguKz8pXFxzK2ltcG9ydHxpbXBvcnRcXHMrKC4rKSkvZ20pIHx8IFtdO1xuICAgICAgICBtYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgIGNvbnN0IGRlcCA9IChtYXRjaC5pbmNsdWRlcygnZnJvbScpID8gbWF0Y2guc3BsaXQoJ2Zyb20nKVsxXS5zcGxpdCgnaW1wb3J0JylbMF0gOiBtYXRjaC5zcGxpdCgnaW1wb3J0JylbMV0pLnRyaW0oKS5zcGxpdCgnLicpWzBdO1xuICAgICAgICAgIGlmICghZGVwLnN0YXJ0c1dpdGgoJy4nKSkgaW1wb3J0cy5wdXNoKGRlcCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChsYW5ndWFnZSA9PT0gJ2dvJykge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaCgvXlxccyppbXBvcnRcXHMqXFwoL2dtKSAmJiBjb250ZW50Lm1hdGNoKC8oPzpcIihbXlwiXSspXCIpL2cpIHx8IFtdO1xuICAgICAgICBtYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgIGNvbnN0IGRlcCA9IG1hdGNoLnJlcGxhY2UoL1wiL2csICcnKTtcbiAgICAgICAgICBpZiAoIWRlcC5zdGFydHNXaXRoKCcuLycpKSBpbXBvcnRzLnB1c2goZGVwLnNwbGl0KCcvJylbMV0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gU2tpcCBkZXBlbmRlbmN5IGV4dHJhY3Rpb24gZXJyb3JzXG4gICAgfVxuXG4gICAgcmV0dXJuIGltcG9ydHMubGVuZ3RoID4gMCA/IGltcG9ydHMuc2xpY2UoMCwgMykuam9pbignLCAnKSA6IG51bGw7IC8vIExpbWl0IHRvIDMgZGVwc1xuICB9XG5cbiAgLy8gRXh0cmFjdCBwYXJlbnQgZnVuY3Rpb24vY2xhc3MgY29udGV4dFxuICBwcml2YXRlIGV4dHJhY3RQYXJlbnRGdW5jdGlvbnMoY29udGVudDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3QgZnVuY3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChbJ3R5cGVzY3JpcHQnLCAnamF2YXNjcmlwdCddLmluY2x1ZGVzKGxhbmd1YWdlKSkge1xuICAgICAgICAvLyBFeHRyYWN0IGZ1bmN0aW9uIGFuZCBjbGFzcyBuYW1lc1xuICAgICAgICBjb25zdCBmdW5jTWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL1xcYihmdW5jdGlvbnxjbGFzc3xjb25zdHxsZXR8dmFyKVxccysoXFx3KykvZykgfHwgW107XG4gICAgICAgIGZ1bmNNYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgIGNvbnN0IHBhcnRzID0gbWF0Y2guc3BsaXQoL1xccysvKTtcbiAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID49IDMpIGZ1bmN0aW9ucy5wdXNoKHBhcnRzWzJdKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQXJyb3cgZnVuY3Rpb25zIGFuZCBtZXRob2RzXG4gICAgICAgIGNvbnN0IGFycm93TWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goLyhcXHcrKVxccyo9Pi9nKSB8fCBbXTtcbiAgICAgICAgYXJyb3dNYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgIGZ1bmN0aW9ucy5wdXNoKG1hdGNoLnNwbGl0KCc9PicpWzBdLnRyaW0oKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChsYW5ndWFnZSA9PT0gJ3B5dGhvbicpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL1xcYig/OmRlZnxjbGFzcylcXHMrKFxcdyspL2cpIHx8IFtdO1xuICAgICAgICBtYXRjaGVzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICAgIGZ1bmN0aW9ucy5wdXNoKG1hdGNoLnNwbGl0KC9cXHMrLylbMV0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAobGFuZ3VhZ2UgPT09ICdqYXZhJykge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaCgvXFxiKD86cHVibGljfHByaXZhdGV8cHJvdGVjdGVkfHN0YXRpY3xmaW5hbHxjbGFzc3xpbnRlcmZhY2V8dm9pZHxTdHJpbmd8aW50fGJvb2xlYW4pXFxzK1xcdysvZykgfHwgW107XG4gICAgICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgICAgY29uc3Qgd29yZHMgPSBtYXRjaC5zcGxpdCgvXFxzKy8pO1xuICAgICAgICAgIGlmICh3b3Jkcy5sZW5ndGggPj0gMikgZnVuY3Rpb25zLnB1c2god29yZHNbd29yZHMubGVuZ3RoIC0gMV0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gU2tpcCBmdW5jdGlvbiBleHRyYWN0aW9uIGVycm9yc1xuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbnMubGVuZ3RoID4gMCA/IGZ1bmN0aW9ucy5zbGljZSgwLCAzKS5qb2luKCcsICcpIDogbnVsbDtcbiAgfVxuXG4gIC8vIENyZWF0ZSBwcm9qZWN0IHN0cnVjdHVyZSBlbWJlZGRpbmdzXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlU3RydWN0dXJlRW1iZWRkaW5ncyhmaWxlczogUHJvamVjdEZpbGVbXSk6IFByb21pc2U8QXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIG1ldGFkYXRhOiBhbnk7XG4gIH0+PiB7XG4gICAgY29uc3QgY2h1bmtzOiBBcnJheTx7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgY29udGVudDogc3RyaW5nO1xuICAgICAgbWV0YWRhdGE6IGFueTtcbiAgICB9PiA9IFtdO1xuXG4gICAgLy8gRGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgIGNvbnN0IGRpclN0cnVjdHVyZSA9IHRoaXMuYnVpbGREaXJlY3RvcnlUcmVlKGZpbGVzKTtcbiAgICBjaHVua3MucHVzaCh7XG4gICAgICBpZDogYHN0cnVjdHVyZV9kaXJzXyR7dGhpcy5wcm9qZWN0SWR9XyR7RGF0ZS5ub3coKX1gLFxuICAgICAgY29udGVudDogYFByb2plY3QgZGlyZWN0b3J5IHN0cnVjdHVyZTpcXG4ke2RpclN0cnVjdHVyZX1gLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgcHJvamVjdF9pZDogdGhpcy5wcm9qZWN0SWQsXG4gICAgICAgIHR5cGU6ICdzdHJ1Y3R1cmUnLFxuICAgICAgICBmaWxlbmFtZTogJ0RJUkVDVE9SWV9TVFJVQ1RVUkUnLFxuICAgICAgICBsYW5ndWFnZTogJ3N0cnVjdHVyZScsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBGaWxlIHR5cGVzIHN1bW1hcnlcbiAgICBjb25zdCBmaWxlVHlwZXMgPSB0aGlzLnN1bW1hcml6ZUZpbGVUeXBlcyhmaWxlcyk7XG4gICAgY2h1bmtzLnB1c2goe1xuICAgICAgaWQ6IGBzdHJ1Y3R1cmVfdHlwZXNfJHt0aGlzLnByb2plY3RJZH1fJHtEYXRlLm5vdygpfWAsXG4gICAgICBjb250ZW50OiBgRmlsZSB0eXBlcyBpbiBwcm9qZWN0OlxcbiR7ZmlsZVR5cGVzfWAsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBwcm9qZWN0X2lkOiB0aGlzLnByb2plY3RJZCxcbiAgICAgICAgdHlwZTogJ3N0cnVjdHVyZScsXG4gICAgICAgIGZpbGVuYW1lOiAnRklMRV9UWVBFUycsXG4gICAgICAgIGxhbmd1YWdlOiAnc3RydWN0dXJlJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBjaHVua3M7XG4gIH1cblxuICAvLyBCdWlsZCBBU0NJSSBkaXJlY3RvcnkgdHJlZVxuICBwcml2YXRlIGJ1aWxkRGlyZWN0b3J5VHJlZShmaWxlczogUHJvamVjdEZpbGVbXSk6IHN0cmluZyB7XG4gICAgY29uc3QgdHJlZTogeyBba2V5OiBzdHJpbmddOiBQcm9qZWN0RmlsZVtdIH0gPSB7fTtcblxuICAgIGZpbGVzLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoZmlsZS5maWxlbmFtZSk7XG4gICAgICBpZiAoIXRyZWVbZGlyXSkgdHJlZVtkaXJdID0gW107XG4gICAgICB0cmVlW2Rpcl0ucHVzaChmaWxlKTtcbiAgICB9KTtcblxuICAgIGxldCByZXN1bHQgPSAnJztcbiAgICBjb25zdCBzb3J0ZWREaXJzID0gT2JqZWN0LmtleXModHJlZSkuc29ydCgpO1xuXG4gICAgc29ydGVkRGlycy5mb3JFYWNoKGRpciA9PiB7XG4gICAgICByZXN1bHQgKz0gYCR7ZGlyfS9cXG5gO1xuICAgICAgdHJlZVtkaXJdLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICAgIHJlc3VsdCArPSBgICDilJTilIDilIAgJHtwYXRoLmJhc2VuYW1lKGZpbGUuZmlsZW5hbWUpfSAoJHtmaWxlLmxhbmd1YWdlfSwgJHsoZmlsZS5jb250ZW50Lmxlbmd0aCAvIDEwMjQpLnRvRml4ZWQoMSl9S0IpXFxuYDtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vIFN1bW1hcml6ZSBmaWxlIHR5cGVzXG4gIHByaXZhdGUgc3VtbWFyaXplRmlsZVR5cGVzKGZpbGVzOiBQcm9qZWN0RmlsZVtdKTogc3RyaW5nIHtcbiAgICBjb25zdCBzdW1tYXJ5OiB7IFtrZXk6IHN0cmluZ106IHsgY291bnQ6IG51bWJlcjsgdG90YWxTaXplOiBudW1iZXIgfSB9ID0ge307XG5cbiAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgaWYgKCFzdW1tYXJ5W2ZpbGUubGFuZ3VhZ2VdKSB7XG4gICAgICAgIHN1bW1hcnlbZmlsZS5sYW5ndWFnZV0gPSB7IGNvdW50OiAwLCB0b3RhbFNpemU6IDAgfTtcbiAgICAgIH1cbiAgICAgIHN1bW1hcnlbZmlsZS5sYW5ndWFnZV0uY291bnQrKztcbiAgICAgIHN1bW1hcnlbZmlsZS5sYW5ndWFnZV0udG90YWxTaXplICs9IGZpbGUuc2l6ZTtcbiAgICB9KTtcblxuICAgIGxldCByZXN1bHQgPSAnJztcbiAgICBPYmplY3QuZW50cmllcyhzdW1tYXJ5KS5mb3JFYWNoKChbbGFuZywgc3RhdHNdKSA9PiB7XG4gICAgICByZXN1bHQgKz0gYCR7bGFuZ306ICR7c3RhdHMuY291bnR9IGZpbGVzICgkeyhzdGF0cy50b3RhbFNpemUgLyAxMDI0KS50b0ZpeGVkKDEpfUtCIHRvdGFsKVxcbmA7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gRW1iZWQgY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgYXN5bmMgZW1iZWRDb252ZXJzYXRpb24oc2Vzc2lvbklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBnZXRTZXNzaW9uTWVtb3J5IH0gPSBhd2FpdCBpbXBvcnQoJy4vbWVtb3J5Jyk7XG4gICAgICBjb25zdCBtZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KHNlc3Npb25JZCk7XG5cbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gbWVtb3J5LmdldE1lc3NhZ2VzKCk7IC8vIEdldCBsYXN0IDEwIG1lc3NhZ2VzXG4gICAgICBjb25zdCByZWNlbnRNZXNzYWdlcyA9IG1lc3NhZ2VzLnNsaWNlKC0xMCk7XG5cbiAgICAgIGlmIChyZWNlbnRNZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgICAgLy8gQ3JlYXRlIHByb21wdCBjaHVua3NcbiAgICAgIGNvbnN0IHByb21wdENodW5rcyA9IHJlY2VudE1lc3NhZ2VzLm1hcCgobXNnLCBpbmRleCkgPT4gKHtcbiAgICAgICAgaWQ6IGBjb252ZXJzYXRpb25fJHt0aGlzLnByb2plY3RJZH1fJHtzZXNzaW9uSWR9XyR7aW5kZXh9YCxcbiAgICAgICAgY29udGVudDogYCR7bXNnLnJvbGV9OiAke21zZy5jb250ZW50fWAsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgcHJvamVjdF9pZDogdGhpcy5wcm9qZWN0SWQsXG4gICAgICAgICAgc2Vzc2lvbl9pZDogc2Vzc2lvbklkLFxuICAgICAgICAgIHR5cGU6ICdwcm9tcHQnIGFzIGNvbnN0LFxuICAgICAgICAgIG1lc3NhZ2VfaW5kZXg6IGluZGV4LFxuICAgICAgICAgIHJvbGU6IG1zZy5yb2xlLFxuICAgICAgICAgIHRpbWVzdGFtcDogbXNnLnRpbWVzdGFtcC50b0lTT1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgIH0pKTtcblxuICAgICAgYXdhaXQgY2hyb21hTWFuYWdlci5hZGRQcm9tcHRDaHVua3ModGhpcy5wcm9qZWN0SWQsIHByb21wdENodW5rcyk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGDwn5KsIEVtYmVkZGVkICR7cHJvbXB0Q2h1bmtzLmxlbmd0aH0gY29udmVyc2F0aW9uIG1lc3NhZ2VzIGZvciBwcm9qZWN0ICR7dGhpcy5wcm9qZWN0SWR9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gZW1iZWQgY29udmVyc2F0aW9uOicsIGVycm9yKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gRXhwb3J0IHV0aWxpdHkgZnVuY3Rpb24gdG8gZW1iZWQgYSBwcm9qZWN0XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW1iZWRQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBzb3VyY2VEaXI6IHN0cmluZyA9ICcuL2dlbmVyYXRlZCcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgZW1iZWRkZXIgPSBuZXcgUHJvamVjdEVtYmVkZGluZ1NlcnZpY2UocHJvamVjdElkLCBzb3VyY2VEaXIpO1xuICBhd2FpdCBlbWJlZGRlci5lbWJlZFByb2plY3QoKTtcbn1cblxuLy8gRXhwb3J0IHV0aWxpdHkgZnVuY3Rpb24gdG8gZW1iZWQgY29udmVyc2F0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW1iZWRDb252ZXJzYXRpb24ocHJvamVjdElkOiBzdHJpbmcsIHNlc3Npb25JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGVtYmVkZGVyID0gbmV3IFByb2plY3RFbWJlZGRpbmdTZXJ2aWNlKHByb2plY3RJZCk7XG4gIGF3YWl0IGVtYmVkZGVyLmVtYmVkQ29udmVyc2F0aW9uKHNlc3Npb25JZCk7XG59XG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiY3J5cHRvIiwiY2hyb21hTWFuYWdlciIsImdlbmVyYXRlQ2h1bmtJZCIsIlNVUFBPUlRFRF9MQU5HVUFHRVMiLCJ0eXBlc2NyaXB0IiwiamF2YXNjcmlwdCIsInB5dGhvbiIsImphdmEiLCJjc2hhcnAiLCJnbyIsInJ1c3QiLCJjcHAiLCJjIiwicGhwIiwicnVieSIsInN3aWZ0Iiwia290bGluIiwic2NhbGEiLCJqc29uIiwieWFtbCIsInhtbCIsImh0bWwiLCJjc3MiLCJtYXJrZG93biIsImRvY2tlcmZpbGUiLCJzaGVsbCIsInNxbCIsIm1ha2VmaWxlIiwiQ09ERV9TRVBBUkFUT1JTIiwiUHJvamVjdEVtYmVkZGluZ1NlcnZpY2UiLCJjb25zdHJ1Y3RvciIsInByb2plY3RJZCIsInNvdXJjZURpciIsImVtYmVkUHJvamVjdCIsImNvbnNvbGUiLCJsb2ciLCJpbml0aWFsaXplUHJvamVjdENvbGxlY3Rpb25zIiwiZmlsZXMiLCJzY2FuUHJvamVjdEZpbGVzIiwibGVuZ3RoIiwiY29kZUNodW5rcyIsInByb2Nlc3NDb2RlRmlsZXMiLCJzdHJ1Y3R1cmVDaHVua3MiLCJjcmVhdGVTdHJ1Y3R1cmVFbWJlZGRpbmdzIiwiYWRkQ29kZUNodW5rcyIsImFkZFN0cnVjdHVyZUNodW5rcyIsImVycm9yIiwic2VsZiIsInNjYW5EaXJlY3RvcnkiLCJkaXJQYXRoIiwiaXRlbXMiLCJyZWFkZGlyU3luYyIsIml0ZW0iLCJmdWxsUGF0aCIsImpvaW4iLCJzdGF0Iiwic3RhdFN5bmMiLCJpc0RpcmVjdG9yeSIsImluY2x1ZGVzIiwiaXNGaWxlIiwiZXh0IiwiZXh0bmFtZSIsImxhbmd1YWdlIiwiZGV0ZWN0TGFuZ3VhZ2UiLCJzaXplIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsInB1c2giLCJmaWxlbmFtZSIsInJlbGF0aXZlIiwibGFzdE1vZGlmaWVkIiwibXRpbWUiLCJ3YXJuIiwiZXh0ZW5zaW9uIiwiZXh0ZW5zaW9ucyIsIk9iamVjdCIsImVudHJpZXMiLCJzb21lIiwidG9Mb3dlckNhc2UiLCJjaHVua3MiLCJmaWxlIiwiZmlsZUNodW5rcyIsImNyZWF0ZUNvZGVDaHVua3MiLCJsaW5lcyIsInNwbGl0Iiwic2VwYXJhdG9ycyIsImNyZWF0ZUxpbmVCYXNlZENodW5rcyIsImJvdW5kYXJpZXMiLCJjdXJyZW50SW5kZXgiLCJsYXN0SW5kZXgiLCJtYXRjaCIsImV4ZWMiLCJsaW5lU3RhcnQiLCJzdWJzdHIiLCJpbmRleCIsImkiLCJzdGFydExpbmUiLCJlbmRMaW5lIiwiY2h1bmtDb250ZW50Iiwic2xpY2UiLCJ0cmltIiwiY2h1bmtJZCIsImNvbnRlbnRIYXNoIiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCIsIm1ldGFkYXRhIiwicHJvamVjdF9pZCIsInR5cGUiLCJsaW5lc19zdGFydCIsImxpbmVzX2VuZCIsImRlcGVuZGVuY2llcyIsImV4dHJhY3REZXBlbmRlbmNpZXMiLCJwYXJlbnRfZnVuY3Rpb25zIiwiZXh0cmFjdFBhcmVudEZ1bmN0aW9ucyIsImNvbnRlbnRfaGFzaCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImlkIiwiY2h1bmtTaXplIiwiY2h1bmtMaW5lcyIsImltcG9ydHMiLCJpbXBvcnRNYXRjaGVzIiwicmVxdWlyZU1hdGNoZXMiLCJmb3JFYWNoIiwidGVzdCIsImRlcCIsInN0YXJ0c1dpdGgiLCJtYXRjaGVzIiwicmVwbGFjZSIsImZ1bmN0aW9ucyIsImZ1bmNNYXRjaGVzIiwicGFydHMiLCJhcnJvd01hdGNoZXMiLCJ3b3JkcyIsImRpclN0cnVjdHVyZSIsImJ1aWxkRGlyZWN0b3J5VHJlZSIsIm5vdyIsImZpbGVUeXBlcyIsInN1bW1hcml6ZUZpbGVUeXBlcyIsInRyZWUiLCJkaXIiLCJkaXJuYW1lIiwicmVzdWx0Iiwic29ydGVkRGlycyIsImtleXMiLCJzb3J0IiwiYmFzZW5hbWUiLCJ0b0ZpeGVkIiwic3VtbWFyeSIsImNvdW50IiwidG90YWxTaXplIiwibGFuZyIsInN0YXRzIiwiZW1iZWRDb252ZXJzYXRpb24iLCJzZXNzaW9uSWQiLCJnZXRTZXNzaW9uTWVtb3J5IiwibWVtb3J5IiwibWVzc2FnZXMiLCJnZXRNZXNzYWdlcyIsInJlY2VudE1lc3NhZ2VzIiwicHJvbXB0Q2h1bmtzIiwibWFwIiwibXNnIiwicm9sZSIsInNlc3Npb25faWQiLCJtZXNzYWdlX2luZGV4IiwiYWRkUHJvbXB0Q2h1bmtzIiwiZW1iZWRkZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/project-embeddings.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/prompt-optimizer.ts":
/*!***************************************!*\
  !*** ./lib/utils/prompt-optimizer.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PromptOptimizer: () => (/* binding */ PromptOptimizer),\n/* harmony export */   promptOptimizer: () => (/* binding */ promptOptimizer)\n/* harmony export */ });\n/* harmony import */ var _summarizer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./summarizer */ \"(rsc)/./lib/utils/summarizer.ts\");\n/**\n * Prompt Optimizer\n * Optimizes prompts before sending to AI to reduce token usage and improve clarity\n */ \nclass PromptOptimizer {\n    constructor(maxTokens = 4000){\n        this.maxTokens = maxTokens;\n    }\n    /**\n   * Optimize a prompt by removing redundancy and compressing content\n   */ optimize(prompt, context) {\n        const originalTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(prompt);\n        let optimized = prompt;\n        // 1. Remove excessive whitespace\n        optimized = this.removeExcessiveWhitespace(optimized);\n        // 2. Deduplicate repeated instructions\n        optimized = this.deduplicateInstructions(optimized);\n        // 3. Compress file listings\n        optimized = this.compressFileLists(optimized);\n        // 4. Remove redundant phrases\n        optimized = this.removeRedundantPhrases(optimized);\n        // 5. If still too long, truncate intelligently\n        if ((0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(optimized) > this.maxTokens) {\n            optimized = this.intelligentTruncate(optimized, context);\n        }\n        const optimizedTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(optimized);\n        const savings = originalTokens - optimizedTokens;\n        const savingsPercent = originalTokens > 0 ? savings / originalTokens * 100 : 0;\n        if (savings > 50) {\n            console.log(`🎯 Prompt optimized: ${originalTokens} → ${optimizedTokens} tokens (${Math.round(savingsPercent)}% reduction)`);\n        }\n        return {\n            optimizedPrompt: optimized,\n            originalTokens,\n            optimizedTokens,\n            savings,\n            savingsPercent\n        };\n    }\n    removeExcessiveWhitespace(text) {\n        return text.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).join(\"\\n\").replace(/\\n{3,}/g, \"\\n\\n\"); // Max 2 consecutive newlines\n    }\n    deduplicateInstructions(text) {\n        const lines = text.split(\"\\n\");\n        const seen = new Set();\n        const result = [];\n        for (const line of lines){\n            const normalized = line.toLowerCase().trim();\n            // Skip if we've seen this exact instruction\n            if (normalized.length > 20 && seen.has(normalized)) {\n                continue;\n            }\n            seen.add(normalized);\n            result.push(line);\n        }\n        return result.join(\"\\n\");\n    }\n    compressFileLists(text) {\n        // Compress long file lists\n        const fileListPattern = /(?:EXISTING FILES|Session files|Current state files):\\s*\\n((?:[-•]\\s*[^\\n]+\\n?)+)/gi;\n        return text.replace(fileListPattern, (match, fileList)=>{\n            const files = fileList.split(\"\\n\").filter((l)=>l.trim().length > 0);\n            if (files.length > 10) {\n                const first5 = files.slice(0, 5).join(\"\\n\");\n                const last3 = files.slice(-3).join(\"\\n\");\n                return `${match.split(\":\")[0]}:\\n${first5}\\n... (${files.length - 8} more files)\\n${last3}`;\n            }\n            return match;\n        });\n    }\n    removeRedundantPhrases(text) {\n        // Remove common redundant phrases\n        const redundantPhrases = [\n            /Please note that /gi,\n            /It is important to /gi,\n            /You should be aware that /gi,\n            /Keep in mind that /gi,\n            /Remember to /gi,\n            /Make sure to /gi,\n            /Don't forget to /gi,\n            /Be sure to /gi\n        ];\n        let result = text;\n        for (const phrase of redundantPhrases){\n            result = result.replace(phrase, \"\");\n        }\n        return result;\n    }\n    intelligentTruncate(text, context) {\n        // Priority sections (keep these)\n        const sections = text.split(\"\\n\\n\");\n        const priority = [];\n        const medium = [];\n        const low = [];\n        for (const section of sections){\n            const lower = section.toLowerCase();\n            if (lower.includes(\"critical\") || lower.includes(\"important\") || lower.includes(\"rules:\") || lower.includes(\"current step\")) {\n                priority.push(section);\n            } else if (lower.includes(\"existing files\") || lower.includes(\"available tools\") || lower.includes(\"context\")) {\n                medium.push(section);\n            } else {\n                low.push(section);\n            }\n        }\n        // Rebuild with priority\n        let result = priority.join(\"\\n\\n\");\n        let currentTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(result);\n        // Add medium priority sections if space allows\n        for (const section of medium){\n            const sectionTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(section);\n            if (currentTokens + sectionTokens < this.maxTokens * 0.9) {\n                result += \"\\n\\n\" + section;\n                currentTokens += sectionTokens;\n            } else {\n                // Truncate section\n                const truncated = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.smartTruncate)(section, 200);\n                result += \"\\n\\n\" + truncated;\n                break;\n            }\n        }\n        return result;\n    }\n    /**\n   * Optimize system prompt specifically\n   */ optimizeSystemPrompt(systemPrompt, contextSummary) {\n        const { optimizedPrompt } = this.optimize(systemPrompt, contextSummary);\n        return optimizedPrompt;\n    }\n    /**\n   * Optimize file content before including in prompt\n   */ optimizeFileContent(filePath, content, maxLines = 50) {\n        const lines = content.split(\"\\n\");\n        if (lines.length <= maxLines) {\n            return content;\n        }\n        // Show first and last portions\n        const firstLines = lines.slice(0, Math.floor(maxLines / 2));\n        const lastLines = lines.slice(-Math.floor(maxLines / 2));\n        return `${firstLines.join(\"\\n\")}\\n... (${lines.length - maxLines} lines omitted) ...\\n${lastLines.join(\"\\n\")}`;\n    }\n    /**\n   * Batch optimize multiple prompts\n   */ batchOptimize(prompts) {\n        return prompts.map((p)=>this.optimize(p).optimizedPrompt);\n    }\n}\nconst promptOptimizer = new PromptOptimizer(4000);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdXRpbHMvcHJvbXB0LW9wdGltaXplci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7O0NBR0MsR0FFNEQ7QUFVdEQsTUFBTUU7SUFHWEMsWUFBWUMsWUFBb0IsSUFBSSxDQUFFO1FBQ3BDLElBQUksQ0FBQ0EsU0FBUyxHQUFHQTtJQUNuQjtJQUVBOztHQUVDLEdBQ0RDLFNBQVNDLE1BQWMsRUFBRUMsT0FBZ0IsRUFBNEI7UUFDbkUsTUFBTUMsaUJBQWlCUiwyREFBY0EsQ0FBQ007UUFFdEMsSUFBSUcsWUFBWUg7UUFFaEIsaUNBQWlDO1FBQ2pDRyxZQUFZLElBQUksQ0FBQ0MseUJBQXlCLENBQUNEO1FBRTNDLHVDQUF1QztRQUN2Q0EsWUFBWSxJQUFJLENBQUNFLHVCQUF1QixDQUFDRjtRQUV6Qyw0QkFBNEI7UUFDNUJBLFlBQVksSUFBSSxDQUFDRyxpQkFBaUIsQ0FBQ0g7UUFFbkMsOEJBQThCO1FBQzlCQSxZQUFZLElBQUksQ0FBQ0ksc0JBQXNCLENBQUNKO1FBRXhDLCtDQUErQztRQUMvQyxJQUFJVCwyREFBY0EsQ0FBQ1MsYUFBYSxJQUFJLENBQUNMLFNBQVMsRUFBRTtZQUM5Q0ssWUFBWSxJQUFJLENBQUNLLG1CQUFtQixDQUFDTCxXQUFXRjtRQUNsRDtRQUVBLE1BQU1RLGtCQUFrQmYsMkRBQWNBLENBQUNTO1FBQ3ZDLE1BQU1PLFVBQVVSLGlCQUFpQk87UUFDakMsTUFBTUUsaUJBQWlCVCxpQkFBaUIsSUFBSSxVQUFXQSxpQkFBa0IsTUFBTTtRQUUvRSxJQUFJUSxVQUFVLElBQUk7WUFDaEJFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHFCQUFxQixFQUFFWCxlQUFlLEdBQUcsRUFBRU8sZ0JBQWdCLFNBQVMsRUFBRUssS0FBS0MsS0FBSyxDQUFDSixnQkFBZ0IsWUFBWSxDQUFDO1FBQzdIO1FBRUEsT0FBTztZQUNMSyxpQkFBaUJiO1lBQ2pCRDtZQUNBTztZQUNBQztZQUNBQztRQUNGO0lBQ0Y7SUFFUVAsMEJBQTBCYSxJQUFZLEVBQVU7UUFDdEQsT0FBT0EsS0FDSkMsS0FBSyxDQUFDLE1BQ05DLEdBQUcsQ0FBQ0MsQ0FBQUEsT0FBUUEsS0FBS0MsSUFBSSxJQUNyQkMsTUFBTSxDQUFDRixDQUFBQSxPQUFRQSxLQUFLRyxNQUFNLEdBQUcsR0FDN0JDLElBQUksQ0FBQyxNQUNMQyxPQUFPLENBQUMsV0FBVyxTQUFTLDZCQUE2QjtJQUM5RDtJQUVRcEIsd0JBQXdCWSxJQUFZLEVBQVU7UUFDcEQsTUFBTVMsUUFBUVQsS0FBS0MsS0FBSyxDQUFDO1FBQ3pCLE1BQU1TLE9BQU8sSUFBSUM7UUFDakIsTUFBTUMsU0FBbUIsRUFBRTtRQUUzQixLQUFLLE1BQU1ULFFBQVFNLE1BQU87WUFDeEIsTUFBTUksYUFBYVYsS0FBS1csV0FBVyxHQUFHVixJQUFJO1lBRTFDLDRDQUE0QztZQUM1QyxJQUFJUyxXQUFXUCxNQUFNLEdBQUcsTUFBTUksS0FBS0ssR0FBRyxDQUFDRixhQUFhO2dCQUNsRDtZQUNGO1lBRUFILEtBQUtNLEdBQUcsQ0FBQ0g7WUFDVEQsT0FBT0ssSUFBSSxDQUFDZDtRQUNkO1FBRUEsT0FBT1MsT0FBT0wsSUFBSSxDQUFDO0lBQ3JCO0lBRVFsQixrQkFBa0JXLElBQVksRUFBVTtRQUM5QywyQkFBMkI7UUFDM0IsTUFBTWtCLGtCQUFrQjtRQUV4QixPQUFPbEIsS0FBS1EsT0FBTyxDQUFDVSxpQkFBaUIsQ0FBQ0MsT0FBT0M7WUFDM0MsTUFBTUMsUUFBUUQsU0FDWG5CLEtBQUssQ0FBQyxNQUNOSSxNQUFNLENBQUMsQ0FBQ2lCLElBQWNBLEVBQUVsQixJQUFJLEdBQUdFLE1BQU0sR0FBRztZQUUzQyxJQUFJZSxNQUFNZixNQUFNLEdBQUcsSUFBSTtnQkFDckIsTUFBTWlCLFNBQVNGLE1BQU1HLEtBQUssQ0FBQyxHQUFHLEdBQUdqQixJQUFJLENBQUM7Z0JBQ3RDLE1BQU1rQixRQUFRSixNQUFNRyxLQUFLLENBQUMsQ0FBQyxHQUFHakIsSUFBSSxDQUFDO2dCQUNuQyxPQUFPLENBQUMsRUFBRVksTUFBTWxCLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRXNCLE9BQU8sT0FBTyxFQUFFRixNQUFNZixNQUFNLEdBQUcsRUFBRSxjQUFjLEVBQUVtQixNQUFNLENBQUM7WUFDN0Y7WUFFQSxPQUFPTjtRQUNUO0lBQ0Y7SUFFUTdCLHVCQUF1QlUsSUFBWSxFQUFVO1FBQ25ELGtDQUFrQztRQUNsQyxNQUFNMEIsbUJBQW1CO1lBQ3ZCO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7U0FDRDtRQUVELElBQUlkLFNBQVNaO1FBQ2IsS0FBSyxNQUFNMkIsVUFBVUQsaUJBQWtCO1lBQ3JDZCxTQUFTQSxPQUFPSixPQUFPLENBQUNtQixRQUFRO1FBQ2xDO1FBRUEsT0FBT2Y7SUFDVDtJQUVRckIsb0JBQW9CUyxJQUFZLEVBQUVoQixPQUFnQixFQUFVO1FBQ2xFLGlDQUFpQztRQUNqQyxNQUFNNEMsV0FBVzVCLEtBQUtDLEtBQUssQ0FBQztRQUM1QixNQUFNNEIsV0FBcUIsRUFBRTtRQUM3QixNQUFNQyxTQUFtQixFQUFFO1FBQzNCLE1BQU1DLE1BQWdCLEVBQUU7UUFFeEIsS0FBSyxNQUFNQyxXQUFXSixTQUFVO1lBQzlCLE1BQU1LLFFBQVFELFFBQVFsQixXQUFXO1lBRWpDLElBQ0VtQixNQUFNQyxRQUFRLENBQUMsZUFDZkQsTUFBTUMsUUFBUSxDQUFDLGdCQUNmRCxNQUFNQyxRQUFRLENBQUMsYUFDZkQsTUFBTUMsUUFBUSxDQUFDLGlCQUNmO2dCQUNBTCxTQUFTWixJQUFJLENBQUNlO1lBQ2hCLE9BQU8sSUFDTEMsTUFBTUMsUUFBUSxDQUFDLHFCQUNmRCxNQUFNQyxRQUFRLENBQUMsc0JBQ2ZELE1BQU1DLFFBQVEsQ0FBQyxZQUNmO2dCQUNBSixPQUFPYixJQUFJLENBQUNlO1lBQ2QsT0FBTztnQkFDTEQsSUFBSWQsSUFBSSxDQUFDZTtZQUNYO1FBQ0Y7UUFFQSx3QkFBd0I7UUFDeEIsSUFBSXBCLFNBQVNpQixTQUFTdEIsSUFBSSxDQUFDO1FBQzNCLElBQUk0QixnQkFBZ0IxRCwyREFBY0EsQ0FBQ21DO1FBRW5DLCtDQUErQztRQUMvQyxLQUFLLE1BQU1vQixXQUFXRixPQUFRO1lBQzVCLE1BQU1NLGdCQUFnQjNELDJEQUFjQSxDQUFDdUQ7WUFDckMsSUFBSUcsZ0JBQWdCQyxnQkFBZ0IsSUFBSSxDQUFDdkQsU0FBUyxHQUFHLEtBQUs7Z0JBQ3hEK0IsVUFBVSxTQUFTb0I7Z0JBQ25CRyxpQkFBaUJDO1lBQ25CLE9BQU87Z0JBQ0wsbUJBQW1CO2dCQUNuQixNQUFNQyxZQUFZM0QsMERBQWFBLENBQUNzRCxTQUFTO2dCQUN6Q3BCLFVBQVUsU0FBU3lCO2dCQUNuQjtZQUNGO1FBQ0Y7UUFFQSxPQUFPekI7SUFDVDtJQUVBOztHQUVDLEdBQ0QwQixxQkFBcUJDLFlBQW9CLEVBQUVDLGNBQXVCLEVBQVU7UUFDMUUsTUFBTSxFQUFFekMsZUFBZSxFQUFFLEdBQUcsSUFBSSxDQUFDakIsUUFBUSxDQUFDeUQsY0FBY0M7UUFDeEQsT0FBT3pDO0lBQ1Q7SUFFQTs7R0FFQyxHQUNEMEMsb0JBQW9CQyxRQUFnQixFQUFFQyxPQUFlLEVBQUVDLFdBQW1CLEVBQUUsRUFBVTtRQUNwRixNQUFNbkMsUUFBUWtDLFFBQVExQyxLQUFLLENBQUM7UUFFNUIsSUFBSVEsTUFBTUgsTUFBTSxJQUFJc0MsVUFBVTtZQUM1QixPQUFPRDtRQUNUO1FBRUEsK0JBQStCO1FBQy9CLE1BQU1FLGFBQWFwQyxNQUFNZSxLQUFLLENBQUMsR0FBRzNCLEtBQUtpRCxLQUFLLENBQUNGLFdBQVc7UUFDeEQsTUFBTUcsWUFBWXRDLE1BQU1lLEtBQUssQ0FBQyxDQUFDM0IsS0FBS2lELEtBQUssQ0FBQ0YsV0FBVztRQUVyRCxPQUFPLENBQUMsRUFBRUMsV0FBV3RDLElBQUksQ0FBQyxNQUFNLE9BQU8sRUFBRUUsTUFBTUgsTUFBTSxHQUFHc0MsU0FBUyxxQkFBcUIsRUFBRUcsVUFBVXhDLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDaEg7SUFFQTs7R0FFQyxHQUNEeUMsY0FBY0MsT0FBaUIsRUFBWTtRQUN6QyxPQUFPQSxRQUFRL0MsR0FBRyxDQUFDZ0QsQ0FBQUEsSUFBSyxJQUFJLENBQUNwRSxRQUFRLENBQUNvRSxHQUFHbkQsZUFBZTtJQUMxRDtBQUNGO0FBRU8sTUFBTW9ELGtCQUFrQixJQUFJeEUsZ0JBQWdCLE1BQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi91dGlscy9wcm9tcHQtb3B0aW1pemVyLnRzPzhmYzIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQcm9tcHQgT3B0aW1pemVyXG4gKiBPcHRpbWl6ZXMgcHJvbXB0cyBiZWZvcmUgc2VuZGluZyB0byBBSSB0byByZWR1Y2UgdG9rZW4gdXNhZ2UgYW5kIGltcHJvdmUgY2xhcml0eVxuICovXG5cbmltcG9ydCB7IGVzdGltYXRlVG9rZW5zLCBzbWFydFRydW5jYXRlIH0gZnJvbSAnLi9zdW1tYXJpemVyJztcblxuaW50ZXJmYWNlIFByb21wdE9wdGltaXphdGlvblJlc3VsdCB7XG4gIG9wdGltaXplZFByb21wdDogc3RyaW5nO1xuICBvcmlnaW5hbFRva2VuczogbnVtYmVyO1xuICBvcHRpbWl6ZWRUb2tlbnM6IG51bWJlcjtcbiAgc2F2aW5nczogbnVtYmVyO1xuICBzYXZpbmdzUGVyY2VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgUHJvbXB0T3B0aW1pemVyIHtcbiAgcHJpdmF0ZSBtYXhUb2tlbnM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihtYXhUb2tlbnM6IG51bWJlciA9IDQwMDApIHtcbiAgICB0aGlzLm1heFRva2VucyA9IG1heFRva2VucztcbiAgfVxuXG4gIC8qKlxuICAgKiBPcHRpbWl6ZSBhIHByb21wdCBieSByZW1vdmluZyByZWR1bmRhbmN5IGFuZCBjb21wcmVzc2luZyBjb250ZW50XG4gICAqL1xuICBvcHRpbWl6ZShwcm9tcHQ6IHN0cmluZywgY29udGV4dD86IHN0cmluZyk6IFByb21wdE9wdGltaXphdGlvblJlc3VsdCB7XG4gICAgY29uc3Qgb3JpZ2luYWxUb2tlbnMgPSBlc3RpbWF0ZVRva2Vucyhwcm9tcHQpO1xuICAgIFxuICAgIGxldCBvcHRpbWl6ZWQgPSBwcm9tcHQ7XG5cbiAgICAvLyAxLiBSZW1vdmUgZXhjZXNzaXZlIHdoaXRlc3BhY2VcbiAgICBvcHRpbWl6ZWQgPSB0aGlzLnJlbW92ZUV4Y2Vzc2l2ZVdoaXRlc3BhY2Uob3B0aW1pemVkKTtcblxuICAgIC8vIDIuIERlZHVwbGljYXRlIHJlcGVhdGVkIGluc3RydWN0aW9uc1xuICAgIG9wdGltaXplZCA9IHRoaXMuZGVkdXBsaWNhdGVJbnN0cnVjdGlvbnMob3B0aW1pemVkKTtcblxuICAgIC8vIDMuIENvbXByZXNzIGZpbGUgbGlzdGluZ3NcbiAgICBvcHRpbWl6ZWQgPSB0aGlzLmNvbXByZXNzRmlsZUxpc3RzKG9wdGltaXplZCk7XG5cbiAgICAvLyA0LiBSZW1vdmUgcmVkdW5kYW50IHBocmFzZXNcbiAgICBvcHRpbWl6ZWQgPSB0aGlzLnJlbW92ZVJlZHVuZGFudFBocmFzZXMob3B0aW1pemVkKTtcblxuICAgIC8vIDUuIElmIHN0aWxsIHRvbyBsb25nLCB0cnVuY2F0ZSBpbnRlbGxpZ2VudGx5XG4gICAgaWYgKGVzdGltYXRlVG9rZW5zKG9wdGltaXplZCkgPiB0aGlzLm1heFRva2Vucykge1xuICAgICAgb3B0aW1pemVkID0gdGhpcy5pbnRlbGxpZ2VudFRydW5jYXRlKG9wdGltaXplZCwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgY29uc3Qgb3B0aW1pemVkVG9rZW5zID0gZXN0aW1hdGVUb2tlbnMob3B0aW1pemVkKTtcbiAgICBjb25zdCBzYXZpbmdzID0gb3JpZ2luYWxUb2tlbnMgLSBvcHRpbWl6ZWRUb2tlbnM7XG4gICAgY29uc3Qgc2F2aW5nc1BlcmNlbnQgPSBvcmlnaW5hbFRva2VucyA+IDAgPyAoc2F2aW5ncyAvIG9yaWdpbmFsVG9rZW5zKSAqIDEwMCA6IDA7XG5cbiAgICBpZiAoc2F2aW5ncyA+IDUwKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+OryBQcm9tcHQgb3B0aW1pemVkOiAke29yaWdpbmFsVG9rZW5zfSDihpIgJHtvcHRpbWl6ZWRUb2tlbnN9IHRva2VucyAoJHtNYXRoLnJvdW5kKHNhdmluZ3NQZXJjZW50KX0lIHJlZHVjdGlvbilgKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgb3B0aW1pemVkUHJvbXB0OiBvcHRpbWl6ZWQsXG4gICAgICBvcmlnaW5hbFRva2VucyxcbiAgICAgIG9wdGltaXplZFRva2VucyxcbiAgICAgIHNhdmluZ3MsXG4gICAgICBzYXZpbmdzUGVyY2VudCxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSByZW1vdmVFeGNlc3NpdmVXaGl0ZXNwYWNlKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcbiAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmxlbmd0aCA+IDApXG4gICAgICAuam9pbignXFxuJylcbiAgICAgIC5yZXBsYWNlKC9cXG57Myx9L2csICdcXG5cXG4nKTsgLy8gTWF4IDIgY29uc2VjdXRpdmUgbmV3bGluZXNcbiAgfVxuXG4gIHByaXZhdGUgZGVkdXBsaWNhdGVJbnN0cnVjdGlvbnModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBsaW5lLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgXG4gICAgICAvLyBTa2lwIGlmIHdlJ3ZlIHNlZW4gdGhpcyBleGFjdCBpbnN0cnVjdGlvblxuICAgICAgaWYgKG5vcm1hbGl6ZWQubGVuZ3RoID4gMjAgJiYgc2Vlbi5oYXMobm9ybWFsaXplZCkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHNlZW4uYWRkKG5vcm1hbGl6ZWQpO1xuICAgICAgcmVzdWx0LnB1c2gobGluZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdC5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIHByaXZhdGUgY29tcHJlc3NGaWxlTGlzdHModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBDb21wcmVzcyBsb25nIGZpbGUgbGlzdHNcbiAgICBjb25zdCBmaWxlTGlzdFBhdHRlcm4gPSAvKD86RVhJU1RJTkcgRklMRVN8U2Vzc2lvbiBmaWxlc3xDdXJyZW50IHN0YXRlIGZpbGVzKTpcXHMqXFxuKCg/Olst4oCiXVxccypbXlxcbl0rXFxuPykrKS9naTtcbiAgICBcbiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKGZpbGVMaXN0UGF0dGVybiwgKG1hdGNoLCBmaWxlTGlzdCkgPT4ge1xuICAgICAgY29uc3QgZmlsZXMgPSBmaWxlTGlzdFxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5maWx0ZXIoKGw6IHN0cmluZykgPT4gbC50cmltKCkubGVuZ3RoID4gMCk7XG4gICAgICBcbiAgICAgIGlmIChmaWxlcy5sZW5ndGggPiAxMCkge1xuICAgICAgICBjb25zdCBmaXJzdDUgPSBmaWxlcy5zbGljZSgwLCA1KS5qb2luKCdcXG4nKTtcbiAgICAgICAgY29uc3QgbGFzdDMgPSBmaWxlcy5zbGljZSgtMykuam9pbignXFxuJyk7XG4gICAgICAgIHJldHVybiBgJHttYXRjaC5zcGxpdCgnOicpWzBdfTpcXG4ke2ZpcnN0NX1cXG4uLi4gKCR7ZmlsZXMubGVuZ3RoIC0gOH0gbW9yZSBmaWxlcylcXG4ke2xhc3QzfWA7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBtYXRjaDtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgcmVtb3ZlUmVkdW5kYW50UGhyYXNlcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIFJlbW92ZSBjb21tb24gcmVkdW5kYW50IHBocmFzZXNcbiAgICBjb25zdCByZWR1bmRhbnRQaHJhc2VzID0gW1xuICAgICAgL1BsZWFzZSBub3RlIHRoYXQgL2dpLFxuICAgICAgL0l0IGlzIGltcG9ydGFudCB0byAvZ2ksXG4gICAgICAvWW91IHNob3VsZCBiZSBhd2FyZSB0aGF0IC9naSxcbiAgICAgIC9LZWVwIGluIG1pbmQgdGhhdCAvZ2ksXG4gICAgICAvUmVtZW1iZXIgdG8gL2dpLFxuICAgICAgL01ha2Ugc3VyZSB0byAvZ2ksXG4gICAgICAvRG9uJ3QgZm9yZ2V0IHRvIC9naSxcbiAgICAgIC9CZSBzdXJlIHRvIC9naSxcbiAgICBdO1xuXG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG4gICAgZm9yIChjb25zdCBwaHJhc2Ugb2YgcmVkdW5kYW50UGhyYXNlcykge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UocGhyYXNlLCAnJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgaW50ZWxsaWdlbnRUcnVuY2F0ZSh0ZXh0OiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIFByaW9yaXR5IHNlY3Rpb25zIChrZWVwIHRoZXNlKVxuICAgIGNvbnN0IHNlY3Rpb25zID0gdGV4dC5zcGxpdCgnXFxuXFxuJyk7XG4gICAgY29uc3QgcHJpb3JpdHk6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgbWVkaXVtOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGxvdzogc3RyaW5nW10gPSBbXTtcblxuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBzZWN0aW9ucykge1xuICAgICAgY29uc3QgbG93ZXIgPSBzZWN0aW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgICBcbiAgICAgIGlmIChcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2NyaXRpY2FsJykgfHxcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2ltcG9ydGFudCcpIHx8XG4gICAgICAgIGxvd2VyLmluY2x1ZGVzKCdydWxlczonKSB8fFxuICAgICAgICBsb3dlci5pbmNsdWRlcygnY3VycmVudCBzdGVwJylcbiAgICAgICkge1xuICAgICAgICBwcmlvcml0eS5wdXNoKHNlY3Rpb24pO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2V4aXN0aW5nIGZpbGVzJykgfHxcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2F2YWlsYWJsZSB0b29scycpIHx8XG4gICAgICAgIGxvd2VyLmluY2x1ZGVzKCdjb250ZXh0JylcbiAgICAgICkge1xuICAgICAgICBtZWRpdW0ucHVzaChzZWN0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvdy5wdXNoKHNlY3Rpb24pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJlYnVpbGQgd2l0aCBwcmlvcml0eVxuICAgIGxldCByZXN1bHQgPSBwcmlvcml0eS5qb2luKCdcXG5cXG4nKTtcbiAgICBsZXQgY3VycmVudFRva2VucyA9IGVzdGltYXRlVG9rZW5zKHJlc3VsdCk7XG5cbiAgICAvLyBBZGQgbWVkaXVtIHByaW9yaXR5IHNlY3Rpb25zIGlmIHNwYWNlIGFsbG93c1xuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBtZWRpdW0pIHtcbiAgICAgIGNvbnN0IHNlY3Rpb25Ub2tlbnMgPSBlc3RpbWF0ZVRva2VucyhzZWN0aW9uKTtcbiAgICAgIGlmIChjdXJyZW50VG9rZW5zICsgc2VjdGlvblRva2VucyA8IHRoaXMubWF4VG9rZW5zICogMC45KSB7XG4gICAgICAgIHJlc3VsdCArPSAnXFxuXFxuJyArIHNlY3Rpb247XG4gICAgICAgIGN1cnJlbnRUb2tlbnMgKz0gc2VjdGlvblRva2VucztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRydW5jYXRlIHNlY3Rpb25cbiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gc21hcnRUcnVuY2F0ZShzZWN0aW9uLCAyMDApO1xuICAgICAgICByZXN1bHQgKz0gJ1xcblxcbicgKyB0cnVuY2F0ZWQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogT3B0aW1pemUgc3lzdGVtIHByb21wdCBzcGVjaWZpY2FsbHlcbiAgICovXG4gIG9wdGltaXplU3lzdGVtUHJvbXB0KHN5c3RlbVByb21wdDogc3RyaW5nLCBjb250ZXh0U3VtbWFyeT86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgeyBvcHRpbWl6ZWRQcm9tcHQgfSA9IHRoaXMub3B0aW1pemUoc3lzdGVtUHJvbXB0LCBjb250ZXh0U3VtbWFyeSk7XG4gICAgcmV0dXJuIG9wdGltaXplZFByb21wdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcHRpbWl6ZSBmaWxlIGNvbnRlbnQgYmVmb3JlIGluY2x1ZGluZyBpbiBwcm9tcHRcbiAgICovXG4gIG9wdGltaXplRmlsZUNvbnRlbnQoZmlsZVBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nLCBtYXhMaW5lczogbnVtYmVyID0gNTApOiBzdHJpbmcge1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgXG4gICAgaWYgKGxpbmVzLmxlbmd0aCA8PSBtYXhMaW5lcykge1xuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgLy8gU2hvdyBmaXJzdCBhbmQgbGFzdCBwb3J0aW9uc1xuICAgIGNvbnN0IGZpcnN0TGluZXMgPSBsaW5lcy5zbGljZSgwLCBNYXRoLmZsb29yKG1heExpbmVzIC8gMikpO1xuICAgIGNvbnN0IGxhc3RMaW5lcyA9IGxpbmVzLnNsaWNlKC1NYXRoLmZsb29yKG1heExpbmVzIC8gMikpO1xuICAgIFxuICAgIHJldHVybiBgJHtmaXJzdExpbmVzLmpvaW4oJ1xcbicpfVxcbi4uLiAoJHtsaW5lcy5sZW5ndGggLSBtYXhMaW5lc30gbGluZXMgb21pdHRlZCkgLi4uXFxuJHtsYXN0TGluZXMuam9pbignXFxuJyl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBCYXRjaCBvcHRpbWl6ZSBtdWx0aXBsZSBwcm9tcHRzXG4gICAqL1xuICBiYXRjaE9wdGltaXplKHByb21wdHM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBwcm9tcHRzLm1hcChwID0+IHRoaXMub3B0aW1pemUocCkub3B0aW1pemVkUHJvbXB0KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcHJvbXB0T3B0aW1pemVyID0gbmV3IFByb21wdE9wdGltaXplcig0MDAwKTtcbiJdLCJuYW1lcyI6WyJlc3RpbWF0ZVRva2VucyIsInNtYXJ0VHJ1bmNhdGUiLCJQcm9tcHRPcHRpbWl6ZXIiLCJjb25zdHJ1Y3RvciIsIm1heFRva2VucyIsIm9wdGltaXplIiwicHJvbXB0IiwiY29udGV4dCIsIm9yaWdpbmFsVG9rZW5zIiwib3B0aW1pemVkIiwicmVtb3ZlRXhjZXNzaXZlV2hpdGVzcGFjZSIsImRlZHVwbGljYXRlSW5zdHJ1Y3Rpb25zIiwiY29tcHJlc3NGaWxlTGlzdHMiLCJyZW1vdmVSZWR1bmRhbnRQaHJhc2VzIiwiaW50ZWxsaWdlbnRUcnVuY2F0ZSIsIm9wdGltaXplZFRva2VucyIsInNhdmluZ3MiLCJzYXZpbmdzUGVyY2VudCIsImNvbnNvbGUiLCJsb2ciLCJNYXRoIiwicm91bmQiLCJvcHRpbWl6ZWRQcm9tcHQiLCJ0ZXh0Iiwic3BsaXQiLCJtYXAiLCJsaW5lIiwidHJpbSIsImZpbHRlciIsImxlbmd0aCIsImpvaW4iLCJyZXBsYWNlIiwibGluZXMiLCJzZWVuIiwiU2V0IiwicmVzdWx0Iiwibm9ybWFsaXplZCIsInRvTG93ZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsImZpbGVMaXN0UGF0dGVybiIsIm1hdGNoIiwiZmlsZUxpc3QiLCJmaWxlcyIsImwiLCJmaXJzdDUiLCJzbGljZSIsImxhc3QzIiwicmVkdW5kYW50UGhyYXNlcyIsInBocmFzZSIsInNlY3Rpb25zIiwicHJpb3JpdHkiLCJtZWRpdW0iLCJsb3ciLCJzZWN0aW9uIiwibG93ZXIiLCJpbmNsdWRlcyIsImN1cnJlbnRUb2tlbnMiLCJzZWN0aW9uVG9rZW5zIiwidHJ1bmNhdGVkIiwib3B0aW1pemVTeXN0ZW1Qcm9tcHQiLCJzeXN0ZW1Qcm9tcHQiLCJjb250ZXh0U3VtbWFyeSIsIm9wdGltaXplRmlsZUNvbnRlbnQiLCJmaWxlUGF0aCIsImNvbnRlbnQiLCJtYXhMaW5lcyIsImZpcnN0TGluZXMiLCJmbG9vciIsImxhc3RMaW5lcyIsImJhdGNoT3B0aW1pemUiLCJwcm9tcHRzIiwicCIsInByb21wdE9wdGltaXplciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/prompt-optimizer.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/summarizer.ts":
/*!*********************************!*\
  !*** ./lib/utils/summarizer.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compressContext: () => (/* binding */ compressContext),\n/* harmony export */   estimateTokens: () => (/* binding */ estimateTokens),\n/* harmony export */   shouldCompress: () => (/* binding */ shouldCompress),\n/* harmony export */   smartTruncate: () => (/* binding */ smartTruncate),\n/* harmony export */   summarizeConversation: () => (/* binding */ summarizeConversation),\n/* harmony export */   summarizeFileContents: () => (/* binding */ summarizeFileContents)\n/* harmony export */ });\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/.pnpm/@langchain+openai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___ws@8.18.3/node_modules/@langchain/openai/dist/index.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n\n\n// Initialize a lightweight model for summarization\nconst apiKey = process.env.OPENROUTER_API_KEY ?? process.env.OPENAI_API_KEY;\nconst apiBase = \"https://openrouter.ai/api/v1\";\nconst summarizer = new _langchain_openai__WEBPACK_IMPORTED_MODULE_0__.ChatOpenAI({\n    apiKey,\n    configuration: {\n        baseURL: apiBase\n    },\n    model: process.env.OPENROUTER_MODEL,\n    temperature: 0.3,\n    maxTokens: 500\n});\n/**\n * Summarize conversation history to reduce token usage\n */ async function summarizeConversation(messages, maxMessages = 10) {\n    // Keep the most recent messages, summarize older ones\n    if (messages.length <= maxMessages) {\n        return {\n            summary: messages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\"),\n            tokensSaved: 0,\n            originalLength: messages.length\n        };\n    }\n    const recentMessages = messages.slice(-maxMessages);\n    const oldMessages = messages.slice(0, -maxMessages);\n    const oldMessagesText = oldMessages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\");\n    const systemPrompt = `You are a context summarizer. Condense the conversation history into a brief, relevant summary.\n\nFocus on:\n1. Key user requests and what was accomplished\n2. Important decisions made\n3. Files created/modified\n4. Current state of the project\n\nKeep it under 200 words. Be concise but preserve critical context.`;\n    try {\n        const response = await summarizer.invoke([\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.SystemMessage(systemPrompt),\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.HumanMessage(`Summarize this conversation history:\\n\\n${oldMessagesText}`)\n        ]);\n        const summary = response.content.toString();\n        // Estimate tokens saved (rough estimate: 4 chars ≈ 1 token)\n        const originalTokens = Math.ceil(oldMessagesText.length / 4);\n        const summaryTokens = Math.ceil(summary.length / 4);\n        const tokensSaved = originalTokens - summaryTokens;\n        return {\n            summary,\n            tokensSaved,\n            originalLength: messages.length\n        };\n    } catch (error) {\n        console.error(\"Summarization error:\", error);\n        // Fallback: just return recent messages\n        return {\n            summary: recentMessages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\"),\n            tokensSaved: 0,\n            originalLength: messages.length\n        };\n    }\n}\n/**\n * Summarize file contents to reduce token usage when passing as context\n */ async function summarizeFileContents(files, maxFileSize = 500) {\n    const summarizedFiles = {};\n    for (const [filename, content] of Object.entries(files)){\n        // If file is small enough, keep it as-is\n        if (content.length <= maxFileSize) {\n            summarizedFiles[filename] = content;\n            continue;\n        }\n        // For large files, provide a structure summary\n        const lines = content.split(\"\\n\");\n        const firstLines = lines.slice(0, 10).join(\"\\n\");\n        const lastLines = lines.slice(-5).join(\"\\n\");\n        const summary = `${firstLines}\\n\\n... (${lines.length - 15} lines omitted) ...\\n\\n${lastLines}`;\n        summarizedFiles[filename] = summary;\n    }\n    return summarizedFiles;\n}\n/**\n * Intelligent context compression for agent prompts\n */ async function compressContext(options) {\n    const parts = [];\n    let originalSize = 0;\n    // 1. User request (always include, high priority)\n    parts.push(`USER REQUEST: ${options.userRequest}`);\n    originalSize += options.userRequest.length;\n    // 2. Conversation history (summarize if long)\n    if (options.conversationHistory && options.conversationHistory.length > 0) {\n        const { summary, tokensSaved } = await summarizeConversation(options.conversationHistory, 5 // Keep last 5 messages\n        );\n        parts.push(`\\nCONVERSATION CONTEXT:\\n${summary}`);\n        originalSize += options.conversationHistory.reduce((sum, m)=>sum + m.content.length, 0);\n    }\n    // 3. Existing files (summarize large files)\n    if (options.existingFiles && Object.keys(options.existingFiles).length > 0) {\n        const summarizedFiles = await summarizeFileContents(options.existingFiles, 400);\n        parts.push(`\\nEXISTING FILES:`);\n        for (const [filename, content] of Object.entries(summarizedFiles)){\n            parts.push(`\\n--- ${filename} ---\\n${content}`);\n        }\n        originalSize += Object.values(options.existingFiles).reduce((sum, content)=>sum + content.length, 0);\n    }\n    // 4. Plan (always include if present)\n    if (options.plan && options.plan.length > 0) {\n        parts.push(`\\nPLAN:\\n${options.plan.map((s, i)=>`${i + 1}. ${s}`).join(\"\\n\")}`);\n        originalSize += options.plan.join(\"\").length;\n    }\n    // 5. Recent operations (keep brief)\n    if (options.recentOperations && options.recentOperations.length > 0) {\n        const recentOps = options.recentOperations.slice(-5);\n        parts.push(`\\nRECENT OPERATIONS:\\n${recentOps.join(\"\\n\")}`);\n        originalSize += options.recentOperations.join(\"\").length;\n    }\n    const compressedContext = parts.join(\"\\n\");\n    const compressedSize = compressedContext.length;\n    const compressionRatio = originalSize > 0 ? (originalSize - compressedSize) / originalSize * 100 : 0;\n    return {\n        compressedContext,\n        stats: {\n            originalSize,\n            compressedSize,\n            compressionRatio\n        }\n    };\n}\n/**\n * Smart truncation for very long content\n */ function smartTruncate(text, maxLength) {\n    if (text.length <= maxLength) {\n        return text;\n    }\n    // Try to truncate at a natural boundary (newline, period, etc.)\n    const truncated = text.substring(0, maxLength);\n    const lastNewline = truncated.lastIndexOf(\"\\n\");\n    const lastPeriod = truncated.lastIndexOf(\".\");\n    const cutPoint = Math.max(lastNewline, lastPeriod);\n    if (cutPoint > maxLength * 0.8) {\n        return text.substring(0, cutPoint + 1) + \"\\n... (truncated)\";\n    }\n    return truncated + \"\\n... (truncated)\";\n}\n/**\n * Calculate approximate token count\n */ function estimateTokens(text) {\n    // Rough estimate: ~4 characters per token\n    // More accurate for English text\n    return Math.ceil(text.length / 4);\n}\n/**\n * Check if context is getting too large and needs compression\n */ function shouldCompress(text, maxTokens = 2000) {\n    return estimateTokens(text) > maxTokens;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUJBQW1CaEIsZUFBZSxJQUNuQyxDQUFDQSxlQUFlZSxjQUFhLElBQUtmLGVBQWUsTUFDbEQ7SUFFSixPQUFPO1FBQ0xjO1FBQ0FHLE9BQU87WUFDTGpCO1lBQ0FlO1lBQ0FDO1FBQ0Y7SUFDRjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTRSxjQUFjQyxJQUFZLEVBQUVDLFNBQWlCO0lBQzNELElBQUlELEtBQUt4RCxNQUFNLElBQUl5RCxXQUFXO1FBQzVCLE9BQU9EO0lBQ1Q7SUFFQSxnRUFBZ0U7SUFDaEUsTUFBTUUsWUFBWUYsS0FBS0csU0FBUyxDQUFDLEdBQUdGO0lBQ3BDLE1BQU1HLGNBQWNGLFVBQVVHLFdBQVcsQ0FBQztJQUMxQyxNQUFNQyxhQUFhSixVQUFVRyxXQUFXLENBQUM7SUFFekMsTUFBTUUsV0FBVzdDLEtBQUs4QyxHQUFHLENBQUNKLGFBQWFFO0lBRXZDLElBQUlDLFdBQVdOLFlBQVksS0FBSztRQUM5QixPQUFPRCxLQUFLRyxTQUFTLENBQUMsR0FBR0ksV0FBVyxLQUFLO0lBQzNDO0lBRUEsT0FBT0wsWUFBWTtBQUNyQjtBQUVBOztDQUVDLEdBQ00sU0FBU08sZUFBZVQsSUFBWTtJQUN6QywwQ0FBMEM7SUFDMUMsaUNBQWlDO0lBQ2pDLE9BQU90QyxLQUFLQyxJQUFJLENBQUNxQyxLQUFLeEQsTUFBTSxHQUFHO0FBQ2pDO0FBRUE7O0NBRUMsR0FDTSxTQUFTa0UsZUFBZVYsSUFBWSxFQUFFNUQsWUFBb0IsSUFBSTtJQUNuRSxPQUFPcUUsZUFBZVQsUUFBUTVEO0FBQ2hDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvLi9saWIvdXRpbHMvc3VtbWFyaXplci50cz9mMTg2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYXRPcGVuQUkgfSBmcm9tICdAbGFuZ2NoYWluL29wZW5haSc7XG5pbXBvcnQgeyBTeXN0ZW1NZXNzYWdlLCBIdW1hbk1lc3NhZ2UgfSBmcm9tICdAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXMnO1xuXG4vLyBJbml0aWFsaXplIGEgbGlnaHR3ZWlnaHQgbW9kZWwgZm9yIHN1bW1hcml6YXRpb25cbmNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfQVBJX0tFWSA/PyBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWTtcbmNvbnN0IGFwaUJhc2UgPSAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MSc7XG5cbmNvbnN0IHN1bW1hcml6ZXIgPSBuZXcgQ2hhdE9wZW5BSSh7XG4gIGFwaUtleSxcbiAgY29uZmlndXJhdGlvbjoge1xuICAgIGJhc2VVUkw6IGFwaUJhc2UsXG4gIH0sXG4gIG1vZGVsOiBwcm9jZXNzLmVudi5PUEVOUk9VVEVSX01PREVMICwgLy8gVXNlIGNoZWFwZXIgbW9kZWwgZm9yIHN1bW1hcml6YXRpb25cbiAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgbWF4VG9rZW5zOiA1MDAsXG59KTtcblxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJpemVkQ29udGV4dCB7XG4gIHN1bW1hcnk6IHN0cmluZztcbiAgdG9rZW5zU2F2ZWQ6IG51bWJlcjtcbiAgb3JpZ2luYWxMZW5ndGg6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBTdW1tYXJpemUgY29udmVyc2F0aW9uIGhpc3RvcnkgdG8gcmVkdWNlIHRva2VuIHVzYWdlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdW1tYXJpemVDb252ZXJzYXRpb24oXG4gIG1lc3NhZ2VzOiBBcnJheTx7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH0+LFxuICBtYXhNZXNzYWdlczogbnVtYmVyID0gMTBcbik6IFByb21pc2U8U3VtbWFyaXplZENvbnRleHQ+IHtcbiAgLy8gS2VlcCB0aGUgbW9zdCByZWNlbnQgbWVzc2FnZXMsIHN1bW1hcml6ZSBvbGRlciBvbmVzXG4gIGlmIChtZXNzYWdlcy5sZW5ndGggPD0gbWF4TWVzc2FnZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VtbWFyeTogbWVzc2FnZXMubWFwKG0gPT4gYCR7bS5yb2xlfTogJHttLmNvbnRlbnR9YCkuam9pbignXFxuJyksXG4gICAgICB0b2tlbnNTYXZlZDogMCxcbiAgICAgIG9yaWdpbmFsTGVuZ3RoOiBtZXNzYWdlcy5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gbWVzc2FnZXMuc2xpY2UoLW1heE1lc3NhZ2VzKTtcbiAgY29uc3Qgb2xkTWVzc2FnZXMgPSBtZXNzYWdlcy5zbGljZSgwLCAtbWF4TWVzc2FnZXMpO1xuXG4gIGNvbnN0IG9sZE1lc3NhZ2VzVGV4dCA9IG9sZE1lc3NhZ2VzXG4gICAgLm1hcChtID0+IGAke20ucm9sZX06ICR7bS5jb250ZW50fWApXG4gICAgLmpvaW4oJ1xcbicpO1xuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgY29udGV4dCBzdW1tYXJpemVyLiBDb25kZW5zZSB0aGUgY29udmVyc2F0aW9uIGhpc3RvcnkgaW50byBhIGJyaWVmLCByZWxldmFudCBzdW1tYXJ5LlxuXG5Gb2N1cyBvbjpcbjEuIEtleSB1c2VyIHJlcXVlc3RzIGFuZCB3aGF0IHdhcyBhY2NvbXBsaXNoZWRcbjIuIEltcG9ydGFudCBkZWNpc2lvbnMgbWFkZVxuMy4gRmlsZXMgY3JlYXRlZC9tb2RpZmllZFxuNC4gQ3VycmVudCBzdGF0ZSBvZiB0aGUgcHJvamVjdFxuXG5LZWVwIGl0IHVuZGVyIDIwMCB3b3Jkcy4gQmUgY29uY2lzZSBidXQgcHJlc2VydmUgY3JpdGljYWwgY29udGV4dC5gO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdW1tYXJpemVyLmludm9rZShbXG4gICAgICBuZXcgU3lzdGVtTWVzc2FnZShzeXN0ZW1Qcm9tcHQpLFxuICAgICAgbmV3IEh1bWFuTWVzc2FnZShgU3VtbWFyaXplIHRoaXMgY29udmVyc2F0aW9uIGhpc3Rvcnk6XFxuXFxuJHtvbGRNZXNzYWdlc1RleHR9YCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBzdW1tYXJ5ID0gcmVzcG9uc2UuY29udGVudC50b1N0cmluZygpO1xuICAgIFxuICAgIC8vIEVzdGltYXRlIHRva2VucyBzYXZlZCAocm91Z2ggZXN0aW1hdGU6IDQgY2hhcnMg4omIIDEgdG9rZW4pXG4gICAgY29uc3Qgb3JpZ2luYWxUb2tlbnMgPSBNYXRoLmNlaWwob2xkTWVzc2FnZXNUZXh0Lmxlbmd0aCAvIDQpO1xuICAgIGNvbnN0IHN1bW1hcnlUb2tlbnMgPSBNYXRoLmNlaWwoc3VtbWFyeS5sZW5ndGggLyA0KTtcbiAgICBjb25zdCB0b2tlbnNTYXZlZCA9IG9yaWdpbmFsVG9rZW5zIC0gc3VtbWFyeVRva2VucztcblxuICAgIHJldHVybiB7XG4gICAgICBzdW1tYXJ5LFxuICAgICAgdG9rZW5zU2F2ZWQsXG4gICAgICBvcmlnaW5hbExlbmd0aDogbWVzc2FnZXMubGVuZ3RoLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignU3VtbWFyaXphdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgLy8gRmFsbGJhY2s6IGp1c3QgcmV0dXJuIHJlY2VudCBtZXNzYWdlc1xuICAgIHJldHVybiB7XG4gICAgICBzdW1tYXJ5OiByZWNlbnRNZXNzYWdlcy5tYXAobSA9PiBgJHttLnJvbGV9OiAke20uY29udGVudH1gKS5qb2luKCdcXG4nKSxcbiAgICAgIHRva2Vuc1NhdmVkOiAwLFxuICAgICAgb3JpZ2luYWxMZW5ndGg6IG1lc3NhZ2VzLmxlbmd0aCxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogU3VtbWFyaXplIGZpbGUgY29udGVudHMgdG8gcmVkdWNlIHRva2VuIHVzYWdlIHdoZW4gcGFzc2luZyBhcyBjb250ZXh0XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdW1tYXJpemVGaWxlQ29udGVudHMoXG4gIGZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuICBtYXhGaWxlU2l6ZTogbnVtYmVyID0gNTAwXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHN0cmluZz4+IHtcbiAgY29uc3Qgc3VtbWFyaXplZEZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG5cbiAgZm9yIChjb25zdCBbZmlsZW5hbWUsIGNvbnRlbnRdIG9mIE9iamVjdC5lbnRyaWVzKGZpbGVzKSkge1xuICAgIC8vIElmIGZpbGUgaXMgc21hbGwgZW5vdWdoLCBrZWVwIGl0IGFzLWlzXG4gICAgaWYgKGNvbnRlbnQubGVuZ3RoIDw9IG1heEZpbGVTaXplKSB7XG4gICAgICBzdW1tYXJpemVkRmlsZXNbZmlsZW5hbWVdID0gY29udGVudDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIEZvciBsYXJnZSBmaWxlcywgcHJvdmlkZSBhIHN0cnVjdHVyZSBzdW1tYXJ5XG4gICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmaXJzdExpbmVzID0gbGluZXMuc2xpY2UoMCwgMTApLmpvaW4oJ1xcbicpO1xuICAgIGNvbnN0IGxhc3RMaW5lcyA9IGxpbmVzLnNsaWNlKC01KS5qb2luKCdcXG4nKTtcbiAgICBcbiAgICBjb25zdCBzdW1tYXJ5ID0gYCR7Zmlyc3RMaW5lc31cXG5cXG4uLi4gKCR7bGluZXMubGVuZ3RoIC0gMTV9IGxpbmVzIG9taXR0ZWQpIC4uLlxcblxcbiR7bGFzdExpbmVzfWA7XG4gICAgc3VtbWFyaXplZEZpbGVzW2ZpbGVuYW1lXSA9IHN1bW1hcnk7XG4gIH1cblxuICByZXR1cm4gc3VtbWFyaXplZEZpbGVzO1xufVxuXG4vKipcbiAqIEludGVsbGlnZW50IGNvbnRleHQgY29tcHJlc3Npb24gZm9yIGFnZW50IHByb21wdHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbXByZXNzQ29udGV4dChvcHRpb25zOiB7XG4gIHVzZXJSZXF1ZXN0OiBzdHJpbmc7XG4gIGNvbnZlcnNhdGlvbkhpc3Rvcnk/OiBBcnJheTx7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH0+O1xuICBleGlzdGluZ0ZpbGVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgcGxhbj86IHN0cmluZ1tdO1xuICByZWNlbnRPcGVyYXRpb25zPzogc3RyaW5nW107XG59KTogUHJvbWlzZTx7XG4gIGNvbXByZXNzZWRDb250ZXh0OiBzdHJpbmc7XG4gIHN0YXRzOiB7XG4gICAgb3JpZ2luYWxTaXplOiBudW1iZXI7XG4gICAgY29tcHJlc3NlZFNpemU6IG51bWJlcjtcbiAgICBjb21wcmVzc2lvblJhdGlvOiBudW1iZXI7XG4gIH07XG59PiB7XG4gIGNvbnN0IHBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICBsZXQgb3JpZ2luYWxTaXplID0gMDtcblxuICAvLyAxLiBVc2VyIHJlcXVlc3QgKGFsd2F5cyBpbmNsdWRlLCBoaWdoIHByaW9yaXR5KVxuICBwYXJ0cy5wdXNoKGBVU0VSIFJFUVVFU1Q6ICR7b3B0aW9ucy51c2VyUmVxdWVzdH1gKTtcbiAgb3JpZ2luYWxTaXplICs9IG9wdGlvbnMudXNlclJlcXVlc3QubGVuZ3RoO1xuXG4gIC8vIDIuIENvbnZlcnNhdGlvbiBoaXN0b3J5IChzdW1tYXJpemUgaWYgbG9uZylcbiAgaWYgKG9wdGlvbnMuY29udmVyc2F0aW9uSGlzdG9yeSAmJiBvcHRpb25zLmNvbnZlcnNhdGlvbkhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IHsgc3VtbWFyeSwgdG9rZW5zU2F2ZWQgfSA9IGF3YWl0IHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcbiAgICAgIG9wdGlvbnMuY29udmVyc2F0aW9uSGlzdG9yeSxcbiAgICAgIDUgLy8gS2VlcCBsYXN0IDUgbWVzc2FnZXNcbiAgICApO1xuICAgIFxuICAgIHBhcnRzLnB1c2goYFxcbkNPTlZFUlNBVElPTiBDT05URVhUOlxcbiR7c3VtbWFyeX1gKTtcbiAgICBvcmlnaW5hbFNpemUgKz0gb3B0aW9ucy5jb252ZXJzYXRpb25IaXN0b3J5LnJlZHVjZShcbiAgICAgIChzdW0sIG0pID0+IHN1bSArIG0uY29udGVudC5sZW5ndGgsXG4gICAgICAwXG4gICAgKTtcbiAgfVxuXG4gIC8vIDMuIEV4aXN0aW5nIGZpbGVzIChzdW1tYXJpemUgbGFyZ2UgZmlsZXMpXG4gIGlmIChvcHRpb25zLmV4aXN0aW5nRmlsZXMgJiYgT2JqZWN0LmtleXMob3B0aW9ucy5leGlzdGluZ0ZpbGVzKS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3Qgc3VtbWFyaXplZEZpbGVzID0gYXdhaXQgc3VtbWFyaXplRmlsZUNvbnRlbnRzKG9wdGlvbnMuZXhpc3RpbmdGaWxlcywgNDAwKTtcbiAgICBcbiAgICBwYXJ0cy5wdXNoKGBcXG5FWElTVElORyBGSUxFUzpgKTtcbiAgICBmb3IgKGNvbnN0IFtmaWxlbmFtZSwgY29udGVudF0gb2YgT2JqZWN0LmVudHJpZXMoc3VtbWFyaXplZEZpbGVzKSkge1xuICAgICAgcGFydHMucHVzaChgXFxuLS0tICR7ZmlsZW5hbWV9IC0tLVxcbiR7Y29udGVudH1gKTtcbiAgICB9XG4gICAgXG4gICAgb3JpZ2luYWxTaXplICs9IE9iamVjdC52YWx1ZXMob3B0aW9ucy5leGlzdGluZ0ZpbGVzKS5yZWR1Y2UoXG4gICAgICAoc3VtLCBjb250ZW50KSA9PiBzdW0gKyBjb250ZW50Lmxlbmd0aCxcbiAgICAgIDBcbiAgICApO1xuICB9XG5cbiAgLy8gNC4gUGxhbiAoYWx3YXlzIGluY2x1ZGUgaWYgcHJlc2VudClcbiAgaWYgKG9wdGlvbnMucGxhbiAmJiBvcHRpb25zLnBsYW4ubGVuZ3RoID4gMCkge1xuICAgIHBhcnRzLnB1c2goYFxcblBMQU46XFxuJHtvcHRpb25zLnBsYW4ubWFwKChzLCBpKSA9PiBgJHtpICsgMX0uICR7c31gKS5qb2luKCdcXG4nKX1gKTtcbiAgICBvcmlnaW5hbFNpemUgKz0gb3B0aW9ucy5wbGFuLmpvaW4oJycpLmxlbmd0aDtcbiAgfVxuXG4gIC8vIDUuIFJlY2VudCBvcGVyYXRpb25zIChrZWVwIGJyaWVmKVxuICBpZiAob3B0aW9ucy5yZWNlbnRPcGVyYXRpb25zICYmIG9wdGlvbnMucmVjZW50T3BlcmF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgcmVjZW50T3BzID0gb3B0aW9ucy5yZWNlbnRPcGVyYXRpb25zLnNsaWNlKC01KTtcbiAgICBwYXJ0cy5wdXNoKGBcXG5SRUNFTlQgT1BFUkFUSU9OUzpcXG4ke3JlY2VudE9wcy5qb2luKCdcXG4nKX1gKTtcbiAgICBvcmlnaW5hbFNpemUgKz0gb3B0aW9ucy5yZWNlbnRPcGVyYXRpb25zLmpvaW4oJycpLmxlbmd0aDtcbiAgfVxuXG4gIGNvbnN0IGNvbXByZXNzZWRDb250ZXh0ID0gcGFydHMuam9pbignXFxuJyk7XG4gIGNvbnN0IGNvbXByZXNzZWRTaXplID0gY29tcHJlc3NlZENvbnRleHQubGVuZ3RoO1xuICBjb25zdCBjb21wcmVzc2lvblJhdGlvID0gb3JpZ2luYWxTaXplID4gMCBcbiAgICA/ICgob3JpZ2luYWxTaXplIC0gY29tcHJlc3NlZFNpemUpIC8gb3JpZ2luYWxTaXplICogMTAwKVxuICAgIDogMDtcblxuICByZXR1cm4ge1xuICAgIGNvbXByZXNzZWRDb250ZXh0LFxuICAgIHN0YXRzOiB7XG4gICAgICBvcmlnaW5hbFNpemUsXG4gICAgICBjb21wcmVzc2VkU2l6ZSxcbiAgICAgIGNvbXByZXNzaW9uUmF0aW8sXG4gICAgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBTbWFydCB0cnVuY2F0aW9uIGZvciB2ZXJ5IGxvbmcgY29udGVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gc21hcnRUcnVuY2F0ZSh0ZXh0OiBzdHJpbmcsIG1heExlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgaWYgKHRleHQubGVuZ3RoIDw9IG1heExlbmd0aCkge1xuICAgIHJldHVybiB0ZXh0O1xuICB9XG5cbiAgLy8gVHJ5IHRvIHRydW5jYXRlIGF0IGEgbmF0dXJhbCBib3VuZGFyeSAobmV3bGluZSwgcGVyaW9kLCBldGMuKVxuICBjb25zdCB0cnVuY2F0ZWQgPSB0ZXh0LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpO1xuICBjb25zdCBsYXN0TmV3bGluZSA9IHRydW5jYXRlZC5sYXN0SW5kZXhPZignXFxuJyk7XG4gIGNvbnN0IGxhc3RQZXJpb2QgPSB0cnVuY2F0ZWQubGFzdEluZGV4T2YoJy4nKTtcbiAgXG4gIGNvbnN0IGN1dFBvaW50ID0gTWF0aC5tYXgobGFzdE5ld2xpbmUsIGxhc3RQZXJpb2QpO1xuICBcbiAgaWYgKGN1dFBvaW50ID4gbWF4TGVuZ3RoICogMC44KSB7XG4gICAgcmV0dXJuIHRleHQuc3Vic3RyaW5nKDAsIGN1dFBvaW50ICsgMSkgKyAnXFxuLi4uICh0cnVuY2F0ZWQpJztcbiAgfVxuICBcbiAgcmV0dXJuIHRydW5jYXRlZCArICdcXG4uLi4gKHRydW5jYXRlZCknO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBhcHByb3hpbWF0ZSB0b2tlbiBjb3VudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgLy8gUm91Z2ggZXN0aW1hdGU6IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gIC8vIE1vcmUgYWNjdXJhdGUgZm9yIEVuZ2xpc2ggdGV4dFxuICByZXR1cm4gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgY29udGV4dCBpcyBnZXR0aW5nIHRvbyBsYXJnZSBhbmQgbmVlZHMgY29tcHJlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3VsZENvbXByZXNzKHRleHQ6IHN0cmluZywgbWF4VG9rZW5zOiBudW1iZXIgPSAyMDAwKTogYm9vbGVhbiB7XG4gIHJldHVybiBlc3RpbWF0ZVRva2Vucyh0ZXh0KSA+IG1heFRva2Vucztcbn1cbiJdLCJuYW1lcyI6WyJDaGF0T3BlbkFJIiwiU3lzdGVtTWVzc2FnZSIsIkh1bWFuTWVzc2FnZSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOUk9VVEVSX0FQSV9LRVkiLCJPUEVOQUlfQVBJX0tFWSIsImFwaUJhc2UiLCJzdW1tYXJpemVyIiwiY29uZmlndXJhdGlvbiIsImJhc2VVUkwiLCJtb2RlbCIsIk9QRU5ST1VURVJfTU9ERUwiLCJ0ZW1wZXJhdHVyZSIsIm1heFRva2VucyIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsIm1lc3NhZ2VzIiwibWF4TWVzc2FnZXMiLCJsZW5ndGgiLCJzdW1tYXJ5IiwibWFwIiwibSIsInJvbGUiLCJjb250ZW50Iiwiam9pbiIsInRva2Vuc1NhdmVkIiwib3JpZ2luYWxMZW5ndGgiLCJyZWNlbnRNZXNzYWdlcyIsInNsaWNlIiwib2xkTWVzc2FnZXMiLCJvbGRNZXNzYWdlc1RleHQiLCJzeXN0ZW1Qcm9tcHQiLCJyZXNwb25zZSIsImludm9rZSIsInRvU3RyaW5nIiwib3JpZ2luYWxUb2tlbnMiLCJNYXRoIiwiY2VpbCIsInN1bW1hcnlUb2tlbnMiLCJlcnJvciIsImNvbnNvbGUiLCJzdW1tYXJpemVGaWxlQ29udGVudHMiLCJmaWxlcyIsIm1heEZpbGVTaXplIiwic3VtbWFyaXplZEZpbGVzIiwiZmlsZW5hbWUiLCJPYmplY3QiLCJlbnRyaWVzIiwibGluZXMiLCJzcGxpdCIsImZpcnN0TGluZXMiLCJsYXN0TGluZXMiLCJjb21wcmVzc0NvbnRleHQiLCJvcHRpb25zIiwicGFydHMiLCJvcmlnaW5hbFNpemUiLCJwdXNoIiwidXNlclJlcXVlc3QiLCJjb252ZXJzYXRpb25IaXN0b3J5IiwicmVkdWNlIiwic3VtIiwiZXhpc3RpbmdGaWxlcyIsImtleXMiLCJ2YWx1ZXMiLCJwbGFuIiwicyIsImkiLCJyZWNlbnRPcGVyYXRpb25zIiwicmVjZW50T3BzIiwiY29tcHJlc3NlZENvbnRleHQiLCJjb21wcmVzc2VkU2l6ZSIsImNvbXByZXNzaW9uUmF0aW8iLCJzdGF0cyIsInNtYXJ0VHJ1bmNhdGUiLCJ0ZXh0IiwibWF4TGVuZ3RoIiwidHJ1bmNhdGVkIiwic3Vic3RyaW5nIiwibGFzdE5ld2xpbmUiLCJsYXN0SW5kZXhPZiIsImxhc3RQZXJpb2QiLCJjdXRQb2ludCIsIm1heCIsImVzdGltYXRlVG9rZW5zIiwic2hvdWxkQ29tcHJlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/summarizer.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/tool-logger.ts":
/*!**********************************!*\
  !*** ./lib/utils/tool-logger.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toolLogger: () => (/* binding */ toolLogger)\n/* harmony export */ });\n/**\n * Tool Call Logger\n * Logs all tool invocations with timing and results for debugging and optimization\n */ class ToolCallLogger {\n    setSession(sessionId) {\n        this.sessionId = sessionId;\n        this.calls = [];\n    }\n    startCall(toolName, parameters) {\n        const callId = this.calls.length;\n        this.calls.push({\n            toolName,\n            parameters,\n            startTime: Date.now(),\n            success: false\n        });\n        console.log(`🔧 [TOOL START] ${toolName}`, this.formatParams(parameters));\n        return callId;\n    }\n    endCall(callId, result, success = true, error) {\n        const call = this.calls[callId];\n        if (!call) return;\n        call.endTime = Date.now();\n        call.duration = call.endTime - call.startTime;\n        call.success = success;\n        call.result = this.truncateResult(result);\n        call.error = error;\n        const icon = success ? \"✅\" : \"❌\";\n        console.log(`${icon} [TOOL END] ${call.toolName} (${call.duration}ms)`);\n        if (error) {\n            console.log(`   Error: ${error}`);\n        }\n    }\n    getStats() {\n        const totalCalls = this.calls.length;\n        const successfulCalls = this.calls.filter((c)=>c.success).length;\n        const failedCalls = totalCalls - successfulCalls;\n        const totalDuration = this.calls.reduce((sum, c)=>sum + (c.duration || 0), 0);\n        const averageDuration = totalCalls > 0 ? totalDuration / totalCalls : 0;\n        const toolUsage = this.calls.reduce((acc, call)=>{\n            acc[call.toolName] = (acc[call.toolName] || 0) + 1;\n            return acc;\n        }, {});\n        return {\n            totalCalls,\n            successfulCalls,\n            failedCalls,\n            totalDuration,\n            averageDuration: Math.round(averageDuration),\n            toolUsage\n        };\n    }\n    getSummary() {\n        const stats = this.getStats();\n        return `\n📊 Tool Call Statistics:\n- Total calls: ${stats.totalCalls}\n- Successful: ${stats.successfulCalls}\n- Failed: ${stats.failedCalls}\n- Total time: ${stats.totalDuration}ms\n- Average time: ${stats.averageDuration}ms\n- Most used: ${Object.entries(stats.toolUsage).sort((a, b)=>b[1] - a[1]).slice(0, 3).map(([tool, count])=>`${tool}(${count})`).join(\", \")}\n    `.trim();\n    }\n    getCalls() {\n        return this.calls;\n    }\n    clear() {\n        this.calls = [];\n    }\n    formatParams(params) {\n        if (typeof params === \"string\") return params;\n        const str = JSON.stringify(params, null, 0);\n        return str.length > 100 ? str.substring(0, 100) + \"...\" : str;\n    }\n    truncateResult(result) {\n        return result.length > 500 ? result.substring(0, 500) + \"...\" : result;\n    }\n    constructor(){\n        this.calls = [];\n        this.sessionId = \"\";\n    }\n}\nconst toolLogger = new ToolCallLogger();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUdDLElBQU1BLENBQUMsQ0FBQyxFQUFFLEdBQUdELENBQUMsQ0FBQyxFQUFFLEVBQzFCRSxLQUFLLENBQUMsR0FBRyxHQUNUQyxHQUFHLENBQUMsQ0FBQyxDQUFDQyxNQUFNQyxNQUFNLEdBQUssQ0FBQyxFQUFFRCxLQUFLLENBQUMsRUFBRUMsTUFBTSxDQUFDLENBQUMsRUFDMUNDLElBQUksQ0FBQyxNQUFNO0lBQ2QsQ0FBQyxDQUFDQyxJQUFJO0lBQ1I7SUFFQUMsV0FBVztRQUNULE9BQU8sSUFBSSxDQUFDakQsS0FBSztJQUNuQjtJQUVBa0QsUUFBUTtRQUNOLElBQUksQ0FBQ2xELEtBQUssR0FBRyxFQUFFO0lBQ2pCO0lBRVFhLGFBQWFzQyxNQUFXLEVBQVU7UUFDeEMsSUFBSSxPQUFPQSxXQUFXLFVBQVUsT0FBT0E7UUFDdkMsTUFBTUMsTUFBTUMsS0FBS0MsU0FBUyxDQUFDSCxRQUFRLE1BQU07UUFDekMsT0FBT0MsSUFBSS9DLE1BQU0sR0FBRyxNQUFNK0MsSUFBSUcsU0FBUyxDQUFDLEdBQUcsT0FBTyxRQUFRSDtJQUM1RDtJQUVRaEMsZUFBZUwsTUFBYyxFQUFVO1FBQzdDLE9BQU9BLE9BQU9WLE1BQU0sR0FBRyxNQUFNVSxPQUFPd0MsU0FBUyxDQUFDLEdBQUcsT0FBTyxRQUFReEM7SUFDbEU7O2FBOUZRZixRQUFvQixFQUFFO2FBQ3RCRCxZQUFvQjs7QUE4RjlCO0FBRU8sTUFBTXlELGFBQWEsSUFBSTNELGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL3V0aWxzL3Rvb2wtbG9nZ2VyLnRzP2ZkOTgiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUb29sIENhbGwgTG9nZ2VyXG4gKiBMb2dzIGFsbCB0b29sIGludm9jYXRpb25zIHdpdGggdGltaW5nIGFuZCByZXN1bHRzIGZvciBkZWJ1Z2dpbmcgYW5kIG9wdGltaXphdGlvblxuICovXG5cbmludGVyZmFjZSBUb29sQ2FsbCB7XG4gIHRvb2xOYW1lOiBzdHJpbmc7XG4gIHBhcmFtZXRlcnM6IGFueTtcbiAgc3RhcnRUaW1lOiBudW1iZXI7XG4gIGVuZFRpbWU/OiBudW1iZXI7XG4gIGR1cmF0aW9uPzogbnVtYmVyO1xuICBzdWNjZXNzOiBib29sZWFuO1xuICByZXN1bHQ/OiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5jbGFzcyBUb29sQ2FsbExvZ2dlciB7XG4gIHByaXZhdGUgY2FsbHM6IFRvb2xDYWxsW10gPSBbXTtcbiAgcHJpdmF0ZSBzZXNzaW9uSWQ6IHN0cmluZyA9ICcnO1xuXG4gIHNldFNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpIHtcbiAgICB0aGlzLnNlc3Npb25JZCA9IHNlc3Npb25JZDtcbiAgICB0aGlzLmNhbGxzID0gW107XG4gIH1cblxuICBzdGFydENhbGwodG9vbE5hbWU6IHN0cmluZywgcGFyYW1ldGVyczogYW55KTogbnVtYmVyIHtcbiAgICBjb25zdCBjYWxsSWQgPSB0aGlzLmNhbGxzLmxlbmd0aDtcbiAgICB0aGlzLmNhbGxzLnB1c2goe1xuICAgICAgdG9vbE5hbWUsXG4gICAgICBwYXJhbWV0ZXJzLFxuICAgICAgc3RhcnRUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coYPCflKcgW1RPT0wgU1RBUlRdICR7dG9vbE5hbWV9YCwgdGhpcy5mb3JtYXRQYXJhbXMocGFyYW1ldGVycykpO1xuICAgIHJldHVybiBjYWxsSWQ7XG4gIH1cblxuICBlbmRDYWxsKGNhbGxJZDogbnVtYmVyLCByZXN1bHQ6IHN0cmluZywgc3VjY2VzczogYm9vbGVhbiA9IHRydWUsIGVycm9yPzogc3RyaW5nKSB7XG4gICAgY29uc3QgY2FsbCA9IHRoaXMuY2FsbHNbY2FsbElkXTtcbiAgICBpZiAoIWNhbGwpIHJldHVybjtcblxuICAgIGNhbGwuZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgY2FsbC5kdXJhdGlvbiA9IGNhbGwuZW5kVGltZSAtIGNhbGwuc3RhcnRUaW1lO1xuICAgIGNhbGwuc3VjY2VzcyA9IHN1Y2Nlc3M7XG4gICAgY2FsbC5yZXN1bHQgPSB0aGlzLnRydW5jYXRlUmVzdWx0KHJlc3VsdCk7XG4gICAgY2FsbC5lcnJvciA9IGVycm9yO1xuXG4gICAgY29uc3QgaWNvbiA9IHN1Y2Nlc3MgPyAn4pyFJyA6ICfinYwnO1xuICAgIGNvbnNvbGUubG9nKGAke2ljb259IFtUT09MIEVORF0gJHtjYWxsLnRvb2xOYW1lfSAoJHtjYWxsLmR1cmF0aW9ufW1zKWApO1xuICAgIFxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coYCAgIEVycm9yOiAke2Vycm9yfWApO1xuICAgIH1cbiAgfVxuXG4gIGdldFN0YXRzKCkge1xuICAgIGNvbnN0IHRvdGFsQ2FsbHMgPSB0aGlzLmNhbGxzLmxlbmd0aDtcbiAgICBjb25zdCBzdWNjZXNzZnVsQ2FsbHMgPSB0aGlzLmNhbGxzLmZpbHRlcihjID0+IGMuc3VjY2VzcykubGVuZ3RoO1xuICAgIGNvbnN0IGZhaWxlZENhbGxzID0gdG90YWxDYWxscyAtIHN1Y2Nlc3NmdWxDYWxscztcbiAgICBjb25zdCB0b3RhbER1cmF0aW9uID0gdGhpcy5jYWxscy5yZWR1Y2UoKHN1bSwgYykgPT4gc3VtICsgKGMuZHVyYXRpb24gfHwgMCksIDApO1xuICAgIGNvbnN0IGF2ZXJhZ2VEdXJhdGlvbiA9IHRvdGFsQ2FsbHMgPiAwID8gdG90YWxEdXJhdGlvbiAvIHRvdGFsQ2FsbHMgOiAwO1xuXG4gICAgY29uc3QgdG9vbFVzYWdlID0gdGhpcy5jYWxscy5yZWR1Y2UoKGFjYywgY2FsbCkgPT4ge1xuICAgICAgYWNjW2NhbGwudG9vbE5hbWVdID0gKGFjY1tjYWxsLnRvb2xOYW1lXSB8fCAwKSArIDE7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj4pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsQ2FsbHMsXG4gICAgICBzdWNjZXNzZnVsQ2FsbHMsXG4gICAgICBmYWlsZWRDYWxscyxcbiAgICAgIHRvdGFsRHVyYXRpb24sXG4gICAgICBhdmVyYWdlRHVyYXRpb246IE1hdGgucm91bmQoYXZlcmFnZUR1cmF0aW9uKSxcbiAgICAgIHRvb2xVc2FnZSxcbiAgICB9O1xuICB9XG5cbiAgZ2V0U3VtbWFyeSgpIHtcbiAgICBjb25zdCBzdGF0cyA9IHRoaXMuZ2V0U3RhdHMoKTtcbiAgICByZXR1cm4gYFxu8J+TiiBUb29sIENhbGwgU3RhdGlzdGljczpcbi0gVG90YWwgY2FsbHM6ICR7c3RhdHMudG90YWxDYWxsc31cbi0gU3VjY2Vzc2Z1bDogJHtzdGF0cy5zdWNjZXNzZnVsQ2FsbHN9XG4tIEZhaWxlZDogJHtzdGF0cy5mYWlsZWRDYWxsc31cbi0gVG90YWwgdGltZTogJHtzdGF0cy50b3RhbER1cmF0aW9ufW1zXG4tIEF2ZXJhZ2UgdGltZTogJHtzdGF0cy5hdmVyYWdlRHVyYXRpb259bXNcbi0gTW9zdCB1c2VkOiAke09iamVjdC5lbnRyaWVzKHN0YXRzLnRvb2xVc2FnZSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlcbiAgICAgIC5zbGljZSgwLCAzKVxuICAgICAgLm1hcCgoW3Rvb2wsIGNvdW50XSkgPT4gYCR7dG9vbH0oJHtjb3VudH0pYClcbiAgICAgIC5qb2luKCcsICcpfVxuICAgIGAudHJpbSgpO1xuICB9XG5cbiAgZ2V0Q2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbHM7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICB0aGlzLmNhbGxzID0gW107XG4gIH1cblxuICBwcml2YXRlIGZvcm1hdFBhcmFtcyhwYXJhbXM6IGFueSk6IHN0cmluZyB7XG4gICAgaWYgKHR5cGVvZiBwYXJhbXMgPT09ICdzdHJpbmcnKSByZXR1cm4gcGFyYW1zO1xuICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KHBhcmFtcywgbnVsbCwgMCk7XG4gICAgcmV0dXJuIHN0ci5sZW5ndGggPiAxMDAgPyBzdHIuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJyA6IHN0cjtcbiAgfVxuXG4gIHByaXZhdGUgdHJ1bmNhdGVSZXN1bHQocmVzdWx0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiByZXN1bHQubGVuZ3RoID4gNTAwID8gcmVzdWx0LnN1YnN0cmluZygwLCA1MDApICsgJy4uLicgOiByZXN1bHQ7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHRvb2xMb2dnZXIgPSBuZXcgVG9vbENhbGxMb2dnZXIoKTtcbiJdLCJuYW1lcyI6WyJUb29sQ2FsbExvZ2dlciIsInNldFNlc3Npb24iLCJzZXNzaW9uSWQiLCJjYWxscyIsInN0YXJ0Q2FsbCIsInRvb2xOYW1lIiwicGFyYW1ldGVycyIsImNhbGxJZCIsImxlbmd0aCIsInB1c2giLCJzdGFydFRpbWUiLCJEYXRlIiwibm93Iiwic3VjY2VzcyIsImNvbnNvbGUiLCJsb2ciLCJmb3JtYXRQYXJhbXMiLCJlbmRDYWxsIiwicmVzdWx0IiwiZXJyb3IiLCJjYWxsIiwiZW5kVGltZSIsImR1cmF0aW9uIiwidHJ1bmNhdGVSZXN1bHQiLCJpY29uIiwiZ2V0U3RhdHMiLCJ0b3RhbENhbGxzIiwic3VjY2Vzc2Z1bENhbGxzIiwiZmlsdGVyIiwiYyIsImZhaWxlZENhbGxzIiwidG90YWxEdXJhdGlvbiIsInJlZHVjZSIsInN1bSIsImF2ZXJhZ2VEdXJhdGlvbiIsInRvb2xVc2FnZSIsImFjYyIsIk1hdGgiLCJyb3VuZCIsImdldFN1bW1hcnkiLCJzdGF0cyIsIk9iamVjdCIsImVudHJpZXMiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsIm1hcCIsInRvb2wiLCJjb3VudCIsImpvaW4iLCJ0cmltIiwiZ2V0Q2FsbHMiLCJjbGVhciIsInBhcmFtcyIsInN0ciIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWJzdHJpbmciLCJ0b29sTG9nZ2VyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/tool-logger.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/vector-tools.ts":
/*!***********************************!*\
  !*** ./lib/utils/vector-tools.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getProjectContext: () => (/* binding */ getProjectContext),\n/* harmony export */   searchSimilarCode: () => (/* binding */ searchSimilarCode)\n/* harmony export */ });\n/* harmony import */ var _db_chroma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../db/chroma */ \"(rsc)/./lib/db/chroma.ts\");\n\n/**\n * Tool for searching similar code examples from vector store\n */ async function searchSimilarCode(query, projectId, maxResults = 5) {\n    try {\n        console.log(`🔍 Searching for similar code: \"${query}\" in project ${projectId}`);\n        const results = await _db_chroma__WEBPACK_IMPORTED_MODULE_0__.chromaManager.searchCode(projectId, query, maxResults);\n        if (results.length === 0) {\n            return \"No similar code examples found.\";\n        }\n        const examples = results.map((result, index)=>{\n            const filename = result.metadata.filename || \"unknown\";\n            const score = Math.round(result.score * 100);\n            const content = result.content.length > 300 ? result.content.substring(0, 300) + \"...\" : result.content;\n            return `Example ${index + 1} (${score}% match - ${filename}):\n\\`\\`\\`\n${content}\n\\`\\`\\``;\n        }).join(\"\\n\\n\");\n        return `Found ${results.length} similar code examples:\\n\\n${examples}`;\n    } catch (error) {\n        console.error(\"❌ Vector search failed:\", error);\n        return \"Error searching for similar code examples.\";\n    }\n}\n/**\n * Tool for getting project context and structure\n */ async function getProjectContext(projectId) {\n    try {\n        console.log(`📊 Getting project context for: ${projectId}`);\n        const stats = await _db_chroma__WEBPACK_IMPORTED_MODULE_0__.chromaManager.getProjectStats(projectId);\n        if (!stats) {\n            return \"No project context available.\";\n        }\n        return `Project Statistics:\n- Total chunks: ${stats.total_chunks}\n- Code chunks: ${stats.code_chunks}\n- Structure chunks: ${stats.structure_chunks}\n- Prompt chunks: ${stats.prompt_chunks}\n- Dependency chunks: ${stats.dependency_chunks}\n- Created: ${stats.created_at}\n- Last updated: ${stats.last_updated}`;\n    } catch (error) {\n        console.error(\"❌ Failed to get project context:\", error);\n        return \"Error retrieving project context.\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdXRpbHMvdmVjdG9yLXRvb2xzLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3Qzs7Q0FFQyxHQUNNLGVBQWVDLGtCQUFrQkMsS0FBYSxFQUFFQyxTQUFpQixFQUFFQyxhQUFxQixDQUFDO0lBQzlGLElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsZ0NBQWdDLEVBQUVKLE1BQU0sYUFBYSxFQUFFQyxVQUFVLENBQUM7UUFFL0UsTUFBTUksVUFBVSxNQUFNUCxxREFBYUEsQ0FBQ1EsVUFBVSxDQUFDTCxXQUFXRCxPQUFPRTtRQUVqRSxJQUFJRyxRQUFRRSxNQUFNLEtBQUssR0FBRztZQUN4QixPQUFPO1FBQ1Q7UUFFQSxNQUFNQyxXQUFXSCxRQUFRSSxHQUFHLENBQUMsQ0FBQ0MsUUFBUUM7WUFDcEMsTUFBTUMsV0FBV0YsT0FBT0csUUFBUSxDQUFDRCxRQUFRLElBQUk7WUFDN0MsTUFBTUUsUUFBUUMsS0FBS0MsS0FBSyxDQUFDTixPQUFPSSxLQUFLLEdBQUc7WUFDeEMsTUFBTUcsVUFBVVAsT0FBT08sT0FBTyxDQUFDVixNQUFNLEdBQUcsTUFDcENHLE9BQU9PLE9BQU8sQ0FBQ0MsU0FBUyxDQUFDLEdBQUcsT0FBTyxRQUNuQ1IsT0FBT08sT0FBTztZQUVsQixPQUFPLENBQUMsUUFBUSxFQUFFTixRQUFRLEVBQUUsRUFBRSxFQUFFRyxNQUFNLFVBQVUsRUFBRUYsU0FBUzs7QUFFakUsRUFBRUssUUFBUTtNQUNKLENBQUM7UUFDSCxHQUFHRSxJQUFJLENBQUM7UUFFUixPQUFPLENBQUMsTUFBTSxFQUFFZCxRQUFRRSxNQUFNLENBQUMsMkJBQTJCLEVBQUVDLFNBQVMsQ0FBQztJQUN4RSxFQUFFLE9BQU9ZLE9BQU87UUFDZGpCLFFBQVFpQixLQUFLLENBQUMsMkJBQTJCQTtRQUN6QyxPQUFPO0lBQ1Q7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZUMsa0JBQWtCcEIsU0FBaUI7SUFDdkQsSUFBSTtRQUNGRSxRQUFRQyxHQUFHLENBQUMsQ0FBQyxnQ0FBZ0MsRUFBRUgsVUFBVSxDQUFDO1FBRTFELE1BQU1xQixRQUFRLE1BQU14QixxREFBYUEsQ0FBQ3lCLGVBQWUsQ0FBQ3RCO1FBRWxELElBQUksQ0FBQ3FCLE9BQU87WUFDVixPQUFPO1FBQ1Q7UUFFQSxPQUFPLENBQUM7Z0JBQ0ksRUFBRUEsTUFBTUUsWUFBWSxDQUFDO2VBQ3RCLEVBQUVGLE1BQU1HLFdBQVcsQ0FBQztvQkFDZixFQUFFSCxNQUFNSSxnQkFBZ0IsQ0FBQztpQkFDNUIsRUFBRUosTUFBTUssYUFBYSxDQUFDO3FCQUNsQixFQUFFTCxNQUFNTSxpQkFBaUIsQ0FBQztXQUNwQyxFQUFFTixNQUFNTyxVQUFVLENBQUM7Z0JBQ2QsRUFBRVAsTUFBTVEsWUFBWSxDQUFDLENBQUM7SUFDcEMsRUFBRSxPQUFPVixPQUFPO1FBQ2RqQixRQUFRaUIsS0FBSyxDQUFDLG9DQUFvQ0E7UUFDbEQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi91dGlscy92ZWN0b3ItdG9vbHMudHM/MjAyZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaHJvbWFNYW5hZ2VyIH0gZnJvbSAnLi4vZGIvY2hyb21hJztcblxuLyoqXG4gKiBUb29sIGZvciBzZWFyY2hpbmcgc2ltaWxhciBjb2RlIGV4YW1wbGVzIGZyb20gdmVjdG9yIHN0b3JlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hTaW1pbGFyQ29kZShxdWVyeTogc3RyaW5nLCBwcm9qZWN0SWQ6IHN0cmluZywgbWF4UmVzdWx0czogbnVtYmVyID0gNSk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coYPCflI0gU2VhcmNoaW5nIGZvciBzaW1pbGFyIGNvZGU6IFwiJHtxdWVyeX1cIiBpbiBwcm9qZWN0ICR7cHJvamVjdElkfWApO1xuXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGNocm9tYU1hbmFnZXIuc2VhcmNoQ29kZShwcm9qZWN0SWQsIHF1ZXJ5LCBtYXhSZXN1bHRzKTtcblxuICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuICdObyBzaW1pbGFyIGNvZGUgZXhhbXBsZXMgZm91bmQuJztcbiAgICB9XG5cbiAgICBjb25zdCBleGFtcGxlcyA9IHJlc3VsdHMubWFwKChyZXN1bHQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBmaWxlbmFtZSA9IHJlc3VsdC5tZXRhZGF0YS5maWxlbmFtZSB8fCAndW5rbm93bic7XG4gICAgICBjb25zdCBzY29yZSA9IE1hdGgucm91bmQocmVzdWx0LnNjb3JlICogMTAwKTtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSByZXN1bHQuY29udGVudC5sZW5ndGggPiAzMDBcbiAgICAgICAgPyByZXN1bHQuY29udGVudC5zdWJzdHJpbmcoMCwgMzAwKSArICcuLi4nXG4gICAgICAgIDogcmVzdWx0LmNvbnRlbnQ7XG5cbiAgICAgIHJldHVybiBgRXhhbXBsZSAke2luZGV4ICsgMX0gKCR7c2NvcmV9JSBtYXRjaCAtICR7ZmlsZW5hbWV9KTpcblxcYFxcYFxcYFxuJHtjb250ZW50fVxuXFxgXFxgXFxgYDtcbiAgICB9KS5qb2luKCdcXG5cXG4nKTtcblxuICAgIHJldHVybiBgRm91bmQgJHtyZXN1bHRzLmxlbmd0aH0gc2ltaWxhciBjb2RlIGV4YW1wbGVzOlxcblxcbiR7ZXhhbXBsZXN9YDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgVmVjdG9yIHNlYXJjaCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgIHJldHVybiAnRXJyb3Igc2VhcmNoaW5nIGZvciBzaW1pbGFyIGNvZGUgZXhhbXBsZXMuJztcbiAgfVxufVxuXG4vKipcbiAqIFRvb2wgZm9yIGdldHRpbmcgcHJvamVjdCBjb250ZXh0IGFuZCBzdHJ1Y3R1cmVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2plY3RDb250ZXh0KHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhg8J+TiiBHZXR0aW5nIHByb2plY3QgY29udGV4dCBmb3I6ICR7cHJvamVjdElkfWApO1xuXG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBjaHJvbWFNYW5hZ2VyLmdldFByb2plY3RTdGF0cyhwcm9qZWN0SWQpO1xuXG4gICAgaWYgKCFzdGF0cykge1xuICAgICAgcmV0dXJuICdObyBwcm9qZWN0IGNvbnRleHQgYXZhaWxhYmxlLic7XG4gICAgfVxuXG4gICAgcmV0dXJuIGBQcm9qZWN0IFN0YXRpc3RpY3M6XG4tIFRvdGFsIGNodW5rczogJHtzdGF0cy50b3RhbF9jaHVua3N9XG4tIENvZGUgY2h1bmtzOiAke3N0YXRzLmNvZGVfY2h1bmtzfVxuLSBTdHJ1Y3R1cmUgY2h1bmtzOiAke3N0YXRzLnN0cnVjdHVyZV9jaHVua3N9XG4tIFByb21wdCBjaHVua3M6ICR7c3RhdHMucHJvbXB0X2NodW5rc31cbi0gRGVwZW5kZW5jeSBjaHVua3M6ICR7c3RhdHMuZGVwZW5kZW5jeV9jaHVua3N9XG4tIENyZWF0ZWQ6ICR7c3RhdHMuY3JlYXRlZF9hdH1cbi0gTGFzdCB1cGRhdGVkOiAke3N0YXRzLmxhc3RfdXBkYXRlZH1gO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gZ2V0IHByb2plY3QgY29udGV4dDonLCBlcnJvcik7XG4gICAgcmV0dXJuICdFcnJvciByZXRyaWV2aW5nIHByb2plY3QgY29udGV4dC4nO1xuICB9XG59Il0sIm5hbWVzIjpbImNocm9tYU1hbmFnZXIiLCJzZWFyY2hTaW1pbGFyQ29kZSIsInF1ZXJ5IiwicHJvamVjdElkIiwibWF4UmVzdWx0cyIsImNvbnNvbGUiLCJsb2ciLCJyZXN1bHRzIiwic2VhcmNoQ29kZSIsImxlbmd0aCIsImV4YW1wbGVzIiwibWFwIiwicmVzdWx0IiwiaW5kZXgiLCJmaWxlbmFtZSIsIm1ldGFkYXRhIiwic2NvcmUiLCJNYXRoIiwicm91bmQiLCJjb250ZW50Iiwic3Vic3RyaW5nIiwiam9pbiIsImVycm9yIiwiZ2V0UHJvamVjdENvbnRleHQiLCJzdGF0cyIsImdldFByb2plY3RTdGF0cyIsInRvdGFsX2NodW5rcyIsImNvZGVfY2h1bmtzIiwic3RydWN0dXJlX2NodW5rcyIsInByb21wdF9jaHVua3MiLCJkZXBlbmRlbmN5X2NodW5rcyIsImNyZWF0ZWRfYXQiLCJsYXN0X3VwZGF0ZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/vector-tools.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/formdata-node@4.4.1","vendor-chunks/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_","vendor-chunks/openai@6.7.0_ws@8.18.3_zod@3.25.76","vendor-chunks/semver@7.7.3","vendor-chunks/@langchain+langgraph@1.0.1_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___r_79a741b742ae68db3a00eb54de512e24","vendor-chunks/@langchain+openai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___ws@8.18.3","vendor-chunks/zod@3.25.76","vendor-chunks/langsmith@0.3.74_openai@6.7.0_ws@8.18.3_zod@3.25.76_","vendor-chunks/groq-sdk@0.19.0","vendor-chunks/@langchain+langgraph-checkpoint@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__","vendor-chunks/uuid@10.0.0","vendor-chunks/form-data-encoder@1.7.2","vendor-chunks/@cfworker+json-schema@4.1.1","vendor-chunks/@langchain+google-genai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__","vendor-chunks/uuid@11.1.0","vendor-chunks/whatwg-url@5.0.0","vendor-chunks/agentkeepalive@4.6.0","vendor-chunks/retry@0.13.1","vendor-chunks/p-queue@6.6.2","vendor-chunks/js-tiktoken@1.0.21","vendor-chunks/@langchain+groq@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__","vendor-chunks/@langchain+community@1.0.0_@browserbasehq+sdk@2.6.0_@browserbasehq+stagehand@1.14.0_@pl_472eda21cf5c5c16bfc96c15f0b8aab9","vendor-chunks/tr46@0.0.3","vendor-chunks/web-streams-polyfill@4.0.0-beta.3","vendor-chunks/node-fetch@2.7.0","vendor-chunks/mustache@4.2.0","vendor-chunks/@google+generative-ai@0.24.1","vendor-chunks/webidl-conversions@3.0.1","vendor-chunks/p-timeout@3.2.0","vendor-chunks/p-retry@4.6.2","vendor-chunks/p-finally@1.0.0","vendor-chunks/ms@2.1.3","vendor-chunks/humanize-ms@1.2.1","vendor-chunks/eventemitter3@4.0.7","vendor-chunks/event-target-shim@5.0.1","vendor-chunks/decamelize@1.2.0","vendor-chunks/camelcase@6.3.0","vendor-chunks/base64-js@1.5.1","vendor-chunks/ansi-styles@5.2.0","vendor-chunks/abort-controller@3.0.0"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();