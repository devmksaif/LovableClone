"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:async_hooks":
/*!***********************************!*\
  !*** external "node:async_hooks" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:async_hooks");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_Apple_Desktop_NextLovable_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/Apple/Desktop/NextLovable/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_Apple_Desktop_NextLovable_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjVfQHBsYXl3cmlnaHQrdGVzdEAxLjU2LjFfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjFfX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRkFwcGxlJTJGRGVza3RvcCUyRk5leHRMb3ZhYmxlJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRkFwcGxlJTJGRGVza3RvcCUyRk5leHRMb3ZhYmxlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNNO0FBQ25GO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvP2ZkZmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL0FwcGxlL0Rlc2t0b3AvTmV4dExvdmFibGUvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9BcHBsZS9EZXNrdG9wL05leHRMb3ZhYmxlL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/agents/agent-core */ \"(rsc)/./lib/agents/agent-core.ts\");\n/* harmony import */ var _lib_agents_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/agents/utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _lib_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/utils/memory-db */ \"(rsc)/./lib/utils/memory-db.ts\");\n/* harmony import */ var _lib_db_database__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/db/database */ \"(rsc)/./lib/db/database.ts\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n// Store for ongoing streams\nconst activeStreams = new Map();\nasync function POST(request) {\n    const encoder = new TextEncoder();\n    const stream = new ReadableStream({\n        async start (controller) {\n            try {\n                const { userRequest, sessionId, model } = await request.json();\n                if (!userRequest) {\n                    controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                        error: \"userRequest is required\"\n                    })}\\n\\n`));\n                    controller.close();\n                    return;\n                }\n                if (sessionId) {\n                    activeStreams.set(sessionId, {\n                        controller,\n                        isComplete: false\n                    });\n                    // Set the emit function for this session\n                    (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.setEmitFunction)(emitStreamEvent);\n                }\n                console.log(\"\\uD83D\\uDE80 Starting agent generation for request:\", userRequest);\n                // Initialize session memory and create project folder\n                (0,_lib_agents_utils__WEBPACK_IMPORTED_MODULE_1__.setSessionMemory)(sessionId || \"default\");\n                const projectFolder = (0,_lib_agents_utils__WEBPACK_IMPORTED_MODULE_1__.getProjectFolder)();\n                // Ensure session exists in database before adding messages\n                await (0,_lib_db_database__WEBPACK_IMPORTED_MODULE_3__.getOrCreateSession)(sessionId || \"default\", projectFolder);\n                const memory = (0,_lib_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__.getSessionMemory)(sessionId || \"default\", projectFolder);\n                console.log(\"\\uD83D\\uDCC1 Project folder:\", projectFolder);\n                // Save user message to database\n                await (0,_lib_db_database__WEBPACK_IMPORTED_MODULE_3__.addConversation)(sessionId, \"user\", userRequest);\n                // Add user message to memory\n                await memory.addMessage(\"user\", userRequest);\n                // Get conversation context for the agent\n                const contextSummary = await memory.getContextSummary();\n                console.log(\"\\uD83D\\uDCAD Context from memory:\", contextSummary ? \"Available\" : \"None\");\n                // Create the streaming agent graph with context\n                const graph = (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.createStreamingLovableAgentGraph)(sessionId, model);\n                // Run the agent workflow with context\n                const result = await graph.invoke({\n                    userRequest: contextSummary ? `${contextSummary}\\n\\nNew request: ${userRequest}` : userRequest,\n                    messages: [\n                        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_4__.HumanMessage(contextSummary ? `${contextSummary}\\n\\n${userRequest}` : userRequest)\n                    ]\n                });\n                console.log(\"\\n✅ Generation complete!\");\n                // Extract chain of thought from messages\n                const chainOfThought = [];\n                result.messages.forEach((message, index)=>{\n                    if (message.content.toString().includes(\"Chain of Thought:\")) {\n                        const cotMatch = message.content.toString().match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Files:|FILENAME:|$)/i);\n                        if (cotMatch) {\n                            chainOfThought.push(`Step ${Math.floor(index / 2) + 1}: ${cotMatch[1].trim()}`);\n                        }\n                    }\n                });\n                // Save generated files and track in memory\n                if (Object.keys(result.generatedFiles).length > 0) {\n                    (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.saveGeneratedFiles)(result.generatedFiles);\n                    // Track file operations in memory\n                    for (const filename of Object.keys(result.generatedFiles)){\n                        await memory.addFileOperation(\"created\", path__WEBPACK_IMPORTED_MODULE_5__.join(projectFolder, filename));\n                    }\n                }\n                // Get tool call statistics\n                const toolStats = (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.getToolCallSummary)();\n                console.log(\"\\n\" + toolStats);\n                const response = {\n                    success: true,\n                    plan: result.plan,\n                    generatedFiles: Object.keys(result.generatedFiles),\n                    projectFolder: projectFolder,\n                    chainOfThought,\n                    reviewFeedback: result.reviewFeedback,\n                    isComplete: result.isComplete,\n                    toolStats: toolStats,\n                    type: \"complete\"\n                };\n                // Add AI response to memory (summarized)\n                const aiSummary = `Generated ${Object.keys(result.generatedFiles).length} files following ${result.plan?.length || 0} steps. ${result.reviewFeedback || \"\"}`;\n                // Save AI response to database\n                await (0,_lib_db_database__WEBPACK_IMPORTED_MODULE_3__.addConversation)(sessionId, \"assistant\", aiSummary);\n                await memory.addMessage(\"assistant\", aiSummary);\n                controller.enqueue(encoder.encode(`data: ${JSON.stringify(response)}\\n\\n`));\n                controller.close();\n                // Clear tool logs for next request\n                (0,_lib_agents_agent_core__WEBPACK_IMPORTED_MODULE_0__.clearToolCallLogs)();\n                if (sessionId) {\n                    const streamData = activeStreams.get(sessionId);\n                    if (streamData) {\n                        streamData.isComplete = true;\n                        activeStreams.delete(sessionId);\n                    }\n                }\n            } catch (error) {\n                console.error(\"Error:\", error);\n                controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                    error: \"Failed to process request\",\n                    details: error instanceof Error ? error.message : String(error),\n                    type: \"error\"\n                })}\\n\\n`));\n                controller.close();\n            }\n        }\n    });\n    return new Response(stream, {\n        headers: {\n            \"Content-Type\": \"text/event-stream\",\n            \"Cache-Control\": \"no-cache\",\n            \"Connection\": \"keep-alive\"\n        }\n    });\n}\n// Function to emit streaming events\nfunction emitStreamEvent(sessionId, data) {\n    const streamData = activeStreams.get(sessionId);\n    if (streamData && !streamData.isComplete) {\n        const encoder = new TextEncoder();\n        streamData.controller.enqueue(encoder.encode(`data: ${JSON.stringify(data)}\\n\\n`));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NoYXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFDOEo7QUFDL0U7QUFDZjtBQUNlO0FBQ3ZCO0FBQzNCO0FBRTdCLDRCQUE0QjtBQUM1QixNQUFNWSxnQkFBZ0IsSUFBSUM7QUFFbkIsZUFBZUMsS0FBS0MsT0FBb0I7SUFDN0MsTUFBTUMsVUFBVSxJQUFJQztJQUNwQixNQUFNQyxTQUFTLElBQUlDLGVBQWU7UUFDaEMsTUFBTUMsT0FBTUMsVUFBVTtZQUNwQixJQUFJO2dCQUNGLE1BQU0sRUFBRUMsV0FBVyxFQUFFQyxTQUFTLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1ULFFBQVFVLElBQUk7Z0JBRTVELElBQUksQ0FBQ0gsYUFBYTtvQkFDaEJELFdBQVdLLE9BQU8sQ0FBQ1YsUUFBUVcsTUFBTSxDQUFDLENBQUMsTUFBTSxFQUFFQyxLQUFLQyxTQUFTLENBQUM7d0JBQUVDLE9BQU87b0JBQTBCLEdBQUcsSUFBSSxDQUFDO29CQUNyR1QsV0FBV1UsS0FBSztvQkFDaEI7Z0JBQ0Y7Z0JBRUEsSUFBSVIsV0FBVztvQkFDYlgsY0FBY29CLEdBQUcsQ0FBQ1QsV0FBVzt3QkFBRUY7d0JBQVlZLFlBQVk7b0JBQU07b0JBQzdELHlDQUF5QztvQkFDekMvQix1RUFBZUEsQ0FBQ2dDO2dCQUNsQjtnQkFFQUMsUUFBUUMsR0FBRyxDQUFDLHVEQUE2Q2Q7Z0JBRXpELHNEQUFzRDtnQkFDdERqQixtRUFBZ0JBLENBQUNrQixhQUFhO2dCQUM5QixNQUFNYyxnQkFBZ0IvQixtRUFBZ0JBO2dCQUV0QywyREFBMkQ7Z0JBQzNELE1BQU1FLG9FQUFrQkEsQ0FBQ2UsYUFBYSxXQUFXYztnQkFFakQsTUFBTUMsU0FBUy9CLHNFQUFnQkEsQ0FBQ2dCLGFBQWEsV0FBV2M7Z0JBRXhERixRQUFRQyxHQUFHLENBQUMsZ0NBQXNCQztnQkFFbEMsZ0NBQWdDO2dCQUNoQyxNQUFNNUIsaUVBQWVBLENBQUNjLFdBQVcsUUFBUUQ7Z0JBRXpDLDZCQUE2QjtnQkFDN0IsTUFBTWdCLE9BQU9DLFVBQVUsQ0FBQyxRQUFRakI7Z0JBRWhDLHlDQUF5QztnQkFDekMsTUFBTWtCLGlCQUFpQixNQUFNRixPQUFPRyxpQkFBaUI7Z0JBRXJETixRQUFRQyxHQUFHLENBQUMscUNBQTJCSSxpQkFBaUIsY0FBYztnQkFFdEUsZ0RBQWdEO2dCQUNoRCxNQUFNRSxRQUFRMUMsd0ZBQWdDQSxDQUFDdUIsV0FBV0M7Z0JBRTFELHNDQUFzQztnQkFDdEMsTUFBTW1CLFNBQVMsTUFBTUQsTUFBTUUsTUFBTSxDQUFDO29CQUNoQ3RCLGFBQWFrQixpQkFBaUIsQ0FBQyxFQUFFQSxlQUFlLGlCQUFpQixFQUFFbEIsWUFBWSxDQUFDLEdBQUdBO29CQUNuRnVCLFVBQVU7d0JBQUMsSUFBSW5DLGtFQUFZQSxDQUFDOEIsaUJBQWlCLENBQUMsRUFBRUEsZUFBZSxJQUFJLEVBQUVsQixZQUFZLENBQUMsR0FBR0E7cUJBQWE7Z0JBQ3BHO2dCQUVBYSxRQUFRQyxHQUFHLENBQUM7Z0JBRVoseUNBQXlDO2dCQUN6QyxNQUFNVSxpQkFBMkIsRUFBRTtnQkFDbkNILE9BQU9FLFFBQVEsQ0FBQ0UsT0FBTyxDQUFDLENBQUNDLFNBQVNDO29CQUNoQyxJQUFJRCxRQUFRRSxPQUFPLENBQUNDLFFBQVEsR0FBR0MsUUFBUSxDQUFDLHNCQUFzQjt3QkFDNUQsTUFBTUMsV0FBV0wsUUFBUUUsT0FBTyxDQUFDQyxRQUFRLEdBQUdHLEtBQUssQ0FBQzt3QkFDbEQsSUFBSUQsVUFBVTs0QkFDWlAsZUFBZVMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFQyxLQUFLQyxLQUFLLENBQUNSLFFBQVEsS0FBSyxFQUFFLEVBQUUsRUFBRUksUUFBUSxDQUFDLEVBQUUsQ0FBQ0ssSUFBSSxHQUFHLENBQUM7d0JBQ2hGO29CQUNGO2dCQUNGO2dCQUVBLDJDQUEyQztnQkFDM0MsSUFBSUMsT0FBT0MsSUFBSSxDQUFDakIsT0FBT2tCLGNBQWMsRUFBRUMsTUFBTSxHQUFHLEdBQUc7b0JBQ2pEN0QsMEVBQWtCQSxDQUFDMEMsT0FBT2tCLGNBQWM7b0JBRXhDLGtDQUFrQztvQkFDbEMsS0FBSyxNQUFNRSxZQUFZSixPQUFPQyxJQUFJLENBQUNqQixPQUFPa0IsY0FBYyxFQUFHO3dCQUN6RCxNQUFNdkIsT0FBTzBCLGdCQUFnQixDQUFDLFdBQVdyRCxzQ0FBUyxDQUFDMEIsZUFBZTBCO29CQUNwRTtnQkFDRjtnQkFFQSwyQkFBMkI7Z0JBQzNCLE1BQU1HLFlBQVkvRCwwRUFBa0JBO2dCQUNwQ2dDLFFBQVFDLEdBQUcsQ0FBQyxPQUFPOEI7Z0JBRW5CLE1BQU1DLFdBQVc7b0JBQ2ZDLFNBQVM7b0JBQ1RDLE1BQU0xQixPQUFPMEIsSUFBSTtvQkFDakJSLGdCQUFnQkYsT0FBT0MsSUFBSSxDQUFDakIsT0FBT2tCLGNBQWM7b0JBQ2pEeEIsZUFBZUE7b0JBQ2ZTO29CQUNBd0IsZ0JBQWdCM0IsT0FBTzJCLGNBQWM7b0JBQ3JDckMsWUFBWVUsT0FBT1YsVUFBVTtvQkFDN0JpQyxXQUFXQTtvQkFDWEssTUFBTTtnQkFDUjtnQkFFQSx5Q0FBeUM7Z0JBQ3pDLE1BQU1DLFlBQVksQ0FBQyxVQUFVLEVBQUViLE9BQU9DLElBQUksQ0FBQ2pCLE9BQU9rQixjQUFjLEVBQUVDLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRW5CLE9BQU8wQixJQUFJLEVBQUVQLFVBQVUsRUFBRSxRQUFRLEVBQUVuQixPQUFPMkIsY0FBYyxJQUFJLEdBQUcsQ0FBQztnQkFFNUosK0JBQStCO2dCQUMvQixNQUFNN0QsaUVBQWVBLENBQUNjLFdBQVcsYUFBYWlEO2dCQUU5QyxNQUFNbEMsT0FBT0MsVUFBVSxDQUFDLGFBQWFpQztnQkFFckNuRCxXQUFXSyxPQUFPLENBQUNWLFFBQVFXLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRUMsS0FBS0MsU0FBUyxDQUFDc0MsVUFBVSxJQUFJLENBQUM7Z0JBQ3pFOUMsV0FBV1UsS0FBSztnQkFFaEIsbUNBQW1DO2dCQUNuQzNCLHlFQUFpQkE7Z0JBRWpCLElBQUltQixXQUFXO29CQUNiLE1BQU1rRCxhQUFhN0QsY0FBYzhELEdBQUcsQ0FBQ25EO29CQUNyQyxJQUFJa0QsWUFBWTt3QkFDZEEsV0FBV3hDLFVBQVUsR0FBRzt3QkFDeEJyQixjQUFjK0QsTUFBTSxDQUFDcEQ7b0JBQ3ZCO2dCQUNGO1lBRUYsRUFBRSxPQUFPTyxPQUFPO2dCQUNkSyxRQUFRTCxLQUFLLENBQUMsVUFBVUE7Z0JBQ3hCVCxXQUFXSyxPQUFPLENBQUNWLFFBQVFXLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRUMsS0FBS0MsU0FBUyxDQUFDO29CQUN4REMsT0FBTztvQkFDUDhDLFNBQVM5QyxpQkFBaUIrQyxRQUFRL0MsTUFBTWtCLE9BQU8sR0FBRzhCLE9BQU9oRDtvQkFDekR5QyxNQUFNO2dCQUNSLEdBQUcsSUFBSSxDQUFDO2dCQUNSbEQsV0FBV1UsS0FBSztZQUNsQjtRQUNGO0lBQ0Y7SUFFQSxPQUFPLElBQUlnRCxTQUFTN0QsUUFBUTtRQUMxQjhELFNBQVM7WUFDUCxnQkFBZ0I7WUFDaEIsaUJBQWlCO1lBQ2pCLGNBQWM7UUFDaEI7SUFDRjtBQUNGO0FBRUEsb0NBQW9DO0FBQ3BDLFNBQVM5QyxnQkFBZ0JYLFNBQWlCLEVBQUUwRCxJQUFTO0lBQ25ELE1BQU1SLGFBQWE3RCxjQUFjOEQsR0FBRyxDQUFDbkQ7SUFDckMsSUFBSWtELGNBQWMsQ0FBQ0EsV0FBV3hDLFVBQVUsRUFBRTtRQUN4QyxNQUFNakIsVUFBVSxJQUFJQztRQUNwQndELFdBQVdwRCxVQUFVLENBQUNLLE9BQU8sQ0FBQ1YsUUFBUVcsTUFBTSxDQUFDLENBQUMsTUFBTSxFQUFFQyxLQUFLQyxTQUFTLENBQUNvRCxNQUFNLElBQUksQ0FBQztJQUNsRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvLi9hcHAvYXBpL2NoYXQvcm91dGUudHM/ZGU0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgY3JlYXRlU3RyZWFtaW5nTG92YWJsZUFnZW50R3JhcGgsIHNhdmVHZW5lcmF0ZWRGaWxlcywgc2V0RW1pdEZ1bmN0aW9uLCBnZXRUb29sQ2FsbFN1bW1hcnksIGNsZWFyVG9vbENhbGxMb2dzIH0gZnJvbSAnLi4vLi4vLi4vbGliL2FnZW50cy9hZ2VudC1jb3JlJztcbmltcG9ydCB7IHNldFNlc3Npb25NZW1vcnksIGdldFByb2plY3RGb2xkZXIgfSBmcm9tICcuLi8uLi8uLi9saWIvYWdlbnRzL3V0aWxzJztcbmltcG9ydCB7IGdldFNlc3Npb25NZW1vcnkgfSBmcm9tICcuLi8uLi8uLi9saWIvdXRpbHMvbWVtb3J5LWRiJztcbmltcG9ydCB7IGdldE9yQ3JlYXRlU2Vzc2lvbiwgYWRkQ29udmVyc2F0aW9uIH0gZnJvbSAnLi4vLi4vLi4vbGliL2RiL2RhdGFiYXNlJztcbmltcG9ydCB7IEh1bWFuTWVzc2FnZSB9IGZyb20gJ0BsYW5nY2hhaW4vY29yZS9tZXNzYWdlcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG4vLyBTdG9yZSBmb3Igb25nb2luZyBzdHJlYW1zXG5jb25zdCBhY3RpdmVTdHJlYW1zID0gbmV3IE1hcCgpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgYXN5bmMgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyB1c2VyUmVxdWVzdCwgc2Vzc2lvbklkLCBtb2RlbCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICAgICAgaWYgKCF1c2VyUmVxdWVzdCkge1xuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAndXNlclJlcXVlc3QgaXMgcmVxdWlyZWQnIH0pfVxcblxcbmApKTtcbiAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgICAgIGFjdGl2ZVN0cmVhbXMuc2V0KHNlc3Npb25JZCwgeyBjb250cm9sbGVyLCBpc0NvbXBsZXRlOiBmYWxzZSB9KTtcbiAgICAgICAgICAvLyBTZXQgdGhlIGVtaXQgZnVuY3Rpb24gZm9yIHRoaXMgc2Vzc2lvblxuICAgICAgICAgIHNldEVtaXRGdW5jdGlvbihlbWl0U3RyZWFtRXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ/CfmoAgU3RhcnRpbmcgYWdlbnQgZ2VuZXJhdGlvbiBmb3IgcmVxdWVzdDonLCB1c2VyUmVxdWVzdCk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBzZXNzaW9uIG1lbW9yeSBhbmQgY3JlYXRlIHByb2plY3QgZm9sZGVyXG4gICAgICAgIHNldFNlc3Npb25NZW1vcnkoc2Vzc2lvbklkIHx8ICdkZWZhdWx0Jyk7XG4gICAgICAgIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBFbnN1cmUgc2Vzc2lvbiBleGlzdHMgaW4gZGF0YWJhc2UgYmVmb3JlIGFkZGluZyBtZXNzYWdlc1xuICAgICAgICBhd2FpdCBnZXRPckNyZWF0ZVNlc3Npb24oc2Vzc2lvbklkIHx8ICdkZWZhdWx0JywgcHJvamVjdEZvbGRlcik7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KHNlc3Npb25JZCB8fCAnZGVmYXVsdCcsIHByb2plY3RGb2xkZXIpO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4EgUHJvamVjdCBmb2xkZXI6JywgcHJvamVjdEZvbGRlcik7XG5cbiAgICAgICAgLy8gU2F2ZSB1c2VyIG1lc3NhZ2UgdG8gZGF0YWJhc2VcbiAgICAgICAgYXdhaXQgYWRkQ29udmVyc2F0aW9uKHNlc3Npb25JZCwgJ3VzZXInLCB1c2VyUmVxdWVzdCk7XG5cbiAgICAgICAgLy8gQWRkIHVzZXIgbWVzc2FnZSB0byBtZW1vcnlcbiAgICAgICAgYXdhaXQgbWVtb3J5LmFkZE1lc3NhZ2UoJ3VzZXInLCB1c2VyUmVxdWVzdCk7XG5cbiAgICAgICAgLy8gR2V0IGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciB0aGUgYWdlbnRcbiAgICAgICAgY29uc3QgY29udGV4dFN1bW1hcnkgPSBhd2FpdCBtZW1vcnkuZ2V0Q29udGV4dFN1bW1hcnkoKTtcblxuICAgICAgICBjb25zb2xlLmxvZygn8J+SrSBDb250ZXh0IGZyb20gbWVtb3J5OicsIGNvbnRleHRTdW1tYXJ5ID8gJ0F2YWlsYWJsZScgOiAnTm9uZScpO1xuXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgc3RyZWFtaW5nIGFnZW50IGdyYXBoIHdpdGggY29udGV4dFxuICAgICAgICBjb25zdCBncmFwaCA9IGNyZWF0ZVN0cmVhbWluZ0xvdmFibGVBZ2VudEdyYXBoKHNlc3Npb25JZCwgbW9kZWwpO1xuXG4gICAgICAgIC8vIFJ1biB0aGUgYWdlbnQgd29ya2Zsb3cgd2l0aCBjb250ZXh0XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdyYXBoLmludm9rZSh7XG4gICAgICAgICAgdXNlclJlcXVlc3Q6IGNvbnRleHRTdW1tYXJ5ID8gYCR7Y29udGV4dFN1bW1hcnl9XFxuXFxuTmV3IHJlcXVlc3Q6ICR7dXNlclJlcXVlc3R9YCA6IHVzZXJSZXF1ZXN0LFxuICAgICAgICAgIG1lc3NhZ2VzOiBbbmV3IEh1bWFuTWVzc2FnZShjb250ZXh0U3VtbWFyeSA/IGAke2NvbnRleHRTdW1tYXJ5fVxcblxcbiR7dXNlclJlcXVlc3R9YCA6IHVzZXJSZXF1ZXN0KV0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdcXG7inIUgR2VuZXJhdGlvbiBjb21wbGV0ZSEnKTtcblxuICAgICAgICAvLyBFeHRyYWN0IGNoYWluIG9mIHRob3VnaHQgZnJvbSBtZXNzYWdlc1xuICAgICAgICBjb25zdCBjaGFpbk9mVGhvdWdodDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgcmVzdWx0Lm1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKG1lc3NhZ2UuY29udGVudC50b1N0cmluZygpLmluY2x1ZGVzKCdDaGFpbiBvZiBUaG91Z2h0OicpKSB7XG4gICAgICAgICAgICBjb25zdCBjb3RNYXRjaCA9IG1lc3NhZ2UuY29udGVudC50b1N0cmluZygpLm1hdGNoKC9DaGFpbiBvZiBUaG91Z2h0OlxccyooW1xcc1xcU10qPykoPz1GaWxlczp8RklMRU5BTUU6fCQpL2kpO1xuICAgICAgICAgICAgaWYgKGNvdE1hdGNoKSB7XG4gICAgICAgICAgICAgIGNoYWluT2ZUaG91Z2h0LnB1c2goYFN0ZXAgJHtNYXRoLmZsb29yKGluZGV4IC8gMikgKyAxfTogJHtjb3RNYXRjaFsxXS50cmltKCl9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTYXZlIGdlbmVyYXRlZCBmaWxlcyBhbmQgdHJhY2sgaW4gbWVtb3J5XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhyZXN1bHQuZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzYXZlR2VuZXJhdGVkRmlsZXMocmVzdWx0LmdlbmVyYXRlZEZpbGVzKTtcblxuICAgICAgICAgIC8vIFRyYWNrIGZpbGUgb3BlcmF0aW9ucyBpbiBtZW1vcnlcbiAgICAgICAgICBmb3IgKGNvbnN0IGZpbGVuYW1lIG9mIE9iamVjdC5rZXlzKHJlc3VsdC5nZW5lcmF0ZWRGaWxlcykpIHtcbiAgICAgICAgICAgIGF3YWl0IG1lbW9yeS5hZGRGaWxlT3BlcmF0aW9uKCdjcmVhdGVkJywgcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVuYW1lKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IHRvb2wgY2FsbCBzdGF0aXN0aWNzXG4gICAgICAgIGNvbnN0IHRvb2xTdGF0cyA9IGdldFRvb2xDYWxsU3VtbWFyeSgpO1xuICAgICAgICBjb25zb2xlLmxvZygnXFxuJyArIHRvb2xTdGF0cyk7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBwbGFuOiByZXN1bHQucGxhbixcbiAgICAgICAgICBnZW5lcmF0ZWRGaWxlczogT2JqZWN0LmtleXMocmVzdWx0LmdlbmVyYXRlZEZpbGVzKSxcbiAgICAgICAgICBwcm9qZWN0Rm9sZGVyOiBwcm9qZWN0Rm9sZGVyLFxuICAgICAgICAgIGNoYWluT2ZUaG91Z2h0LFxuICAgICAgICAgIHJldmlld0ZlZWRiYWNrOiByZXN1bHQucmV2aWV3RmVlZGJhY2ssXG4gICAgICAgICAgaXNDb21wbGV0ZTogcmVzdWx0LmlzQ29tcGxldGUsXG4gICAgICAgICAgdG9vbFN0YXRzOiB0b29sU3RhdHMsXG4gICAgICAgICAgdHlwZTogJ2NvbXBsZXRlJ1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFkZCBBSSByZXNwb25zZSB0byBtZW1vcnkgKHN1bW1hcml6ZWQpXG4gICAgICAgIGNvbnN0IGFpU3VtbWFyeSA9IGBHZW5lcmF0ZWQgJHtPYmplY3Qua2V5cyhyZXN1bHQuZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aH0gZmlsZXMgZm9sbG93aW5nICR7cmVzdWx0LnBsYW4/Lmxlbmd0aCB8fCAwfSBzdGVwcy4gJHtyZXN1bHQucmV2aWV3RmVlZGJhY2sgfHwgJyd9YDtcblxuICAgICAgICAvLyBTYXZlIEFJIHJlc3BvbnNlIHRvIGRhdGFiYXNlXG4gICAgICAgIGF3YWl0IGFkZENvbnZlcnNhdGlvbihzZXNzaW9uSWQsICdhc3Npc3RhbnQnLCBhaVN1bW1hcnkpO1xuXG4gICAgICAgIGF3YWl0IG1lbW9yeS5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCBhaVN1bW1hcnkpO1xuXG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeShyZXNwb25zZSl9XFxuXFxuYCkpO1xuICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhciB0b29sIGxvZ3MgZm9yIG5leHQgcmVxdWVzdFxuICAgICAgICBjbGVhclRvb2xDYWxsTG9ncygpO1xuXG4gICAgICAgIGlmIChzZXNzaW9uSWQpIHtcbiAgICAgICAgICBjb25zdCBzdHJlYW1EYXRhID0gYWN0aXZlU3RyZWFtcy5nZXQoc2Vzc2lvbklkKTtcbiAgICAgICAgICBpZiAoc3RyZWFtRGF0YSkge1xuICAgICAgICAgICAgc3RyZWFtRGF0YS5pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIGFjdGl2ZVN0cmVhbXMuZGVsZXRlKHNlc3Npb25JZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKTtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBwcm9jZXNzIHJlcXVlc3QnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICAgICAgICB0eXBlOiAnZXJyb3InXG4gICAgICAgIH0pfVxcblxcbmApKTtcbiAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShzdHJlYW0sIHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvZXZlbnQtc3RyZWFtJyxcbiAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlJyxcbiAgICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLFxuICAgIH0sXG4gIH0pO1xufVxuXG4vLyBGdW5jdGlvbiB0byBlbWl0IHN0cmVhbWluZyBldmVudHNcbmZ1bmN0aW9uIGVtaXRTdHJlYW1FdmVudChzZXNzaW9uSWQ6IHN0cmluZywgZGF0YTogYW55KSB7XG4gIGNvbnN0IHN0cmVhbURhdGEgPSBhY3RpdmVTdHJlYW1zLmdldChzZXNzaW9uSWQpO1xuICBpZiAoc3RyZWFtRGF0YSAmJiAhc3RyZWFtRGF0YS5pc0NvbXBsZXRlKSB7XG4gICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgIHN0cmVhbURhdGEuY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KGRhdGEpfVxcblxcbmApKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVN0cmVhbWluZ0xvdmFibGVBZ2VudEdyYXBoIiwic2F2ZUdlbmVyYXRlZEZpbGVzIiwic2V0RW1pdEZ1bmN0aW9uIiwiZ2V0VG9vbENhbGxTdW1tYXJ5IiwiY2xlYXJUb29sQ2FsbExvZ3MiLCJzZXRTZXNzaW9uTWVtb3J5IiwiZ2V0UHJvamVjdEZvbGRlciIsImdldFNlc3Npb25NZW1vcnkiLCJnZXRPckNyZWF0ZVNlc3Npb24iLCJhZGRDb252ZXJzYXRpb24iLCJIdW1hbk1lc3NhZ2UiLCJwYXRoIiwiYWN0aXZlU3RyZWFtcyIsIk1hcCIsIlBPU1QiLCJyZXF1ZXN0IiwiZW5jb2RlciIsIlRleHRFbmNvZGVyIiwic3RyZWFtIiwiUmVhZGFibGVTdHJlYW0iLCJzdGFydCIsImNvbnRyb2xsZXIiLCJ1c2VyUmVxdWVzdCIsInNlc3Npb25JZCIsIm1vZGVsIiwianNvbiIsImVucXVldWUiLCJlbmNvZGUiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJjbG9zZSIsInNldCIsImlzQ29tcGxldGUiLCJlbWl0U3RyZWFtRXZlbnQiLCJjb25zb2xlIiwibG9nIiwicHJvamVjdEZvbGRlciIsIm1lbW9yeSIsImFkZE1lc3NhZ2UiLCJjb250ZXh0U3VtbWFyeSIsImdldENvbnRleHRTdW1tYXJ5IiwiZ3JhcGgiLCJyZXN1bHQiLCJpbnZva2UiLCJtZXNzYWdlcyIsImNoYWluT2ZUaG91Z2h0IiwiZm9yRWFjaCIsIm1lc3NhZ2UiLCJpbmRleCIsImNvbnRlbnQiLCJ0b1N0cmluZyIsImluY2x1ZGVzIiwiY290TWF0Y2giLCJtYXRjaCIsInB1c2giLCJNYXRoIiwiZmxvb3IiLCJ0cmltIiwiT2JqZWN0Iiwia2V5cyIsImdlbmVyYXRlZEZpbGVzIiwibGVuZ3RoIiwiZmlsZW5hbWUiLCJhZGRGaWxlT3BlcmF0aW9uIiwiam9pbiIsInRvb2xTdGF0cyIsInJlc3BvbnNlIiwic3VjY2VzcyIsInBsYW4iLCJyZXZpZXdGZWVkYmFjayIsInR5cGUiLCJhaVN1bW1hcnkiLCJzdHJlYW1EYXRhIiwiZ2V0IiwiZGVsZXRlIiwiZGV0YWlscyIsIkVycm9yIiwiU3RyaW5nIiwiUmVzcG9uc2UiLCJoZWFkZXJzIiwiZGF0YSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/agent-core.ts":
/*!**********************************!*\
  !*** ./lib/agents/agent-core.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearToolCallLogs: () => (/* binding */ clearToolCallLogs),\n/* harmony export */   createLovableAgentGraph: () => (/* binding */ createLovableAgentGraph),\n/* harmony export */   createStreamingLovableAgentGraph: () => (/* binding */ createStreamingLovableAgentGraph),\n/* harmony export */   getMemoryStats: () => (/* binding */ getMemoryStats),\n/* harmony export */   getToolCallStats: () => (/* binding */ getToolCallStats),\n/* harmony export */   getToolCallSummary: () => (/* binding */ getToolCallSummary),\n/* harmony export */   saveGeneratedFiles: () => (/* binding */ saveGeneratedFiles),\n/* harmony export */   setEmitFunction: () => (/* binding */ setEmitFunction)\n/* harmony export */ });\n/* harmony import */ var _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/langgraph */ \"(rsc)/./node_modules/.pnpm/@langchain+langgraph@1.0.1_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___r_79a741b742ae68db3a00eb54de512e24/node_modules/@langchain/langgraph/dist/index.js\");\n/* harmony import */ var _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/tool-logger */ \"(rsc)/./lib/utils/tool-logger.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _streaming_agents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./streaming-agents */ \"(rsc)/./lib/agents/streaming-agents.ts\");\n/* harmony import */ var _agents__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./agents */ \"(rsc)/./lib/agents/agents.ts\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n// Import the emit function from the API route\nlet emitEvent = ()=>{};\nfunction setEmitFunction(fn) {\n    emitEvent = fn;\n}\n// Define the state schema for our Lovable-like agent\nconst AgentState = _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation.Root({\n    messages: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (current, update)=>[\n                ...current,\n                ...update\n            ],\n        default: ()=>[]\n    }),\n    userRequest: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>\"\"\n    }),\n    plan: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>[]\n    }),\n    generatedFiles: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (current, update)=>({\n                ...current,\n                ...update\n            }),\n        default: ()=>({})\n    }),\n    currentIteration: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>0\n    }),\n    reviewFeedback: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>\"\"\n    }),\n    isComplete: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>false\n    }),\n    reviewIterations: (0,_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.Annotation)({\n        reducer: (_, update)=>update,\n        default: ()=>0\n    })\n});\n// Streaming agent graph\nfunction createStreamingLovableAgentGraph(sessionId, model) {\n    // Update LLM if a specific model is requested\n    if (model) {\n        const { createLLM } = __webpack_require__(/*! ./model-providers */ \"(rsc)/./lib/agents/model-providers.ts\");\n        const { llm: newLlm } = __webpack_require__(/*! ./model-providers */ \"(rsc)/./lib/agents/model-providers.ts\");\n    // This is a bit of a hack - we need to update the module-level llm\n    // In a real refactor, we'd pass llm as a parameter\n    }\n    const workflow = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateGraph(AgentState).addNode(\"planner\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingPlannerAgent)(state, sessionId, model)).addNode(\"generator\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingCodeGeneratorAgent)(state, sessionId, model)).addNode(\"reviewer\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingReviewerAgent)(state, sessionId, model)).addNode(\"fix_issues\", (state)=>(0,_streaming_agents__WEBPACK_IMPORTED_MODULE_3__.streamingFixerAgent)(state, sessionId, model)).addEdge(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.START, \"planner\").addConditionalEdges(\"planner\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        planner: \"planner\",\n        generator: \"generator\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"generator\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        generator: \"generator\",\n        reviewer: \"reviewer\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"reviewer\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        fix_issues: \"fix_issues\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"fix_issues\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        reviewer: \"reviewer\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    });\n    return workflow.compile();\n}\n// Non-streaming agent graph\nfunction createLovableAgentGraph(sessionId, model) {\n    const workflow = new _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.StateGraph(AgentState).addNode(\"planner\", (state)=>(0,_agents__WEBPACK_IMPORTED_MODULE_4__.plannerAgent)(state, sessionId, model)).addNode(\"generator\", (state)=>(0,_agents__WEBPACK_IMPORTED_MODULE_4__.codeGeneratorAgent)(state, sessionId, model)).addNode(\"reviewer\", (state)=>(0,_agents__WEBPACK_IMPORTED_MODULE_4__.reviewerAgent)(state, sessionId, model)).addEdge(_langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.START, \"planner\").addConditionalEdges(\"planner\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        generator: \"generator\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"generator\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        generator: \"generator\",\n        reviewer: \"reviewer\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    }).addConditionalEdges(\"reviewer\", _streaming_agents__WEBPACK_IMPORTED_MODULE_3__.shouldContinue, {\n        generator: \"generator\",\n        end: _langchain_langgraph__WEBPACK_IMPORTED_MODULE_0__.END\n    });\n    return workflow.compile();\n}\n// Helper function to save generated files to disk\nfunction saveGeneratedFiles(files, outputDir) {\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getMemory)();\n    // Use project folder if no output directory specified\n    const targetDir = outputDir || (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getProjectFolder)();\n    if (!fs__WEBPACK_IMPORTED_MODULE_5__.existsSync(targetDir)) {\n        fs__WEBPACK_IMPORTED_MODULE_5__.mkdirSync(targetDir, {\n            recursive: true\n        });\n    }\n    const savedFiles = [];\n    for (const [filename, content] of Object.entries(files)){\n        const fullPath = path__WEBPACK_IMPORTED_MODULE_6__.join(targetDir, filename);\n        const dir = path__WEBPACK_IMPORTED_MODULE_6__.dirname(fullPath);\n        if (!fs__WEBPACK_IMPORTED_MODULE_5__.existsSync(dir)) {\n            fs__WEBPACK_IMPORTED_MODULE_5__.mkdirSync(dir, {\n                recursive: true\n            });\n        }\n        const exists = fs__WEBPACK_IMPORTED_MODULE_5__.existsSync(fullPath);\n        fs__WEBPACK_IMPORTED_MODULE_5__.writeFileSync(fullPath, content, \"utf-8\");\n        // Track in memory\n        memory.addFileOperation(exists ? \"modified\" : \"created\", fullPath);\n        savedFiles.push(fullPath);\n    }\n    return savedFiles;\n}\n// Export tool logger statistics\nfunction getToolCallStats() {\n    return _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__.toolLogger.getStats();\n}\nfunction getToolCallSummary() {\n    return _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__.toolLogger.getSummary();\n}\nfunction clearToolCallLogs() {\n    _utils_tool_logger__WEBPACK_IMPORTED_MODULE_1__.toolLogger.clear();\n}\n// Get memory statistics for debugging/monitoring\nasync function getMemoryStats() {\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_2__.getMemory)();\n    const messages = await memory.getMessages();\n    const fileOps = await memory.getRecentFileOperations();\n    const sessionFiles = await memory.getSessionFiles();\n    return {\n        tokenEstimate: await memory.getTokenEstimate(),\n        messageCount: messages.length,\n        fileOperationCount: fileOps.length,\n        sessionFiles: sessionFiles\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPQyxPQUFPLENBQUNYLE9BQVE7UUFDdkQsTUFBTVksV0FBV25ELHNDQUFTLENBQUMwQyxXQUFXSztRQUN0QyxNQUFNTSxNQUFNckQseUNBQVksQ0FBQ21EO1FBRXpCLElBQUksQ0FBQ3BELDBDQUFhLENBQUNzRCxNQUFNO1lBQ3ZCdEQseUNBQVksQ0FBQ3NELEtBQUs7Z0JBQUVSLFdBQVc7WUFBSztRQUN0QztRQUVBLE1BQU1VLFNBQVN4RCwwQ0FBYSxDQUFDb0Q7UUFDN0JwRCw2Q0FBZ0IsQ0FBQ29ELFVBQVVILFNBQVM7UUFFcEMsa0JBQWtCO1FBQ2xCUCxPQUFPZ0IsZ0JBQWdCLENBQUNGLFNBQVMsYUFBYSxXQUFXSjtRQUV6REwsV0FBV1ksSUFBSSxDQUFDUDtJQUNsQjtJQUVBLE9BQU9MO0FBQ1Q7QUFFQSxnQ0FBZ0M7QUFDekIsU0FBU2E7SUFDZCxPQUFPdkUsMERBQVVBLENBQUN3RSxRQUFRO0FBQzVCO0FBRU8sU0FBU0M7SUFDZCxPQUFPekUsMERBQVVBLENBQUMwRSxVQUFVO0FBQzlCO0FBRU8sU0FBU0M7SUFDZDNFLDBEQUFVQSxDQUFDNEUsS0FBSztBQUNsQjtBQUVBLGlEQUFpRDtBQUMxQyxlQUFlQztJQUNwQixNQUFNeEIsU0FBU3BELGlEQUFTQTtJQUN4QixNQUFNaUIsV0FBVyxNQUFNbUMsT0FBT3lCLFdBQVc7SUFDekMsTUFBTUMsVUFBVSxNQUFNMUIsT0FBTzJCLHVCQUF1QjtJQUNwRCxNQUFNQyxlQUFlLE1BQU01QixPQUFPNkIsZUFBZTtJQUVqRCxPQUFPO1FBQ0xDLGVBQWUsTUFBTTlCLE9BQU8rQixnQkFBZ0I7UUFDNUNDLGNBQWNuRSxTQUFTb0UsTUFBTTtRQUM3QkMsb0JBQW9CUixRQUFRTyxNQUFNO1FBQ2xDTCxjQUFjQTtJQUNoQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvLi9saWIvYWdlbnRzL2FnZW50LWNvcmUudHM/ODI5YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTdGF0ZUdyYXBoLCBFTkQsIFNUQVJULCBBbm5vdGF0aW9uIH0gZnJvbSAnQGxhbmdjaGFpbi9sYW5nZ3JhcGgnO1xuaW1wb3J0IHsgQmFzZU1lc3NhZ2UsIEh1bWFuTWVzc2FnZSwgQUlNZXNzYWdlLCBTeXN0ZW1NZXNzYWdlIH0gZnJvbSAnQGxhbmdjaGFpbi9jb3JlL21lc3NhZ2VzJztcbmltcG9ydCB7IHRvb2xMb2dnZXIgfSBmcm9tICcuLi91dGlscy90b29sLWxvZ2dlcic7XG5pbXBvcnQgeyBwcm9tcHRPcHRpbWl6ZXIgfSBmcm9tICcuLi91dGlscy9wcm9tcHQtb3B0aW1pemVyJztcbmltcG9ydCB7IGNvbXByZXNzQ29udGV4dCwgc3VtbWFyaXplRmlsZUNvbnRlbnRzLCBlc3RpbWF0ZVRva2Vucywgc2hvdWxkQ29tcHJlc3MsIHNtYXJ0VHJ1bmNhdGUgfSBmcm9tICcuLi91dGlscy9zdW1tYXJpemVyJztcbmltcG9ydCB7IGdldE1lbW9yeSwgZ2V0UHJvamVjdEZvbGRlciB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgbGxtIH0gZnJvbSAnLi9tb2RlbC1wcm92aWRlcnMnO1xuaW1wb3J0IHsgdG9vbHMsIHdyYXBUb29sV2l0aExvZ2dpbmcgfSBmcm9tICcuL3Rvb2xzJztcbmltcG9ydCB7IHN0cmVhbWluZ1BsYW5uZXJBZ2VudCwgc3RyZWFtaW5nQ29kZUdlbmVyYXRvckFnZW50LCBzdHJlYW1pbmdSZXZpZXdlckFnZW50LCBzdHJlYW1pbmdGaXhlckFnZW50LCBzaG91bGRDb250aW51ZSB9IGZyb20gJy4vc3RyZWFtaW5nLWFnZW50cyc7XG5pbXBvcnQgeyBwbGFubmVyQWdlbnQsIGNvZGVHZW5lcmF0b3JBZ2VudCwgcmV2aWV3ZXJBZ2VudCB9IGZyb20gJy4vYWdlbnRzJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbi8vIEltcG9ydCB0aGUgZW1pdCBmdW5jdGlvbiBmcm9tIHRoZSBBUEkgcm91dGVcbmxldCBlbWl0RXZlbnQ6IChzZXNzaW9uSWQ6IHN0cmluZywgZGF0YTogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XG5leHBvcnQgZnVuY3Rpb24gc2V0RW1pdEZ1bmN0aW9uKGZuOiAoc2Vzc2lvbklkOiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdm9pZCkge1xuICBlbWl0RXZlbnQgPSBmbjtcbn1cblxuLy8gRGVmaW5lIHRoZSBzdGF0ZSBzY2hlbWEgZm9yIG91ciBMb3ZhYmxlLWxpa2UgYWdlbnRcbmNvbnN0IEFnZW50U3RhdGUgPSBBbm5vdGF0aW9uLlJvb3Qoe1xuICBtZXNzYWdlczogQW5ub3RhdGlvbjxCYXNlTWVzc2FnZVtdPih7XG4gICAgcmVkdWNlcjogKGN1cnJlbnQsIHVwZGF0ZSkgPT4gWy4uLmN1cnJlbnQsIC4uLnVwZGF0ZV0sXG4gICAgZGVmYXVsdDogKCkgPT4gW10sXG4gIH0pLFxuICB1c2VyUmVxdWVzdDogQW5ub3RhdGlvbjxzdHJpbmc+KHtcbiAgICByZWR1Y2VyOiAoXywgdXBkYXRlKSA9PiB1cGRhdGUsXG4gICAgZGVmYXVsdDogKCkgPT4gJycsXG4gIH0pLFxuICBwbGFuOiBBbm5vdGF0aW9uPHN0cmluZ1tdPih7XG4gICAgcmVkdWNlcjogKF8sIHVwZGF0ZSkgPT4gdXBkYXRlLFxuICAgIGRlZmF1bHQ6ICgpID0+IFtdLFxuICB9KSxcbiAgZ2VuZXJhdGVkRmlsZXM6IEFubm90YXRpb248UmVjb3JkPHN0cmluZywgc3RyaW5nPj4oe1xuICAgIHJlZHVjZXI6IChjdXJyZW50LCB1cGRhdGUpID0+ICh7IC4uLmN1cnJlbnQsIC4uLnVwZGF0ZSB9KSxcbiAgICBkZWZhdWx0OiAoKSA9PiAoe30pLFxuICB9KSxcbiAgY3VycmVudEl0ZXJhdGlvbjogQW5ub3RhdGlvbjxudW1iZXI+KHtcbiAgICByZWR1Y2VyOiAoXywgdXBkYXRlKSA9PiB1cGRhdGUsXG4gICAgZGVmYXVsdDogKCkgPT4gMCxcbiAgfSksXG4gIHJldmlld0ZlZWRiYWNrOiBBbm5vdGF0aW9uPHN0cmluZz4oe1xuICAgIHJlZHVjZXI6IChfLCB1cGRhdGUpID0+IHVwZGF0ZSxcbiAgICBkZWZhdWx0OiAoKSA9PiAnJyxcbiAgfSksXG4gIGlzQ29tcGxldGU6IEFubm90YXRpb248Ym9vbGVhbj4oe1xuICAgIHJlZHVjZXI6IChfLCB1cGRhdGUpID0+IHVwZGF0ZSxcbiAgICBkZWZhdWx0OiAoKSA9PiBmYWxzZSxcbiAgfSksXG4gIHJldmlld0l0ZXJhdGlvbnM6IEFubm90YXRpb248bnVtYmVyPih7XG4gICAgcmVkdWNlcjogKF8sIHVwZGF0ZSkgPT4gdXBkYXRlLFxuICAgIGRlZmF1bHQ6ICgpID0+IDAsXG4gIH0pLFxufSk7XG5cbmV4cG9ydCB0eXBlIEFnZW50U3RhdGVUeXBlID0gdHlwZW9mIEFnZW50U3RhdGUuU3RhdGU7XG5cbi8vIFN0cmVhbWluZyBhZ2VudCBncmFwaFxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN0cmVhbWluZ0xvdmFibGVBZ2VudEdyYXBoKHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpIHtcbiAgLy8gVXBkYXRlIExMTSBpZiBhIHNwZWNpZmljIG1vZGVsIGlzIHJlcXVlc3RlZFxuICBpZiAobW9kZWwpIHtcbiAgICBjb25zdCB7IGNyZWF0ZUxMTSB9ID0gcmVxdWlyZSgnLi9tb2RlbC1wcm92aWRlcnMnKTtcbiAgICBjb25zdCB7IGxsbTogbmV3TGxtIH0gPSByZXF1aXJlKCcuL21vZGVsLXByb3ZpZGVycycpO1xuICAgIC8vIFRoaXMgaXMgYSBiaXQgb2YgYSBoYWNrIC0gd2UgbmVlZCB0byB1cGRhdGUgdGhlIG1vZHVsZS1sZXZlbCBsbG1cbiAgICAvLyBJbiBhIHJlYWwgcmVmYWN0b3IsIHdlJ2QgcGFzcyBsbG0gYXMgYSBwYXJhbWV0ZXJcbiAgfVxuXG4gIGNvbnN0IHdvcmtmbG93ID0gbmV3IFN0YXRlR3JhcGgoQWdlbnRTdGF0ZSlcbiAgICAuYWRkTm9kZSgncGxhbm5lcicsIChzdGF0ZSkgPT4gc3RyZWFtaW5nUGxhbm5lckFnZW50KHN0YXRlLCBzZXNzaW9uSWQsIG1vZGVsKSlcbiAgICAuYWRkTm9kZSgnZ2VuZXJhdG9yJywgKHN0YXRlKSA9PiBzdHJlYW1pbmdDb2RlR2VuZXJhdG9yQWdlbnQoc3RhdGUsIHNlc3Npb25JZCwgbW9kZWwpKVxuICAgIC5hZGROb2RlKCdyZXZpZXdlcicsIChzdGF0ZSkgPT4gc3RyZWFtaW5nUmV2aWV3ZXJBZ2VudChzdGF0ZSwgc2Vzc2lvbklkLCBtb2RlbCkpXG4gICAgLmFkZE5vZGUoJ2ZpeF9pc3N1ZXMnLCAoc3RhdGUpID0+IHN0cmVhbWluZ0ZpeGVyQWdlbnQoc3RhdGUsIHNlc3Npb25JZCwgbW9kZWwpKVxuICAgIC5hZGRFZGdlKFNUQVJULCAncGxhbm5lcicpXG4gICAgLmFkZENvbmRpdGlvbmFsRWRnZXMoJ3BsYW5uZXInLCBzaG91bGRDb250aW51ZSwge1xuICAgICAgcGxhbm5lcjogJ3BsYW5uZXInLFxuICAgICAgZ2VuZXJhdG9yOiAnZ2VuZXJhdG9yJyxcbiAgICAgIGVuZDogRU5ELFxuICAgIH0pXG4gICAgLmFkZENvbmRpdGlvbmFsRWRnZXMoJ2dlbmVyYXRvcicsIHNob3VsZENvbnRpbnVlLCB7XG4gICAgICBnZW5lcmF0b3I6ICdnZW5lcmF0b3InLFxuICAgICAgcmV2aWV3ZXI6ICdyZXZpZXdlcicsXG4gICAgICBlbmQ6IEVORCxcbiAgICB9KVxuICAgIC5hZGRDb25kaXRpb25hbEVkZ2VzKCdyZXZpZXdlcicsIHNob3VsZENvbnRpbnVlLCB7XG4gICAgICBmaXhfaXNzdWVzOiAnZml4X2lzc3VlcycsXG4gICAgICBlbmQ6IEVORCxcbiAgICB9KVxuICAgIC5hZGRDb25kaXRpb25hbEVkZ2VzKCdmaXhfaXNzdWVzJywgc2hvdWxkQ29udGludWUsIHtcbiAgICAgIHJldmlld2VyOiAncmV2aWV3ZXInLFxuICAgICAgZW5kOiBFTkQsXG4gICAgfSk7XG5cbiAgcmV0dXJuIHdvcmtmbG93LmNvbXBpbGUoKTtcbn1cblxuLy8gTm9uLXN0cmVhbWluZyBhZ2VudCBncmFwaFxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxvdmFibGVBZ2VudEdyYXBoKHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpIHtcbiAgY29uc3Qgd29ya2Zsb3cgPSBuZXcgU3RhdGVHcmFwaChBZ2VudFN0YXRlKVxuICAgIC5hZGROb2RlKCdwbGFubmVyJywgKHN0YXRlKSA9PiBwbGFubmVyQWdlbnQoc3RhdGUsIHNlc3Npb25JZCwgbW9kZWwpKVxuICAgIC5hZGROb2RlKCdnZW5lcmF0b3InLCAoc3RhdGUpID0+IGNvZGVHZW5lcmF0b3JBZ2VudChzdGF0ZSwgc2Vzc2lvbklkLCBtb2RlbCkpXG4gICAgLmFkZE5vZGUoJ3Jldmlld2VyJywgKHN0YXRlKSA9PiByZXZpZXdlckFnZW50KHN0YXRlLCBzZXNzaW9uSWQsIG1vZGVsKSlcbiAgICAuYWRkRWRnZShTVEFSVCwgJ3BsYW5uZXInKVxuICAgIC5hZGRDb25kaXRpb25hbEVkZ2VzKCdwbGFubmVyJywgc2hvdWxkQ29udGludWUsIHtcbiAgICAgIGdlbmVyYXRvcjogJ2dlbmVyYXRvcicsXG4gICAgICBlbmQ6IEVORCxcbiAgICB9KVxuICAgIC5hZGRDb25kaXRpb25hbEVkZ2VzKCdnZW5lcmF0b3InLCBzaG91bGRDb250aW51ZSwge1xuICAgICAgZ2VuZXJhdG9yOiAnZ2VuZXJhdG9yJyxcbiAgICAgIHJldmlld2VyOiAncmV2aWV3ZXInLFxuICAgICAgZW5kOiBFTkQsXG4gICAgfSlcbiAgICAuYWRkQ29uZGl0aW9uYWxFZGdlcygncmV2aWV3ZXInLCBzaG91bGRDb250aW51ZSwge1xuICAgICAgZ2VuZXJhdG9yOiAnZ2VuZXJhdG9yJyxcbiAgICAgIGVuZDogRU5ELFxuICAgIH0pO1xuXG4gIHJldHVybiB3b3JrZmxvdy5jb21waWxlKCk7XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBzYXZlIGdlbmVyYXRlZCBmaWxlcyB0byBkaXNrXG5leHBvcnQgZnVuY3Rpb24gc2F2ZUdlbmVyYXRlZEZpbGVzKGZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvdXRwdXREaXI/OiBzdHJpbmcpIHtcbiAgY29uc3QgbWVtb3J5ID0gZ2V0TWVtb3J5KCk7XG5cbiAgLy8gVXNlIHByb2plY3QgZm9sZGVyIGlmIG5vIG91dHB1dCBkaXJlY3Rvcnkgc3BlY2lmaWVkXG4gIGNvbnN0IHRhcmdldERpciA9IG91dHB1dERpciB8fCBnZXRQcm9qZWN0Rm9sZGVyKCk7XG5cbiAgaWYgKCFmcy5leGlzdHNTeW5jKHRhcmdldERpcikpIHtcbiAgICBmcy5ta2RpclN5bmModGFyZ2V0RGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgfVxuXG4gIGNvbnN0IHNhdmVkRmlsZXM6IHN0cmluZ1tdID0gW107XG5cbiAgZm9yIChjb25zdCBbZmlsZW5hbWUsIGNvbnRlbnRdIG9mIE9iamVjdC5lbnRyaWVzKGZpbGVzKSkge1xuICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKHRhcmdldERpciwgZmlsZW5hbWUpO1xuICAgIGNvbnN0IGRpciA9IHBhdGguZGlybmFtZShmdWxsUGF0aCk7XG5cbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGlyKSkge1xuICAgICAgZnMubWtkaXJTeW5jKGRpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgZXhpc3RzID0gZnMuZXhpc3RzU3luYyhmdWxsUGF0aCk7XG4gICAgZnMud3JpdGVGaWxlU3luYyhmdWxsUGF0aCwgY29udGVudCwgJ3V0Zi04Jyk7XG5cbiAgICAvLyBUcmFjayBpbiBtZW1vcnlcbiAgICBtZW1vcnkuYWRkRmlsZU9wZXJhdGlvbihleGlzdHMgPyAnbW9kaWZpZWQnIDogJ2NyZWF0ZWQnLCBmdWxsUGF0aCk7XG5cbiAgICBzYXZlZEZpbGVzLnB1c2goZnVsbFBhdGgpO1xuICB9XG5cbiAgcmV0dXJuIHNhdmVkRmlsZXM7XG59XG5cbi8vIEV4cG9ydCB0b29sIGxvZ2dlciBzdGF0aXN0aWNzXG5leHBvcnQgZnVuY3Rpb24gZ2V0VG9vbENhbGxTdGF0cygpIHtcbiAgcmV0dXJuIHRvb2xMb2dnZXIuZ2V0U3RhdHMoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRvb2xDYWxsU3VtbWFyeSgpIHtcbiAgcmV0dXJuIHRvb2xMb2dnZXIuZ2V0U3VtbWFyeSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJUb29sQ2FsbExvZ3MoKSB7XG4gIHRvb2xMb2dnZXIuY2xlYXIoKTtcbn1cblxuLy8gR2V0IG1lbW9yeSBzdGF0aXN0aWNzIGZvciBkZWJ1Z2dpbmcvbW9uaXRvcmluZ1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE1lbW9yeVN0YXRzKCkge1xuICBjb25zdCBtZW1vcnkgPSBnZXRNZW1vcnkoKTtcbiAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBtZW1vcnkuZ2V0TWVzc2FnZXMoKTtcbiAgY29uc3QgZmlsZU9wcyA9IGF3YWl0IG1lbW9yeS5nZXRSZWNlbnRGaWxlT3BlcmF0aW9ucygpO1xuICBjb25zdCBzZXNzaW9uRmlsZXMgPSBhd2FpdCBtZW1vcnkuZ2V0U2Vzc2lvbkZpbGVzKCk7XG5cbiAgcmV0dXJuIHtcbiAgICB0b2tlbkVzdGltYXRlOiBhd2FpdCBtZW1vcnkuZ2V0VG9rZW5Fc3RpbWF0ZSgpLFxuICAgIG1lc3NhZ2VDb3VudDogbWVzc2FnZXMubGVuZ3RoLFxuICAgIGZpbGVPcGVyYXRpb25Db3VudDogZmlsZU9wcy5sZW5ndGgsXG4gICAgc2Vzc2lvbkZpbGVzOiBzZXNzaW9uRmlsZXMsXG4gIH07XG59Il0sIm5hbWVzIjpbIlN0YXRlR3JhcGgiLCJFTkQiLCJTVEFSVCIsIkFubm90YXRpb24iLCJ0b29sTG9nZ2VyIiwiZ2V0TWVtb3J5IiwiZ2V0UHJvamVjdEZvbGRlciIsInN0cmVhbWluZ1BsYW5uZXJBZ2VudCIsInN0cmVhbWluZ0NvZGVHZW5lcmF0b3JBZ2VudCIsInN0cmVhbWluZ1Jldmlld2VyQWdlbnQiLCJzdHJlYW1pbmdGaXhlckFnZW50Iiwic2hvdWxkQ29udGludWUiLCJwbGFubmVyQWdlbnQiLCJjb2RlR2VuZXJhdG9yQWdlbnQiLCJyZXZpZXdlckFnZW50IiwiZnMiLCJwYXRoIiwiZW1pdEV2ZW50Iiwic2V0RW1pdEZ1bmN0aW9uIiwiZm4iLCJBZ2VudFN0YXRlIiwiUm9vdCIsIm1lc3NhZ2VzIiwicmVkdWNlciIsImN1cnJlbnQiLCJ1cGRhdGUiLCJkZWZhdWx0IiwidXNlclJlcXVlc3QiLCJfIiwicGxhbiIsImdlbmVyYXRlZEZpbGVzIiwiY3VycmVudEl0ZXJhdGlvbiIsInJldmlld0ZlZWRiYWNrIiwiaXNDb21wbGV0ZSIsInJldmlld0l0ZXJhdGlvbnMiLCJjcmVhdGVTdHJlYW1pbmdMb3ZhYmxlQWdlbnRHcmFwaCIsInNlc3Npb25JZCIsIm1vZGVsIiwiY3JlYXRlTExNIiwicmVxdWlyZSIsImxsbSIsIm5ld0xsbSIsIndvcmtmbG93IiwiYWRkTm9kZSIsInN0YXRlIiwiYWRkRWRnZSIsImFkZENvbmRpdGlvbmFsRWRnZXMiLCJwbGFubmVyIiwiZ2VuZXJhdG9yIiwiZW5kIiwicmV2aWV3ZXIiLCJmaXhfaXNzdWVzIiwiY29tcGlsZSIsImNyZWF0ZUxvdmFibGVBZ2VudEdyYXBoIiwic2F2ZUdlbmVyYXRlZEZpbGVzIiwiZmlsZXMiLCJvdXRwdXREaXIiLCJtZW1vcnkiLCJ0YXJnZXREaXIiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwic2F2ZWRGaWxlcyIsImZpbGVuYW1lIiwiY29udGVudCIsIk9iamVjdCIsImVudHJpZXMiLCJmdWxsUGF0aCIsImpvaW4iLCJkaXIiLCJkaXJuYW1lIiwiZXhpc3RzIiwid3JpdGVGaWxlU3luYyIsImFkZEZpbGVPcGVyYXRpb24iLCJwdXNoIiwiZ2V0VG9vbENhbGxTdGF0cyIsImdldFN0YXRzIiwiZ2V0VG9vbENhbGxTdW1tYXJ5IiwiZ2V0U3VtbWFyeSIsImNsZWFyVG9vbENhbGxMb2dzIiwiY2xlYXIiLCJnZXRNZW1vcnlTdGF0cyIsImdldE1lc3NhZ2VzIiwiZmlsZU9wcyIsImdldFJlY2VudEZpbGVPcGVyYXRpb25zIiwic2Vzc2lvbkZpbGVzIiwiZ2V0U2Vzc2lvbkZpbGVzIiwidG9rZW5Fc3RpbWF0ZSIsImdldFRva2VuRXN0aW1hdGUiLCJtZXNzYWdlQ291bnQiLCJsZW5ndGgiLCJmaWxlT3BlcmF0aW9uQ291bnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/agent-core.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/agents.ts":
/*!******************************!*\
  !*** ./lib/agents/agents.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   codeGeneratorAgent: () => (/* binding */ codeGeneratorAgent),\n/* harmony export */   plannerAgent: () => (/* binding */ plannerAgent),\n/* harmony export */   reviewerAgent: () => (/* binding */ reviewerAgent)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _model_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./model-providers */ \"(rsc)/./lib/agents/model-providers.ts\");\n\n\n// Non-streaming Planner Agent\nasync function plannerAgent(state, sessionId, model) {\n    const systemPrompt = `You are a senior software architect. Break down the user's request into clear, actionable steps.\nEach step should be specific and focused on a single file or component.\n\nOutput format:\n1. [Step description]\n2. [Step description]\n...\n\nBe concise but clear about what needs to be built.`;\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`User request: ${state.userRequest}\\n\\nCreate a detailed plan with numbered steps.`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llm\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_1__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_1__.llm;\n    const response = await llmToUse.invoke(messages);\n    const planText = response.content.toString();\n    // Extract numbered steps\n    const steps = planText.split(\"\\n\").filter((line)=>/^\\d+\\./.test(line.trim())).map((line)=>line.trim());\n    return {\n        plan: steps,\n        messages: [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Plan created:\\n${planText}`)\n        ]\n    };\n}\n// Non-streaming Code Generator Agent\nasync function codeGeneratorAgent(state, sessionId, model) {\n    const currentStep = state.currentIteration;\n    const stepToImplement = state.plan[currentStep];\n    if (!stepToImplement) {\n        return {\n            isComplete: true,\n            messages: [\n                new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(\"All planned steps have been completed.\")\n            ]\n        };\n    }\n    // Use consistent project ID for vector context\n    const projectId = \"agent_context_project\";\n    // Get vector context for better code generation\n    let similarExamples = \"\";\n    let projectContext = \"\";\n    try {\n        // Search for similar code examples\n        similarExamples = await searchSimilarCode(stepToImplement, projectId, 3);\n        console.log(`📚 Found similar examples for step: ${stepToImplement.substring(0, 50)}...`);\n        // Get project context\n        projectContext = await getProjectContext(projectId);\n    } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : String(error);\n        console.log(`⚠️ Vector search unavailable (${errorMessage}) - proceeding without examples`);\n        similarExamples = \"Vector search not available - proceeding without examples.\";\n        projectContext = \"Project context not available.\";\n    }\n    const systemPrompt = `You are an expert full-stack developer. Generate clean, well-documented code.\n\nRules:\n1. Think step by step when generating code and log your chain of thought\n2. Generate complete, working code\n3. Include comments for complex logic\n4. Follow best practices and modern patterns\n5. Use TypeScript when applicable\n6. Return code in a structured format with filename and content\n7. Reference similar examples when applicable to maintain consistency\n\nOutput format:\nChain of Thought:\n[Your step-by-step reasoning here]\n\nFiles:\nFILENAME: [relative/path/to/file.ext]\n\\`\\`\\`[language]\n[code here]\n\\`\\`\\`\n\nYou can output multiple files if needed.`;\n    const contextMessages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Current step to implement: ${stepToImplement}\n\nFull plan context:\n${state.plan.join(\"\\n\")}\n\nSimilar examples from codebase:\n${similarExamples}\n\nProject context:\n${projectContext}\n\nCurrent iteration: ${currentStep + 1}/${state.plan.length}`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llm\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_1__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_1__.llm;\n    const response = await llmToUse.invoke(contextMessages);\n    const generatedContent = response.content.toString();\n    // Parse the generated content to extract files\n    const files = parseGeneratedFiles(generatedContent);\n    return {\n        generatedFiles: files,\n        currentIteration: currentStep + 1,\n        messages: [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Generated code for step ${currentStep + 1}:\\n${generatedContent}`)\n        ]\n    };\n}\n// Non-streaming Reviewer Agent\nasync function reviewerAgent(state, sessionId, model) {\n    const generatedFiles = state.generatedFiles;\n    if (Object.keys(generatedFiles).length === 0) {\n        return {\n            isComplete: true,\n            messages: [\n                new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(\"No files to review.\")\n            ]\n        };\n    }\n    const systemPrompt = `You are a senior code reviewer. Analyze the generated code for:\n1. Syntax errors and type issues\n2. Logic errors or bugs\n3. Security vulnerabilities\n4. Performance issues\n5. Code quality and best practices\n6. Missing functionality\n7. Integration issues\n\nBe thorough but constructive. If you find issues, provide specific recommendations for fixes.\n\nOutput format:\nISSUES FOUND:\n- [Issue 1 with specific details]\n- [Issue 2 with specific details]\n\nRECOMMENDATIONS:\n- [Specific fix for issue 1]\n- [Specific fix for issue 2]\n\nIf no issues found, say \"CODE REVIEW PASSED\"`;\n    const fileContents = Object.entries(generatedFiles).map(([filename, content])=>`File: ${filename}\\n\\`\\`\\`\\n${content}\\n\\`\\`\\``).join(\"\\n\\n\");\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Review the following generated code:\n\n${fileContents}\n\nUser request: ${state.userRequest}\nPlan: ${state.plan.join(\"\\n\")}`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llm\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_1__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_1__.llm;\n    const response = await llmToUse.invoke(messages);\n    const reviewContent = response.content.toString();\n    const hasIssues = !reviewContent.toLowerCase().includes(\"code review passed\");\n    return {\n        reviewFeedback: reviewContent,\n        reviewIterations: state.reviewIterations + 1,\n        messages: [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Code review completed:\\n${reviewContent}`)\n        ]\n    };\n}\n// Helper functions (copied from original)\nasync function searchSimilarCode(query, projectId, limit = 3) {\n    // This would integrate with vector search - placeholder for now\n    return \"Vector search integration needed\";\n}\nasync function getProjectContext(projectId) {\n    // This would get project context - placeholder for now\n    return \"Project context integration needed\";\n}\nfunction parseGeneratedFiles(content) {\n    const files = {};\n    const fileRegex = /FILENAME:\\s*([^\\n]+)\\n```[\\w]*\\n([\\s\\S]*?)```/g;\n    let match;\n    while((match = fileRegex.exec(content)) !== null){\n        const filename = match[1].trim();\n        const fileContent = match[2].trim();\n        files[filename] = fileContent;\n    }\n    return files;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxNQUFNLENBQUNKO0lBQ3ZDLE1BQU0rQyxnQkFBZ0I1QyxTQUFTRyxPQUFPLENBQUNDLFFBQVE7SUFFL0MsTUFBTXlDLFlBQVksQ0FBQ0QsY0FBY0UsV0FBVyxHQUFHQyxRQUFRLENBQUM7SUFFeEQsT0FBTztRQUNMQyxnQkFBZ0JKO1FBQ2hCSyxrQkFBa0J4RCxNQUFNd0QsZ0JBQWdCLEdBQUc7UUFDM0NwRCxVQUFVO1lBQUMsSUFBSVQsK0RBQVNBLENBQUMsQ0FBQyx3QkFBd0IsRUFBRXdELGNBQWMsQ0FBQztTQUFFO0lBQ3ZFO0FBQ0Y7QUFFQSwwQ0FBMEM7QUFDMUMsZUFBZXZCLGtCQUFrQjZCLEtBQWEsRUFBRWhDLFNBQWlCLEVBQUVpQyxRQUFnQixDQUFDO0lBQ2xGLGdFQUFnRTtJQUNoRSxPQUFPO0FBQ1Q7QUFFQSxlQUFlMUIsa0JBQWtCUCxTQUFpQjtJQUNoRCx1REFBdUQ7SUFDdkQsT0FBTztBQUNUO0FBRUEsU0FBU2tCLG9CQUFvQmpDLE9BQWU7SUFDMUMsTUFBTWdDLFFBQWdDLENBQUM7SUFDdkMsTUFBTWlCLFlBQVk7SUFFbEIsSUFBSUM7SUFDSixNQUFPLENBQUNBLFFBQVFELFVBQVVFLElBQUksQ0FBQ25ELFFBQU8sTUFBTyxLQUFNO1FBQ2pELE1BQU13QyxXQUFXVSxLQUFLLENBQUMsRUFBRSxDQUFDM0MsSUFBSTtRQUM5QixNQUFNNkMsY0FBY0YsS0FBSyxDQUFDLEVBQUUsQ0FBQzNDLElBQUk7UUFDakN5QixLQUFLLENBQUNRLFNBQVMsR0FBR1k7SUFDcEI7SUFFQSxPQUFPcEI7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2FnZW50cy9hZ2VudHMudHM/ZWRhZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlTWVzc2FnZSwgSHVtYW5NZXNzYWdlLCBBSU1lc3NhZ2UsIFN5c3RlbU1lc3NhZ2UgfSBmcm9tICdAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXMnO1xuaW1wb3J0IHsgdG9vbExvZ2dlciB9IGZyb20gJy4uL3V0aWxzL3Rvb2wtbG9nZ2VyJztcbmltcG9ydCB7IHByb21wdE9wdGltaXplciB9IGZyb20gJy4uL3V0aWxzL3Byb21wdC1vcHRpbWl6ZXInO1xuaW1wb3J0IHsgY29tcHJlc3NDb250ZXh0LCBzdW1tYXJpemVGaWxlQ29udGVudHMsIGVzdGltYXRlVG9rZW5zLCBzaG91bGRDb21wcmVzcywgc21hcnRUcnVuY2F0ZSB9IGZyb20gJy4uL3V0aWxzL3N1bW1hcml6ZXInO1xuaW1wb3J0IHsgZ2V0TWVtb3J5LCBnZXRQcm9qZWN0Rm9sZGVyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBsbG0sIGNyZWF0ZUxMTSB9IGZyb20gJy4vbW9kZWwtcHJvdmlkZXJzJztcbmltcG9ydCB7IHRvb2xzLCB3cmFwVG9vbFdpdGhMb2dnaW5nIH0gZnJvbSAnLi90b29scyc7XG5pbXBvcnQgeyBBZ2VudFN0YXRlVHlwZSB9IGZyb20gJy4vYWdlbnQtY29yZSc7XG5cbi8vIE5vbi1zdHJlYW1pbmcgUGxhbm5lciBBZ2VudFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBsYW5uZXJBZ2VudChzdGF0ZTogQWdlbnRTdGF0ZVR5cGUsIHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8QWdlbnRTdGF0ZVR5cGU+PiB7XG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgc2VuaW9yIHNvZnR3YXJlIGFyY2hpdGVjdC4gQnJlYWsgZG93biB0aGUgdXNlcidzIHJlcXVlc3QgaW50byBjbGVhciwgYWN0aW9uYWJsZSBzdGVwcy5cbkVhY2ggc3RlcCBzaG91bGQgYmUgc3BlY2lmaWMgYW5kIGZvY3VzZWQgb24gYSBzaW5nbGUgZmlsZSBvciBjb21wb25lbnQuXG5cbk91dHB1dCBmb3JtYXQ6XG4xLiBbU3RlcCBkZXNjcmlwdGlvbl1cbjIuIFtTdGVwIGRlc2NyaXB0aW9uXVxuLi4uXG5cbkJlIGNvbmNpc2UgYnV0IGNsZWFyIGFib3V0IHdoYXQgbmVlZHMgdG8gYmUgYnVpbHQuYDtcblxuICBjb25zdCBtZXNzYWdlcyA9IFtcbiAgICBuZXcgU3lzdGVtTWVzc2FnZShzeXN0ZW1Qcm9tcHQpLFxuICAgIG5ldyBIdW1hbk1lc3NhZ2UoYFVzZXIgcmVxdWVzdDogJHtzdGF0ZS51c2VyUmVxdWVzdH1cXG5cXG5DcmVhdGUgYSBkZXRhaWxlZCBwbGFuIHdpdGggbnVtYmVyZWQgc3RlcHMuYCksXG4gIF07XG5cbiAgLy8gVXNlIG1vZGVsLXNwZWNpZmljIExMTSBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBnbG9iYWwgbGxtXG4gIGNvbnN0IGxsbVRvVXNlID0gbW9kZWwgPyBjcmVhdGVMTE0obW9kZWwpIDogbGxtO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxsbVRvVXNlLmludm9rZShtZXNzYWdlcyk7XG4gIGNvbnN0IHBsYW5UZXh0ID0gcmVzcG9uc2UuY29udGVudC50b1N0cmluZygpO1xuXG4gIC8vIEV4dHJhY3QgbnVtYmVyZWQgc3RlcHNcbiAgY29uc3Qgc3RlcHMgPSBwbGFuVGV4dFxuICAgIC5zcGxpdCgnXFxuJylcbiAgICAuZmlsdGVyKGxpbmUgPT4gL15cXGQrXFwuLy50ZXN0KGxpbmUudHJpbSgpKSlcbiAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpO1xuXG4gIHJldHVybiB7XG4gICAgcGxhbjogc3RlcHMsXG4gICAgbWVzc2FnZXM6IFtuZXcgQUlNZXNzYWdlKGBQbGFuIGNyZWF0ZWQ6XFxuJHtwbGFuVGV4dH1gKV0sXG4gIH07XG59XG5cbi8vIE5vbi1zdHJlYW1pbmcgQ29kZSBHZW5lcmF0b3IgQWdlbnRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb2RlR2VuZXJhdG9yQWdlbnQoc3RhdGU6IEFnZW50U3RhdGVUeXBlLCBzZXNzaW9uSWQ/OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nKTogUHJvbWlzZTxQYXJ0aWFsPEFnZW50U3RhdGVUeXBlPj4ge1xuICBjb25zdCBjdXJyZW50U3RlcCA9IHN0YXRlLmN1cnJlbnRJdGVyYXRpb247XG4gIGNvbnN0IHN0ZXBUb0ltcGxlbWVudCA9IHN0YXRlLnBsYW5bY3VycmVudFN0ZXBdO1xuXG4gIGlmICghc3RlcFRvSW1wbGVtZW50KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzQ29tcGxldGU6IHRydWUsXG4gICAgICBtZXNzYWdlczogW25ldyBBSU1lc3NhZ2UoJ0FsbCBwbGFubmVkIHN0ZXBzIGhhdmUgYmVlbiBjb21wbGV0ZWQuJyldLFxuICAgIH07XG4gIH1cblxuICAvLyBVc2UgY29uc2lzdGVudCBwcm9qZWN0IElEIGZvciB2ZWN0b3IgY29udGV4dFxuICBjb25zdCBwcm9qZWN0SWQgPSAnYWdlbnRfY29udGV4dF9wcm9qZWN0JztcblxuICAvLyBHZXQgdmVjdG9yIGNvbnRleHQgZm9yIGJldHRlciBjb2RlIGdlbmVyYXRpb25cbiAgbGV0IHNpbWlsYXJFeGFtcGxlcyA9ICcnO1xuICBsZXQgcHJvamVjdENvbnRleHQgPSAnJztcblxuICB0cnkge1xuICAgIC8vIFNlYXJjaCBmb3Igc2ltaWxhciBjb2RlIGV4YW1wbGVzXG4gICAgc2ltaWxhckV4YW1wbGVzID0gYXdhaXQgc2VhcmNoU2ltaWxhckNvZGUoc3RlcFRvSW1wbGVtZW50LCBwcm9qZWN0SWQsIDMpO1xuICAgIGNvbnNvbGUubG9nKGDwn5OaIEZvdW5kIHNpbWlsYXIgZXhhbXBsZXMgZm9yIHN0ZXA6ICR7c3RlcFRvSW1wbGVtZW50LnN1YnN0cmluZygwLCA1MCl9Li4uYCk7XG5cbiAgICAvLyBHZXQgcHJvamVjdCBjb250ZXh0XG4gICAgcHJvamVjdENvbnRleHQgPSBhd2FpdCBnZXRQcm9qZWN0Q29udGV4dChwcm9qZWN0SWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcbiAgICBjb25zb2xlLmxvZyhg4pqg77iPIFZlY3RvciBzZWFyY2ggdW5hdmFpbGFibGUgKCR7ZXJyb3JNZXNzYWdlfSkgLSBwcm9jZWVkaW5nIHdpdGhvdXQgZXhhbXBsZXNgKTtcbiAgICBzaW1pbGFyRXhhbXBsZXMgPSAnVmVjdG9yIHNlYXJjaCBub3QgYXZhaWxhYmxlIC0gcHJvY2VlZGluZyB3aXRob3V0IGV4YW1wbGVzLic7XG4gICAgcHJvamVjdENvbnRleHQgPSAnUHJvamVjdCBjb250ZXh0IG5vdCBhdmFpbGFibGUuJztcbiAgfVxuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBmdWxsLXN0YWNrIGRldmVsb3Blci4gR2VuZXJhdGUgY2xlYW4sIHdlbGwtZG9jdW1lbnRlZCBjb2RlLlxuXG5SdWxlczpcbjEuIFRoaW5rIHN0ZXAgYnkgc3RlcCB3aGVuIGdlbmVyYXRpbmcgY29kZSBhbmQgbG9nIHlvdXIgY2hhaW4gb2YgdGhvdWdodFxuMi4gR2VuZXJhdGUgY29tcGxldGUsIHdvcmtpbmcgY29kZVxuMy4gSW5jbHVkZSBjb21tZW50cyBmb3IgY29tcGxleCBsb2dpY1xuNC4gRm9sbG93IGJlc3QgcHJhY3RpY2VzIGFuZCBtb2Rlcm4gcGF0dGVybnNcbjUuIFVzZSBUeXBlU2NyaXB0IHdoZW4gYXBwbGljYWJsZVxuNi4gUmV0dXJuIGNvZGUgaW4gYSBzdHJ1Y3R1cmVkIGZvcm1hdCB3aXRoIGZpbGVuYW1lIGFuZCBjb250ZW50XG43LiBSZWZlcmVuY2Ugc2ltaWxhciBleGFtcGxlcyB3aGVuIGFwcGxpY2FibGUgdG8gbWFpbnRhaW4gY29uc2lzdGVuY3lcblxuT3V0cHV0IGZvcm1hdDpcbkNoYWluIG9mIFRob3VnaHQ6XG5bWW91ciBzdGVwLWJ5LXN0ZXAgcmVhc29uaW5nIGhlcmVdXG5cbkZpbGVzOlxuRklMRU5BTUU6IFtyZWxhdGl2ZS9wYXRoL3RvL2ZpbGUuZXh0XVxuXFxgXFxgXFxgW2xhbmd1YWdlXVxuW2NvZGUgaGVyZV1cblxcYFxcYFxcYFxuXG5Zb3UgY2FuIG91dHB1dCBtdWx0aXBsZSBmaWxlcyBpZiBuZWVkZWQuYDtcblxuICBjb25zdCBjb250ZXh0TWVzc2FnZXMgPSBbXG4gICAgbmV3IFN5c3RlbU1lc3NhZ2Uoc3lzdGVtUHJvbXB0KSxcbiAgICBuZXcgSHVtYW5NZXNzYWdlKGBDdXJyZW50IHN0ZXAgdG8gaW1wbGVtZW50OiAke3N0ZXBUb0ltcGxlbWVudH1cblxuRnVsbCBwbGFuIGNvbnRleHQ6XG4ke3N0YXRlLnBsYW4uam9pbignXFxuJyl9XG5cblNpbWlsYXIgZXhhbXBsZXMgZnJvbSBjb2RlYmFzZTpcbiR7c2ltaWxhckV4YW1wbGVzfVxuXG5Qcm9qZWN0IGNvbnRleHQ6XG4ke3Byb2plY3RDb250ZXh0fVxuXG5DdXJyZW50IGl0ZXJhdGlvbjogJHtjdXJyZW50U3RlcCArIDF9LyR7c3RhdGUucGxhbi5sZW5ndGh9YCksXG4gIF07XG5cbiAgLy8gVXNlIG1vZGVsLXNwZWNpZmljIExMTSBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBnbG9iYWwgbGxtXG4gIGNvbnN0IGxsbVRvVXNlID0gbW9kZWwgPyBjcmVhdGVMTE0obW9kZWwpIDogbGxtO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxsbVRvVXNlLmludm9rZShjb250ZXh0TWVzc2FnZXMpO1xuICBjb25zdCBnZW5lcmF0ZWRDb250ZW50ID0gcmVzcG9uc2UuY29udGVudC50b1N0cmluZygpO1xuXG4gIC8vIFBhcnNlIHRoZSBnZW5lcmF0ZWQgY29udGVudCB0byBleHRyYWN0IGZpbGVzXG4gIGNvbnN0IGZpbGVzID0gcGFyc2VHZW5lcmF0ZWRGaWxlcyhnZW5lcmF0ZWRDb250ZW50KTtcblxuICByZXR1cm4ge1xuICAgIGdlbmVyYXRlZEZpbGVzOiBmaWxlcyxcbiAgICBjdXJyZW50SXRlcmF0aW9uOiBjdXJyZW50U3RlcCArIDEsXG4gICAgbWVzc2FnZXM6IFtuZXcgQUlNZXNzYWdlKGBHZW5lcmF0ZWQgY29kZSBmb3Igc3RlcCAke2N1cnJlbnRTdGVwICsgMX06XFxuJHtnZW5lcmF0ZWRDb250ZW50fWApXSxcbiAgfTtcbn1cblxuLy8gTm9uLXN0cmVhbWluZyBSZXZpZXdlciBBZ2VudFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJldmlld2VyQWdlbnQoc3RhdGU6IEFnZW50U3RhdGVUeXBlLCBzZXNzaW9uSWQ/OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nKTogUHJvbWlzZTxQYXJ0aWFsPEFnZW50U3RhdGVUeXBlPj4ge1xuICBjb25zdCBnZW5lcmF0ZWRGaWxlcyA9IHN0YXRlLmdlbmVyYXRlZEZpbGVzO1xuXG4gIGlmIChPYmplY3Qua2V5cyhnZW5lcmF0ZWRGaWxlcykubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzQ29tcGxldGU6IHRydWUsXG4gICAgICBtZXNzYWdlczogW25ldyBBSU1lc3NhZ2UoJ05vIGZpbGVzIHRvIHJldmlldy4nKV0sXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgc2VuaW9yIGNvZGUgcmV2aWV3ZXIuIEFuYWx5emUgdGhlIGdlbmVyYXRlZCBjb2RlIGZvcjpcbjEuIFN5bnRheCBlcnJvcnMgYW5kIHR5cGUgaXNzdWVzXG4yLiBMb2dpYyBlcnJvcnMgb3IgYnVnc1xuMy4gU2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzXG40LiBQZXJmb3JtYW5jZSBpc3N1ZXNcbjUuIENvZGUgcXVhbGl0eSBhbmQgYmVzdCBwcmFjdGljZXNcbjYuIE1pc3NpbmcgZnVuY3Rpb25hbGl0eVxuNy4gSW50ZWdyYXRpb24gaXNzdWVzXG5cbkJlIHRob3JvdWdoIGJ1dCBjb25zdHJ1Y3RpdmUuIElmIHlvdSBmaW5kIGlzc3VlcywgcHJvdmlkZSBzcGVjaWZpYyByZWNvbW1lbmRhdGlvbnMgZm9yIGZpeGVzLlxuXG5PdXRwdXQgZm9ybWF0OlxuSVNTVUVTIEZPVU5EOlxuLSBbSXNzdWUgMSB3aXRoIHNwZWNpZmljIGRldGFpbHNdXG4tIFtJc3N1ZSAyIHdpdGggc3BlY2lmaWMgZGV0YWlsc11cblxuUkVDT01NRU5EQVRJT05TOlxuLSBbU3BlY2lmaWMgZml4IGZvciBpc3N1ZSAxXVxuLSBbU3BlY2lmaWMgZml4IGZvciBpc3N1ZSAyXVxuXG5JZiBubyBpc3N1ZXMgZm91bmQsIHNheSBcIkNPREUgUkVWSUVXIFBBU1NFRFwiYDtcblxuICBjb25zdCBmaWxlQ29udGVudHMgPSBPYmplY3QuZW50cmllcyhnZW5lcmF0ZWRGaWxlcylcbiAgICAubWFwKChbZmlsZW5hbWUsIGNvbnRlbnRdKSA9PiBgRmlsZTogJHtmaWxlbmFtZX1cXG5cXGBcXGBcXGBcXG4ke2NvbnRlbnR9XFxuXFxgXFxgXFxgYClcbiAgICAuam9pbignXFxuXFxuJyk7XG5cbiAgY29uc3QgbWVzc2FnZXMgPSBbXG4gICAgbmV3IFN5c3RlbU1lc3NhZ2Uoc3lzdGVtUHJvbXB0KSxcbiAgICBuZXcgSHVtYW5NZXNzYWdlKGBSZXZpZXcgdGhlIGZvbGxvd2luZyBnZW5lcmF0ZWQgY29kZTpcblxuJHtmaWxlQ29udGVudHN9XG5cblVzZXIgcmVxdWVzdDogJHtzdGF0ZS51c2VyUmVxdWVzdH1cblBsYW46ICR7c3RhdGUucGxhbi5qb2luKCdcXG4nKX1gKSxcbiAgXTtcblxuICAvLyBVc2UgbW9kZWwtc3BlY2lmaWMgTExNIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGdsb2JhbCBsbG1cbiAgY29uc3QgbGxtVG9Vc2UgPSBtb2RlbCA/IGNyZWF0ZUxMTShtb2RlbCkgOiBsbG07XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbGxtVG9Vc2UuaW52b2tlKG1lc3NhZ2VzKTtcbiAgY29uc3QgcmV2aWV3Q29udGVudCA9IHJlc3BvbnNlLmNvbnRlbnQudG9TdHJpbmcoKTtcblxuICBjb25zdCBoYXNJc3N1ZXMgPSAhcmV2aWV3Q29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjb2RlIHJldmlldyBwYXNzZWQnKTtcblxuICByZXR1cm4ge1xuICAgIHJldmlld0ZlZWRiYWNrOiByZXZpZXdDb250ZW50LFxuICAgIHJldmlld0l0ZXJhdGlvbnM6IHN0YXRlLnJldmlld0l0ZXJhdGlvbnMgKyAxLFxuICAgIG1lc3NhZ2VzOiBbbmV3IEFJTWVzc2FnZShgQ29kZSByZXZpZXcgY29tcGxldGVkOlxcbiR7cmV2aWV3Q29udGVudH1gKV0sXG4gIH07XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbnMgKGNvcGllZCBmcm9tIG9yaWdpbmFsKVxuYXN5bmMgZnVuY3Rpb24gc2VhcmNoU2ltaWxhckNvZGUocXVlcnk6IHN0cmluZywgcHJvamVjdElkOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSAzKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgLy8gVGhpcyB3b3VsZCBpbnRlZ3JhdGUgd2l0aCB2ZWN0b3Igc2VhcmNoIC0gcGxhY2Vob2xkZXIgZm9yIG5vd1xuICByZXR1cm4gJ1ZlY3RvciBzZWFyY2ggaW50ZWdyYXRpb24gbmVlZGVkJztcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdENvbnRleHQocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAvLyBUaGlzIHdvdWxkIGdldCBwcm9qZWN0IGNvbnRleHQgLSBwbGFjZWhvbGRlciBmb3Igbm93XG4gIHJldHVybiAnUHJvamVjdCBjb250ZXh0IGludGVncmF0aW9uIG5lZWRlZCc7XG59XG5cbmZ1bmN0aW9uIHBhcnNlR2VuZXJhdGVkRmlsZXMoY29udGVudDogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gIGNvbnN0IGZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGNvbnN0IGZpbGVSZWdleCA9IC9GSUxFTkFNRTpcXHMqKFteXFxuXSspXFxuYGBgW1xcd10qXFxuKFtcXHNcXFNdKj8pYGBgL2c7XG5cbiAgbGV0IG1hdGNoO1xuICB3aGlsZSAoKG1hdGNoID0gZmlsZVJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG4gICAgY29uc3QgZmlsZW5hbWUgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgY29uc3QgZmlsZUNvbnRlbnQgPSBtYXRjaFsyXS50cmltKCk7XG4gICAgZmlsZXNbZmlsZW5hbWVdID0gZmlsZUNvbnRlbnQ7XG4gIH1cblxuICByZXR1cm4gZmlsZXM7XG59Il0sIm5hbWVzIjpbIkh1bWFuTWVzc2FnZSIsIkFJTWVzc2FnZSIsIlN5c3RlbU1lc3NhZ2UiLCJsbG0iLCJjcmVhdGVMTE0iLCJwbGFubmVyQWdlbnQiLCJzdGF0ZSIsInNlc3Npb25JZCIsIm1vZGVsIiwic3lzdGVtUHJvbXB0IiwibWVzc2FnZXMiLCJ1c2VyUmVxdWVzdCIsImxsbVRvVXNlIiwicmVzcG9uc2UiLCJpbnZva2UiLCJwbGFuVGV4dCIsImNvbnRlbnQiLCJ0b1N0cmluZyIsInN0ZXBzIiwic3BsaXQiLCJmaWx0ZXIiLCJsaW5lIiwidGVzdCIsInRyaW0iLCJtYXAiLCJwbGFuIiwiY29kZUdlbmVyYXRvckFnZW50IiwiY3VycmVudFN0ZXAiLCJjdXJyZW50SXRlcmF0aW9uIiwic3RlcFRvSW1wbGVtZW50IiwiaXNDb21wbGV0ZSIsInByb2plY3RJZCIsInNpbWlsYXJFeGFtcGxlcyIsInByb2plY3RDb250ZXh0Iiwic2VhcmNoU2ltaWxhckNvZGUiLCJjb25zb2xlIiwibG9nIiwic3Vic3RyaW5nIiwiZ2V0UHJvamVjdENvbnRleHQiLCJlcnJvciIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsIlN0cmluZyIsImNvbnRleHRNZXNzYWdlcyIsImpvaW4iLCJsZW5ndGgiLCJnZW5lcmF0ZWRDb250ZW50IiwiZmlsZXMiLCJwYXJzZUdlbmVyYXRlZEZpbGVzIiwiZ2VuZXJhdGVkRmlsZXMiLCJyZXZpZXdlckFnZW50IiwiT2JqZWN0Iiwia2V5cyIsImZpbGVDb250ZW50cyIsImVudHJpZXMiLCJmaWxlbmFtZSIsInJldmlld0NvbnRlbnQiLCJoYXNJc3N1ZXMiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwicmV2aWV3RmVlZGJhY2siLCJyZXZpZXdJdGVyYXRpb25zIiwicXVlcnkiLCJsaW1pdCIsImZpbGVSZWdleCIsIm1hdGNoIiwiZXhlYyIsImZpbGVDb250ZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/agents.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/model-providers.ts":
/*!***************************************!*\
  !*** ./lib/agents/model-providers.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLLM: () => (/* binding */ createLLM),\n/* harmony export */   getModelName: () => (/* binding */ getModelName),\n/* harmony export */   llm: () => (/* binding */ llm)\n/* harmony export */ });\n/* harmony import */ var _langchain_groq__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/groq */ \"(rsc)/./node_modules/.pnpm/@langchain+groq@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__/node_modules/@langchain/groq/dist/index.js\");\n/* harmony import */ var _langchain_google_genai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/google-genai */ \"(rsc)/./node_modules/.pnpm/@langchain+google-genai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__/node_modules/@langchain/google-genai/dist/index.js\");\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/.pnpm/@langchain+openai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___ws@8.18.3/node_modules/@langchain/openai/dist/index.js\");\n\n\n\n// Model ID to actual model name mapping\nconst getModelName = (modelId)=>{\n    const modelMappings = {\n        \"groq-mixtral-8x7b\": \"mixtral-8x7b-32768\",\n        \"groq-llama-3.1-8b-instant\": \"llama-3.1-8b-instant\",\n        \"groq-llama-3.3-70b-versatile\": \"llama-3.3-70b-versatile\",\n        \"gemini-2.5-flash\": \"gemini-2.5-flash\",\n        \"gemini-2.5-pro\": \"gemini-2.5-pro\"\n    };\n    return modelMappings[modelId] || modelId;\n};\n// Initialize the LLM model with provider selection\nfunction createLLM(model) {\n    // If a specific model is requested, try to use it\n    if (model) {\n        const groqApiKey = process.env.GROQ_API_KEY;\n        const geminiApiKey = process.env.GEMINI_API_KEY;\n        const openRouterApiKey = process.env.OPENROUTER_API_KEY ?? process.env.OPENAI_API_KEY;\n        if (model.startsWith(\"groq-\") && groqApiKey) {\n            const actualModel = getModelName(model);\n            console.log(\"⚡ Using Groq API (Fastest) - Model:\", actualModel);\n            return new _langchain_groq__WEBPACK_IMPORTED_MODULE_0__.ChatGroq({\n                apiKey: groqApiKey,\n                model: actualModel,\n                temperature: 0.7,\n                maxTokens: 4096\n            });\n        } else if (model.startsWith(\"gemini-\") && geminiApiKey) {\n            const actualModel = getModelName(model);\n            console.log(\"\\uD83E\\uDD16 Using Google Gemini API - Model:\", actualModel);\n            return new _langchain_google_genai__WEBPACK_IMPORTED_MODULE_1__.ChatGoogleGenerativeAI({\n                apiKey: geminiApiKey,\n                model: actualModel,\n                temperature: 0.7,\n                maxOutputTokens: 4096\n            });\n        } else if (openRouterApiKey) {\n            console.log(\"\\uD83D\\uDD04 Using OpenRouter API - Model:\", model);\n            const apiBase = process.env.OPENROUTER_API_BASE ?? process.env.OPENAI_API_BASE ?? \"https://openrouter.ai/api/v1\";\n            return new _langchain_openai__WEBPACK_IMPORTED_MODULE_2__.ChatOpenAI({\n                apiKey: openRouterApiKey,\n                configuration: {\n                    baseURL: apiBase\n                },\n                model: model,\n                temperature: 0.7\n            });\n        }\n    }\n    // Default priority: Groq (fastest) → Gemini (reliable) → OpenRouter (fallback)\n    const groqApiKey = process.env.GROQ_API_KEY;\n    const geminiApiKey = process.env.GEMINI_API_KEY;\n    const openRouterApiKey = process.env.OPENROUTER_API_KEY ?? process.env.OPENAI_API_KEY;\n    if (groqApiKey) {\n        console.log(\"⚡ Using Groq API (Fastest)\");\n        return new _langchain_groq__WEBPACK_IMPORTED_MODULE_0__.ChatGroq({\n            apiKey: groqApiKey,\n            model: process.env.GROQ_MODEL ?? \"llama-3.1-8b-instant\",\n            temperature: 0.7,\n            maxTokens: 4096\n        });\n    } else if (geminiApiKey) {\n        console.log(\"\\uD83E\\uDD16 Using Google Gemini API\");\n        return new _langchain_google_genai__WEBPACK_IMPORTED_MODULE_1__.ChatGoogleGenerativeAI({\n            apiKey: geminiApiKey,\n            model: process.env.GEMINI_MODEL ?? \"gemini-2.5-flash\",\n            temperature: 0.7,\n            maxOutputTokens: 4096\n        });\n    } else if (openRouterApiKey) {\n        console.log(\"\\uD83D\\uDD04 Using OpenRouter API\");\n        const apiBase = process.env.OPENROUTER_API_BASE ?? process.env.OPENAI_API_BASE ?? \"https://openrouter.ai/api/v1\";\n        return new _langchain_openai__WEBPACK_IMPORTED_MODULE_2__.ChatOpenAI({\n            apiKey: openRouterApiKey,\n            configuration: {\n                baseURL: apiBase\n            },\n            model: process.env.OPENAI_MODEL ?? process.env.OPENROUTER_MODEL ?? \"openai/gpt-4o\",\n            temperature: 0.7\n        });\n    } else {\n        throw new Error(\"No API key found. Set GROQ_API_KEY, GEMINI_API_KEY, or OPENROUTER_API_KEY/OPENAI_API_KEY\");\n    }\n}\nlet llm = createLLM();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWdlbnRzL21vZGVsLXByb3ZpZGVycy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBMkM7QUFDc0I7QUFDbEI7QUFFL0Msd0NBQXdDO0FBQ2pDLE1BQU1HLGVBQWUsQ0FBQ0M7SUFDM0IsTUFBTUMsZ0JBQXdDO1FBQzVDLHFCQUFxQjtRQUNyQiw2QkFBNkI7UUFDN0IsZ0NBQWdDO1FBQ2hDLG9CQUFvQjtRQUNwQixrQkFBa0I7SUFDcEI7SUFDQSxPQUFPQSxhQUFhLENBQUNELFFBQVEsSUFBSUE7QUFDbkMsRUFBRTtBQUVGLG1EQUFtRDtBQUM1QyxTQUFTRSxVQUFVQyxLQUFjO0lBQ3RDLGtEQUFrRDtJQUNsRCxJQUFJQSxPQUFPO1FBQ1QsTUFBTUMsYUFBYUMsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO1FBQzNDLE1BQU1DLGVBQWVILFFBQVFDLEdBQUcsQ0FBQ0csY0FBYztRQUMvQyxNQUFNQyxtQkFBbUJMLFFBQVFDLEdBQUcsQ0FBQ0ssa0JBQWtCLElBQUlOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztRQUVyRixJQUFJVCxNQUFNVSxVQUFVLENBQUMsWUFBWVQsWUFBWTtZQUMzQyxNQUFNVSxjQUFjZixhQUFhSTtZQUNqQ1ksUUFBUUMsR0FBRyxDQUFDLHVDQUF1Q0Y7WUFDbkQsT0FBTyxJQUFJbEIscURBQVFBLENBQUM7Z0JBQ2xCcUIsUUFBUWI7Z0JBQ1JELE9BQU9XO2dCQUNQSSxhQUFhO2dCQUNiQyxXQUFXO1lBQ2I7UUFDRixPQUFPLElBQUloQixNQUFNVSxVQUFVLENBQUMsY0FBY0wsY0FBYztZQUN0RCxNQUFNTSxjQUFjZixhQUFhSTtZQUNqQ1ksUUFBUUMsR0FBRyxDQUFDLGlEQUF1Q0Y7WUFDbkQsT0FBTyxJQUFJakIsMkVBQXNCQSxDQUFDO2dCQUNoQ29CLFFBQVFUO2dCQUNSTCxPQUFPVztnQkFDUEksYUFBYTtnQkFDYkUsaUJBQWlCO1lBQ25CO1FBQ0YsT0FBTyxJQUFJVixrQkFBa0I7WUFDM0JLLFFBQVFDLEdBQUcsQ0FBQyw4Q0FBb0NiO1lBQ2hELE1BQU1rQixVQUFVaEIsUUFBUUMsR0FBRyxDQUFDZ0IsbUJBQW1CLElBQUlqQixRQUFRQyxHQUFHLENBQUNpQixlQUFlLElBQUk7WUFDbEYsT0FBTyxJQUFJekIseURBQVVBLENBQUM7Z0JBQ3BCbUIsUUFBUVA7Z0JBQ1JjLGVBQWU7b0JBQ2JDLFNBQVNKO2dCQUNYO2dCQUNBbEIsT0FBT0E7Z0JBQ1BlLGFBQWE7WUFDZjtRQUNGO0lBQ0Y7SUFFQSwrRUFBK0U7SUFDL0UsTUFBTWQsYUFBYUMsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO0lBQzNDLE1BQU1DLGVBQWVILFFBQVFDLEdBQUcsQ0FBQ0csY0FBYztJQUMvQyxNQUFNQyxtQkFBbUJMLFFBQVFDLEdBQUcsQ0FBQ0ssa0JBQWtCLElBQUlOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztJQUVyRixJQUFJUixZQUFZO1FBQ2RXLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU8sSUFBSXBCLHFEQUFRQSxDQUFDO1lBQ2xCcUIsUUFBUWI7WUFDUkQsT0FBT0UsUUFBUUMsR0FBRyxDQUFDb0IsVUFBVSxJQUFJO1lBQ2pDUixhQUFhO1lBQ2JDLFdBQVc7UUFDYjtJQUNGLE9BQU8sSUFBSVgsY0FBYztRQUN2Qk8sUUFBUUMsR0FBRyxDQUFDO1FBQ1osT0FBTyxJQUFJbkIsMkVBQXNCQSxDQUFDO1lBQ2hDb0IsUUFBUVQ7WUFDUkwsT0FBT0UsUUFBUUMsR0FBRyxDQUFDcUIsWUFBWSxJQUFJO1lBQ25DVCxhQUFhO1lBQ2JFLGlCQUFpQjtRQUNuQjtJQUNGLE9BQU8sSUFBSVYsa0JBQWtCO1FBQzNCSyxRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNSyxVQUFVaEIsUUFBUUMsR0FBRyxDQUFDZ0IsbUJBQW1CLElBQUlqQixRQUFRQyxHQUFHLENBQUNpQixlQUFlLElBQUk7UUFDbEYsT0FBTyxJQUFJekIseURBQVVBLENBQUM7WUFDcEJtQixRQUFRUDtZQUNSYyxlQUFlO2dCQUNiQyxTQUFTSjtZQUNYO1lBQ0FsQixPQUFPRSxRQUFRQyxHQUFHLENBQUNzQixZQUFZLElBQUl2QixRQUFRQyxHQUFHLENBQUN1QixnQkFBZ0IsSUFBSTtZQUNuRVgsYUFBYTtRQUNmO0lBQ0YsT0FBTztRQUNMLE1BQU0sSUFBSVksTUFBTTtJQUNsQjtBQUNGO0FBRU8sSUFBSUMsTUFBTTdCLFlBQVkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi9hZ2VudHMvbW9kZWwtcHJvdmlkZXJzLnRzP2U4NzIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhdEdyb3EgfSBmcm9tICdAbGFuZ2NoYWluL2dyb3EnO1xuaW1wb3J0IHsgQ2hhdEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gJ0BsYW5nY2hhaW4vZ29vZ2xlLWdlbmFpJztcbmltcG9ydCB7IENoYXRPcGVuQUkgfSBmcm9tICdAbGFuZ2NoYWluL29wZW5haSc7XG5cbi8vIE1vZGVsIElEIHRvIGFjdHVhbCBtb2RlbCBuYW1lIG1hcHBpbmdcbmV4cG9ydCBjb25zdCBnZXRNb2RlbE5hbWUgPSAobW9kZWxJZDogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgbW9kZWxNYXBwaW5nczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAnZ3JvcS1taXh0cmFsLTh4N2InOiAnbWl4dHJhbC04eDdiLTMyNzY4JyxcbiAgICAnZ3JvcS1sbGFtYS0zLjEtOGItaW5zdGFudCc6ICdsbGFtYS0zLjEtOGItaW5zdGFudCcsXG4gICAgJ2dyb3EtbGxhbWEtMy4zLTcwYi12ZXJzYXRpbGUnOiAnbGxhbWEtMy4zLTcwYi12ZXJzYXRpbGUnLFxuICAgICdnZW1pbmktMi41LWZsYXNoJzogJ2dlbWluaS0yLjUtZmxhc2gnLFxuICAgICdnZW1pbmktMi41LXBybyc6ICdnZW1pbmktMi41LXBybycsXG4gIH07XG4gIHJldHVybiBtb2RlbE1hcHBpbmdzW21vZGVsSWRdIHx8IG1vZGVsSWQ7XG59O1xuXG4vLyBJbml0aWFsaXplIHRoZSBMTE0gbW9kZWwgd2l0aCBwcm92aWRlciBzZWxlY3Rpb25cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMTE0obW9kZWw/OiBzdHJpbmcpIHtcbiAgLy8gSWYgYSBzcGVjaWZpYyBtb2RlbCBpcyByZXF1ZXN0ZWQsIHRyeSB0byB1c2UgaXRcbiAgaWYgKG1vZGVsKSB7XG4gICAgY29uc3QgZ3JvcUFwaUtleSA9IHByb2Nlc3MuZW52LkdST1FfQVBJX0tFWTtcbiAgICBjb25zdCBnZW1pbmlBcGlLZXkgPSBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWTtcbiAgICBjb25zdCBvcGVuUm91dGVyQXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZO1xuXG4gICAgaWYgKG1vZGVsLnN0YXJ0c1dpdGgoJ2dyb3EtJykgJiYgZ3JvcUFwaUtleSkge1xuICAgICAgY29uc3QgYWN0dWFsTW9kZWwgPSBnZXRNb2RlbE5hbWUobW9kZWwpO1xuICAgICAgY29uc29sZS5sb2coJ+KaoSBVc2luZyBHcm9xIEFQSSAoRmFzdGVzdCkgLSBNb2RlbDonLCBhY3R1YWxNb2RlbCk7XG4gICAgICByZXR1cm4gbmV3IENoYXRHcm9xKHtcbiAgICAgICAgYXBpS2V5OiBncm9xQXBpS2V5LFxuICAgICAgICBtb2RlbDogYWN0dWFsTW9kZWwsXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgIG1heFRva2VuczogNDA5NixcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAobW9kZWwuc3RhcnRzV2l0aCgnZ2VtaW5pLScpICYmIGdlbWluaUFwaUtleSkge1xuICAgICAgY29uc3QgYWN0dWFsTW9kZWwgPSBnZXRNb2RlbE5hbWUobW9kZWwpO1xuICAgICAgY29uc29sZS5sb2coJ/CfpJYgVXNpbmcgR29vZ2xlIEdlbWluaSBBUEkgLSBNb2RlbDonLCBhY3R1YWxNb2RlbCk7XG4gICAgICByZXR1cm4gbmV3IENoYXRHb29nbGVHZW5lcmF0aXZlQUkoe1xuICAgICAgICBhcGlLZXk6IGdlbWluaUFwaUtleSxcbiAgICAgICAgbW9kZWw6IGFjdHVhbE1vZGVsLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDQwOTYsXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKG9wZW5Sb3V0ZXJBcGlLZXkpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIFVzaW5nIE9wZW5Sb3V0ZXIgQVBJIC0gTW9kZWw6JywgbW9kZWwpO1xuICAgICAgY29uc3QgYXBpQmFzZSA9IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfQVBJX0JBU0UgPz8gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9CQVNFID8/ICdodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxJztcbiAgICAgIHJldHVybiBuZXcgQ2hhdE9wZW5BSSh7XG4gICAgICAgIGFwaUtleTogb3BlblJvdXRlckFwaUtleSxcbiAgICAgICAgY29uZmlndXJhdGlvbjoge1xuICAgICAgICAgIGJhc2VVUkw6IGFwaUJhc2UsXG4gICAgICAgIH0sXG4gICAgICAgIG1vZGVsOiBtb2RlbCxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIERlZmF1bHQgcHJpb3JpdHk6IEdyb3EgKGZhc3Rlc3QpIOKGkiBHZW1pbmkgKHJlbGlhYmxlKSDihpIgT3BlblJvdXRlciAoZmFsbGJhY2spXG4gIGNvbnN0IGdyb3FBcGlLZXkgPSBwcm9jZXNzLmVudi5HUk9RX0FQSV9LRVk7XG4gIGNvbnN0IGdlbWluaUFwaUtleSA9IHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZO1xuICBjb25zdCBvcGVuUm91dGVyQXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZO1xuXG4gIGlmIChncm9xQXBpS2V5KSB7XG4gICAgY29uc29sZS5sb2coJ+KaoSBVc2luZyBHcm9xIEFQSSAoRmFzdGVzdCknKTtcbiAgICByZXR1cm4gbmV3IENoYXRHcm9xKHtcbiAgICAgIGFwaUtleTogZ3JvcUFwaUtleSxcbiAgICAgIG1vZGVsOiBwcm9jZXNzLmVudi5HUk9RX01PREVMID8/ICdsbGFtYS0zLjEtOGItaW5zdGFudCcsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgbWF4VG9rZW5zOiA0MDk2LFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKGdlbWluaUFwaUtleSkge1xuICAgIGNvbnNvbGUubG9nKCfwn6SWIFVzaW5nIEdvb2dsZSBHZW1pbmkgQVBJJyk7XG4gICAgcmV0dXJuIG5ldyBDaGF0R29vZ2xlR2VuZXJhdGl2ZUFJKHtcbiAgICAgIGFwaUtleTogZ2VtaW5pQXBpS2V5LFxuICAgICAgbW9kZWw6IHByb2Nlc3MuZW52LkdFTUlOSV9NT0RFTCA/PyAnZ2VtaW5pLTIuNS1mbGFzaCcsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgbWF4T3V0cHV0VG9rZW5zOiA0MDk2LFxuICAgIH0pO1xuICB9IGVsc2UgaWYgKG9wZW5Sb3V0ZXJBcGlLZXkpIHtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBVc2luZyBPcGVuUm91dGVyIEFQSScpO1xuICAgIGNvbnN0IGFwaUJhc2UgPSBwcm9jZXNzLmVudi5PUEVOUk9VVEVSX0FQSV9CQVNFID8/IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfQkFTRSA/PyAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MSc7XG4gICAgcmV0dXJuIG5ldyBDaGF0T3BlbkFJKHtcbiAgICAgIGFwaUtleTogb3BlblJvdXRlckFwaUtleSxcbiAgICAgIGNvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgYmFzZVVSTDogYXBpQmFzZSxcbiAgICAgIH0sXG4gICAgICBtb2RlbDogcHJvY2Vzcy5lbnYuT1BFTkFJX01PREVMID8/IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfTU9ERUwgPz8gJ29wZW5haS9ncHQtNG8nLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEFQSSBrZXkgZm91bmQuIFNldCBHUk9RX0FQSV9LRVksIEdFTUlOSV9BUElfS0VZLCBvciBPUEVOUk9VVEVSX0FQSV9LRVkvT1BFTkFJX0FQSV9LRVknKTtcbiAgfVxufVxuXG5leHBvcnQgbGV0IGxsbSA9IGNyZWF0ZUxMTSgpOyJdLCJuYW1lcyI6WyJDaGF0R3JvcSIsIkNoYXRHb29nbGVHZW5lcmF0aXZlQUkiLCJDaGF0T3BlbkFJIiwiZ2V0TW9kZWxOYW1lIiwibW9kZWxJZCIsIm1vZGVsTWFwcGluZ3MiLCJjcmVhdGVMTE0iLCJtb2RlbCIsImdyb3FBcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiR1JPUV9BUElfS0VZIiwiZ2VtaW5pQXBpS2V5IiwiR0VNSU5JX0FQSV9LRVkiLCJvcGVuUm91dGVyQXBpS2V5IiwiT1BFTlJPVVRFUl9BUElfS0VZIiwiT1BFTkFJX0FQSV9LRVkiLCJzdGFydHNXaXRoIiwiYWN0dWFsTW9kZWwiLCJjb25zb2xlIiwibG9nIiwiYXBpS2V5IiwidGVtcGVyYXR1cmUiLCJtYXhUb2tlbnMiLCJtYXhPdXRwdXRUb2tlbnMiLCJhcGlCYXNlIiwiT1BFTlJPVVRFUl9BUElfQkFTRSIsIk9QRU5BSV9BUElfQkFTRSIsImNvbmZpZ3VyYXRpb24iLCJiYXNlVVJMIiwiR1JPUV9NT0RFTCIsIkdFTUlOSV9NT0RFTCIsIk9QRU5BSV9NT0RFTCIsIk9QRU5ST1VURVJfTU9ERUwiLCJFcnJvciIsImxsbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/model-providers.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/streaming-agents.ts":
/*!****************************************!*\
  !*** ./lib/agents/streaming-agents.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   setEmitFunction: () => (/* binding */ setEmitFunction),\n/* harmony export */   shouldContinue: () => (/* binding */ shouldContinue),\n/* harmony export */   streamingCodeGeneratorAgent: () => (/* binding */ streamingCodeGeneratorAgent),\n/* harmony export */   streamingFixerAgent: () => (/* binding */ streamingFixerAgent),\n/* harmony export */   streamingPlannerAgent: () => (/* binding */ streamingPlannerAgent),\n/* harmony export */   streamingReviewerAgent: () => (/* binding */ streamingReviewerAgent)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n/* harmony import */ var _utils_prompt_optimizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/prompt-optimizer */ \"(rsc)/./lib/utils/prompt-optimizer.ts\");\n/* harmony import */ var _utils_summarizer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/summarizer */ \"(rsc)/./lib/utils/summarizer.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _model_providers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./model-providers */ \"(rsc)/./lib/agents/model-providers.ts\");\n/* harmony import */ var _tools__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tools */ \"(rsc)/./lib/agents/tools.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n// Import the emit function from the API route\nlet emitEvent = ()=>{};\nfunction setEmitFunction(fn) {\n    emitEvent = fn;\n}\n// Bind tools to the LLM\nconst llmWithTools = _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools);\n// Helper function to parse generated files from LLM output\nfunction parseGeneratedFiles(content) {\n    const files = {};\n    const fileRegex = /FILENAME:\\s*(.+?)\\n```(\\w+)?\\n([\\s\\S]*?)```/g;\n    let match;\n    while((match = fileRegex.exec(content)) !== null){\n        const filename = match[1].trim();\n        const code = match[3].trim();\n        files[filename] = code;\n    }\n    return files;\n}\n// Streaming Planner Agent: Breaks down user request into actionable steps\nasync function streamingPlannerAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Planning your request...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    // Add user request to memory\n    await memory.addMessage(\"user\", state.userRequest);\n    // Get compressed context from memory\n    const contextSummary = await memory.getCompressedContext(state.userRequest);\n    const sessionFiles = await memory.getSessionFiles();\n    // Check if there are existing files - if so, this is a modification request\n    const hasExistingFiles = Object.keys(state.generatedFiles).length > 0 || sessionFiles.length > 0;\n    let systemPrompt = `You are a senior software architect. Analyze the user's request and create a clear plan.\n\n${hasExistingFiles ? `\nIMPORTANT: There are EXISTING FILES in this session. The user wants to MODIFY or ENHANCE them.\nSession files: ${sessionFiles.length > 0 ? sessionFiles.join(\", \") : \"None\"}\nCurrent state files: ${Object.keys(state.generatedFiles).join(\", \")}\n\nYour plan should focus on MODIFYING these existing files, not creating new random files.\n` : `\nThis is a NEW project. Create a plan to build it from scratch.\n`}\n\n${contextSummary ? `\\nRECENT CONTEXT:\\n${(0,_utils_summarizer__WEBPACK_IMPORTED_MODULE_2__.smartTruncate)(contextSummary, 800)}` : \"\"}\n\nOUTPUT FORMAT: Just numbered steps like:\n1. Create/Modify [specific file] - [what to do]\n2. Update [specific file] - [what to change]\n3. Add [feature] to [file]\n\nRULES:\n- Maximum 5 steps\n- Be SPECIFIC about which files to create/modify\n- If modifying, say \"Modify\" or \"Update\", not \"Create\"\n- Each step should produce tangible code\n- Keep it simple and actionable`;\n    // Optimize the system prompt\n    systemPrompt = _utils_prompt_optimizer__WEBPACK_IMPORTED_MODULE_1__.promptOptimizer.optimizeSystemPrompt(systemPrompt, contextSummary || undefined);\n    let contextInfo = `User request: ${state.userRequest}`;\n    if (hasExistingFiles) {\n        const allFiles = Array.from(new Set([\n            ...sessionFiles,\n            ...Object.keys(state.generatedFiles)\n        ]));\n        contextInfo += `\\n\\nEXISTING PROJECT FILES:\\n${allFiles.map((f)=>`- ${f}`).join(\"\\n\")}`;\n        contextInfo += `\\n\\nThe user wants to modify/enhance the existing project. Create a plan that works WITH these files.`;\n    }\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(contextInfo)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llm\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm;\n    const response = await llmToUse.invoke(messages);\n    const planText = response.content.toString();\n    // Add plan to memory\n    await memory.addMessage(\"assistant\", `Planning: ${planText.substring(0, 200)}...`);\n    // Parse the plan into steps\n    const planSteps = planText.split(\"\\n\").filter((line)=>/^\\d+\\./.test(line.trim())).map((line)=>line.replace(/^\\d+\\.\\s*/, \"\").trim()).filter((step)=>step.length > 0).slice(0, 5); // Limit to 5 steps\n    console.log(`📋 Generated plan with ${planSteps.length} steps:`, planSteps);\n    // Emit plan to client\n    emitEvent(sessionId || \"\", {\n        type: \"plan\",\n        plan: planSteps\n    });\n    return {\n        plan: planSteps,\n        messages: [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Planning completed. Created ${planSteps.length} steps to implement your request.`)\n        ]\n    };\n}\n// Streaming Code Generator Agent: Implements each step of the plan\nasync function streamingCodeGeneratorAgent(state, sessionId, model) {\n    const currentStep = state.currentIteration;\n    const stepToImplement = state.plan[currentStep];\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: `Generating code for step ${currentStep + 1}: ${stepToImplement?.substring(0, 50)}...`\n    });\n    if (!stepToImplement) {\n        console.log(\"⚠️  No step to implement at iteration\", currentStep);\n        return {\n            isComplete: true\n        };\n    }\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const contextSummary = await memory.getCompressedContext(state.userRequest);\n    const sessionFiles = await memory.getSessionFiles();\n    // Get existing files for context\n    const existingFiles = {\n        ...state.generatedFiles\n    };\n    for (const file of sessionFiles){\n        try {\n            const content = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23)).then((fs)=>fs.readFileSync(file, \"utf-8\"));\n            existingFiles[file] = content;\n        } catch (error) {\n            console.warn(`Could not read existing file ${file}:`, error);\n        }\n    }\n    const systemPrompt = `You are an expert software engineer. Implement the specified step using the available tools.\n\nIMPORTANT RULES:\n- Use the provided tools to create/modify files\n- Each tool call should be purposeful and targeted\n- Read existing files first to understand the current state\n- Make incremental, testable changes\n- Include proper imports and dependencies\n- Follow the existing code style and patterns\n- Test your changes by reading the files back\n\n${contextSummary ? `CONTEXT:\\n${(0,_utils_summarizer__WEBPACK_IMPORTED_MODULE_2__.smartTruncate)(contextSummary, 600)}\\n\\n` : \"\"}\n\nAVAILABLE TOOLS:\n- read_file: Read existing files\n- write_file: Create new files or replace entire files\n- append_to_file: Add content to existing files\n- replace_in_file: Find and replace text patterns\n- insert_at_line: Insert content at specific line numbers\n- replace_block: Replace content between markers\n- replace_line_range: Replace specific line ranges\n- search_files: Find code patterns across files\n- execute_command: Run shell commands (npm, git, etc.)\n\nOUTPUT FORMAT:\nChain of Thought: [Your reasoning process]\nFiles: [List of files you'll create/modify]\n[Then use the appropriate tools to implement the changes]\n\nTOOL USAGE:\n- Use tools by calling them directly in your response\n- Each tool call should be a separate function call with proper JSON arguments\n- Tools will automatically execute and provide results\n- Format: Call tools like normal function calls with the tool name and arguments\n- Example: write_file({ \"filePath\": \"index.html\", \"content\": \"<html>...</html>\" })`;\n    const userPrompt = `Implement this step: \"${stepToImplement}\"\n\nExisting project files: ${Object.keys(existingFiles).join(\", \") || \"None\"}\n\n${state.reviewFeedback ? `Previous review feedback to address: ${state.reviewFeedback}` : \"\"}`;\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(userPrompt)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llmWithTools\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm;\n    const llmWithToolsToUse = model ? llmToUse.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools) : llmWithTools;\n    const response = await llmWithToolsToUse.invoke(messages);\n    // Extract generated files from tool calls or response content\n    const generatedFiles = {};\n    let chainOfThought = \"\";\n    if (response.tool_calls && response.tool_calls.length > 0) {\n        for (const toolCall of response.tool_calls){\n            console.log(`🔧 Tool called: ${toolCall.name}`, toolCall.args);\n            if (toolCall.name === \"write_file\" || toolCall.name === \"append_to_file\") {\n                try {\n                    const args = toolCall.args;\n                    if (args.filePath && args.content) {\n                        generatedFiles[args.filePath] = args.content;\n                    }\n                } catch (error) {\n                    console.warn(\"Could not parse tool call arguments:\", error);\n                }\n            }\n        }\n        console.log(`📊 Processed ${response.tool_calls.length} tool calls`);\n    } else {\n        // Fallback: parse files from response content\n        const newFiles = parseGeneratedFiles(response.content.toString());\n        Object.assign(generatedFiles, newFiles);\n    }\n    // Extract chain of thought from response\n    const content = response.content.toString();\n    const cotMatch = content.match(/Chain of Thought:\\s*([\\s\\S]*?)(?=Files:|FILENAME:|$)/i);\n    if (cotMatch) {\n        chainOfThought = cotMatch[1].trim();\n    }\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Step ${currentStep + 1}: ${chainOfThought.substring(0, 200)}...`);\n    // Emit real-time updates\n    if (chainOfThought) {\n        console.log(`🔍 Real-time COT Step ${currentStep + 1}: ${chainOfThought.substring(0, 100)}...`);\n        emitEvent(sessionId || \"\", {\n            type: \"chain_of_thought\",\n            step: currentStep + 1,\n            reasoning: chainOfThought\n        });\n    }\n    if (Object.keys(generatedFiles).length > 0) {\n        const files = Object.keys(generatedFiles);\n        console.log(`📁 Real-time Files Generated: ${files.join(\", \")}`);\n        emitEvent(sessionId || \"\", {\n            type: \"files_generated\",\n            files: files,\n            step: currentStep + 1\n        });\n    }\n    return {\n        generatedFiles,\n        currentIteration: currentStep + 1,\n        messages: [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Step ${currentStep + 1} completed. ${Object.keys(generatedFiles).length} files updated.`)\n        ]\n    };\n}\n// Streaming Reviewer Agent: Reviews the generated code for quality and completeness\nasync function streamingReviewerAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Reviewing generated code...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const allFiles = {\n        ...state.generatedFiles\n    };\n    // Read current state of all files - try multiple resolution strategies\n    // 1) If filePath is absolute or exists under project folder, use it\n    // 2) Otherwise try to find a matching basename in session files tracked in memory\n    // 3) Fallback to the content already present in state.generatedFiles\n    const sessionFiles = await memory.getSessionFiles();\n    for (const filePath of Object.keys(allFiles)){\n        try {\n            const fs = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n            const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getProjectFolder)();\n            // Candidate 1: absolute path or projectFolder + filePath\n            const candidate = path__WEBPACK_IMPORTED_MODULE_6__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_6__.join(projectFolder, filePath);\n            if (fs.existsSync(candidate)) {\n                allFiles[filePath] = fs.readFileSync(candidate, \"utf-8\");\n                continue;\n            }\n            // Candidate 2: look up by basename in sessionFiles recorded in memory\n            const base = path__WEBPACK_IMPORTED_MODULE_6__.basename(filePath);\n            const match = sessionFiles.find((f)=>path__WEBPACK_IMPORTED_MODULE_6__.basename(f) === base);\n            if (match && fs.existsSync(match)) {\n                allFiles[filePath] = fs.readFileSync(match, \"utf-8\");\n                continue;\n            }\n            // Candidate 3: attempt a recursive scan under project folder for a matching basename (best-effort)\n            let found = null;\n            try {\n                const walk = (dir)=>{\n                    const entries = fs.readdirSync(dir, {\n                        withFileTypes: true\n                    });\n                    for (const ent of entries){\n                        const p = path__WEBPACK_IMPORTED_MODULE_6__.join(dir, ent.name);\n                        if (ent.isDirectory()) {\n                            walk(p);\n                            if (found) return;\n                        } else if (ent.isFile() && path__WEBPACK_IMPORTED_MODULE_6__.basename(p) === base) {\n                            found = p;\n                            return;\n                        }\n                    }\n                };\n                if (fs.existsSync(projectFolder)) walk(projectFolder);\n            } catch (err) {\n            // ignore scanning errors\n            }\n            if (found && fs.existsSync(found)) {\n                allFiles[filePath] = fs.readFileSync(found, \"utf-8\");\n                continue;\n            }\n            // If none of the above succeeded, leave the content as-is and warn\n            console.warn(`Could not locate file ${filePath} under project folder; using in-memory content if available.`);\n        } catch (error) {\n            console.warn(`Could not read file ${filePath} for review:`, error);\n        }\n    }\n    const systemPrompt = `You are a senior code reviewer. Review the generated code for quality, completeness, and correctness.\n\nEVALUATION CRITERIA:\n- Code quality and best practices\n- Proper imports and dependencies\n- Error handling and edge cases\n- TypeScript types (if applicable)\n- Code organization and readability\n- Completeness of implementation\n- Integration with existing codebase\n\nOUTPUT FORMAT:\nAPPROVED or NEEDS IMPROVEMENT\n\nIf NEEDS IMPROVEMENT, provide specific, actionable feedback.\nIf APPROVED, confirm the implementation is complete and ready.\n\nBe constructive and specific in your feedback.`;\n    const codeSummary = Object.entries(allFiles).map(([file, content])=>`=== ${file} ===\\n${content.substring(0, 500)}${content.length > 500 ? \"\\n... (truncated)\" : \"\"}`).join(\"\\n\\n\");\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Review the following generated code:\\n\\n${codeSummary}`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llm\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm;\n    const response = await llmToUse.invoke(messages);\n    const feedback = response.content.toString().trim();\n    const isApproved = feedback.toUpperCase().includes(\"APPROVED\") && !feedback.toLowerCase().includes(\"missing\") && !feedback.toLowerCase().includes(\"not implemented\");\n    console.log(`🔍 Review result: ${isApproved ? \"APPROVED\" : \"NEEDS IMPROVEMENT\"}`);\n    console.log(`📝 Feedback: ${feedback.substring(0, 100)}...`);\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Review: ${feedback.substring(0, 200)}...`);\n    // Emit review results\n    emitEvent(sessionId || \"\", {\n        type: \"review\",\n        feedback: feedback\n    });\n    if (isApproved) {\n        emitEvent(sessionId || \"\", {\n            type: \"complete\",\n            message: \"Code generation completed successfully!\"\n        });\n    }\n    return {\n        reviewFeedback: feedback,\n        isComplete: isApproved,\n        reviewIterations: (state.reviewIterations || 0) + 1\n    };\n}\n// Streaming Fixer Agent: Addresses review feedback by fixing issues\nasync function streamingFixerAgent(state, sessionId, model) {\n    emitEvent(sessionId || \"\", {\n        type: \"status\",\n        message: \"Fixing issues based on review...\"\n    });\n    const memory = (0,_utils__WEBPACK_IMPORTED_MODULE_3__.getMemory)();\n    const contextSummary = await memory.getCompressedContext(state.userRequest);\n    const systemPrompt = `You are an expert software engineer. Fix the issues identified in the review feedback.\n\nINSTRUCTIONS:\n- Address each point in the review feedback\n- Make targeted fixes using the available tools\n- Test your changes by reading files back\n- Ensure the fixes are complete and correct\n- Maintain code quality and consistency\n\n${contextSummary ? `CONTEXT:\\n${(0,_utils_summarizer__WEBPACK_IMPORTED_MODULE_2__.smartTruncate)(contextSummary, 400)}\\n\\n` : \"\"}\n\nUse the same tools as before to implement fixes.`;\n    const messages = [\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.SystemMessage(systemPrompt),\n        new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.HumanMessage(`Review feedback to address: ${state.reviewFeedback}\n\nCurrent files: ${Object.keys(state.generatedFiles).join(\", \")}\n\nPlease fix the identified issues.`)\n    ];\n    // Use model-specific LLM if provided, otherwise use global llmWithTools\n    const llmToUse = model ? (0,_model_providers__WEBPACK_IMPORTED_MODULE_4__.createLLM)(model) : _model_providers__WEBPACK_IMPORTED_MODULE_4__.llm;\n    const llmWithToolsToUse = model ? llmToUse.bindTools(_tools__WEBPACK_IMPORTED_MODULE_5__.tools) : llmWithTools;\n    const response = await llmWithToolsToUse.invoke(messages);\n    // Extract fixed files from tool calls or response content\n    const generatedFiles = {};\n    if (response.tool_calls && response.tool_calls.length > 0) {\n        for (const toolCall of response.tool_calls){\n            console.log(`🔧 Tool called: ${toolCall.name}`, toolCall.args);\n            if (toolCall.name === \"write_file\" || toolCall.name === \"append_to_file\") {\n                try {\n                    const args = toolCall.args;\n                    if (args.filePath && args.content) {\n                        generatedFiles[args.filePath] = args.content;\n                    }\n                } catch (error) {\n                    console.warn(\"Could not parse tool call arguments:\", error);\n                }\n            }\n        }\n    } else {\n        // Fallback: parse files from response content\n        const fixedFiles = parseGeneratedFiles(response.content.toString());\n        Object.assign(generatedFiles, fixedFiles);\n    }\n    // Add to memory\n    await memory.addMessage(\"assistant\", `Fixed issues based on review feedback. Updated ${Object.keys(generatedFiles).length} files.`);\n    // Emit fixes\n    if (Object.keys(generatedFiles).length > 0) {\n        const files = Object.keys(generatedFiles);\n        console.log(`🔧 Real-time Fixes Applied: ${files.join(\", \")}`);\n        emitEvent(sessionId || \"\", {\n            type: \"files_fixed\",\n            files: files\n        });\n    }\n    return {\n        generatedFiles,\n        currentIteration: 0,\n        messages: [\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_0__.AIMessage(`Applied fixes for review feedback. ${Object.keys(generatedFiles).length} files updated.`)\n        ]\n    };\n}\n// Helper function to determine if we should continue the workflow\nfunction shouldContinue(state) {\n    // If marked complete, we're done\n    if (state.isComplete) {\n        return \"end\";\n    }\n    // Start with planning if no plan exists\n    if (state.plan.length === 0) {\n        return \"planner\";\n    }\n    // If we haven't finished all steps, continue generating\n    if (state.currentIteration < state.plan.length) {\n        return \"generator\";\n    }\n    // All steps completed, need review\n    if (!state.reviewFeedback) {\n        return \"reviewer\";\n    }\n    // Review feedback exists - check if approved\n    const feedback = state.reviewFeedback.toUpperCase();\n    const isApproved = feedback.includes(\"APPROVED\") && !feedback.toLowerCase().includes(\"missing\") && !feedback.toLowerCase().includes(\"not implemented\");\n    if (isApproved) {\n        // Approved - we're done!\n        return \"end\";\n    }\n    // Not approved - check if we can retry\n    const reviewIter = state.reviewIterations || 0;\n    if (reviewIter >= 3) {\n        // Max iterations reached, force end\n        console.log(\"⚠️  Max review iterations reached in router, ending\");\n        return \"end\";\n    }\n    // Not approved and can retry - go back to executor to fix issues\n    console.log(`🔄 Review not approved (iteration ${reviewIter}), retrying executor to fix issues`);\n    // Reset current iteration to re-execute all steps with feedback\n    return \"fix_issues\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWdlbnRzL3N0cmVhbWluZy1hZ2VudHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFFbkM7QUFDZ0U7QUFDdEU7QUFDSDtBQUNFO0FBRXhCO0FBRTdCLDhDQUE4QztBQUM5QyxJQUFJVyxZQUFvRCxLQUFPO0FBQ3hELFNBQVNDLGdCQUFnQkMsRUFBMEM7SUFDeEVGLFlBQVlFO0FBQ2Q7QUFFQSx3QkFBd0I7QUFDeEIsTUFBTUMsZUFBZVAsaURBQUdBLENBQUNRLFNBQVMsQ0FBQ04seUNBQUtBO0FBRXhDLDJEQUEyRDtBQUMzRCxTQUFTTyxvQkFBb0JDLE9BQWU7SUFDMUMsTUFBTUMsUUFBZ0MsQ0FBQztJQUN2QyxNQUFNQyxZQUFZO0lBRWxCLElBQUlDO0lBQ0osTUFBTyxDQUFDQSxRQUFRRCxVQUFVRSxJQUFJLENBQUNKLFFBQU8sTUFBTyxLQUFNO1FBQ2pELE1BQU1LLFdBQVdGLEtBQUssQ0FBQyxFQUFFLENBQUNHLElBQUk7UUFDOUIsTUFBTUMsT0FBT0osS0FBSyxDQUFDLEVBQUUsQ0FBQ0csSUFBSTtRQUMxQkwsS0FBSyxDQUFDSSxTQUFTLEdBQUdFO0lBQ3BCO0lBRUEsT0FBT047QUFDVDtBQUVBLDBFQUEwRTtBQUNuRSxlQUFlTyxzQkFBc0JDLEtBQXFCLEVBQUVDLFNBQWtCLEVBQUVDLEtBQWM7SUFDbkdqQixVQUFVZ0IsYUFBYSxJQUFJO1FBQUVFLE1BQU07UUFBVUMsU0FBUztJQUEyQjtJQUVqRixNQUFNQyxTQUFTMUIsaURBQVNBO0lBRXhCLDZCQUE2QjtJQUM3QixNQUFNMEIsT0FBT0MsVUFBVSxDQUFDLFFBQVFOLE1BQU1PLFdBQVc7SUFFakQscUNBQXFDO0lBQ3JDLE1BQU1DLGlCQUFpQixNQUFNSCxPQUFPSSxvQkFBb0IsQ0FBQ1QsTUFBTU8sV0FBVztJQUMxRSxNQUFNRyxlQUFlLE1BQU1MLE9BQU9NLGVBQWU7SUFFakQsNEVBQTRFO0lBQzVFLE1BQU1DLG1CQUFtQkMsT0FBT0MsSUFBSSxDQUFDZCxNQUFNZSxjQUFjLEVBQUVDLE1BQU0sR0FBRyxLQUFLTixhQUFhTSxNQUFNLEdBQUc7SUFFL0YsSUFBSUMsZUFBZSxDQUFDOztBQUV0QixFQUFFTCxtQkFBbUIsQ0FBQzs7ZUFFUCxFQUFFRixhQUFhTSxNQUFNLEdBQUcsSUFBSU4sYUFBYVEsSUFBSSxDQUFDLFFBQVEsT0FBTztxQkFDdkQsRUFBRUwsT0FBT0MsSUFBSSxDQUFDZCxNQUFNZSxjQUFjLEVBQUVHLElBQUksQ0FBQyxNQUFNOzs7QUFHcEUsQ0FBQyxHQUFHLENBQUM7O0FBRUwsQ0FBQyxDQUFDOztBQUVGLEVBQUVWLGlCQUFpQixDQUFDLG1CQUFtQixFQUFFOUIsZ0VBQWFBLENBQUM4QixnQkFBZ0IsS0FBSyxDQUFDLEdBQUcsR0FBRzs7Ozs7Ozs7Ozs7OytCQVlwRCxDQUFDO0lBRTlCLDZCQUE2QjtJQUM3QlMsZUFBZXhDLG9FQUFlQSxDQUFDMEMsb0JBQW9CLENBQUNGLGNBQWNULGtCQUFrQlk7SUFFcEYsSUFBSUMsY0FBYyxDQUFDLGNBQWMsRUFBRXJCLE1BQU1PLFdBQVcsQ0FBQyxDQUFDO0lBRXRELElBQUlLLGtCQUFrQjtRQUNwQixNQUFNVSxXQUFXQyxNQUFNQyxJQUFJLENBQUMsSUFBSUMsSUFBSTtlQUFJZjtlQUFpQkcsT0FBT0MsSUFBSSxDQUFDZCxNQUFNZSxjQUFjO1NBQUU7UUFDM0ZNLGVBQWUsQ0FBQyw2QkFBNkIsRUFBRUMsU0FBU0ksR0FBRyxDQUFDQyxDQUFBQSxJQUFLLENBQUMsRUFBRSxFQUFFQSxFQUFFLENBQUMsRUFBRVQsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUN2RkcsZUFBZSxDQUFDLHFHQUFxRyxDQUFDO0lBQ3hIO0lBRUEsTUFBTU8sV0FBVztRQUNmLElBQUlwRCxtRUFBYUEsQ0FBQ3lDO1FBQ2xCLElBQUkzQyxrRUFBWUEsQ0FBQytDO0tBQ2xCO0lBRUQsK0RBQStEO0lBQy9ELE1BQU1RLFdBQVczQixRQUFRcEIsMkRBQVNBLENBQUNvQixTQUFTckIsaURBQUdBO0lBQy9DLE1BQU1pRCxXQUFXLE1BQU1ELFNBQVNFLE1BQU0sQ0FBQ0g7SUFDdkMsTUFBTUksV0FBV0YsU0FBU3ZDLE9BQU8sQ0FBQzBDLFFBQVE7SUFFMUMscUJBQXFCO0lBQ3JCLE1BQU01QixPQUFPQyxVQUFVLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRTBCLFNBQVNFLFNBQVMsQ0FBQyxHQUFHLEtBQUssR0FBRyxDQUFDO0lBRWpGLDRCQUE0QjtJQUM1QixNQUFNQyxZQUFZSCxTQUNmSSxLQUFLLENBQUMsTUFDTkMsTUFBTSxDQUFDQyxDQUFBQSxPQUFRLFNBQVNDLElBQUksQ0FBQ0QsS0FBS3pDLElBQUksS0FDdEM2QixHQUFHLENBQUNZLENBQUFBLE9BQVFBLEtBQUtFLE9BQU8sQ0FBQyxhQUFhLElBQUkzQyxJQUFJLElBQzlDd0MsTUFBTSxDQUFDSSxDQUFBQSxPQUFRQSxLQUFLekIsTUFBTSxHQUFHLEdBQzdCMEIsS0FBSyxDQUFDLEdBQUcsSUFBSSxtQkFBbUI7SUFFbkNDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixFQUFFVCxVQUFVbkIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFbUI7SUFFakUsc0JBQXNCO0lBQ3RCbEQsVUFBVWdCLGFBQWEsSUFBSTtRQUFFRSxNQUFNO1FBQVEwQyxNQUFNVjtJQUFVO0lBRTNELE9BQU87UUFDTFUsTUFBTVY7UUFDTlAsVUFBVTtZQUFDLElBQUlyRCwrREFBU0EsQ0FBQyxDQUFDLDRCQUE0QixFQUFFNEQsVUFBVW5CLE1BQU0sQ0FBQyxpQ0FBaUMsQ0FBQztTQUFFO0lBQy9HO0FBQ0Y7QUFFQSxtRUFBbUU7QUFDNUQsZUFBZThCLDRCQUE0QjlDLEtBQXFCLEVBQUVDLFNBQWtCLEVBQUVDLEtBQWM7SUFDekcsTUFBTTZDLGNBQWMvQyxNQUFNZ0QsZ0JBQWdCO0lBQzFDLE1BQU1DLGtCQUFrQmpELE1BQU02QyxJQUFJLENBQUNFLFlBQVk7SUFFL0M5RCxVQUFVZ0IsYUFBYSxJQUFJO1FBQ3pCRSxNQUFNO1FBQ05DLFNBQVMsQ0FBQyx5QkFBeUIsRUFBRTJDLGNBQWMsRUFBRSxFQUFFLEVBQUVFLGlCQUFpQmYsVUFBVSxHQUFHLElBQUksR0FBRyxDQUFDO0lBQ2pHO0lBRUEsSUFBSSxDQUFDZSxpQkFBaUI7UUFDcEJOLFFBQVFDLEdBQUcsQ0FBQyx5Q0FBeUNHO1FBQ3JELE9BQU87WUFBRUcsWUFBWTtRQUFLO0lBQzVCO0lBRUEsTUFBTTdDLFNBQVMxQixpREFBU0E7SUFDeEIsTUFBTTZCLGlCQUFpQixNQUFNSCxPQUFPSSxvQkFBb0IsQ0FBQ1QsTUFBTU8sV0FBVztJQUMxRSxNQUFNRyxlQUFlLE1BQU1MLE9BQU9NLGVBQWU7SUFFakQsaUNBQWlDO0lBQ2pDLE1BQU13QyxnQkFBZ0I7UUFBRSxHQUFHbkQsTUFBTWUsY0FBYztJQUFDO0lBQ2hELEtBQUssTUFBTXFDLFFBQVExQyxhQUFjO1FBQy9CLElBQUk7WUFDRixNQUFNbkIsVUFBVSxNQUFNLDBHQUFPLENBQU04RCxJQUFJLENBQUNDLENBQUFBLEtBQU1BLEdBQUdDLFlBQVksQ0FBQ0gsTUFBTTtZQUNwRUQsYUFBYSxDQUFDQyxLQUFLLEdBQUc3RDtRQUN4QixFQUFFLE9BQU9pRSxPQUFPO1lBQ2RiLFFBQVFjLElBQUksQ0FBQyxDQUFDLDZCQUE2QixFQUFFTCxLQUFLLENBQUMsQ0FBQyxFQUFFSTtRQUN4RDtJQUNGO0lBRUEsTUFBTXZDLGVBQWUsQ0FBQzs7Ozs7Ozs7Ozs7QUFXeEIsRUFBRVQsaUJBQWlCLENBQUMsVUFBVSxFQUFFOUIsZ0VBQWFBLENBQUM4QixnQkFBZ0IsS0FBSyxJQUFJLENBQUMsR0FBRyxHQUFHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrRkF1QkksQ0FBQztJQUVqRixNQUFNa0QsYUFBYSxDQUFDLHNCQUFzQixFQUFFVCxnQkFBZ0I7O3dCQUV0QyxFQUFFcEMsT0FBT0MsSUFBSSxDQUFDcUMsZUFBZWpDLElBQUksQ0FBQyxTQUFTLE9BQU87O0FBRTFFLEVBQUVsQixNQUFNMkQsY0FBYyxHQUFHLENBQUMscUNBQXFDLEVBQUUzRCxNQUFNMkQsY0FBYyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7SUFFNUYsTUFBTS9CLFdBQVc7UUFDZixJQUFJcEQsbUVBQWFBLENBQUN5QztRQUNsQixJQUFJM0Msa0VBQVlBLENBQUNvRjtLQUNsQjtJQUVELHdFQUF3RTtJQUN4RSxNQUFNN0IsV0FBVzNCLFFBQVFwQiwyREFBU0EsQ0FBQ29CLFNBQVNyQixpREFBR0E7SUFDL0MsTUFBTStFLG9CQUFvQjFELFFBQVEyQixTQUFTeEMsU0FBUyxDQUFDTix5Q0FBS0EsSUFBSUs7SUFDOUQsTUFBTTBDLFdBQVcsTUFBTThCLGtCQUFrQjdCLE1BQU0sQ0FBQ0g7SUFFaEQsOERBQThEO0lBQzlELE1BQU1iLGlCQUF5QyxDQUFDO0lBQ2hELElBQUk4QyxpQkFBaUI7SUFFckIsSUFBSS9CLFNBQVNnQyxVQUFVLElBQUloQyxTQUFTZ0MsVUFBVSxDQUFDOUMsTUFBTSxHQUFHLEdBQUc7UUFDekQsS0FBSyxNQUFNK0MsWUFBWWpDLFNBQVNnQyxVQUFVLENBQUU7WUFDMUNuQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRW1CLFNBQVNDLElBQUksQ0FBQyxDQUFDLEVBQUVELFNBQVNFLElBQUk7WUFDN0QsSUFBSUYsU0FBU0MsSUFBSSxLQUFLLGdCQUFnQkQsU0FBU0MsSUFBSSxLQUFLLGtCQUFrQjtnQkFDeEUsSUFBSTtvQkFDRixNQUFNQyxPQUFPRixTQUFTRSxJQUFJO29CQUMxQixJQUFJQSxLQUFLQyxRQUFRLElBQUlELEtBQUsxRSxPQUFPLEVBQUU7d0JBQ2pDd0IsY0FBYyxDQUFDa0QsS0FBS0MsUUFBUSxDQUFDLEdBQUdELEtBQUsxRSxPQUFPO29CQUM5QztnQkFDRixFQUFFLE9BQU9pRSxPQUFPO29CQUNkYixRQUFRYyxJQUFJLENBQUMsd0NBQXdDRDtnQkFDdkQ7WUFDRjtRQUNGO1FBQ0FiLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGFBQWEsRUFBRWQsU0FBU2dDLFVBQVUsQ0FBQzlDLE1BQU0sQ0FBQyxXQUFXLENBQUM7SUFDckUsT0FBTztRQUNMLDhDQUE4QztRQUM5QyxNQUFNbUQsV0FBVzdFLG9CQUFvQndDLFNBQVN2QyxPQUFPLENBQUMwQyxRQUFRO1FBQzlEcEIsT0FBT3VELE1BQU0sQ0FBQ3JELGdCQUFnQm9EO0lBQ2hDO0lBRUEseUNBQXlDO0lBQ3pDLE1BQU01RSxVQUFVdUMsU0FBU3ZDLE9BQU8sQ0FBQzBDLFFBQVE7SUFDekMsTUFBTW9DLFdBQVc5RSxRQUFRRyxLQUFLLENBQUM7SUFDL0IsSUFBSTJFLFVBQVU7UUFDWlIsaUJBQWlCUSxRQUFRLENBQUMsRUFBRSxDQUFDeEUsSUFBSTtJQUNuQztJQUVBLGdCQUFnQjtJQUNoQixNQUFNUSxPQUFPQyxVQUFVLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRXlDLGNBQWMsRUFBRSxFQUFFLEVBQUVjLGVBQWUzQixTQUFTLENBQUMsR0FBRyxLQUFLLEdBQUcsQ0FBQztJQUV0Ryx5QkFBeUI7SUFDekIsSUFBSTJCLGdCQUFnQjtRQUNsQmxCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHNCQUFzQixFQUFFRyxjQUFjLEVBQUUsRUFBRSxFQUFFYyxlQUFlM0IsU0FBUyxDQUFDLEdBQUcsS0FBSyxHQUFHLENBQUM7UUFDOUZqRCxVQUFVZ0IsYUFBYSxJQUFJO1lBQ3pCRSxNQUFNO1lBQ05zQyxNQUFNTSxjQUFjO1lBQ3BCdUIsV0FBV1Q7UUFDYjtJQUNGO0lBRUEsSUFBSWhELE9BQU9DLElBQUksQ0FBQ0MsZ0JBQWdCQyxNQUFNLEdBQUcsR0FBRztRQUMxQyxNQUFNeEIsUUFBUXFCLE9BQU9DLElBQUksQ0FBQ0M7UUFDMUI0QixRQUFRQyxHQUFHLENBQUMsQ0FBQyw4QkFBOEIsRUFBRXBELE1BQU0wQixJQUFJLENBQUMsTUFBTSxDQUFDO1FBQy9EakMsVUFBVWdCLGFBQWEsSUFBSTtZQUN6QkUsTUFBTTtZQUNOWCxPQUFPQTtZQUNQaUQsTUFBTU0sY0FBYztRQUN0QjtJQUNGO0lBRUEsT0FBTztRQUNMaEM7UUFDQWlDLGtCQUFrQkQsY0FBYztRQUNoQ25CLFVBQVU7WUFBQyxJQUFJckQsK0RBQVNBLENBQUMsQ0FBQyxLQUFLLEVBQUV3RSxjQUFjLEVBQUUsWUFBWSxFQUFFbEMsT0FBT0MsSUFBSSxDQUFDQyxnQkFBZ0JDLE1BQU0sQ0FBQyxlQUFlLENBQUM7U0FBRTtJQUN0SDtBQUNGO0FBRUEsb0ZBQW9GO0FBQzdFLGVBQWV1RCx1QkFBdUJ2RSxLQUFxQixFQUFFQyxTQUFrQixFQUFFQyxLQUFjO0lBQ3BHakIsVUFBVWdCLGFBQWEsSUFBSTtRQUFFRSxNQUFNO1FBQVVDLFNBQVM7SUFBOEI7SUFFcEYsTUFBTUMsU0FBUzFCLGlEQUFTQTtJQUN4QixNQUFNMkMsV0FBVztRQUFFLEdBQUd0QixNQUFNZSxjQUFjO0lBQUM7SUFFM0MsdUVBQXVFO0lBQ3ZFLG9FQUFvRTtJQUNwRSxrRkFBa0Y7SUFDbEYscUVBQXFFO0lBQ3JFLE1BQU1MLGVBQWUsTUFBTUwsT0FBT00sZUFBZTtJQUNqRCxLQUFLLE1BQU11RCxZQUFZckQsT0FBT0MsSUFBSSxDQUFDUSxVQUFXO1FBQzVDLElBQUk7WUFDRixNQUFNZ0MsS0FBSyxNQUFNLDBHQUFPO1lBQ3hCLE1BQU1rQixnQkFBZ0I1Rix3REFBZ0JBO1lBRXRDLHlEQUF5RDtZQUN6RCxNQUFNNkYsWUFBWXpGLDRDQUFlLENBQUNrRixZQUFZQSxXQUFXbEYsc0NBQVMsQ0FBQ3dGLGVBQWVOO1lBQ2xGLElBQUlaLEdBQUdxQixVQUFVLENBQUNGLFlBQVk7Z0JBQzVCbkQsUUFBUSxDQUFDNEMsU0FBUyxHQUFHWixHQUFHQyxZQUFZLENBQUNrQixXQUFXO2dCQUNoRDtZQUNGO1lBRUEsc0VBQXNFO1lBQ3RFLE1BQU1HLE9BQU81RiwwQ0FBYSxDQUFDa0Y7WUFDM0IsTUFBTXhFLFFBQVFnQixhQUFhb0UsSUFBSSxDQUFDbkQsQ0FBQUEsSUFBSzNDLDBDQUFhLENBQUMyQyxPQUFPaUQ7WUFDMUQsSUFBSWxGLFNBQVM0RCxHQUFHcUIsVUFBVSxDQUFDakYsUUFBUTtnQkFDakM0QixRQUFRLENBQUM0QyxTQUFTLEdBQUdaLEdBQUdDLFlBQVksQ0FBQzdELE9BQU87Z0JBQzVDO1lBQ0Y7WUFFQSxtR0FBbUc7WUFDbkcsSUFBSXFGLFFBQVE7WUFDWixJQUFJO2dCQUNGLE1BQU1DLE9BQU8sQ0FBQ0M7b0JBQ1osTUFBTUMsVUFBVTVCLEdBQUc2QixXQUFXLENBQUNGLEtBQUs7d0JBQUVHLGVBQWU7b0JBQUs7b0JBQzFELEtBQUssTUFBTUMsT0FBT0gsUUFBUzt3QkFDekIsTUFBTUksSUFBSXRHLHNDQUFTLENBQUNpRyxLQUFLSSxJQUFJckIsSUFBSTt3QkFDakMsSUFBSXFCLElBQUlFLFdBQVcsSUFBSTs0QkFDckJQLEtBQUtNOzRCQUNMLElBQUlQLE9BQU87d0JBQ2IsT0FBTyxJQUFJTSxJQUFJRyxNQUFNLE1BQU14RywwQ0FBYSxDQUFDc0csT0FBT1YsTUFBTTs0QkFDcERHLFFBQVFPOzRCQUNSO3dCQUNGO29CQUNGO2dCQUNGO2dCQUNBLElBQUloQyxHQUFHcUIsVUFBVSxDQUFDSCxnQkFBZ0JRLEtBQUtSO1lBQ3pDLEVBQUUsT0FBT2lCLEtBQUs7WUFDWix5QkFBeUI7WUFDM0I7WUFFQSxJQUFJVixTQUFTekIsR0FBR3FCLFVBQVUsQ0FBQ0ksUUFBUTtnQkFDakN6RCxRQUFRLENBQUM0QyxTQUFTLEdBQUdaLEdBQUdDLFlBQVksQ0FBQ3dCLE9BQU87Z0JBQzVDO1lBQ0Y7WUFFQSxtRUFBbUU7WUFDbkVwQyxRQUFRYyxJQUFJLENBQUMsQ0FBQyxzQkFBc0IsRUFBRVMsU0FBUyw0REFBNEQsQ0FBQztRQUM5RyxFQUFFLE9BQU9WLE9BQU87WUFDZGIsUUFBUWMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLEVBQUVTLFNBQVMsWUFBWSxDQUFDLEVBQUVWO1FBQzlEO0lBQ0Y7SUFFQSxNQUFNdkMsZUFBZSxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs4Q0FpQnNCLENBQUM7SUFFN0MsTUFBTXlFLGNBQWM3RSxPQUFPcUUsT0FBTyxDQUFDNUQsVUFDaENJLEdBQUcsQ0FBQyxDQUFDLENBQUMwQixNQUFNN0QsUUFBUSxHQUFLLENBQUMsSUFBSSxFQUFFNkQsS0FBSyxNQUFNLEVBQUU3RCxRQUFRMkMsU0FBUyxDQUFDLEdBQUcsS0FBSyxFQUFFM0MsUUFBUXlCLE1BQU0sR0FBRyxNQUFNLHNCQUFzQixHQUFHLENBQUMsRUFDMUhFLElBQUksQ0FBQztJQUVSLE1BQU1VLFdBQVc7UUFDZixJQUFJcEQsbUVBQWFBLENBQUN5QztRQUNsQixJQUFJM0Msa0VBQVlBLENBQUMsQ0FBQyx3Q0FBd0MsRUFBRW9ILFlBQVksQ0FBQztLQUMxRTtJQUVELCtEQUErRDtJQUMvRCxNQUFNN0QsV0FBVzNCLFFBQVFwQiwyREFBU0EsQ0FBQ29CLFNBQVNyQixpREFBR0E7SUFDL0MsTUFBTWlELFdBQVcsTUFBTUQsU0FBU0UsTUFBTSxDQUFDSDtJQUN2QyxNQUFNK0QsV0FBVzdELFNBQVN2QyxPQUFPLENBQUMwQyxRQUFRLEdBQUdwQyxJQUFJO0lBRWpELE1BQU0rRixhQUFhRCxTQUFTRSxXQUFXLEdBQUdDLFFBQVEsQ0FBQyxlQUNoQyxDQUFDSCxTQUFTSSxXQUFXLEdBQUdELFFBQVEsQ0FBQyxjQUNqQyxDQUFDSCxTQUFTSSxXQUFXLEdBQUdELFFBQVEsQ0FBQztJQUVwRG5ELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFZ0QsYUFBYSxhQUFhLG9CQUFvQixDQUFDO0lBQ2hGakQsUUFBUUMsR0FBRyxDQUFDLENBQUMsYUFBYSxFQUFFK0MsU0FBU3pELFNBQVMsQ0FBQyxHQUFHLEtBQUssR0FBRyxDQUFDO0lBRTNELGdCQUFnQjtJQUNoQixNQUFNN0IsT0FBT0MsVUFBVSxDQUFDLGFBQWEsQ0FBQyxRQUFRLEVBQUVxRixTQUFTekQsU0FBUyxDQUFDLEdBQUcsS0FBSyxHQUFHLENBQUM7SUFFL0Usc0JBQXNCO0lBQ3RCakQsVUFBVWdCLGFBQWEsSUFBSTtRQUFFRSxNQUFNO1FBQVV3RixVQUFVQTtJQUFTO0lBRWhFLElBQUlDLFlBQVk7UUFDZDNHLFVBQVVnQixhQUFhLElBQUk7WUFBRUUsTUFBTTtZQUFZQyxTQUFTO1FBQTBDO0lBQ3BHO0lBRUEsT0FBTztRQUNMdUQsZ0JBQWdCZ0M7UUFDaEJ6QyxZQUFZMEM7UUFDWkksa0JBQWtCLENBQUNoRyxNQUFNZ0csZ0JBQWdCLElBQUksS0FBSztJQUNwRDtBQUNGO0FBRUEsb0VBQW9FO0FBQzdELGVBQWVDLG9CQUFvQmpHLEtBQXFCLEVBQUVDLFNBQWtCLEVBQUVDLEtBQWM7SUFDakdqQixVQUFVZ0IsYUFBYSxJQUFJO1FBQUVFLE1BQU07UUFBVUMsU0FBUztJQUFtQztJQUV6RixNQUFNQyxTQUFTMUIsaURBQVNBO0lBQ3hCLE1BQU02QixpQkFBaUIsTUFBTUgsT0FBT0ksb0JBQW9CLENBQUNULE1BQU1PLFdBQVc7SUFFMUUsTUFBTVUsZUFBZSxDQUFDOzs7Ozs7Ozs7QUFTeEIsRUFBRVQsaUJBQWlCLENBQUMsVUFBVSxFQUFFOUIsZ0VBQWFBLENBQUM4QixnQkFBZ0IsS0FBSyxJQUFJLENBQUMsR0FBRyxHQUFHOztnREFFOUIsQ0FBQztJQUUvQyxNQUFNb0IsV0FBVztRQUNmLElBQUlwRCxtRUFBYUEsQ0FBQ3lDO1FBQ2xCLElBQUkzQyxrRUFBWUEsQ0FBQyxDQUFDLDRCQUE0QixFQUFFMEIsTUFBTTJELGNBQWMsQ0FBQzs7ZUFFMUQsRUFBRTlDLE9BQU9DLElBQUksQ0FBQ2QsTUFBTWUsY0FBYyxFQUFFRyxJQUFJLENBQUMsTUFBTTs7aUNBRTdCLENBQUM7S0FDL0I7SUFFRCx3RUFBd0U7SUFDeEUsTUFBTVcsV0FBVzNCLFFBQVFwQiwyREFBU0EsQ0FBQ29CLFNBQVNyQixpREFBR0E7SUFDL0MsTUFBTStFLG9CQUFvQjFELFFBQVEyQixTQUFTeEMsU0FBUyxDQUFDTix5Q0FBS0EsSUFBSUs7SUFDOUQsTUFBTTBDLFdBQVcsTUFBTThCLGtCQUFrQjdCLE1BQU0sQ0FBQ0g7SUFFaEQsMERBQTBEO0lBQzFELE1BQU1iLGlCQUF5QyxDQUFDO0lBRWhELElBQUllLFNBQVNnQyxVQUFVLElBQUloQyxTQUFTZ0MsVUFBVSxDQUFDOUMsTUFBTSxHQUFHLEdBQUc7UUFDekQsS0FBSyxNQUFNK0MsWUFBWWpDLFNBQVNnQyxVQUFVLENBQUU7WUFDMUNuQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRW1CLFNBQVNDLElBQUksQ0FBQyxDQUFDLEVBQUVELFNBQVNFLElBQUk7WUFDN0QsSUFBSUYsU0FBU0MsSUFBSSxLQUFLLGdCQUFnQkQsU0FBU0MsSUFBSSxLQUFLLGtCQUFrQjtnQkFDeEUsSUFBSTtvQkFDRixNQUFNQyxPQUFPRixTQUFTRSxJQUFJO29CQUMxQixJQUFJQSxLQUFLQyxRQUFRLElBQUlELEtBQUsxRSxPQUFPLEVBQUU7d0JBQ2pDd0IsY0FBYyxDQUFDa0QsS0FBS0MsUUFBUSxDQUFDLEdBQUdELEtBQUsxRSxPQUFPO29CQUM5QztnQkFDRixFQUFFLE9BQU9pRSxPQUFPO29CQUNkYixRQUFRYyxJQUFJLENBQUMsd0NBQXdDRDtnQkFDdkQ7WUFDRjtRQUNGO0lBQ0YsT0FBTztRQUNMLDhDQUE4QztRQUM5QyxNQUFNMEMsYUFBYTVHLG9CQUFvQndDLFNBQVN2QyxPQUFPLENBQUMwQyxRQUFRO1FBQ2hFcEIsT0FBT3VELE1BQU0sQ0FBQ3JELGdCQUFnQm1GO0lBQ2hDO0lBRUEsZ0JBQWdCO0lBQ2hCLE1BQU03RixPQUFPQyxVQUFVLENBQUMsYUFBYSxDQUFDLCtDQUErQyxFQUFFTyxPQUFPQyxJQUFJLENBQUNDLGdCQUFnQkMsTUFBTSxDQUFDLE9BQU8sQ0FBQztJQUVsSSxhQUFhO0lBQ2IsSUFBSUgsT0FBT0MsSUFBSSxDQUFDQyxnQkFBZ0JDLE1BQU0sR0FBRyxHQUFHO1FBQzFDLE1BQU14QixRQUFRcUIsT0FBT0MsSUFBSSxDQUFDQztRQUMxQjRCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDRCQUE0QixFQUFFcEQsTUFBTTBCLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDN0RqQyxVQUFVZ0IsYUFBYSxJQUFJO1lBQ3pCRSxNQUFNO1lBQ05YLE9BQU9BO1FBQ1Q7SUFDRjtJQUVBLE9BQU87UUFDTHVCO1FBQ0FpQyxrQkFBa0I7UUFDbEJwQixVQUFVO1lBQUMsSUFBSXJELCtEQUFTQSxDQUFDLENBQUMsbUNBQW1DLEVBQUVzQyxPQUFPQyxJQUFJLENBQUNDLGdCQUFnQkMsTUFBTSxDQUFDLGVBQWUsQ0FBQztTQUFFO0lBQ3RIO0FBQ0Y7QUFFQSxrRUFBa0U7QUFDM0QsU0FBU21GLGVBQWVuRyxLQUFxQjtJQUNsRCxpQ0FBaUM7SUFDakMsSUFBSUEsTUFBTWtELFVBQVUsRUFBRTtRQUNwQixPQUFPO0lBQ1Q7SUFFQSx3Q0FBd0M7SUFDeEMsSUFBSWxELE1BQU02QyxJQUFJLENBQUM3QixNQUFNLEtBQUssR0FBRztRQUMzQixPQUFPO0lBQ1Q7SUFFQSx3REFBd0Q7SUFDeEQsSUFBSWhCLE1BQU1nRCxnQkFBZ0IsR0FBR2hELE1BQU02QyxJQUFJLENBQUM3QixNQUFNLEVBQUU7UUFDOUMsT0FBTztJQUNUO0lBRUEsbUNBQW1DO0lBQ25DLElBQUksQ0FBQ2hCLE1BQU0yRCxjQUFjLEVBQUU7UUFDekIsT0FBTztJQUNUO0lBRUEsNkNBQTZDO0lBQzdDLE1BQU1nQyxXQUFXM0YsTUFBTTJELGNBQWMsQ0FBQ2tDLFdBQVc7SUFDakQsTUFBTUQsYUFBYUQsU0FBU0csUUFBUSxDQUFDLGVBQ2xCLENBQUNILFNBQVNJLFdBQVcsR0FBR0QsUUFBUSxDQUFDLGNBQ2pDLENBQUNILFNBQVNJLFdBQVcsR0FBR0QsUUFBUSxDQUFDO0lBRXBELElBQUlGLFlBQVk7UUFDZCx5QkFBeUI7UUFDekIsT0FBTztJQUNUO0lBRUEsdUNBQXVDO0lBQ3ZDLE1BQU1RLGFBQWFwRyxNQUFNZ0csZ0JBQWdCLElBQUk7SUFDN0MsSUFBSUksY0FBYyxHQUFHO1FBQ25CLG9DQUFvQztRQUNwQ3pELFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU87SUFDVDtJQUVBLGlFQUFpRTtJQUNqRUQsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUV3RCxXQUFXLGtDQUFrQyxDQUFDO0lBRS9GLGdFQUFnRTtJQUNoRSxPQUFPO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi9hZ2VudHMvc3RyZWFtaW5nLWFnZW50cy50cz9iMzdkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJhc2VNZXNzYWdlLCBIdW1hbk1lc3NhZ2UsIEFJTWVzc2FnZSwgU3lzdGVtTWVzc2FnZSB9IGZyb20gJ0BsYW5nY2hhaW4vY29yZS9tZXNzYWdlcyc7XG5pbXBvcnQgeyB0b29sTG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvdG9vbC1sb2dnZXInO1xuaW1wb3J0IHsgcHJvbXB0T3B0aW1pemVyIH0gZnJvbSAnLi4vdXRpbHMvcHJvbXB0LW9wdGltaXplcic7XG5pbXBvcnQgeyBjb21wcmVzc0NvbnRleHQsIHN1bW1hcml6ZUZpbGVDb250ZW50cywgZXN0aW1hdGVUb2tlbnMsIHNob3VsZENvbXByZXNzLCBzbWFydFRydW5jYXRlIH0gZnJvbSAnLi4vdXRpbHMvc3VtbWFyaXplcic7XG5pbXBvcnQgeyBnZXRNZW1vcnksIGdldFByb2plY3RGb2xkZXIgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IGxsbSwgY3JlYXRlTExNIH0gZnJvbSAnLi9tb2RlbC1wcm92aWRlcnMnO1xuaW1wb3J0IHsgdG9vbHMsIHdyYXBUb29sV2l0aExvZ2dpbmcgfSBmcm9tICcuL3Rvb2xzJztcbmltcG9ydCB7IEFnZW50U3RhdGVUeXBlIH0gZnJvbSAnLi9hZ2VudC1jb3JlJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbi8vIEltcG9ydCB0aGUgZW1pdCBmdW5jdGlvbiBmcm9tIHRoZSBBUEkgcm91dGVcbmxldCBlbWl0RXZlbnQ6IChzZXNzaW9uSWQ6IHN0cmluZywgZGF0YTogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XG5leHBvcnQgZnVuY3Rpb24gc2V0RW1pdEZ1bmN0aW9uKGZuOiAoc2Vzc2lvbklkOiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdm9pZCkge1xuICBlbWl0RXZlbnQgPSBmbjtcbn1cblxuLy8gQmluZCB0b29scyB0byB0aGUgTExNXG5jb25zdCBsbG1XaXRoVG9vbHMgPSBsbG0uYmluZFRvb2xzKHRvb2xzKTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHBhcnNlIGdlbmVyYXRlZCBmaWxlcyBmcm9tIExMTSBvdXRwdXRcbmZ1bmN0aW9uIHBhcnNlR2VuZXJhdGVkRmlsZXMoY29udGVudDogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gIGNvbnN0IGZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGNvbnN0IGZpbGVSZWdleCA9IC9GSUxFTkFNRTpcXHMqKC4rPylcXG5gYGAoXFx3Kyk/XFxuKFtcXHNcXFNdKj8pYGBgL2c7XG5cbiAgbGV0IG1hdGNoO1xuICB3aGlsZSAoKG1hdGNoID0gZmlsZVJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG4gICAgY29uc3QgZmlsZW5hbWUgPSBtYXRjaFsxXS50cmltKCk7XG4gICAgY29uc3QgY29kZSA9IG1hdGNoWzNdLnRyaW0oKTtcbiAgICBmaWxlc1tmaWxlbmFtZV0gPSBjb2RlO1xuICB9XG5cbiAgcmV0dXJuIGZpbGVzO1xufVxuXG4vLyBTdHJlYW1pbmcgUGxhbm5lciBBZ2VudDogQnJlYWtzIGRvd24gdXNlciByZXF1ZXN0IGludG8gYWN0aW9uYWJsZSBzdGVwc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0cmVhbWluZ1BsYW5uZXJBZ2VudChzdGF0ZTogQWdlbnRTdGF0ZVR5cGUsIHNlc3Npb25JZD86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8QWdlbnRTdGF0ZVR5cGU+PiB7XG4gIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ3N0YXR1cycsIG1lc3NhZ2U6ICdQbGFubmluZyB5b3VyIHJlcXVlc3QuLi4nIH0pO1xuXG4gIGNvbnN0IG1lbW9yeSA9IGdldE1lbW9yeSgpO1xuXG4gIC8vIEFkZCB1c2VyIHJlcXVlc3QgdG8gbWVtb3J5XG4gIGF3YWl0IG1lbW9yeS5hZGRNZXNzYWdlKCd1c2VyJywgc3RhdGUudXNlclJlcXVlc3QpO1xuXG4gIC8vIEdldCBjb21wcmVzc2VkIGNvbnRleHQgZnJvbSBtZW1vcnlcbiAgY29uc3QgY29udGV4dFN1bW1hcnkgPSBhd2FpdCBtZW1vcnkuZ2V0Q29tcHJlc3NlZENvbnRleHQoc3RhdGUudXNlclJlcXVlc3QpO1xuICBjb25zdCBzZXNzaW9uRmlsZXMgPSBhd2FpdCBtZW1vcnkuZ2V0U2Vzc2lvbkZpbGVzKCk7XG5cbiAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGV4aXN0aW5nIGZpbGVzIC0gaWYgc28sIHRoaXMgaXMgYSBtb2RpZmljYXRpb24gcmVxdWVzdFxuICBjb25zdCBoYXNFeGlzdGluZ0ZpbGVzID0gT2JqZWN0LmtleXMoc3RhdGUuZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aCA+IDAgfHwgc2Vzc2lvbkZpbGVzLmxlbmd0aCA+IDA7XG5cbiAgbGV0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgc2VuaW9yIHNvZnR3YXJlIGFyY2hpdGVjdC4gQW5hbHl6ZSB0aGUgdXNlcidzIHJlcXVlc3QgYW5kIGNyZWF0ZSBhIGNsZWFyIHBsYW4uXG5cbiR7aGFzRXhpc3RpbmdGaWxlcyA/IGBcbklNUE9SVEFOVDogVGhlcmUgYXJlIEVYSVNUSU5HIEZJTEVTIGluIHRoaXMgc2Vzc2lvbi4gVGhlIHVzZXIgd2FudHMgdG8gTU9ESUZZIG9yIEVOSEFOQ0UgdGhlbS5cblNlc3Npb24gZmlsZXM6ICR7c2Vzc2lvbkZpbGVzLmxlbmd0aCA+IDAgPyBzZXNzaW9uRmlsZXMuam9pbignLCAnKSA6ICdOb25lJ31cbkN1cnJlbnQgc3RhdGUgZmlsZXM6ICR7T2JqZWN0LmtleXMoc3RhdGUuZ2VuZXJhdGVkRmlsZXMpLmpvaW4oJywgJyl9XG5cbllvdXIgcGxhbiBzaG91bGQgZm9jdXMgb24gTU9ESUZZSU5HIHRoZXNlIGV4aXN0aW5nIGZpbGVzLCBub3QgY3JlYXRpbmcgbmV3IHJhbmRvbSBmaWxlcy5cbmAgOiBgXG5UaGlzIGlzIGEgTkVXIHByb2plY3QuIENyZWF0ZSBhIHBsYW4gdG8gYnVpbGQgaXQgZnJvbSBzY3JhdGNoLlxuYH1cblxuJHtjb250ZXh0U3VtbWFyeSA/IGBcXG5SRUNFTlQgQ09OVEVYVDpcXG4ke3NtYXJ0VHJ1bmNhdGUoY29udGV4dFN1bW1hcnksIDgwMCl9YCA6ICcnfVxuXG5PVVRQVVQgRk9STUFUOiBKdXN0IG51bWJlcmVkIHN0ZXBzIGxpa2U6XG4xLiBDcmVhdGUvTW9kaWZ5IFtzcGVjaWZpYyBmaWxlXSAtIFt3aGF0IHRvIGRvXVxuMi4gVXBkYXRlIFtzcGVjaWZpYyBmaWxlXSAtIFt3aGF0IHRvIGNoYW5nZV1cbjMuIEFkZCBbZmVhdHVyZV0gdG8gW2ZpbGVdXG5cblJVTEVTOlxuLSBNYXhpbXVtIDUgc3RlcHNcbi0gQmUgU1BFQ0lGSUMgYWJvdXQgd2hpY2ggZmlsZXMgdG8gY3JlYXRlL21vZGlmeVxuLSBJZiBtb2RpZnlpbmcsIHNheSBcIk1vZGlmeVwiIG9yIFwiVXBkYXRlXCIsIG5vdCBcIkNyZWF0ZVwiXG4tIEVhY2ggc3RlcCBzaG91bGQgcHJvZHVjZSB0YW5naWJsZSBjb2RlXG4tIEtlZXAgaXQgc2ltcGxlIGFuZCBhY3Rpb25hYmxlYDtcblxuICAvLyBPcHRpbWl6ZSB0aGUgc3lzdGVtIHByb21wdFxuICBzeXN0ZW1Qcm9tcHQgPSBwcm9tcHRPcHRpbWl6ZXIub3B0aW1pemVTeXN0ZW1Qcm9tcHQoc3lzdGVtUHJvbXB0LCBjb250ZXh0U3VtbWFyeSB8fCB1bmRlZmluZWQpO1xuXG4gIGxldCBjb250ZXh0SW5mbyA9IGBVc2VyIHJlcXVlc3Q6ICR7c3RhdGUudXNlclJlcXVlc3R9YDtcblxuICBpZiAoaGFzRXhpc3RpbmdGaWxlcykge1xuICAgIGNvbnN0IGFsbEZpbGVzID0gQXJyYXkuZnJvbShuZXcgU2V0KFsuLi5zZXNzaW9uRmlsZXMsIC4uLk9iamVjdC5rZXlzKHN0YXRlLmdlbmVyYXRlZEZpbGVzKV0pKTtcbiAgICBjb250ZXh0SW5mbyArPSBgXFxuXFxuRVhJU1RJTkcgUFJPSkVDVCBGSUxFUzpcXG4ke2FsbEZpbGVzLm1hcChmID0+IGAtICR7Zn1gKS5qb2luKCdcXG4nKX1gO1xuICAgIGNvbnRleHRJbmZvICs9IGBcXG5cXG5UaGUgdXNlciB3YW50cyB0byBtb2RpZnkvZW5oYW5jZSB0aGUgZXhpc3RpbmcgcHJvamVjdC4gQ3JlYXRlIGEgcGxhbiB0aGF0IHdvcmtzIFdJVEggdGhlc2UgZmlsZXMuYDtcbiAgfVxuXG4gIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgIG5ldyBTeXN0ZW1NZXNzYWdlKHN5c3RlbVByb21wdCksXG4gICAgbmV3IEh1bWFuTWVzc2FnZShjb250ZXh0SW5mbyksXG4gIF07XG5cbiAgLy8gVXNlIG1vZGVsLXNwZWNpZmljIExMTSBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBnbG9iYWwgbGxtXG4gIGNvbnN0IGxsbVRvVXNlID0gbW9kZWwgPyBjcmVhdGVMTE0obW9kZWwpIDogbGxtO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxsbVRvVXNlLmludm9rZShtZXNzYWdlcyk7XG4gIGNvbnN0IHBsYW5UZXh0ID0gcmVzcG9uc2UuY29udGVudC50b1N0cmluZygpO1xuXG4gIC8vIEFkZCBwbGFuIHRvIG1lbW9yeVxuICBhd2FpdCBtZW1vcnkuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgYFBsYW5uaW5nOiAke3BsYW5UZXh0LnN1YnN0cmluZygwLCAyMDApfS4uLmApO1xuXG4gIC8vIFBhcnNlIHRoZSBwbGFuIGludG8gc3RlcHNcbiAgY29uc3QgcGxhblN0ZXBzID0gcGxhblRleHRcbiAgICAuc3BsaXQoJ1xcbicpXG4gICAgLmZpbHRlcihsaW5lID0+IC9eXFxkK1xcLi8udGVzdChsaW5lLnRyaW0oKSkpXG4gICAgLm1hcChsaW5lID0+IGxpbmUucmVwbGFjZSgvXlxcZCtcXC5cXHMqLywgJycpLnRyaW0oKSlcbiAgICAuZmlsdGVyKHN0ZXAgPT4gc3RlcC5sZW5ndGggPiAwKVxuICAgIC5zbGljZSgwLCA1KTsgLy8gTGltaXQgdG8gNSBzdGVwc1xuXG4gIGNvbnNvbGUubG9nKGDwn5OLIEdlbmVyYXRlZCBwbGFuIHdpdGggJHtwbGFuU3RlcHMubGVuZ3RofSBzdGVwczpgLCBwbGFuU3RlcHMpO1xuXG4gIC8vIEVtaXQgcGxhbiB0byBjbGllbnRcbiAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywgeyB0eXBlOiAncGxhbicsIHBsYW46IHBsYW5TdGVwcyB9KTtcblxuICByZXR1cm4ge1xuICAgIHBsYW46IHBsYW5TdGVwcyxcbiAgICBtZXNzYWdlczogW25ldyBBSU1lc3NhZ2UoYFBsYW5uaW5nIGNvbXBsZXRlZC4gQ3JlYXRlZCAke3BsYW5TdGVwcy5sZW5ndGh9IHN0ZXBzIHRvIGltcGxlbWVudCB5b3VyIHJlcXVlc3QuYCldLFxuICB9O1xufVxuXG4vLyBTdHJlYW1pbmcgQ29kZSBHZW5lcmF0b3IgQWdlbnQ6IEltcGxlbWVudHMgZWFjaCBzdGVwIG9mIHRoZSBwbGFuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RyZWFtaW5nQ29kZUdlbmVyYXRvckFnZW50KHN0YXRlOiBBZ2VudFN0YXRlVHlwZSwgc2Vzc2lvbklkPzogc3RyaW5nLCBtb2RlbD86IHN0cmluZyk6IFByb21pc2U8UGFydGlhbDxBZ2VudFN0YXRlVHlwZT4+IHtcbiAgY29uc3QgY3VycmVudFN0ZXAgPSBzdGF0ZS5jdXJyZW50SXRlcmF0aW9uO1xuICBjb25zdCBzdGVwVG9JbXBsZW1lbnQgPSBzdGF0ZS5wbGFuW2N1cnJlbnRTdGVwXTtcblxuICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgdHlwZTogJ3N0YXR1cycsXG4gICAgbWVzc2FnZTogYEdlbmVyYXRpbmcgY29kZSBmb3Igc3RlcCAke2N1cnJlbnRTdGVwICsgMX06ICR7c3RlcFRvSW1wbGVtZW50Py5zdWJzdHJpbmcoMCwgNTApfS4uLmBcbiAgfSk7XG5cbiAgaWYgKCFzdGVwVG9JbXBsZW1lbnQpIHtcbiAgICBjb25zb2xlLmxvZygn4pqg77iPICBObyBzdGVwIHRvIGltcGxlbWVudCBhdCBpdGVyYXRpb24nLCBjdXJyZW50U3RlcCk7XG4gICAgcmV0dXJuIHsgaXNDb21wbGV0ZTogdHJ1ZSB9O1xuICB9XG5cbiAgY29uc3QgbWVtb3J5ID0gZ2V0TWVtb3J5KCk7XG4gIGNvbnN0IGNvbnRleHRTdW1tYXJ5ID0gYXdhaXQgbWVtb3J5LmdldENvbXByZXNzZWRDb250ZXh0KHN0YXRlLnVzZXJSZXF1ZXN0KTtcbiAgY29uc3Qgc2Vzc2lvbkZpbGVzID0gYXdhaXQgbWVtb3J5LmdldFNlc3Npb25GaWxlcygpO1xuXG4gIC8vIEdldCBleGlzdGluZyBmaWxlcyBmb3IgY29udGV4dFxuICBjb25zdCBleGlzdGluZ0ZpbGVzID0geyAuLi5zdGF0ZS5nZW5lcmF0ZWRGaWxlcyB9O1xuICBmb3IgKGNvbnN0IGZpbGUgb2Ygc2Vzc2lvbkZpbGVzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBpbXBvcnQoJ2ZzJykudGhlbihmcyA9PiBmcy5yZWFkRmlsZVN5bmMoZmlsZSwgJ3V0Zi04JykpO1xuICAgICAgZXhpc3RpbmdGaWxlc1tmaWxlXSA9IGNvbnRlbnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IHJlYWQgZXhpc3RpbmcgZmlsZSAke2ZpbGV9OmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBhbiBleHBlcnQgc29mdHdhcmUgZW5naW5lZXIuIEltcGxlbWVudCB0aGUgc3BlY2lmaWVkIHN0ZXAgdXNpbmcgdGhlIGF2YWlsYWJsZSB0b29scy5cblxuSU1QT1JUQU5UIFJVTEVTOlxuLSBVc2UgdGhlIHByb3ZpZGVkIHRvb2xzIHRvIGNyZWF0ZS9tb2RpZnkgZmlsZXNcbi0gRWFjaCB0b29sIGNhbGwgc2hvdWxkIGJlIHB1cnBvc2VmdWwgYW5kIHRhcmdldGVkXG4tIFJlYWQgZXhpc3RpbmcgZmlsZXMgZmlyc3QgdG8gdW5kZXJzdGFuZCB0aGUgY3VycmVudCBzdGF0ZVxuLSBNYWtlIGluY3JlbWVudGFsLCB0ZXN0YWJsZSBjaGFuZ2VzXG4tIEluY2x1ZGUgcHJvcGVyIGltcG9ydHMgYW5kIGRlcGVuZGVuY2llc1xuLSBGb2xsb3cgdGhlIGV4aXN0aW5nIGNvZGUgc3R5bGUgYW5kIHBhdHRlcm5zXG4tIFRlc3QgeW91ciBjaGFuZ2VzIGJ5IHJlYWRpbmcgdGhlIGZpbGVzIGJhY2tcblxuJHtjb250ZXh0U3VtbWFyeSA/IGBDT05URVhUOlxcbiR7c21hcnRUcnVuY2F0ZShjb250ZXh0U3VtbWFyeSwgNjAwKX1cXG5cXG5gIDogJyd9XG5cbkFWQUlMQUJMRSBUT09MUzpcbi0gcmVhZF9maWxlOiBSZWFkIGV4aXN0aW5nIGZpbGVzXG4tIHdyaXRlX2ZpbGU6IENyZWF0ZSBuZXcgZmlsZXMgb3IgcmVwbGFjZSBlbnRpcmUgZmlsZXNcbi0gYXBwZW5kX3RvX2ZpbGU6IEFkZCBjb250ZW50IHRvIGV4aXN0aW5nIGZpbGVzXG4tIHJlcGxhY2VfaW5fZmlsZTogRmluZCBhbmQgcmVwbGFjZSB0ZXh0IHBhdHRlcm5zXG4tIGluc2VydF9hdF9saW5lOiBJbnNlcnQgY29udGVudCBhdCBzcGVjaWZpYyBsaW5lIG51bWJlcnNcbi0gcmVwbGFjZV9ibG9jazogUmVwbGFjZSBjb250ZW50IGJldHdlZW4gbWFya2Vyc1xuLSByZXBsYWNlX2xpbmVfcmFuZ2U6IFJlcGxhY2Ugc3BlY2lmaWMgbGluZSByYW5nZXNcbi0gc2VhcmNoX2ZpbGVzOiBGaW5kIGNvZGUgcGF0dGVybnMgYWNyb3NzIGZpbGVzXG4tIGV4ZWN1dGVfY29tbWFuZDogUnVuIHNoZWxsIGNvbW1hbmRzIChucG0sIGdpdCwgZXRjLilcblxuT1VUUFVUIEZPUk1BVDpcbkNoYWluIG9mIFRob3VnaHQ6IFtZb3VyIHJlYXNvbmluZyBwcm9jZXNzXVxuRmlsZXM6IFtMaXN0IG9mIGZpbGVzIHlvdSdsbCBjcmVhdGUvbW9kaWZ5XVxuW1RoZW4gdXNlIHRoZSBhcHByb3ByaWF0ZSB0b29scyB0byBpbXBsZW1lbnQgdGhlIGNoYW5nZXNdXG5cblRPT0wgVVNBR0U6XG4tIFVzZSB0b29scyBieSBjYWxsaW5nIHRoZW0gZGlyZWN0bHkgaW4geW91ciByZXNwb25zZVxuLSBFYWNoIHRvb2wgY2FsbCBzaG91bGQgYmUgYSBzZXBhcmF0ZSBmdW5jdGlvbiBjYWxsIHdpdGggcHJvcGVyIEpTT04gYXJndW1lbnRzXG4tIFRvb2xzIHdpbGwgYXV0b21hdGljYWxseSBleGVjdXRlIGFuZCBwcm92aWRlIHJlc3VsdHNcbi0gRm9ybWF0OiBDYWxsIHRvb2xzIGxpa2Ugbm9ybWFsIGZ1bmN0aW9uIGNhbGxzIHdpdGggdGhlIHRvb2wgbmFtZSBhbmQgYXJndW1lbnRzXG4tIEV4YW1wbGU6IHdyaXRlX2ZpbGUoeyBcImZpbGVQYXRoXCI6IFwiaW5kZXguaHRtbFwiLCBcImNvbnRlbnRcIjogXCI8aHRtbD4uLi48L2h0bWw+XCIgfSlgO1xuXG4gIGNvbnN0IHVzZXJQcm9tcHQgPSBgSW1wbGVtZW50IHRoaXMgc3RlcDogXCIke3N0ZXBUb0ltcGxlbWVudH1cIlxuXG5FeGlzdGluZyBwcm9qZWN0IGZpbGVzOiAke09iamVjdC5rZXlzKGV4aXN0aW5nRmlsZXMpLmpvaW4oJywgJykgfHwgJ05vbmUnfVxuXG4ke3N0YXRlLnJldmlld0ZlZWRiYWNrID8gYFByZXZpb3VzIHJldmlldyBmZWVkYmFjayB0byBhZGRyZXNzOiAke3N0YXRlLnJldmlld0ZlZWRiYWNrfWAgOiAnJ31gO1xuXG4gIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgIG5ldyBTeXN0ZW1NZXNzYWdlKHN5c3RlbVByb21wdCksXG4gICAgbmV3IEh1bWFuTWVzc2FnZSh1c2VyUHJvbXB0KSxcbiAgXTtcblxuICAvLyBVc2UgbW9kZWwtc3BlY2lmaWMgTExNIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGdsb2JhbCBsbG1XaXRoVG9vbHNcbiAgY29uc3QgbGxtVG9Vc2UgPSBtb2RlbCA/IGNyZWF0ZUxMTShtb2RlbCkgOiBsbG07XG4gIGNvbnN0IGxsbVdpdGhUb29sc1RvVXNlID0gbW9kZWwgPyBsbG1Ub1VzZS5iaW5kVG9vbHModG9vbHMpIDogbGxtV2l0aFRvb2xzO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxsbVdpdGhUb29sc1RvVXNlLmludm9rZShtZXNzYWdlcyk7XG5cbiAgLy8gRXh0cmFjdCBnZW5lcmF0ZWQgZmlsZXMgZnJvbSB0b29sIGNhbGxzIG9yIHJlc3BvbnNlIGNvbnRlbnRcbiAgY29uc3QgZ2VuZXJhdGVkRmlsZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgbGV0IGNoYWluT2ZUaG91Z2h0ID0gJyc7XG5cbiAgaWYgKHJlc3BvbnNlLnRvb2xfY2FsbHMgJiYgcmVzcG9uc2UudG9vbF9jYWxscy5sZW5ndGggPiAwKSB7XG4gICAgZm9yIChjb25zdCB0b29sQ2FsbCBvZiByZXNwb25zZS50b29sX2NhbGxzKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+UpyBUb29sIGNhbGxlZDogJHt0b29sQ2FsbC5uYW1lfWAsIHRvb2xDYWxsLmFyZ3MpO1xuICAgICAgaWYgKHRvb2xDYWxsLm5hbWUgPT09ICd3cml0ZV9maWxlJyB8fCB0b29sQ2FsbC5uYW1lID09PSAnYXBwZW5kX3RvX2ZpbGUnKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgYXJncyA9IHRvb2xDYWxsLmFyZ3MgYXMgYW55O1xuICAgICAgICAgIGlmIChhcmdzLmZpbGVQYXRoICYmIGFyZ3MuY29udGVudCkge1xuICAgICAgICAgICAgZ2VuZXJhdGVkRmlsZXNbYXJncy5maWxlUGF0aF0gPSBhcmdzLmNvbnRlbnQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IHBhcnNlIHRvb2wgY2FsbCBhcmd1bWVudHM6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGDwn5OKIFByb2Nlc3NlZCAke3Jlc3BvbnNlLnRvb2xfY2FsbHMubGVuZ3RofSB0b29sIGNhbGxzYCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IHBhcnNlIGZpbGVzIGZyb20gcmVzcG9uc2UgY29udGVudFxuICAgIGNvbnN0IG5ld0ZpbGVzID0gcGFyc2VHZW5lcmF0ZWRGaWxlcyhyZXNwb25zZS5jb250ZW50LnRvU3RyaW5nKCkpO1xuICAgIE9iamVjdC5hc3NpZ24oZ2VuZXJhdGVkRmlsZXMsIG5ld0ZpbGVzKTtcbiAgfVxuXG4gIC8vIEV4dHJhY3QgY2hhaW4gb2YgdGhvdWdodCBmcm9tIHJlc3BvbnNlXG4gIGNvbnN0IGNvbnRlbnQgPSByZXNwb25zZS5jb250ZW50LnRvU3RyaW5nKCk7XG4gIGNvbnN0IGNvdE1hdGNoID0gY29udGVudC5tYXRjaCgvQ2hhaW4gb2YgVGhvdWdodDpcXHMqKFtcXHNcXFNdKj8pKD89RmlsZXM6fEZJTEVOQU1FOnwkKS9pKTtcbiAgaWYgKGNvdE1hdGNoKSB7XG4gICAgY2hhaW5PZlRob3VnaHQgPSBjb3RNYXRjaFsxXS50cmltKCk7XG4gIH1cblxuICAvLyBBZGQgdG8gbWVtb3J5XG4gIGF3YWl0IG1lbW9yeS5hZGRNZXNzYWdlKCdhc3Npc3RhbnQnLCBgU3RlcCAke2N1cnJlbnRTdGVwICsgMX06ICR7Y2hhaW5PZlRob3VnaHQuc3Vic3RyaW5nKDAsIDIwMCl9Li4uYCk7XG5cbiAgLy8gRW1pdCByZWFsLXRpbWUgdXBkYXRlc1xuICBpZiAoY2hhaW5PZlRob3VnaHQpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+UjSBSZWFsLXRpbWUgQ09UIFN0ZXAgJHtjdXJyZW50U3RlcCArIDF9OiAke2NoYWluT2ZUaG91Z2h0LnN1YnN0cmluZygwLCAxMDApfS4uLmApO1xuICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgIHR5cGU6ICdjaGFpbl9vZl90aG91Z2h0JyxcbiAgICAgIHN0ZXA6IGN1cnJlbnRTdGVwICsgMSxcbiAgICAgIHJlYXNvbmluZzogY2hhaW5PZlRob3VnaHRcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChPYmplY3Qua2V5cyhnZW5lcmF0ZWRGaWxlcykubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGZpbGVzID0gT2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpO1xuICAgIGNvbnNvbGUubG9nKGDwn5OBIFJlYWwtdGltZSBGaWxlcyBHZW5lcmF0ZWQ6ICR7ZmlsZXMuam9pbignLCAnKX1gKTtcbiAgICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7XG4gICAgICB0eXBlOiAnZmlsZXNfZ2VuZXJhdGVkJyxcbiAgICAgIGZpbGVzOiBmaWxlcyxcbiAgICAgIHN0ZXA6IGN1cnJlbnRTdGVwICsgMVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnZW5lcmF0ZWRGaWxlcyxcbiAgICBjdXJyZW50SXRlcmF0aW9uOiBjdXJyZW50U3RlcCArIDEsXG4gICAgbWVzc2FnZXM6IFtuZXcgQUlNZXNzYWdlKGBTdGVwICR7Y3VycmVudFN0ZXAgKyAxfSBjb21wbGV0ZWQuICR7T2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aH0gZmlsZXMgdXBkYXRlZC5gKV0sXG4gIH07XG59XG5cbi8vIFN0cmVhbWluZyBSZXZpZXdlciBBZ2VudDogUmV2aWV3cyB0aGUgZ2VuZXJhdGVkIGNvZGUgZm9yIHF1YWxpdHkgYW5kIGNvbXBsZXRlbmVzc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0cmVhbWluZ1Jldmlld2VyQWdlbnQoc3RhdGU6IEFnZW50U3RhdGVUeXBlLCBzZXNzaW9uSWQ/OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nKTogUHJvbWlzZTxQYXJ0aWFsPEFnZW50U3RhdGVUeXBlPj4ge1xuICBlbWl0RXZlbnQoc2Vzc2lvbklkIHx8ICcnLCB7IHR5cGU6ICdzdGF0dXMnLCBtZXNzYWdlOiAnUmV2aWV3aW5nIGdlbmVyYXRlZCBjb2RlLi4uJyB9KTtcblxuICBjb25zdCBtZW1vcnkgPSBnZXRNZW1vcnkoKTtcbiAgY29uc3QgYWxsRmlsZXMgPSB7IC4uLnN0YXRlLmdlbmVyYXRlZEZpbGVzIH07XG5cbiAgLy8gUmVhZCBjdXJyZW50IHN0YXRlIG9mIGFsbCBmaWxlcyAtIHRyeSBtdWx0aXBsZSByZXNvbHV0aW9uIHN0cmF0ZWdpZXNcbiAgLy8gMSkgSWYgZmlsZVBhdGggaXMgYWJzb2x1dGUgb3IgZXhpc3RzIHVuZGVyIHByb2plY3QgZm9sZGVyLCB1c2UgaXRcbiAgLy8gMikgT3RoZXJ3aXNlIHRyeSB0byBmaW5kIGEgbWF0Y2hpbmcgYmFzZW5hbWUgaW4gc2Vzc2lvbiBmaWxlcyB0cmFja2VkIGluIG1lbW9yeVxuICAvLyAzKSBGYWxsYmFjayB0byB0aGUgY29udGVudCBhbHJlYWR5IHByZXNlbnQgaW4gc3RhdGUuZ2VuZXJhdGVkRmlsZXNcbiAgY29uc3Qgc2Vzc2lvbkZpbGVzID0gYXdhaXQgbWVtb3J5LmdldFNlc3Npb25GaWxlcygpO1xuICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIE9iamVjdC5rZXlzKGFsbEZpbGVzKSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydCgnZnMnKTtcbiAgICAgIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG5cbiAgICAgIC8vIENhbmRpZGF0ZSAxOiBhYnNvbHV0ZSBwYXRoIG9yIHByb2plY3RGb2xkZXIgKyBmaWxlUGF0aFxuICAgICAgY29uc3QgY2FuZGlkYXRlID0gcGF0aC5pc0Fic29sdXRlKGZpbGVQYXRoKSA/IGZpbGVQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVQYXRoKTtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGNhbmRpZGF0ZSkpIHtcbiAgICAgICAgYWxsRmlsZXNbZmlsZVBhdGhdID0gZnMucmVhZEZpbGVTeW5jKGNhbmRpZGF0ZSwgJ3V0Zi04Jyk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBDYW5kaWRhdGUgMjogbG9vayB1cCBieSBiYXNlbmFtZSBpbiBzZXNzaW9uRmlsZXMgcmVjb3JkZWQgaW4gbWVtb3J5XG4gICAgICBjb25zdCBiYXNlID0gcGF0aC5iYXNlbmFtZShmaWxlUGF0aCk7XG4gICAgICBjb25zdCBtYXRjaCA9IHNlc3Npb25GaWxlcy5maW5kKGYgPT4gcGF0aC5iYXNlbmFtZShmKSA9PT0gYmFzZSk7XG4gICAgICBpZiAobWF0Y2ggJiYgZnMuZXhpc3RzU3luYyhtYXRjaCkpIHtcbiAgICAgICAgYWxsRmlsZXNbZmlsZVBhdGhdID0gZnMucmVhZEZpbGVTeW5jKG1hdGNoLCAndXRmLTgnKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIENhbmRpZGF0ZSAzOiBhdHRlbXB0IGEgcmVjdXJzaXZlIHNjYW4gdW5kZXIgcHJvamVjdCBmb2xkZXIgZm9yIGEgbWF0Y2hpbmcgYmFzZW5hbWUgKGJlc3QtZWZmb3J0KVxuICAgICAgbGV0IGZvdW5kID0gbnVsbCBhcyBzdHJpbmcgfCBudWxsO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgd2FsayA9IChkaXI6IHN0cmluZykgPT4ge1xuICAgICAgICAgIGNvbnN0IGVudHJpZXMgPSBmcy5yZWFkZGlyU3luYyhkaXIsIHsgd2l0aEZpbGVUeXBlczogdHJ1ZSB9KTtcbiAgICAgICAgICBmb3IgKGNvbnN0IGVudCBvZiBlbnRyaWVzKSB7XG4gICAgICAgICAgICBjb25zdCBwID0gcGF0aC5qb2luKGRpciwgZW50Lm5hbWUpO1xuICAgICAgICAgICAgaWYgKGVudC5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICAgIHdhbGsocCk7XG4gICAgICAgICAgICAgIGlmIChmb3VuZCkgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChlbnQuaXNGaWxlKCkgJiYgcGF0aC5iYXNlbmFtZShwKSA9PT0gYmFzZSkge1xuICAgICAgICAgICAgICBmb3VuZCA9IHA7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKHByb2plY3RGb2xkZXIpKSB3YWxrKHByb2plY3RGb2xkZXIpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIGlnbm9yZSBzY2FubmluZyBlcnJvcnNcbiAgICAgIH1cblxuICAgICAgaWYgKGZvdW5kICYmIGZzLmV4aXN0c1N5bmMoZm91bmQpKSB7XG4gICAgICAgIGFsbEZpbGVzW2ZpbGVQYXRoXSA9IGZzLnJlYWRGaWxlU3luYyhmb3VuZCwgJ3V0Zi04Jyk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiBub25lIG9mIHRoZSBhYm92ZSBzdWNjZWVkZWQsIGxlYXZlIHRoZSBjb250ZW50IGFzLWlzIGFuZCB3YXJuXG4gICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBsb2NhdGUgZmlsZSAke2ZpbGVQYXRofSB1bmRlciBwcm9qZWN0IGZvbGRlcjsgdXNpbmcgaW4tbWVtb3J5IGNvbnRlbnQgaWYgYXZhaWxhYmxlLmApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZWFkIGZpbGUgJHtmaWxlUGF0aH0gZm9yIHJldmlldzpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYFlvdSBhcmUgYSBzZW5pb3IgY29kZSByZXZpZXdlci4gUmV2aWV3IHRoZSBnZW5lcmF0ZWQgY29kZSBmb3IgcXVhbGl0eSwgY29tcGxldGVuZXNzLCBhbmQgY29ycmVjdG5lc3MuXG5cbkVWQUxVQVRJT04gQ1JJVEVSSUE6XG4tIENvZGUgcXVhbGl0eSBhbmQgYmVzdCBwcmFjdGljZXNcbi0gUHJvcGVyIGltcG9ydHMgYW5kIGRlcGVuZGVuY2llc1xuLSBFcnJvciBoYW5kbGluZyBhbmQgZWRnZSBjYXNlc1xuLSBUeXBlU2NyaXB0IHR5cGVzIChpZiBhcHBsaWNhYmxlKVxuLSBDb2RlIG9yZ2FuaXphdGlvbiBhbmQgcmVhZGFiaWxpdHlcbi0gQ29tcGxldGVuZXNzIG9mIGltcGxlbWVudGF0aW9uXG4tIEludGVncmF0aW9uIHdpdGggZXhpc3RpbmcgY29kZWJhc2VcblxuT1VUUFVUIEZPUk1BVDpcbkFQUFJPVkVEIG9yIE5FRURTIElNUFJPVkVNRU5UXG5cbklmIE5FRURTIElNUFJPVkVNRU5ULCBwcm92aWRlIHNwZWNpZmljLCBhY3Rpb25hYmxlIGZlZWRiYWNrLlxuSWYgQVBQUk9WRUQsIGNvbmZpcm0gdGhlIGltcGxlbWVudGF0aW9uIGlzIGNvbXBsZXRlIGFuZCByZWFkeS5cblxuQmUgY29uc3RydWN0aXZlIGFuZCBzcGVjaWZpYyBpbiB5b3VyIGZlZWRiYWNrLmA7XG5cbiAgY29uc3QgY29kZVN1bW1hcnkgPSBPYmplY3QuZW50cmllcyhhbGxGaWxlcylcbiAgICAubWFwKChbZmlsZSwgY29udGVudF0pID0+IGA9PT0gJHtmaWxlfSA9PT1cXG4ke2NvbnRlbnQuc3Vic3RyaW5nKDAsIDUwMCl9JHtjb250ZW50Lmxlbmd0aCA+IDUwMCA/ICdcXG4uLi4gKHRydW5jYXRlZCknIDogJyd9YClcbiAgICAuam9pbignXFxuXFxuJyk7XG5cbiAgY29uc3QgbWVzc2FnZXMgPSBbXG4gICAgbmV3IFN5c3RlbU1lc3NhZ2Uoc3lzdGVtUHJvbXB0KSxcbiAgICBuZXcgSHVtYW5NZXNzYWdlKGBSZXZpZXcgdGhlIGZvbGxvd2luZyBnZW5lcmF0ZWQgY29kZTpcXG5cXG4ke2NvZGVTdW1tYXJ5fWApLFxuICBdO1xuXG4gIC8vIFVzZSBtb2RlbC1zcGVjaWZpYyBMTE0gaWYgcHJvdmlkZWQsIG90aGVyd2lzZSB1c2UgZ2xvYmFsIGxsbVxuICBjb25zdCBsbG1Ub1VzZSA9IG1vZGVsID8gY3JlYXRlTExNKG1vZGVsKSA6IGxsbTtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBsbG1Ub1VzZS5pbnZva2UobWVzc2FnZXMpO1xuICBjb25zdCBmZWVkYmFjayA9IHJlc3BvbnNlLmNvbnRlbnQudG9TdHJpbmcoKS50cmltKCk7XG5cbiAgY29uc3QgaXNBcHByb3ZlZCA9IGZlZWRiYWNrLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ0FQUFJPVkVEJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICFmZWVkYmFjay50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdtaXNzaW5nJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICFmZWVkYmFjay50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdub3QgaW1wbGVtZW50ZWQnKTtcblxuICBjb25zb2xlLmxvZyhg8J+UjSBSZXZpZXcgcmVzdWx0OiAke2lzQXBwcm92ZWQgPyAnQVBQUk9WRUQnIDogJ05FRURTIElNUFJPVkVNRU5UJ31gKTtcbiAgY29uc29sZS5sb2coYPCfk50gRmVlZGJhY2s6ICR7ZmVlZGJhY2suc3Vic3RyaW5nKDAsIDEwMCl9Li4uYCk7XG5cbiAgLy8gQWRkIHRvIG1lbW9yeVxuICBhd2FpdCBtZW1vcnkuYWRkTWVzc2FnZSgnYXNzaXN0YW50JywgYFJldmlldzogJHtmZWVkYmFjay5zdWJzdHJpbmcoMCwgMjAwKX0uLi5gKTtcblxuICAvLyBFbWl0IHJldmlldyByZXN1bHRzXG4gIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ3JldmlldycsIGZlZWRiYWNrOiBmZWVkYmFjayB9KTtcblxuICBpZiAoaXNBcHByb3ZlZCkge1xuICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHsgdHlwZTogJ2NvbXBsZXRlJywgbWVzc2FnZTogJ0NvZGUgZ2VuZXJhdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IScgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHJldmlld0ZlZWRiYWNrOiBmZWVkYmFjayxcbiAgICBpc0NvbXBsZXRlOiBpc0FwcHJvdmVkLFxuICAgIHJldmlld0l0ZXJhdGlvbnM6IChzdGF0ZS5yZXZpZXdJdGVyYXRpb25zIHx8IDApICsgMSxcbiAgfTtcbn1cblxuLy8gU3RyZWFtaW5nIEZpeGVyIEFnZW50OiBBZGRyZXNzZXMgcmV2aWV3IGZlZWRiYWNrIGJ5IGZpeGluZyBpc3N1ZXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdHJlYW1pbmdGaXhlckFnZW50KHN0YXRlOiBBZ2VudFN0YXRlVHlwZSwgc2Vzc2lvbklkPzogc3RyaW5nLCBtb2RlbD86IHN0cmluZyk6IFByb21pc2U8UGFydGlhbDxBZ2VudFN0YXRlVHlwZT4+IHtcbiAgZW1pdEV2ZW50KHNlc3Npb25JZCB8fCAnJywgeyB0eXBlOiAnc3RhdHVzJywgbWVzc2FnZTogJ0ZpeGluZyBpc3N1ZXMgYmFzZWQgb24gcmV2aWV3Li4uJyB9KTtcblxuICBjb25zdCBtZW1vcnkgPSBnZXRNZW1vcnkoKTtcbiAgY29uc3QgY29udGV4dFN1bW1hcnkgPSBhd2FpdCBtZW1vcnkuZ2V0Q29tcHJlc3NlZENvbnRleHQoc3RhdGUudXNlclJlcXVlc3QpO1xuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBzb2Z0d2FyZSBlbmdpbmVlci4gRml4IHRoZSBpc3N1ZXMgaWRlbnRpZmllZCBpbiB0aGUgcmV2aWV3IGZlZWRiYWNrLlxuXG5JTlNUUlVDVElPTlM6XG4tIEFkZHJlc3MgZWFjaCBwb2ludCBpbiB0aGUgcmV2aWV3IGZlZWRiYWNrXG4tIE1ha2UgdGFyZ2V0ZWQgZml4ZXMgdXNpbmcgdGhlIGF2YWlsYWJsZSB0b29sc1xuLSBUZXN0IHlvdXIgY2hhbmdlcyBieSByZWFkaW5nIGZpbGVzIGJhY2tcbi0gRW5zdXJlIHRoZSBmaXhlcyBhcmUgY29tcGxldGUgYW5kIGNvcnJlY3Rcbi0gTWFpbnRhaW4gY29kZSBxdWFsaXR5IGFuZCBjb25zaXN0ZW5jeVxuXG4ke2NvbnRleHRTdW1tYXJ5ID8gYENPTlRFWFQ6XFxuJHtzbWFydFRydW5jYXRlKGNvbnRleHRTdW1tYXJ5LCA0MDApfVxcblxcbmAgOiAnJ31cblxuVXNlIHRoZSBzYW1lIHRvb2xzIGFzIGJlZm9yZSB0byBpbXBsZW1lbnQgZml4ZXMuYDtcblxuICBjb25zdCBtZXNzYWdlcyA9IFtcbiAgICBuZXcgU3lzdGVtTWVzc2FnZShzeXN0ZW1Qcm9tcHQpLFxuICAgIG5ldyBIdW1hbk1lc3NhZ2UoYFJldmlldyBmZWVkYmFjayB0byBhZGRyZXNzOiAke3N0YXRlLnJldmlld0ZlZWRiYWNrfVxuXG5DdXJyZW50IGZpbGVzOiAke09iamVjdC5rZXlzKHN0YXRlLmdlbmVyYXRlZEZpbGVzKS5qb2luKCcsICcpfVxuXG5QbGVhc2UgZml4IHRoZSBpZGVudGlmaWVkIGlzc3Vlcy5gKSxcbiAgXTtcblxuICAvLyBVc2UgbW9kZWwtc3BlY2lmaWMgTExNIGlmIHByb3ZpZGVkLCBvdGhlcndpc2UgdXNlIGdsb2JhbCBsbG1XaXRoVG9vbHNcbiAgY29uc3QgbGxtVG9Vc2UgPSBtb2RlbCA/IGNyZWF0ZUxMTShtb2RlbCkgOiBsbG07XG4gIGNvbnN0IGxsbVdpdGhUb29sc1RvVXNlID0gbW9kZWwgPyBsbG1Ub1VzZS5iaW5kVG9vbHModG9vbHMpIDogbGxtV2l0aFRvb2xzO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxsbVdpdGhUb29sc1RvVXNlLmludm9rZShtZXNzYWdlcyk7XG5cbiAgLy8gRXh0cmFjdCBmaXhlZCBmaWxlcyBmcm9tIHRvb2wgY2FsbHMgb3IgcmVzcG9uc2UgY29udGVudFxuICBjb25zdCBnZW5lcmF0ZWRGaWxlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuXG4gIGlmIChyZXNwb25zZS50b29sX2NhbGxzICYmIHJlc3BvbnNlLnRvb2xfY2FsbHMubGVuZ3RoID4gMCkge1xuICAgIGZvciAoY29uc3QgdG9vbENhbGwgb2YgcmVzcG9uc2UudG9vbF9jYWxscykge1xuICAgICAgY29uc29sZS5sb2coYPCflKcgVG9vbCBjYWxsZWQ6ICR7dG9vbENhbGwubmFtZX1gLCB0b29sQ2FsbC5hcmdzKTtcbiAgICAgIGlmICh0b29sQ2FsbC5uYW1lID09PSAnd3JpdGVfZmlsZScgfHwgdG9vbENhbGwubmFtZSA9PT0gJ2FwcGVuZF90b19maWxlJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGFyZ3MgPSB0b29sQ2FsbC5hcmdzIGFzIGFueTtcbiAgICAgICAgICBpZiAoYXJncy5maWxlUGF0aCAmJiBhcmdzLmNvbnRlbnQpIHtcbiAgICAgICAgICAgIGdlbmVyYXRlZEZpbGVzW2FyZ3MuZmlsZVBhdGhdID0gYXJncy5jb250ZW50O1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBwYXJzZSB0b29sIGNhbGwgYXJndW1lbnRzOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogcGFyc2UgZmlsZXMgZnJvbSByZXNwb25zZSBjb250ZW50XG4gICAgY29uc3QgZml4ZWRGaWxlcyA9IHBhcnNlR2VuZXJhdGVkRmlsZXMocmVzcG9uc2UuY29udGVudC50b1N0cmluZygpKTtcbiAgICBPYmplY3QuYXNzaWduKGdlbmVyYXRlZEZpbGVzLCBmaXhlZEZpbGVzKTtcbiAgfVxuXG4gIC8vIEFkZCB0byBtZW1vcnlcbiAgYXdhaXQgbWVtb3J5LmFkZE1lc3NhZ2UoJ2Fzc2lzdGFudCcsIGBGaXhlZCBpc3N1ZXMgYmFzZWQgb24gcmV2aWV3IGZlZWRiYWNrLiBVcGRhdGVkICR7T2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aH0gZmlsZXMuYCk7XG5cbiAgLy8gRW1pdCBmaXhlc1xuICBpZiAoT2JqZWN0LmtleXMoZ2VuZXJhdGVkRmlsZXMpLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBmaWxlcyA9IE9iamVjdC5rZXlzKGdlbmVyYXRlZEZpbGVzKTtcbiAgICBjb25zb2xlLmxvZyhg8J+UpyBSZWFsLXRpbWUgRml4ZXMgQXBwbGllZDogJHtmaWxlcy5qb2luKCcsICcpfWApO1xuICAgIGVtaXRFdmVudChzZXNzaW9uSWQgfHwgJycsIHtcbiAgICAgIHR5cGU6ICdmaWxlc19maXhlZCcsXG4gICAgICBmaWxlczogZmlsZXMsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdlbmVyYXRlZEZpbGVzLFxuICAgIGN1cnJlbnRJdGVyYXRpb246IDAsIC8vIFJlc2V0IHRvIHJlLXJ1biBhbGwgc3RlcHMgd2l0aCBmaXhlc1xuICAgIG1lc3NhZ2VzOiBbbmV3IEFJTWVzc2FnZShgQXBwbGllZCBmaXhlcyBmb3IgcmV2aWV3IGZlZWRiYWNrLiAke09iamVjdC5rZXlzKGdlbmVyYXRlZEZpbGVzKS5sZW5ndGh9IGZpbGVzIHVwZGF0ZWQuYCldLFxuICB9O1xufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBjb250aW51ZSB0aGUgd29ya2Zsb3dcbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRDb250aW51ZShzdGF0ZTogQWdlbnRTdGF0ZVR5cGUpOiBzdHJpbmcge1xuICAvLyBJZiBtYXJrZWQgY29tcGxldGUsIHdlJ3JlIGRvbmVcbiAgaWYgKHN0YXRlLmlzQ29tcGxldGUpIHtcbiAgICByZXR1cm4gJ2VuZCc7XG4gIH1cblxuICAvLyBTdGFydCB3aXRoIHBsYW5uaW5nIGlmIG5vIHBsYW4gZXhpc3RzXG4gIGlmIChzdGF0ZS5wbGFuLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAncGxhbm5lcic7XG4gIH1cblxuICAvLyBJZiB3ZSBoYXZlbid0IGZpbmlzaGVkIGFsbCBzdGVwcywgY29udGludWUgZ2VuZXJhdGluZ1xuICBpZiAoc3RhdGUuY3VycmVudEl0ZXJhdGlvbiA8IHN0YXRlLnBsYW4ubGVuZ3RoKSB7XG4gICAgcmV0dXJuICdnZW5lcmF0b3InO1xuICB9XG5cbiAgLy8gQWxsIHN0ZXBzIGNvbXBsZXRlZCwgbmVlZCByZXZpZXdcbiAgaWYgKCFzdGF0ZS5yZXZpZXdGZWVkYmFjaykge1xuICAgIHJldHVybiAncmV2aWV3ZXInO1xuICB9XG5cbiAgLy8gUmV2aWV3IGZlZWRiYWNrIGV4aXN0cyAtIGNoZWNrIGlmIGFwcHJvdmVkXG4gIGNvbnN0IGZlZWRiYWNrID0gc3RhdGUucmV2aWV3RmVlZGJhY2sudG9VcHBlckNhc2UoKTtcbiAgY29uc3QgaXNBcHByb3ZlZCA9IGZlZWRiYWNrLmluY2x1ZGVzKCdBUFBST1ZFRCcpICYmXG4gICAgICAgICAgICAgICAgICAgICAhZmVlZGJhY2sudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbWlzc2luZycpICYmXG4gICAgICAgICAgICAgICAgICAgICAhZmVlZGJhY2sudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbm90IGltcGxlbWVudGVkJyk7XG5cbiAgaWYgKGlzQXBwcm92ZWQpIHtcbiAgICAvLyBBcHByb3ZlZCAtIHdlJ3JlIGRvbmUhXG4gICAgcmV0dXJuICdlbmQnO1xuICB9XG5cbiAgLy8gTm90IGFwcHJvdmVkIC0gY2hlY2sgaWYgd2UgY2FuIHJldHJ5XG4gIGNvbnN0IHJldmlld0l0ZXIgPSBzdGF0ZS5yZXZpZXdJdGVyYXRpb25zIHx8IDA7XG4gIGlmIChyZXZpZXdJdGVyID49IDMpIHtcbiAgICAvLyBNYXggaXRlcmF0aW9ucyByZWFjaGVkLCBmb3JjZSBlbmRcbiAgICBjb25zb2xlLmxvZygn4pqg77iPICBNYXggcmV2aWV3IGl0ZXJhdGlvbnMgcmVhY2hlZCBpbiByb3V0ZXIsIGVuZGluZycpO1xuICAgIHJldHVybiAnZW5kJztcbiAgfVxuXG4gIC8vIE5vdCBhcHByb3ZlZCBhbmQgY2FuIHJldHJ5IC0gZ28gYmFjayB0byBleGVjdXRvciB0byBmaXggaXNzdWVzXG4gIGNvbnNvbGUubG9nKGDwn5SEIFJldmlldyBub3QgYXBwcm92ZWQgKGl0ZXJhdGlvbiAke3Jldmlld0l0ZXJ9KSwgcmV0cnlpbmcgZXhlY3V0b3IgdG8gZml4IGlzc3Vlc2ApO1xuXG4gIC8vIFJlc2V0IGN1cnJlbnQgaXRlcmF0aW9uIHRvIHJlLWV4ZWN1dGUgYWxsIHN0ZXBzIHdpdGggZmVlZGJhY2tcbiAgcmV0dXJuICdmaXhfaXNzdWVzJztcbn0iXSwibmFtZXMiOlsiSHVtYW5NZXNzYWdlIiwiQUlNZXNzYWdlIiwiU3lzdGVtTWVzc2FnZSIsInByb21wdE9wdGltaXplciIsInNtYXJ0VHJ1bmNhdGUiLCJnZXRNZW1vcnkiLCJnZXRQcm9qZWN0Rm9sZGVyIiwibGxtIiwiY3JlYXRlTExNIiwidG9vbHMiLCJwYXRoIiwiZW1pdEV2ZW50Iiwic2V0RW1pdEZ1bmN0aW9uIiwiZm4iLCJsbG1XaXRoVG9vbHMiLCJiaW5kVG9vbHMiLCJwYXJzZUdlbmVyYXRlZEZpbGVzIiwiY29udGVudCIsImZpbGVzIiwiZmlsZVJlZ2V4IiwibWF0Y2giLCJleGVjIiwiZmlsZW5hbWUiLCJ0cmltIiwiY29kZSIsInN0cmVhbWluZ1BsYW5uZXJBZ2VudCIsInN0YXRlIiwic2Vzc2lvbklkIiwibW9kZWwiLCJ0eXBlIiwibWVzc2FnZSIsIm1lbW9yeSIsImFkZE1lc3NhZ2UiLCJ1c2VyUmVxdWVzdCIsImNvbnRleHRTdW1tYXJ5IiwiZ2V0Q29tcHJlc3NlZENvbnRleHQiLCJzZXNzaW9uRmlsZXMiLCJnZXRTZXNzaW9uRmlsZXMiLCJoYXNFeGlzdGluZ0ZpbGVzIiwiT2JqZWN0Iiwia2V5cyIsImdlbmVyYXRlZEZpbGVzIiwibGVuZ3RoIiwic3lzdGVtUHJvbXB0Iiwiam9pbiIsIm9wdGltaXplU3lzdGVtUHJvbXB0IiwidW5kZWZpbmVkIiwiY29udGV4dEluZm8iLCJhbGxGaWxlcyIsIkFycmF5IiwiZnJvbSIsIlNldCIsIm1hcCIsImYiLCJtZXNzYWdlcyIsImxsbVRvVXNlIiwicmVzcG9uc2UiLCJpbnZva2UiLCJwbGFuVGV4dCIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwicGxhblN0ZXBzIiwic3BsaXQiLCJmaWx0ZXIiLCJsaW5lIiwidGVzdCIsInJlcGxhY2UiLCJzdGVwIiwic2xpY2UiLCJjb25zb2xlIiwibG9nIiwicGxhbiIsInN0cmVhbWluZ0NvZGVHZW5lcmF0b3JBZ2VudCIsImN1cnJlbnRTdGVwIiwiY3VycmVudEl0ZXJhdGlvbiIsInN0ZXBUb0ltcGxlbWVudCIsImlzQ29tcGxldGUiLCJleGlzdGluZ0ZpbGVzIiwiZmlsZSIsInRoZW4iLCJmcyIsInJlYWRGaWxlU3luYyIsImVycm9yIiwid2FybiIsInVzZXJQcm9tcHQiLCJyZXZpZXdGZWVkYmFjayIsImxsbVdpdGhUb29sc1RvVXNlIiwiY2hhaW5PZlRob3VnaHQiLCJ0b29sX2NhbGxzIiwidG9vbENhbGwiLCJuYW1lIiwiYXJncyIsImZpbGVQYXRoIiwibmV3RmlsZXMiLCJhc3NpZ24iLCJjb3RNYXRjaCIsInJlYXNvbmluZyIsInN0cmVhbWluZ1Jldmlld2VyQWdlbnQiLCJwcm9qZWN0Rm9sZGVyIiwiY2FuZGlkYXRlIiwiaXNBYnNvbHV0ZSIsImV4aXN0c1N5bmMiLCJiYXNlIiwiYmFzZW5hbWUiLCJmaW5kIiwiZm91bmQiLCJ3YWxrIiwiZGlyIiwiZW50cmllcyIsInJlYWRkaXJTeW5jIiwid2l0aEZpbGVUeXBlcyIsImVudCIsInAiLCJpc0RpcmVjdG9yeSIsImlzRmlsZSIsImVyciIsImNvZGVTdW1tYXJ5IiwiZmVlZGJhY2siLCJpc0FwcHJvdmVkIiwidG9VcHBlckNhc2UiLCJpbmNsdWRlcyIsInRvTG93ZXJDYXNlIiwicmV2aWV3SXRlcmF0aW9ucyIsInN0cmVhbWluZ0ZpeGVyQWdlbnQiLCJmaXhlZEZpbGVzIiwic2hvdWxkQ29udGludWUiLCJyZXZpZXdJdGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/streaming-agents.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/tools.ts":
/*!*****************************!*\
  !*** ./lib/agents/tools.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendToFileTool: () => (/* binding */ appendToFileTool),\n/* harmony export */   copyFileTool: () => (/* binding */ copyFileTool),\n/* harmony export */   createDirectoryTool: () => (/* binding */ createDirectoryTool),\n/* harmony export */   deleteFileTool: () => (/* binding */ deleteFileTool),\n/* harmony export */   deleteLinesTool: () => (/* binding */ deleteLinesTool),\n/* harmony export */   executeCommandTool: () => (/* binding */ executeCommandTool),\n/* harmony export */   getFileInfoTool: () => (/* binding */ getFileInfoTool),\n/* harmony export */   getProjectStructureTool: () => (/* binding */ getProjectStructureTool),\n/* harmony export */   insertAtLineTool: () => (/* binding */ insertAtLineTool),\n/* harmony export */   listDirectoryTool: () => (/* binding */ listDirectoryTool),\n/* harmony export */   moveFileTool: () => (/* binding */ moveFileTool),\n/* harmony export */   readFileTool: () => (/* binding */ readFileTool),\n/* harmony export */   readLinesTool: () => (/* binding */ readLinesTool),\n/* harmony export */   replaceBlockTool: () => (/* binding */ replaceBlockTool),\n/* harmony export */   replaceInFileTool: () => (/* binding */ replaceInFileTool),\n/* harmony export */   replaceLineRangeTool: () => (/* binding */ replaceLineRangeTool),\n/* harmony export */   searchFilesTool: () => (/* binding */ searchFilesTool),\n/* harmony export */   tools: () => (/* binding */ tools),\n/* harmony export */   wrapToolWithLogging: () => (/* binding */ wrapToolWithLogging),\n/* harmony export */   writeFileTool: () => (/* binding */ writeFileTool)\n/* harmony export */ });\n/* harmony import */ var _langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/core/tools */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/tools/index.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.76/node_modules/zod/v3/types.js\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_fileops__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/fileops */ \"(rsc)/./lib/utils/fileops.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/agents/utils.ts\");\n/* harmony import */ var _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/tool-logger */ \"(rsc)/./lib/utils/tool-logger.ts\");\n\n\n\n\n\n\n\n// File operation tools\nconst readFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath })=>{\n    // Resolve path relative to project folder\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📖 Reading file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n    if (result.success) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"read\", fullPath);\n        return `File content:\\n${result.content}`;\n    } else {\n        return `Error reading file: ${result.error}`;\n    }\n}, {\n    name: \"read_file\",\n    description: \"Read the contents of a file. Use this to examine existing code or documents.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileReadSchema\n});\nconst writeFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, content })=>{\n    // Resolve path relative to project folder\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📝 Writing file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, content);\n    if (result.success) {\n        const exists = fs__WEBPACK_IMPORTED_MODULE_1__.existsSync(fullPath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(exists ? \"modified\" : \"created\", fullPath);\n        return `File written successfully: ${fullPath}`;\n    } else {\n        return `Error writing file: ${result.error}`;\n    }\n}, {\n    name: \"write_file\",\n    description: \"Create or overwrite a file with content. Use this to create new files or completely replace existing ones.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileWriteSchema\n});\nconst appendToFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, content })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📎 Appending to file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.appendToFile)(fullPath, content);\n    if (result.success) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n        return `Content appended successfully to: ${fullPath}`;\n    } else {\n        return `Error appending to file: ${result.error}`;\n    }\n}, {\n    name: \"append_to_file\",\n    description: \"Append content to the end of an existing file. Use this to add to existing files.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileAppendSchema\n});\nconst deleteFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`🗑️ Deleting file: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.deleteFile)(fullPath);\n    if (result.success) {\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"deleted\", fullPath);\n        return `File deleted successfully: ${fullPath}`;\n    } else {\n        return `Error deleting file: ${result.error}`;\n    }\n}, {\n    name: \"delete_file\",\n    description: \"Delete a file. Only works on files in the generated directory for security.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileDeleteSchema\n});\nconst listDirectoryTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ dirPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(dirPath) ? dirPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, dirPath);\n    console.log(`📂 Listing directory: ${fullPath}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.listDirectory)(fullPath);\n    if (result.success && result.files) {\n        return `Directory contents:\\n${result.files.join(\"\\n\")}`;\n    } else {\n        return `Error listing directory: ${result.error}`;\n    }\n}, {\n    name: \"list_directory\",\n    description: \"List the contents of a directory. Use this to see what files are available.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.DirectoryListSchema\n});\nconst searchFilesTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ dirPath, pattern })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(dirPath) ? dirPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, dirPath);\n    console.log(`🔍 Searching files in ${fullPath} for pattern: ${pattern}`);\n    const result = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.searchFiles)(fullPath, pattern);\n    if (result.success && result.matches) {\n        const matchesText = result.matches.slice(0, 20) // Limit to first 20 matches\n        .map((match)=>`${match.file}:${match.line} - ${match.content}`).join(\"\\n\");\n        return `${result.matches.length} matches found:\\n${matchesText}${result.matches.length > 20 ? \"\\n... (showing first 20)\" : \"\"}`;\n    } else {\n        return `Error searching files: ${result.error}`;\n    }\n}, {\n    name: \"search_files\",\n    description: \"Search for files containing a regex pattern. Use this to find specific code patterns or text.\",\n    schema: _utils_fileops__WEBPACK_IMPORTED_MODULE_3__.FileSearchSchema\n});\n// Advanced code editing tools\nconst replaceInFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, searchText, replaceText })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`✏️ Replacing text in file: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const originalContent = readResult.content;\n        const newContent = originalContent.replace(new RegExp(searchText, \"g\"), replaceText);\n        const replacementCount = (originalContent.match(new RegExp(searchText, \"g\")) || []).length;\n        if (replacementCount === 0) {\n            return `No matches found for \"${searchText}\" in ${fullPath}`;\n        }\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            return `Replaced ${replacementCount} occurrence(s) of \"${searchText}\" with \"${replaceText}\" in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"replace_in_file\",\n    description: \"Find and replace text in a file using regex. Use this for refactoring or fixing code patterns.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\"),\n        searchText: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Text or regex pattern to search for\"),\n        replaceText: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Text to replace with\")\n    })\n});\nconst insertAtLineTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, lineNumber, content })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📍 Inserting at line ${lineNumber} in: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (lineNumber < 1 || lineNumber > lines.length + 1) {\n            return `Error: Line number ${lineNumber} is out of range (file has ${lines.length} lines)`;\n        }\n        lines.splice(lineNumber - 1, 0, content);\n        const newContent = lines.join(\"\\n\");\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            return `Inserted content at line ${lineNumber} in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"insert_at_line\",\n    description: \"Insert content at a specific line number in a file. Use this for precise code additions.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\"),\n        lineNumber: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Line number where content should be inserted (1-based)\"),\n        content: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Content to insert\")\n    })\n});\nconst deleteLinesTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startLine, endLine })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`✂️ Deleting lines ${startLine}-${endLine} in: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (startLine < 1 || endLine > lines.length || startLine > endLine) {\n            return `Error: Invalid line range ${startLine}-${endLine} (file has ${lines.length} lines)`;\n        }\n        lines.splice(startLine - 1, endLine - startLine + 1);\n        const newContent = lines.join(\"\\n\");\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            return `Deleted lines ${startLine}-${endLine} in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"delete_lines\",\n    description: \"Delete a range of lines from a file. Use this to remove code blocks.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\"),\n        startLine: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Starting line number (1-based, inclusive)\"),\n        endLine: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Ending line number (1-based, inclusive)\")\n    })\n});\nconst replaceBlockTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startMarker, endMarker, newContent })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`🔄 Replacing block in: ${fullPath}`);\n    console.log(`   Start marker: ${startMarker}`);\n    console.log(`   End marker: ${endMarker}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const content = readResult.content;\n        // Find start and end positions\n        const startIdx = content.indexOf(startMarker);\n        if (startIdx === -1) {\n            return `Error: Start marker \"${startMarker}\" not found in ${fullPath}`;\n        }\n        const endIdx = content.indexOf(endMarker, startIdx + startMarker.length);\n        if (endIdx === -1) {\n            return `Error: End marker \"${endMarker}\" not found after start marker in ${fullPath}`;\n        }\n        // Replace the block (including markers)\n        const before = content.substring(0, startIdx);\n        const after = content.substring(endIdx + endMarker.length);\n        const newFileContent = before + startMarker + \"\\n\" + newContent + \"\\n\" + endMarker + after;\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newFileContent);\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            const oldBlock = content.substring(startIdx, endIdx + endMarker.length);\n            return `Successfully replaced block in ${fullPath}\\nOld block (${oldBlock.split(\"\\n\").length} lines) → New block (${newContent.split(\"\\n\").length} lines)`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"replace_block\",\n    description: \"Replace a block of code between two markers. More efficient than rewriting entire file. Perfect for updating functions, classes, or sections.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\"),\n        startMarker: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe('Unique text that marks the start of the block (e.g., \"function myFunc(\" or \"// START SECTION\")'),\n        endMarker: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe('Unique text that marks the end of the block (e.g., \"}\" or \"// END SECTION\")'),\n        newContent: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"New content to replace the block between markers (markers will be preserved)\")\n    })\n});\nconst replaceLineRangeTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startLine, endLine, newContent })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📝 Replacing lines ${startLine}-${endLine} in: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (startLine < 1 || endLine > lines.length || startLine > endLine) {\n            return `Error: Invalid line range ${startLine}-${endLine} (file has ${lines.length} lines)`;\n        }\n        // Replace the line range\n        const before = lines.slice(0, startLine - 1);\n        const after = lines.slice(endLine);\n        const newLines = newContent.split(\"\\n\");\n        const newFileLines = [\n            ...before,\n            ...newLines,\n            ...after\n        ];\n        const writeResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.writeFile)(fullPath, newFileLines.join(\"\\n\"));\n        if (writeResult.success) {\n            (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"modified\", fullPath);\n            const oldLineCount = endLine - startLine + 1;\n            const newLineCount = newLines.length;\n            return `Replaced lines ${startLine}-${endLine} (${oldLineCount} lines) with new content (${newLineCount} lines) in ${fullPath}`;\n        } else {\n            return `Error writing file: ${writeResult.error}`;\n        }\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"replace_line_range\",\n    description: \"Replace a specific range of lines with new content. More precise than replace_block. Use when you know exact line numbers.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\"),\n        startLine: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Starting line number (1-based, inclusive)\"),\n        endLine: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Ending line number (1-based, inclusive)\"),\n        newContent: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"New content to replace the specified lines\")\n    })\n});\nconst getFileInfoTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`ℹ️ Getting file info: ${fullPath}`);\n    try {\n        const stats = fs__WEBPACK_IMPORTED_MODULE_1__.statSync(fullPath);\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        const extension = path__WEBPACK_IMPORTED_MODULE_2__.extname(fullPath);\n        return JSON.stringify({\n            path: fullPath,\n            size: stats.size,\n            lines: lines.length,\n            extension,\n            created: stats.birthtime,\n            modified: stats.mtime,\n            isDirectory: stats.isDirectory()\n        }, null, 2);\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"get_file_info\",\n    description: \"Get detailed information about a file (size, lines, dates, etc.). Use this to understand file structure.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\")\n    })\n});\nconst createDirectoryTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ dirPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(dirPath) ? dirPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, dirPath);\n    console.log(`📁 Creating directory: ${fullPath}`);\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1__.mkdirSync(fullPath, {\n            recursive: true\n        });\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"created\", fullPath);\n        return `Directory created successfully: ${fullPath}`;\n    } catch (error) {\n        return `Error creating directory: ${error.message}`;\n    }\n}, {\n    name: \"create_directory\",\n    description: \"Create a new directory (including parent directories if needed). Use this to organize project structure.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        dirPath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the directory to create\")\n    })\n});\nconst copyFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ sourcePath, destinationPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullSourcePath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(sourcePath) ? sourcePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, sourcePath);\n    const fullDestPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(destinationPath) ? destinationPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, destinationPath);\n    console.log(`📋 Copying file from ${fullSourcePath} to ${fullDestPath}`);\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1__.copyFileSync(fullSourcePath, fullDestPath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"created\", fullDestPath);\n        return `File copied successfully from ${fullSourcePath} to ${fullDestPath}`;\n    } catch (error) {\n        return `Error copying file: ${error.message}`;\n    }\n}, {\n    name: \"copy_file\",\n    description: \"Copy a file to a new location. Use this to duplicate files or create templates.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        sourcePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Source file path\"),\n        destinationPath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Destination file path\")\n    })\n});\nconst moveFileTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ sourcePath, destinationPath })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullSourcePath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(sourcePath) ? sourcePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, sourcePath);\n    const fullDestPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(destinationPath) ? destinationPath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, destinationPath);\n    console.log(`🚚 Moving file from ${fullSourcePath} to ${fullDestPath}`);\n    try {\n        fs__WEBPACK_IMPORTED_MODULE_1__.renameSync(fullSourcePath, fullDestPath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"deleted\", fullSourcePath);\n        (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getMemory)().addFileOperation(\"created\", fullDestPath);\n        return `File moved successfully from ${fullSourcePath} to ${fullDestPath}`;\n    } catch (error) {\n        return `Error moving file: ${error.message}`;\n    }\n}, {\n    name: \"move_file\",\n    description: \"Move or rename a file. Use this to reorganize project structure.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        sourcePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Source file path\"),\n        destinationPath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Destination file path\")\n    })\n});\nconst readLinesTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ filePath, startLine, endLine })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.isAbsolute(filePath) ? filePath : path__WEBPACK_IMPORTED_MODULE_2__.join(projectFolder, filePath);\n    console.log(`📖 Reading lines ${startLine}-${endLine} from: ${fullPath}`);\n    try {\n        const readResult = await (0,_utils_fileops__WEBPACK_IMPORTED_MODULE_3__.readFile)(fullPath);\n        if (!readResult.success || !readResult.content) {\n            return `Error: Could not read file ${fullPath}`;\n        }\n        const lines = readResult.content.split(\"\\n\");\n        if (startLine < 1 || endLine > lines.length || startLine > endLine) {\n            return `Error: Invalid line range ${startLine}-${endLine} (file has ${lines.length} lines)`;\n        }\n        const selectedLines = lines.slice(startLine - 1, endLine);\n        return `Lines ${startLine}-${endLine} of ${fullPath}:\\n${selectedLines.join(\"\\n\")}`;\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"read_lines\",\n    description: \"Read a specific range of lines from a file. Use this to examine specific code sections.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        filePath: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Path to the file\"),\n        startLine: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Starting line number (1-based, inclusive)\"),\n        endLine: zod__WEBPACK_IMPORTED_MODULE_6__.number().describe(\"Ending line number (1-based, inclusive)\")\n    })\n});\nconst getProjectStructureTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ maxDepth })=>{\n    const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n    console.log(`🗂️ Getting project structure from: ${projectFolder}`);\n    try {\n        const structure = [];\n        const traverseDirectory = (dir, depth, prefix = \"\")=>{\n            if (depth > maxDepth) return;\n            const items = fs__WEBPACK_IMPORTED_MODULE_1__.readdirSync(dir);\n            items.forEach((item, index)=>{\n                const fullPath = path__WEBPACK_IMPORTED_MODULE_2__.join(dir, item);\n                const isLast = index === items.length - 1;\n                const connector = isLast ? \"└── \" : \"├── \";\n                const relativePath = path__WEBPACK_IMPORTED_MODULE_2__.relative(projectFolder, fullPath);\n                // Skip node_modules and hidden files\n                if (item === \"node_modules\" || item.startsWith(\".\")) return;\n                structure.push(`${prefix}${connector}${item}`);\n                if (fs__WEBPACK_IMPORTED_MODULE_1__.statSync(fullPath).isDirectory()) {\n                    const newPrefix = prefix + (isLast ? \"    \" : \"│   \");\n                    traverseDirectory(fullPath, depth + 1, newPrefix);\n                }\n            });\n        };\n        traverseDirectory(projectFolder, 0);\n        return `Project structure:\\n${projectFolder}\\n${structure.join(\"\\n\")}`;\n    } catch (error) {\n        return `Error: ${error.message}`;\n    }\n}, {\n    name: \"get_project_structure\",\n    description: \"Get a tree view of the project directory structure. Use this to understand project organization.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        maxDepth: zod__WEBPACK_IMPORTED_MODULE_6__.number().default(3).describe(\"Maximum depth to traverse (default: 3)\")\n    })\n});\nconst executeCommandTool = (0,_langchain_core_tools__WEBPACK_IMPORTED_MODULE_0__.tool)(async ({ command, description })=>{\n    console.log(`⚙️ Executing command: ${command}`);\n    console.log(`📝 Description: ${description}`);\n    try {\n        const { execSync } = __webpack_require__(/*! child_process */ \"child_process\");\n        const projectFolder = (0,_utils__WEBPACK_IMPORTED_MODULE_4__.getProjectFolder)();\n        // Execute command in project folder\n        const output = execSync(command, {\n            cwd: projectFolder,\n            encoding: \"utf-8\",\n            maxBuffer: 1024 * 1024 * 10,\n            timeout: 30000\n        });\n        return `Command executed successfully:\\n${output}`;\n    } catch (error) {\n        return `Command failed with error:\\n${error.message}\\n${error.stdout || \"\"}\\n${error.stderr || \"\"}`;\n    }\n}, {\n    name: \"execute_command\",\n    description: \"Execute a shell command in the project directory. Use this for npm install, git operations, building, testing, etc. ALWAYS provide a clear description.\",\n    schema: zod__WEBPACK_IMPORTED_MODULE_6__.object({\n        command: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Shell command to execute\"),\n        description: zod__WEBPACK_IMPORTED_MODULE_6__.string().describe(\"Clear description of what this command does and why\")\n    })\n});\n// Create the tools array with all tools\nconst tools = [\n    // Basic file operations\n    readFileTool,\n    writeFileTool,\n    appendToFileTool,\n    deleteFileTool,\n    listDirectoryTool,\n    searchFilesTool,\n    // Advanced editing tools\n    replaceInFileTool,\n    insertAtLineTool,\n    deleteLinesTool,\n    replaceBlockTool,\n    replaceLineRangeTool,\n    readLinesTool,\n    // File management\n    getFileInfoTool,\n    createDirectoryTool,\n    copyFileTool,\n    moveFileTool,\n    // Project tools\n    getProjectStructureTool,\n    executeCommandTool\n];\n// Helper function to wrap tool execution with logging\nfunction wrapToolWithLogging(toolFn, toolName) {\n    return async (...args)=>{\n        const callId = _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__.toolLogger.startCall(toolName, args[0] || {});\n        try {\n            const result = await toolFn(...args);\n            _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__.toolLogger.endCall(callId, result, true);\n            return result;\n        } catch (error) {\n            const errorMsg = error.message || String(error);\n            _utils_tool_logger__WEBPACK_IMPORTED_MODULE_5__.toolLogger.endCall(callId, errorMsg, false, errorMsg);\n            throw error;\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sSUFBSSxHQUFHLEVBQUUsRUFBRXBILE1BQU1xSCxNQUFNLElBQUksR0FBRyxDQUFDO0lBQ3JHO0FBQ0YsR0FBRztJQUNEcEgsTUFBTTtJQUNOQyxhQUFhO0lBQ2JDLFFBQVFqQyx1Q0FBUSxDQUFDO1FBQ2YwSSxTQUFTMUksdUNBQVEsR0FBR2lFLFFBQVEsQ0FBQztRQUM3QmpDLGFBQWFoQyx1Q0FBUSxHQUFHaUUsUUFBUSxDQUFDO0lBQ25DO0FBQ0YsR0FBRztBQUVILHdDQUF3QztBQUNqQyxNQUFNbUYsUUFBUTtJQUNuQix3QkFBd0I7SUFDeEJsSTtJQUNBZ0I7SUFDQUc7SUFDQUM7SUFDQUM7SUFDQUc7SUFDQSx5QkFBeUI7SUFDekJVO0lBQ0FjO0lBQ0FNO0lBQ0FHO0lBQ0FXO0lBQ0E2QjtJQUNBLGtCQUFrQjtJQUNsQnhCO0lBQ0FhO0lBQ0FHO0lBQ0FNO0lBQ0EsZ0JBQWdCO0lBQ2hCSTtJQUNBb0I7Q0FDRCxDQUFDO0FBRUYsc0RBQXNEO0FBQy9DLFNBQVNZLG9CQUFvQkMsTUFBVyxFQUFFQyxRQUFnQjtJQUMvRCxPQUFPLE9BQU8sR0FBR0M7UUFDZixNQUFNQyxTQUFTeEksMERBQVVBLENBQUN5SSxTQUFTLENBQUNILFVBQVVDLElBQUksQ0FBQyxFQUFFLElBQUksQ0FBQztRQUMxRCxJQUFJO1lBQ0YsTUFBTTlILFNBQVMsTUFBTTRILFVBQVVFO1lBQy9CdkksMERBQVVBLENBQUMwSSxPQUFPLENBQUNGLFFBQVEvSCxRQUFRO1lBQ25DLE9BQU9BO1FBQ1QsRUFBRSxPQUFPSSxPQUFZO1lBQ25CLE1BQU04SCxXQUFXOUgsTUFBTWdDLE9BQU8sSUFBSStGLE9BQU8vSDtZQUN6Q2IsMERBQVVBLENBQUMwSSxPQUFPLENBQUNGLFFBQVFHLFVBQVUsT0FBT0E7WUFDNUMsTUFBTTlIO1FBQ1I7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvLi9saWIvYWdlbnRzL3Rvb2xzLnRzPzIwNDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdG9vbCB9IGZyb20gJ0BsYW5nY2hhaW4vY29yZS90b29scyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQge1xuICByZWFkRmlsZSxcbiAgd3JpdGVGaWxlLFxuICBhcHBlbmRUb0ZpbGUsXG4gIGRlbGV0ZUZpbGUsXG4gIGxpc3REaXJlY3RvcnksXG4gIHNlYXJjaEZpbGVzLFxuICBGaWxlUmVhZFNjaGVtYSxcbiAgRmlsZVdyaXRlU2NoZW1hLFxuICBGaWxlQXBwZW5kU2NoZW1hLFxuICBGaWxlRGVsZXRlU2NoZW1hLFxuICBEaXJlY3RvcnlMaXN0U2NoZW1hLFxuICBGaWxlU2VhcmNoU2NoZW1hXG59IGZyb20gJy4uL3V0aWxzL2ZpbGVvcHMnO1xuaW1wb3J0IHsgZ2V0TWVtb3J5LCBnZXRQcm9qZWN0Rm9sZGVyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyB0b29sTG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvdG9vbC1sb2dnZXInO1xuXG4vLyBGaWxlIG9wZXJhdGlvbiB0b29sc1xuZXhwb3J0IGNvbnN0IHJlYWRGaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGggfSkgPT4ge1xuICAvLyBSZXNvbHZlIHBhdGggcmVsYXRpdmUgdG8gcHJvamVjdCBmb2xkZXJcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OWIFJlYWRpbmcgZmlsZTogJHtmdWxsUGF0aH1gKTtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVhZEZpbGUoZnVsbFBhdGgpO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ3JlYWQnLCBmdWxsUGF0aCk7XG4gICAgcmV0dXJuIGBGaWxlIGNvbnRlbnQ6XFxuJHtyZXN1bHQuY29udGVudH1gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBgRXJyb3IgcmVhZGluZyBmaWxlOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdyZWFkX2ZpbGUnLFxuICBkZXNjcmlwdGlvbjogJ1JlYWQgdGhlIGNvbnRlbnRzIG9mIGEgZmlsZS4gVXNlIHRoaXMgdG8gZXhhbWluZSBleGlzdGluZyBjb2RlIG9yIGRvY3VtZW50cy4nLFxuICBzY2hlbWE6IEZpbGVSZWFkU2NoZW1hLFxufSk7XG5cbmV4cG9ydCBjb25zdCB3cml0ZUZpbGVUb29sID0gdG9vbChhc3luYyAoeyBmaWxlUGF0aCwgY29udGVudCB9KSA9PiB7XG4gIC8vIFJlc29sdmUgcGF0aCByZWxhdGl2ZSB0byBwcm9qZWN0IGZvbGRlclxuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk50gV3JpdGluZyBmaWxlOiAke2Z1bGxQYXRofWApO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIGNvbnRlbnQpO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIGNvbnN0IGV4aXN0cyA9IGZzLmV4aXN0c1N5bmMoZnVsbFBhdGgpO1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oZXhpc3RzID8gJ21vZGlmaWVkJyA6ICdjcmVhdGVkJywgZnVsbFBhdGgpO1xuICAgIHJldHVybiBgRmlsZSB3cml0dGVuIHN1Y2Nlc3NmdWxseTogJHtmdWxsUGF0aH1gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBgRXJyb3Igd3JpdGluZyBmaWxlOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICd3cml0ZV9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdDcmVhdGUgb3Igb3ZlcndyaXRlIGEgZmlsZSB3aXRoIGNvbnRlbnQuIFVzZSB0aGlzIHRvIGNyZWF0ZSBuZXcgZmlsZXMgb3IgY29tcGxldGVseSByZXBsYWNlIGV4aXN0aW5nIG9uZXMuJyxcbiAgc2NoZW1hOiBGaWxlV3JpdGVTY2hlbWEsXG59KTtcblxuZXhwb3J0IGNvbnN0IGFwcGVuZFRvRmlsZVRvb2wgPSB0b29sKGFzeW5jICh7IGZpbGVQYXRoLCBjb250ZW50IH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OOIEFwcGVuZGluZyB0byBmaWxlOiAke2Z1bGxQYXRofWApO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcHBlbmRUb0ZpbGUoZnVsbFBhdGgsIGNvbnRlbnQpO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ21vZGlmaWVkJywgZnVsbFBhdGgpO1xuICAgIHJldHVybiBgQ29udGVudCBhcHBlbmRlZCBzdWNjZXNzZnVsbHkgdG86ICR7ZnVsbFBhdGh9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYEVycm9yIGFwcGVuZGluZyB0byBmaWxlOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdhcHBlbmRfdG9fZmlsZScsXG4gIGRlc2NyaXB0aW9uOiAnQXBwZW5kIGNvbnRlbnQgdG8gdGhlIGVuZCBvZiBhbiBleGlzdGluZyBmaWxlLiBVc2UgdGhpcyB0byBhZGQgdG8gZXhpc3RpbmcgZmlsZXMuJyxcbiAgc2NoZW1hOiBGaWxlQXBwZW5kU2NoZW1hLFxufSk7XG5cbmV4cG9ydCBjb25zdCBkZWxldGVGaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGggfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfl5HvuI8gRGVsZXRpbmcgZmlsZTogJHtmdWxsUGF0aH1gKTtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGVsZXRlRmlsZShmdWxsUGF0aCk7XG5cbiAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignZGVsZXRlZCcsIGZ1bGxQYXRoKTtcbiAgICByZXR1cm4gYEZpbGUgZGVsZXRlZCBzdWNjZXNzZnVsbHk6ICR7ZnVsbFBhdGh9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYEVycm9yIGRlbGV0aW5nIGZpbGU6ICR7cmVzdWx0LmVycm9yfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2RlbGV0ZV9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdEZWxldGUgYSBmaWxlLiBPbmx5IHdvcmtzIG9uIGZpbGVzIGluIHRoZSBnZW5lcmF0ZWQgZGlyZWN0b3J5IGZvciBzZWN1cml0eS4nLFxuICBzY2hlbWE6IEZpbGVEZWxldGVTY2hlbWEsXG59KTtcblxuZXhwb3J0IGNvbnN0IGxpc3REaXJlY3RvcnlUb29sID0gdG9vbChhc3luYyAoeyBkaXJQYXRoIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZGlyUGF0aCkgPyBkaXJQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGRpclBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OCIExpc3RpbmcgZGlyZWN0b3J5OiAke2Z1bGxQYXRofWApO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBsaXN0RGlyZWN0b3J5KGZ1bGxQYXRoKTtcblxuICBpZiAocmVzdWx0LnN1Y2Nlc3MgJiYgcmVzdWx0LmZpbGVzKSB7XG4gICAgcmV0dXJuIGBEaXJlY3RvcnkgY29udGVudHM6XFxuJHtyZXN1bHQuZmlsZXMuam9pbignXFxuJyl9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYEVycm9yIGxpc3RpbmcgZGlyZWN0b3J5OiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdsaXN0X2RpcmVjdG9yeScsXG4gIGRlc2NyaXB0aW9uOiAnTGlzdCB0aGUgY29udGVudHMgb2YgYSBkaXJlY3RvcnkuIFVzZSB0aGlzIHRvIHNlZSB3aGF0IGZpbGVzIGFyZSBhdmFpbGFibGUuJyxcbiAgc2NoZW1hOiBEaXJlY3RvcnlMaXN0U2NoZW1hLFxufSk7XG5cbmV4cG9ydCBjb25zdCBzZWFyY2hGaWxlc1Rvb2wgPSB0b29sKGFzeW5jICh7IGRpclBhdGgsIHBhdHRlcm4gfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShkaXJQYXRoKSA/IGRpclBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZGlyUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCflI0gU2VhcmNoaW5nIGZpbGVzIGluICR7ZnVsbFBhdGh9IGZvciBwYXR0ZXJuOiAke3BhdHRlcm59YCk7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlYXJjaEZpbGVzKGZ1bGxQYXRoLCBwYXR0ZXJuKTtcblxuICBpZiAocmVzdWx0LnN1Y2Nlc3MgJiYgcmVzdWx0Lm1hdGNoZXMpIHtcbiAgICBjb25zdCBtYXRjaGVzVGV4dCA9IHJlc3VsdC5tYXRjaGVzXG4gICAgICAuc2xpY2UoMCwgMjApIC8vIExpbWl0IHRvIGZpcnN0IDIwIG1hdGNoZXNcbiAgICAgIC5tYXAobWF0Y2ggPT4gYCR7bWF0Y2guZmlsZX06JHttYXRjaC5saW5lfSAtICR7bWF0Y2guY29udGVudH1gKVxuICAgICAgLmpvaW4oJ1xcbicpO1xuXG4gICAgcmV0dXJuIGAke3Jlc3VsdC5tYXRjaGVzLmxlbmd0aH0gbWF0Y2hlcyBmb3VuZDpcXG4ke21hdGNoZXNUZXh0fSR7cmVzdWx0Lm1hdGNoZXMubGVuZ3RoID4gMjAgPyAnXFxuLi4uIChzaG93aW5nIGZpcnN0IDIwKScgOiAnJ31gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBgRXJyb3Igc2VhcmNoaW5nIGZpbGVzOiAke3Jlc3VsdC5lcnJvcn1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdzZWFyY2hfZmlsZXMnLFxuICBkZXNjcmlwdGlvbjogJ1NlYXJjaCBmb3IgZmlsZXMgY29udGFpbmluZyBhIHJlZ2V4IHBhdHRlcm4uIFVzZSB0aGlzIHRvIGZpbmQgc3BlY2lmaWMgY29kZSBwYXR0ZXJucyBvciB0ZXh0LicsXG4gIHNjaGVtYTogRmlsZVNlYXJjaFNjaGVtYSxcbn0pO1xuXG4vLyBBZHZhbmNlZCBjb2RlIGVkaXRpbmcgdG9vbHNcbmV4cG9ydCBjb25zdCByZXBsYWNlSW5GaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIHNlYXJjaFRleHQsIHJlcGxhY2VUZXh0IH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDinI/vuI8gUmVwbGFjaW5nIHRleHQgaW4gZmlsZTogJHtmdWxsUGF0aH1gKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlYWRSZXN1bHQgPSBhd2FpdCByZWFkRmlsZShmdWxsUGF0aCk7XG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gcmVhZFJlc3VsdC5jb250ZW50O1xuICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBvcmlnaW5hbENvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKHNlYXJjaFRleHQsICdnJyksIHJlcGxhY2VUZXh0KTtcbiAgICBjb25zdCByZXBsYWNlbWVudENvdW50ID0gKG9yaWdpbmFsQ29udGVudC5tYXRjaChuZXcgUmVnRXhwKHNlYXJjaFRleHQsICdnJykpIHx8IFtdKS5sZW5ndGg7XG5cbiAgICBpZiAocmVwbGFjZW1lbnRDb3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGBObyBtYXRjaGVzIGZvdW5kIGZvciBcIiR7c2VhcmNoVGV4dH1cIiBpbiAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0NvbnRlbnQpO1xuICAgIGlmICh3cml0ZVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdtb2RpZmllZCcsIGZ1bGxQYXRoKTtcbiAgICAgIHJldHVybiBgUmVwbGFjZWQgJHtyZXBsYWNlbWVudENvdW50fSBvY2N1cnJlbmNlKHMpIG9mIFwiJHtzZWFyY2hUZXh0fVwiIHdpdGggXCIke3JlcGxhY2VUZXh0fVwiIGluICR7ZnVsbFBhdGh9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGBFcnJvciB3cml0aW5nIGZpbGU6ICR7d3JpdGVSZXN1bHQuZXJyb3J9YDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAncmVwbGFjZV9pbl9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdGaW5kIGFuZCByZXBsYWNlIHRleHQgaW4gYSBmaWxlIHVzaW5nIHJlZ2V4LiBVc2UgdGhpcyBmb3IgcmVmYWN0b3Jpbmcgb3IgZml4aW5nIGNvZGUgcGF0dGVybnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgICBzZWFyY2hUZXh0OiB6LnN0cmluZygpLmRlc2NyaWJlKCdUZXh0IG9yIHJlZ2V4IHBhdHRlcm4gdG8gc2VhcmNoIGZvcicpLFxuICAgIHJlcGxhY2VUZXh0OiB6LnN0cmluZygpLmRlc2NyaWJlKCdUZXh0IHRvIHJlcGxhY2Ugd2l0aCcpLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0QXRMaW5lVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIGxpbmVOdW1iZXIsIGNvbnRlbnQgfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkgPyBmaWxlUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBmaWxlUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk40gSW5zZXJ0aW5nIGF0IGxpbmUgJHtsaW5lTnVtYmVyfSBpbjogJHtmdWxsUGF0aH1gKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlYWRSZXN1bHQgPSBhd2FpdCByZWFkRmlsZShmdWxsUGF0aCk7XG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSByZWFkUmVzdWx0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGlmIChsaW5lTnVtYmVyIDwgMSB8fCBsaW5lTnVtYmVyID4gbGluZXMubGVuZ3RoICsgMSkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogTGluZSBudW1iZXIgJHtsaW5lTnVtYmVyfSBpcyBvdXQgb2YgcmFuZ2UgKGZpbGUgaGFzICR7bGluZXMubGVuZ3RofSBsaW5lcylgO1xuICAgIH1cblxuICAgIGxpbmVzLnNwbGljZShsaW5lTnVtYmVyIC0gMSwgMCwgY29udGVudCk7XG4gICAgY29uc3QgbmV3Q29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0NvbnRlbnQpO1xuICAgIGlmICh3cml0ZVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdtb2RpZmllZCcsIGZ1bGxQYXRoKTtcbiAgICAgIHJldHVybiBgSW5zZXJ0ZWQgY29udGVudCBhdCBsaW5lICR7bGluZU51bWJlcn0gaW4gJHtmdWxsUGF0aH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYEVycm9yIHdyaXRpbmcgZmlsZTogJHt3cml0ZVJlc3VsdC5lcnJvcn1gO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdpbnNlcnRfYXRfbGluZScsXG4gIGRlc2NyaXB0aW9uOiAnSW5zZXJ0IGNvbnRlbnQgYXQgYSBzcGVjaWZpYyBsaW5lIG51bWJlciBpbiBhIGZpbGUuIFVzZSB0aGlzIGZvciBwcmVjaXNlIGNvZGUgYWRkaXRpb25zLicsXG4gIHNjaGVtYTogei5vYmplY3Qoe1xuICAgIGZpbGVQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBmaWxlJyksXG4gICAgbGluZU51bWJlcjogei5udW1iZXIoKS5kZXNjcmliZSgnTGluZSBudW1iZXIgd2hlcmUgY29udGVudCBzaG91bGQgYmUgaW5zZXJ0ZWQgKDEtYmFzZWQpJyksXG4gICAgY29udGVudDogei5zdHJpbmcoKS5kZXNjcmliZSgnQ29udGVudCB0byBpbnNlcnQnKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUxpbmVzVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIHN0YXJ0TGluZSwgZW5kTGluZSB9KSA9PiB7XG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG4gIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5pc0Fic29sdXRlKGZpbGVQYXRoKSA/IGZpbGVQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVQYXRoKTtcblxuICBjb25zb2xlLmxvZyhg4pyC77iPIERlbGV0aW5nIGxpbmVzICR7c3RhcnRMaW5lfS0ke2VuZExpbmV9IGluOiAke2Z1bGxQYXRofWApO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVhZFJlc3VsdCA9IGF3YWl0IHJlYWRGaWxlKGZ1bGxQYXRoKTtcbiAgICBpZiAoIXJlYWRSZXN1bHQuc3VjY2VzcyB8fCAhcmVhZFJlc3VsdC5jb250ZW50KSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBDb3VsZCBub3QgcmVhZCBmaWxlICR7ZnVsbFBhdGh9YDtcbiAgICB9XG5cbiAgICBjb25zdCBsaW5lcyA9IHJlYWRSZXN1bHQuY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgaWYgKHN0YXJ0TGluZSA8IDEgfHwgZW5kTGluZSA+IGxpbmVzLmxlbmd0aCB8fCBzdGFydExpbmUgPiBlbmRMaW5lKSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBJbnZhbGlkIGxpbmUgcmFuZ2UgJHtzdGFydExpbmV9LSR7ZW5kTGluZX0gKGZpbGUgaGFzICR7bGluZXMubGVuZ3RofSBsaW5lcylgO1xuICAgIH1cblxuICAgIGxpbmVzLnNwbGljZShzdGFydExpbmUgLSAxLCBlbmRMaW5lIC0gc3RhcnRMaW5lICsgMSk7XG4gICAgY29uc3QgbmV3Q29udGVudCA9IGxpbmVzLmpvaW4oJ1xcbicpO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0NvbnRlbnQpO1xuICAgIGlmICh3cml0ZVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdtb2RpZmllZCcsIGZ1bGxQYXRoKTtcbiAgICAgIHJldHVybiBgRGVsZXRlZCBsaW5lcyAke3N0YXJ0TGluZX0tJHtlbmRMaW5lfSBpbiAke2Z1bGxQYXRofWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgRXJyb3Igd3JpdGluZyBmaWxlOiAke3dyaXRlUmVzdWx0LmVycm9yfWA7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2RlbGV0ZV9saW5lcycsXG4gIGRlc2NyaXB0aW9uOiAnRGVsZXRlIGEgcmFuZ2Ugb2YgbGluZXMgZnJvbSBhIGZpbGUuIFVzZSB0aGlzIHRvIHJlbW92ZSBjb2RlIGJsb2Nrcy4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBmaWxlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB0byB0aGUgZmlsZScpLFxuICAgIHN0YXJ0TGluZTogei5udW1iZXIoKS5kZXNjcmliZSgnU3RhcnRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgICBlbmRMaW5lOiB6Lm51bWJlcigpLmRlc2NyaWJlKCdFbmRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IHJlcGxhY2VCbG9ja1Rvb2wgPSB0b29sKGFzeW5jICh7IGZpbGVQYXRoLCBzdGFydE1hcmtlciwgZW5kTWFya2VyLCBuZXdDb250ZW50IH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5SEIFJlcGxhY2luZyBibG9jayBpbjogJHtmdWxsUGF0aH1gKTtcbiAgY29uc29sZS5sb2coYCAgIFN0YXJ0IG1hcmtlcjogJHtzdGFydE1hcmtlcn1gKTtcbiAgY29uc29sZS5sb2coYCAgIEVuZCBtYXJrZXI6ICR7ZW5kTWFya2VyfWApO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVhZFJlc3VsdCA9IGF3YWl0IHJlYWRGaWxlKGZ1bGxQYXRoKTtcbiAgICBpZiAoIXJlYWRSZXN1bHQuc3VjY2VzcyB8fCAhcmVhZFJlc3VsdC5jb250ZW50KSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBDb3VsZCBub3QgcmVhZCBmaWxlICR7ZnVsbFBhdGh9YDtcbiAgICB9XG5cbiAgICBjb25zdCBjb250ZW50ID0gcmVhZFJlc3VsdC5jb250ZW50O1xuXG4gICAgLy8gRmluZCBzdGFydCBhbmQgZW5kIHBvc2l0aW9uc1xuICAgIGNvbnN0IHN0YXJ0SWR4ID0gY29udGVudC5pbmRleE9mKHN0YXJ0TWFya2VyKTtcbiAgICBpZiAoc3RhcnRJZHggPT09IC0xKSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBTdGFydCBtYXJrZXIgXCIke3N0YXJ0TWFya2VyfVwiIG5vdCBmb3VuZCBpbiAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgZW5kSWR4ID0gY29udGVudC5pbmRleE9mKGVuZE1hcmtlciwgc3RhcnRJZHggKyBzdGFydE1hcmtlci5sZW5ndGgpO1xuICAgIGlmIChlbmRJZHggPT09IC0xKSB7XG4gICAgICByZXR1cm4gYEVycm9yOiBFbmQgbWFya2VyIFwiJHtlbmRNYXJrZXJ9XCIgbm90IGZvdW5kIGFmdGVyIHN0YXJ0IG1hcmtlciBpbiAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgLy8gUmVwbGFjZSB0aGUgYmxvY2sgKGluY2x1ZGluZyBtYXJrZXJzKVxuICAgIGNvbnN0IGJlZm9yZSA9IGNvbnRlbnQuc3Vic3RyaW5nKDAsIHN0YXJ0SWR4KTtcbiAgICBjb25zdCBhZnRlciA9IGNvbnRlbnQuc3Vic3RyaW5nKGVuZElkeCArIGVuZE1hcmtlci5sZW5ndGgpO1xuICAgIGNvbnN0IG5ld0ZpbGVDb250ZW50ID0gYmVmb3JlICsgc3RhcnRNYXJrZXIgKyAnXFxuJyArIG5ld0NvbnRlbnQgKyAnXFxuJyArIGVuZE1hcmtlciArIGFmdGVyO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0ZpbGVDb250ZW50KTtcbiAgICBpZiAod3JpdGVSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignbW9kaWZpZWQnLCBmdWxsUGF0aCk7XG4gICAgICBjb25zdCBvbGRCbG9jayA9IGNvbnRlbnQuc3Vic3RyaW5nKHN0YXJ0SWR4LCBlbmRJZHggKyBlbmRNYXJrZXIubGVuZ3RoKTtcbiAgICAgIHJldHVybiBgU3VjY2Vzc2Z1bGx5IHJlcGxhY2VkIGJsb2NrIGluICR7ZnVsbFBhdGh9XFxuT2xkIGJsb2NrICgke29sZEJsb2NrLnNwbGl0KCdcXG4nKS5sZW5ndGh9IGxpbmVzKSDihpIgTmV3IGJsb2NrICgke25ld0NvbnRlbnQuc3BsaXQoJ1xcbicpLmxlbmd0aH0gbGluZXMpYDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGBFcnJvciB3cml0aW5nIGZpbGU6ICR7d3JpdGVSZXN1bHQuZXJyb3J9YDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAncmVwbGFjZV9ibG9jaycsXG4gIGRlc2NyaXB0aW9uOiAnUmVwbGFjZSBhIGJsb2NrIG9mIGNvZGUgYmV0d2VlbiB0d28gbWFya2Vycy4gTW9yZSBlZmZpY2llbnQgdGhhbiByZXdyaXRpbmcgZW50aXJlIGZpbGUuIFBlcmZlY3QgZm9yIHVwZGF0aW5nIGZ1bmN0aW9ucywgY2xhc3Nlcywgb3Igc2VjdGlvbnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgICBzdGFydE1hcmtlcjogei5zdHJpbmcoKS5kZXNjcmliZSgnVW5pcXVlIHRleHQgdGhhdCBtYXJrcyB0aGUgc3RhcnQgb2YgdGhlIGJsb2NrIChlLmcuLCBcImZ1bmN0aW9uIG15RnVuYyhcIiBvciBcIi8vIFNUQVJUIFNFQ1RJT05cIiknKSxcbiAgICBlbmRNYXJrZXI6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1VuaXF1ZSB0ZXh0IHRoYXQgbWFya3MgdGhlIGVuZCBvZiB0aGUgYmxvY2sgKGUuZy4sIFwifVwiIG9yIFwiLy8gRU5EIFNFQ1RJT05cIiknKSxcbiAgICBuZXdDb250ZW50OiB6LnN0cmluZygpLmRlc2NyaWJlKCdOZXcgY29udGVudCB0byByZXBsYWNlIHRoZSBibG9jayBiZXR3ZWVuIG1hcmtlcnMgKG1hcmtlcnMgd2lsbCBiZSBwcmVzZXJ2ZWQpJyksXG4gIH0pLFxufSk7XG5cbmV4cG9ydCBjb25zdCByZXBsYWNlTGluZVJhbmdlVG9vbCA9IHRvb2woYXN5bmMgKHsgZmlsZVBhdGgsIHN0YXJ0TGluZSwgZW5kTGluZSwgbmV3Q29udGVudCB9KSA9PiB7XG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG4gIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5pc0Fic29sdXRlKGZpbGVQYXRoKSA/IGZpbGVQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGZpbGVQYXRoKTtcblxuICBjb25zb2xlLmxvZyhg8J+TnSBSZXBsYWNpbmcgbGluZXMgJHtzdGFydExpbmV9LSR7ZW5kTGluZX0gaW46ICR7ZnVsbFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZWFkUmVzdWx0ID0gYXdhaXQgcmVhZEZpbGUoZnVsbFBhdGgpO1xuICAgIGlmICghcmVhZFJlc3VsdC5zdWNjZXNzIHx8ICFyZWFkUmVzdWx0LmNvbnRlbnQpIHtcbiAgICAgIHJldHVybiBgRXJyb3I6IENvdWxkIG5vdCByZWFkIGZpbGUgJHtmdWxsUGF0aH1gO1xuICAgIH1cblxuICAgIGNvbnN0IGxpbmVzID0gcmVhZFJlc3VsdC5jb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBpZiAoc3RhcnRMaW5lIDwgMSB8fCBlbmRMaW5lID4gbGluZXMubGVuZ3RoIHx8IHN0YXJ0TGluZSA+IGVuZExpbmUpIHtcbiAgICAgIHJldHVybiBgRXJyb3I6IEludmFsaWQgbGluZSByYW5nZSAke3N0YXJ0TGluZX0tJHtlbmRMaW5lfSAoZmlsZSBoYXMgJHtsaW5lcy5sZW5ndGh9IGxpbmVzKWA7XG4gICAgfVxuXG4gICAgLy8gUmVwbGFjZSB0aGUgbGluZSByYW5nZVxuICAgIGNvbnN0IGJlZm9yZSA9IGxpbmVzLnNsaWNlKDAsIHN0YXJ0TGluZSAtIDEpO1xuICAgIGNvbnN0IGFmdGVyID0gbGluZXMuc2xpY2UoZW5kTGluZSk7XG4gICAgY29uc3QgbmV3TGluZXMgPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBuZXdGaWxlTGluZXMgPSBbLi4uYmVmb3JlLCAuLi5uZXdMaW5lcywgLi4uYWZ0ZXJdO1xuXG4gICAgY29uc3Qgd3JpdGVSZXN1bHQgPSBhd2FpdCB3cml0ZUZpbGUoZnVsbFBhdGgsIG5ld0ZpbGVMaW5lcy5qb2luKCdcXG4nKSk7XG4gICAgaWYgKHdyaXRlUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ21vZGlmaWVkJywgZnVsbFBhdGgpO1xuICAgICAgY29uc3Qgb2xkTGluZUNvdW50ID0gZW5kTGluZSAtIHN0YXJ0TGluZSArIDE7XG4gICAgICBjb25zdCBuZXdMaW5lQ291bnQgPSBuZXdMaW5lcy5sZW5ndGg7XG4gICAgICByZXR1cm4gYFJlcGxhY2VkIGxpbmVzICR7c3RhcnRMaW5lfS0ke2VuZExpbmV9ICgke29sZExpbmVDb3VudH0gbGluZXMpIHdpdGggbmV3IGNvbnRlbnQgKCR7bmV3TGluZUNvdW50fSBsaW5lcykgaW4gJHtmdWxsUGF0aH1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYEVycm9yIHdyaXRpbmcgZmlsZTogJHt3cml0ZVJlc3VsdC5lcnJvcn1gO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdyZXBsYWNlX2xpbmVfcmFuZ2UnLFxuICBkZXNjcmlwdGlvbjogJ1JlcGxhY2UgYSBzcGVjaWZpYyByYW5nZSBvZiBsaW5lcyB3aXRoIG5ldyBjb250ZW50LiBNb3JlIHByZWNpc2UgdGhhbiByZXBsYWNlX2Jsb2NrLiBVc2Ugd2hlbiB5b3Uga25vdyBleGFjdCBsaW5lIG51bWJlcnMuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgICBzdGFydExpbmU6IHoubnVtYmVyKCkuZGVzY3JpYmUoJ1N0YXJ0aW5nIGxpbmUgbnVtYmVyICgxLWJhc2VkLCBpbmNsdXNpdmUpJyksXG4gICAgZW5kTGluZTogei5udW1iZXIoKS5kZXNjcmliZSgnRW5kaW5nIGxpbmUgbnVtYmVyICgxLWJhc2VkLCBpbmNsdXNpdmUpJyksXG4gICAgbmV3Q29udGVudDogei5zdHJpbmcoKS5kZXNjcmliZSgnTmV3IGNvbnRlbnQgdG8gcmVwbGFjZSB0aGUgc3BlY2lmaWVkIGxpbmVzJyksXG4gIH0pLFxufSk7XG5cbmV4cG9ydCBjb25zdCBnZXRGaWxlSW5mb1Rvb2wgPSB0b29sKGFzeW5jICh7IGZpbGVQYXRoIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDihLnvuI8gR2V0dGluZyBmaWxlIGluZm86ICR7ZnVsbFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzdGF0cyA9IGZzLnN0YXRTeW5jKGZ1bGxQYXRoKTtcbiAgICBjb25zdCByZWFkUmVzdWx0ID0gYXdhaXQgcmVhZEZpbGUoZnVsbFBhdGgpO1xuXG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSByZWFkUmVzdWx0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGV4dGVuc2lvbiA9IHBhdGguZXh0bmFtZShmdWxsUGF0aCk7XG5cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcGF0aDogZnVsbFBhdGgsXG4gICAgICBzaXplOiBzdGF0cy5zaXplLFxuICAgICAgbGluZXM6IGxpbmVzLmxlbmd0aCxcbiAgICAgIGV4dGVuc2lvbixcbiAgICAgIGNyZWF0ZWQ6IHN0YXRzLmJpcnRodGltZSxcbiAgICAgIG1vZGlmaWVkOiBzdGF0cy5tdGltZSxcbiAgICAgIGlzRGlyZWN0b3J5OiBzdGF0cy5pc0RpcmVjdG9yeSgpLFxuICAgIH0sIG51bGwsIDIpO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2dldF9maWxlX2luZm8nLFxuICBkZXNjcmlwdGlvbjogJ0dldCBkZXRhaWxlZCBpbmZvcm1hdGlvbiBhYm91dCBhIGZpbGUgKHNpemUsIGxpbmVzLCBkYXRlcywgZXRjLikuIFVzZSB0aGlzIHRvIHVuZGVyc3RhbmQgZmlsZSBzdHJ1Y3R1cmUuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUnKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZURpcmVjdG9yeVRvb2wgPSB0b29sKGFzeW5jICh7IGRpclBhdGggfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShkaXJQYXRoKSA/IGRpclBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZGlyUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk4EgQ3JlYXRpbmcgZGlyZWN0b3J5OiAke2Z1bGxQYXRofWApO1xuXG4gIHRyeSB7XG4gICAgZnMubWtkaXJTeW5jKGZ1bGxQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICBnZXRNZW1vcnkoKS5hZGRGaWxlT3BlcmF0aW9uKCdjcmVhdGVkJywgZnVsbFBhdGgpO1xuICAgIHJldHVybiBgRGlyZWN0b3J5IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5OiAke2Z1bGxQYXRofWA7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yIGNyZWF0aW5nIGRpcmVjdG9yeTogJHtlcnJvci5tZXNzYWdlfWA7XG4gIH1cbn0sIHtcbiAgbmFtZTogJ2NyZWF0ZV9kaXJlY3RvcnknLFxuICBkZXNjcmlwdGlvbjogJ0NyZWF0ZSBhIG5ldyBkaXJlY3RvcnkgKGluY2x1ZGluZyBwYXJlbnQgZGlyZWN0b3JpZXMgaWYgbmVlZGVkKS4gVXNlIHRoaXMgdG8gb3JnYW5pemUgcHJvamVjdCBzdHJ1Y3R1cmUuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgZGlyUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB0byB0aGUgZGlyZWN0b3J5IHRvIGNyZWF0ZScpLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgY29uc3QgY29weUZpbGVUb29sID0gdG9vbChhc3luYyAoeyBzb3VyY2VQYXRoLCBkZXN0aW5hdGlvblBhdGggfSkgPT4ge1xuICBjb25zdCBwcm9qZWN0Rm9sZGVyID0gZ2V0UHJvamVjdEZvbGRlcigpO1xuICBjb25zdCBmdWxsU291cmNlUGF0aCA9IHBhdGguaXNBYnNvbHV0ZShzb3VyY2VQYXRoKSA/IHNvdXJjZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgc291cmNlUGF0aCk7XG4gIGNvbnN0IGZ1bGxEZXN0UGF0aCA9IHBhdGguaXNBYnNvbHV0ZShkZXN0aW5hdGlvblBhdGgpID8gZGVzdGluYXRpb25QYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIGRlc3RpbmF0aW9uUGF0aCk7XG5cbiAgY29uc29sZS5sb2coYPCfk4sgQ29weWluZyBmaWxlIGZyb20gJHtmdWxsU291cmNlUGF0aH0gdG8gJHtmdWxsRGVzdFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBmcy5jb3B5RmlsZVN5bmMoZnVsbFNvdXJjZVBhdGgsIGZ1bGxEZXN0UGF0aCk7XG4gICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignY3JlYXRlZCcsIGZ1bGxEZXN0UGF0aCk7XG4gICAgcmV0dXJuIGBGaWxlIGNvcGllZCBzdWNjZXNzZnVsbHkgZnJvbSAke2Z1bGxTb3VyY2VQYXRofSB0byAke2Z1bGxEZXN0UGF0aH1gO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBFcnJvciBjb3B5aW5nIGZpbGU6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdjb3B5X2ZpbGUnLFxuICBkZXNjcmlwdGlvbjogJ0NvcHkgYSBmaWxlIHRvIGEgbmV3IGxvY2F0aW9uLiBVc2UgdGhpcyB0byBkdXBsaWNhdGUgZmlsZXMgb3IgY3JlYXRlIHRlbXBsYXRlcy4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBzb3VyY2VQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdTb3VyY2UgZmlsZSBwYXRoJyksXG4gICAgZGVzdGluYXRpb25QYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdEZXN0aW5hdGlvbiBmaWxlIHBhdGgnKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IG1vdmVGaWxlVG9vbCA9IHRvb2woYXN5bmMgKHsgc291cmNlUGF0aCwgZGVzdGluYXRpb25QYXRoIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFNvdXJjZVBhdGggPSBwYXRoLmlzQWJzb2x1dGUoc291cmNlUGF0aCkgPyBzb3VyY2VQYXRoIDogcGF0aC5qb2luKHByb2plY3RGb2xkZXIsIHNvdXJjZVBhdGgpO1xuICBjb25zdCBmdWxsRGVzdFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZGVzdGluYXRpb25QYXRoKSA/IGRlc3RpbmF0aW9uUGF0aCA6IHBhdGguam9pbihwcm9qZWN0Rm9sZGVyLCBkZXN0aW5hdGlvblBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5qaIE1vdmluZyBmaWxlIGZyb20gJHtmdWxsU291cmNlUGF0aH0gdG8gJHtmdWxsRGVzdFBhdGh9YCk7XG5cbiAgdHJ5IHtcbiAgICBmcy5yZW5hbWVTeW5jKGZ1bGxTb3VyY2VQYXRoLCBmdWxsRGVzdFBhdGgpO1xuICAgIGdldE1lbW9yeSgpLmFkZEZpbGVPcGVyYXRpb24oJ2RlbGV0ZWQnLCBmdWxsU291cmNlUGF0aCk7XG4gICAgZ2V0TWVtb3J5KCkuYWRkRmlsZU9wZXJhdGlvbignY3JlYXRlZCcsIGZ1bGxEZXN0UGF0aCk7XG4gICAgcmV0dXJuIGBGaWxlIG1vdmVkIHN1Y2Nlc3NmdWxseSBmcm9tICR7ZnVsbFNvdXJjZVBhdGh9IHRvICR7ZnVsbERlc3RQYXRofWA7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yIG1vdmluZyBmaWxlOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAnbW92ZV9maWxlJyxcbiAgZGVzY3JpcHRpb246ICdNb3ZlIG9yIHJlbmFtZSBhIGZpbGUuIFVzZSB0aGlzIHRvIHJlb3JnYW5pemUgcHJvamVjdCBzdHJ1Y3R1cmUuJyxcbiAgc2NoZW1hOiB6Lm9iamVjdCh7XG4gICAgc291cmNlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnU291cmNlIGZpbGUgcGF0aCcpLFxuICAgIGRlc3RpbmF0aW9uUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnRGVzdGluYXRpb24gZmlsZSBwYXRoJyksXG4gIH0pLFxufSk7XG5cbmV4cG9ydCBjb25zdCByZWFkTGluZXNUb29sID0gdG9vbChhc3luYyAoeyBmaWxlUGF0aCwgc3RhcnRMaW5lLCBlbmRMaW5lIH0pID0+IHtcbiAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcbiAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmlzQWJzb2x1dGUoZmlsZVBhdGgpID8gZmlsZVBhdGggOiBwYXRoLmpvaW4ocHJvamVjdEZvbGRlciwgZmlsZVBhdGgpO1xuXG4gIGNvbnNvbGUubG9nKGDwn5OWIFJlYWRpbmcgbGluZXMgJHtzdGFydExpbmV9LSR7ZW5kTGluZX0gZnJvbTogJHtmdWxsUGF0aH1gKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlYWRSZXN1bHQgPSBhd2FpdCByZWFkRmlsZShmdWxsUGF0aCk7XG4gICAgaWYgKCFyZWFkUmVzdWx0LnN1Y2Nlc3MgfHwgIXJlYWRSZXN1bHQuY29udGVudCkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogQ291bGQgbm90IHJlYWQgZmlsZSAke2Z1bGxQYXRofWA7XG4gICAgfVxuXG4gICAgY29uc3QgbGluZXMgPSByZWFkUmVzdWx0LmNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICAgIGlmIChzdGFydExpbmUgPCAxIHx8IGVuZExpbmUgPiBsaW5lcy5sZW5ndGggfHwgc3RhcnRMaW5lID4gZW5kTGluZSkge1xuICAgICAgcmV0dXJuIGBFcnJvcjogSW52YWxpZCBsaW5lIHJhbmdlICR7c3RhcnRMaW5lfS0ke2VuZExpbmV9IChmaWxlIGhhcyAke2xpbmVzLmxlbmd0aH0gbGluZXMpYDtcbiAgICB9XG5cbiAgICBjb25zdCBzZWxlY3RlZExpbmVzID0gbGluZXMuc2xpY2Uoc3RhcnRMaW5lIC0gMSwgZW5kTGluZSk7XG4gICAgcmV0dXJuIGBMaW5lcyAke3N0YXJ0TGluZX0tJHtlbmRMaW5lfSBvZiAke2Z1bGxQYXRofTpcXG4ke3NlbGVjdGVkTGluZXMuam9pbignXFxuJyl9YDtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiBgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdyZWFkX2xpbmVzJyxcbiAgZGVzY3JpcHRpb246ICdSZWFkIGEgc3BlY2lmaWMgcmFuZ2Ugb2YgbGluZXMgZnJvbSBhIGZpbGUuIFVzZSB0aGlzIHRvIGV4YW1pbmUgc3BlY2lmaWMgY29kZSBzZWN0aW9ucy4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBmaWxlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB0byB0aGUgZmlsZScpLFxuICAgIHN0YXJ0TGluZTogei5udW1iZXIoKS5kZXNjcmliZSgnU3RhcnRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgICBlbmRMaW5lOiB6Lm51bWJlcigpLmRlc2NyaWJlKCdFbmRpbmcgbGluZSBudW1iZXIgKDEtYmFzZWQsIGluY2x1c2l2ZSknKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IGNvbnN0IGdldFByb2plY3RTdHJ1Y3R1cmVUb29sID0gdG9vbChhc3luYyAoeyBtYXhEZXB0aCB9KSA9PiB7XG4gIGNvbnN0IHByb2plY3RGb2xkZXIgPSBnZXRQcm9qZWN0Rm9sZGVyKCk7XG5cbiAgY29uc29sZS5sb2coYPCfl4LvuI8gR2V0dGluZyBwcm9qZWN0IHN0cnVjdHVyZSBmcm9tOiAke3Byb2plY3RGb2xkZXJ9YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzdHJ1Y3R1cmU6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdCB0cmF2ZXJzZURpcmVjdG9yeSA9IChkaXI6IHN0cmluZywgZGVwdGg6IG51bWJlciwgcHJlZml4OiBzdHJpbmcgPSAnJykgPT4ge1xuICAgICAgaWYgKGRlcHRoID4gbWF4RGVwdGgpIHJldHVybjtcblxuICAgICAgY29uc3QgaXRlbXMgPSBmcy5yZWFkZGlyU3luYyhkaXIpO1xuICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmpvaW4oZGlyLCBpdGVtKTtcbiAgICAgICAgY29uc3QgaXNMYXN0ID0gaW5kZXggPT09IGl0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgIGNvbnN0IGNvbm5lY3RvciA9IGlzTGFzdCA/ICfilJTilIDilIAgJyA6ICfilJzilIDilIAgJztcbiAgICAgICAgY29uc3QgcmVsYXRpdmVQYXRoID0gcGF0aC5yZWxhdGl2ZShwcm9qZWN0Rm9sZGVyLCBmdWxsUGF0aCk7XG5cbiAgICAgICAgLy8gU2tpcCBub2RlX21vZHVsZXMgYW5kIGhpZGRlbiBmaWxlc1xuICAgICAgICBpZiAoaXRlbSA9PT0gJ25vZGVfbW9kdWxlcycgfHwgaXRlbS5zdGFydHNXaXRoKCcuJykpIHJldHVybjtcblxuICAgICAgICBzdHJ1Y3R1cmUucHVzaChgJHtwcmVmaXh9JHtjb25uZWN0b3J9JHtpdGVtfWApO1xuXG4gICAgICAgIGlmIChmcy5zdGF0U3luYyhmdWxsUGF0aCkuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgIGNvbnN0IG5ld1ByZWZpeCA9IHByZWZpeCArIChpc0xhc3QgPyAnICAgICcgOiAn4pSCICAgJyk7XG4gICAgICAgICAgdHJhdmVyc2VEaXJlY3RvcnkoZnVsbFBhdGgsIGRlcHRoICsgMSwgbmV3UHJlZml4KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRyYXZlcnNlRGlyZWN0b3J5KHByb2plY3RGb2xkZXIsIDApO1xuICAgIHJldHVybiBgUHJvamVjdCBzdHJ1Y3R1cmU6XFxuJHtwcm9qZWN0Rm9sZGVyfVxcbiR7c3RydWN0dXJlLmpvaW4oJ1xcbicpfWA7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgfVxufSwge1xuICBuYW1lOiAnZ2V0X3Byb2plY3Rfc3RydWN0dXJlJyxcbiAgZGVzY3JpcHRpb246ICdHZXQgYSB0cmVlIHZpZXcgb2YgdGhlIHByb2plY3QgZGlyZWN0b3J5IHN0cnVjdHVyZS4gVXNlIHRoaXMgdG8gdW5kZXJzdGFuZCBwcm9qZWN0IG9yZ2FuaXphdGlvbi4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBtYXhEZXB0aDogei5udW1iZXIoKS5kZWZhdWx0KDMpLmRlc2NyaWJlKCdNYXhpbXVtIGRlcHRoIHRvIHRyYXZlcnNlIChkZWZhdWx0OiAzKScpLFxuICB9KSxcbn0pO1xuXG5leHBvcnQgY29uc3QgZXhlY3V0ZUNvbW1hbmRUb29sID0gdG9vbChhc3luYyAoeyBjb21tYW5kLCBkZXNjcmlwdGlvbiB9KSA9PiB7XG4gIGNvbnNvbGUubG9nKGDimpnvuI8gRXhlY3V0aW5nIGNvbW1hbmQ6ICR7Y29tbWFuZH1gKTtcbiAgY29uc29sZS5sb2coYPCfk50gRGVzY3JpcHRpb246ICR7ZGVzY3JpcHRpb259YCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IGV4ZWNTeW5jIH0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG4gICAgY29uc3QgcHJvamVjdEZvbGRlciA9IGdldFByb2plY3RGb2xkZXIoKTtcblxuICAgIC8vIEV4ZWN1dGUgY29tbWFuZCBpbiBwcm9qZWN0IGZvbGRlclxuICAgIGNvbnN0IG91dHB1dCA9IGV4ZWNTeW5jKGNvbW1hbmQsIHtcbiAgICAgIGN3ZDogcHJvamVjdEZvbGRlcixcbiAgICAgIGVuY29kaW5nOiAndXRmLTgnLFxuICAgICAgbWF4QnVmZmVyOiAxMDI0ICogMTAyNCAqIDEwLCAvLyAxME1CXG4gICAgICB0aW1lb3V0OiAzMDAwMCwgLy8gMzAgc2Vjb25kc1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGBDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseTpcXG4ke291dHB1dH1gO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgcmV0dXJuIGBDb21tYW5kIGZhaWxlZCB3aXRoIGVycm9yOlxcbiR7ZXJyb3IubWVzc2FnZX1cXG4ke2Vycm9yLnN0ZG91dCB8fCAnJ31cXG4ke2Vycm9yLnN0ZGVyciB8fCAnJ31gO1xuICB9XG59LCB7XG4gIG5hbWU6ICdleGVjdXRlX2NvbW1hbmQnLFxuICBkZXNjcmlwdGlvbjogJ0V4ZWN1dGUgYSBzaGVsbCBjb21tYW5kIGluIHRoZSBwcm9qZWN0IGRpcmVjdG9yeS4gVXNlIHRoaXMgZm9yIG5wbSBpbnN0YWxsLCBnaXQgb3BlcmF0aW9ucywgYnVpbGRpbmcsIHRlc3RpbmcsIGV0Yy4gQUxXQVlTIHByb3ZpZGUgYSBjbGVhciBkZXNjcmlwdGlvbi4nLFxuICBzY2hlbWE6IHoub2JqZWN0KHtcbiAgICBjb21tYW5kOiB6LnN0cmluZygpLmRlc2NyaWJlKCdTaGVsbCBjb21tYW5kIHRvIGV4ZWN1dGUnKSxcbiAgICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5kZXNjcmliZSgnQ2xlYXIgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGlzIGNvbW1hbmQgZG9lcyBhbmQgd2h5JyksXG4gIH0pLFxufSk7XG5cbi8vIENyZWF0ZSB0aGUgdG9vbHMgYXJyYXkgd2l0aCBhbGwgdG9vbHNcbmV4cG9ydCBjb25zdCB0b29scyA9IFtcbiAgLy8gQmFzaWMgZmlsZSBvcGVyYXRpb25zXG4gIHJlYWRGaWxlVG9vbCxcbiAgd3JpdGVGaWxlVG9vbCxcbiAgYXBwZW5kVG9GaWxlVG9vbCxcbiAgZGVsZXRlRmlsZVRvb2wsXG4gIGxpc3REaXJlY3RvcnlUb29sLFxuICBzZWFyY2hGaWxlc1Rvb2wsXG4gIC8vIEFkdmFuY2VkIGVkaXRpbmcgdG9vbHNcbiAgcmVwbGFjZUluRmlsZVRvb2wsXG4gIGluc2VydEF0TGluZVRvb2wsXG4gIGRlbGV0ZUxpbmVzVG9vbCxcbiAgcmVwbGFjZUJsb2NrVG9vbCxcbiAgcmVwbGFjZUxpbmVSYW5nZVRvb2wsXG4gIHJlYWRMaW5lc1Rvb2wsXG4gIC8vIEZpbGUgbWFuYWdlbWVudFxuICBnZXRGaWxlSW5mb1Rvb2wsXG4gIGNyZWF0ZURpcmVjdG9yeVRvb2wsXG4gIGNvcHlGaWxlVG9vbCxcbiAgbW92ZUZpbGVUb29sLFxuICAvLyBQcm9qZWN0IHRvb2xzXG4gIGdldFByb2plY3RTdHJ1Y3R1cmVUb29sLFxuICBleGVjdXRlQ29tbWFuZFRvb2wsXG5dO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gd3JhcCB0b29sIGV4ZWN1dGlvbiB3aXRoIGxvZ2dpbmdcbmV4cG9ydCBmdW5jdGlvbiB3cmFwVG9vbFdpdGhMb2dnaW5nKHRvb2xGbjogYW55LCB0b29sTmFtZTogc3RyaW5nKSB7XG4gIHJldHVybiBhc3luYyAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICBjb25zdCBjYWxsSWQgPSB0b29sTG9nZ2VyLnN0YXJ0Q2FsbCh0b29sTmFtZSwgYXJnc1swXSB8fCB7fSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvb2xGbiguLi5hcmdzKTtcbiAgICAgIHRvb2xMb2dnZXIuZW5kQ2FsbChjYWxsSWQsIHJlc3VsdCwgdHJ1ZSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnN0IGVycm9yTXNnID0gZXJyb3IubWVzc2FnZSB8fCBTdHJpbmcoZXJyb3IpO1xuICAgICAgdG9vbExvZ2dlci5lbmRDYWxsKGNhbGxJZCwgZXJyb3JNc2csIGZhbHNlLCBlcnJvck1zZyk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH07XG59Il0sIm5hbWVzIjpbInRvb2wiLCJ6IiwiZnMiLCJwYXRoIiwicmVhZEZpbGUiLCJ3cml0ZUZpbGUiLCJhcHBlbmRUb0ZpbGUiLCJkZWxldGVGaWxlIiwibGlzdERpcmVjdG9yeSIsInNlYXJjaEZpbGVzIiwiRmlsZVJlYWRTY2hlbWEiLCJGaWxlV3JpdGVTY2hlbWEiLCJGaWxlQXBwZW5kU2NoZW1hIiwiRmlsZURlbGV0ZVNjaGVtYSIsIkRpcmVjdG9yeUxpc3RTY2hlbWEiLCJGaWxlU2VhcmNoU2NoZW1hIiwiZ2V0TWVtb3J5IiwiZ2V0UHJvamVjdEZvbGRlciIsInRvb2xMb2dnZXIiLCJyZWFkRmlsZVRvb2wiLCJmaWxlUGF0aCIsInByb2plY3RGb2xkZXIiLCJmdWxsUGF0aCIsImlzQWJzb2x1dGUiLCJqb2luIiwiY29uc29sZSIsImxvZyIsInJlc3VsdCIsInN1Y2Nlc3MiLCJhZGRGaWxlT3BlcmF0aW9uIiwiY29udGVudCIsImVycm9yIiwibmFtZSIsImRlc2NyaXB0aW9uIiwic2NoZW1hIiwid3JpdGVGaWxlVG9vbCIsImV4aXN0cyIsImV4aXN0c1N5bmMiLCJhcHBlbmRUb0ZpbGVUb29sIiwiZGVsZXRlRmlsZVRvb2wiLCJsaXN0RGlyZWN0b3J5VG9vbCIsImRpclBhdGgiLCJmaWxlcyIsInNlYXJjaEZpbGVzVG9vbCIsInBhdHRlcm4iLCJtYXRjaGVzIiwibWF0Y2hlc1RleHQiLCJzbGljZSIsIm1hcCIsIm1hdGNoIiwiZmlsZSIsImxpbmUiLCJsZW5ndGgiLCJyZXBsYWNlSW5GaWxlVG9vbCIsInNlYXJjaFRleHQiLCJyZXBsYWNlVGV4dCIsInJlYWRSZXN1bHQiLCJvcmlnaW5hbENvbnRlbnQiLCJuZXdDb250ZW50IiwicmVwbGFjZSIsIlJlZ0V4cCIsInJlcGxhY2VtZW50Q291bnQiLCJ3cml0ZVJlc3VsdCIsIm1lc3NhZ2UiLCJvYmplY3QiLCJzdHJpbmciLCJkZXNjcmliZSIsImluc2VydEF0TGluZVRvb2wiLCJsaW5lTnVtYmVyIiwibGluZXMiLCJzcGxpdCIsInNwbGljZSIsIm51bWJlciIsImRlbGV0ZUxpbmVzVG9vbCIsInN0YXJ0TGluZSIsImVuZExpbmUiLCJyZXBsYWNlQmxvY2tUb29sIiwic3RhcnRNYXJrZXIiLCJlbmRNYXJrZXIiLCJzdGFydElkeCIsImluZGV4T2YiLCJlbmRJZHgiLCJiZWZvcmUiLCJzdWJzdHJpbmciLCJhZnRlciIsIm5ld0ZpbGVDb250ZW50Iiwib2xkQmxvY2siLCJyZXBsYWNlTGluZVJhbmdlVG9vbCIsIm5ld0xpbmVzIiwibmV3RmlsZUxpbmVzIiwib2xkTGluZUNvdW50IiwibmV3TGluZUNvdW50IiwiZ2V0RmlsZUluZm9Ub29sIiwic3RhdHMiLCJzdGF0U3luYyIsImV4dGVuc2lvbiIsImV4dG5hbWUiLCJKU09OIiwic3RyaW5naWZ5Iiwic2l6ZSIsImNyZWF0ZWQiLCJiaXJ0aHRpbWUiLCJtb2RpZmllZCIsIm10aW1lIiwiaXNEaXJlY3RvcnkiLCJjcmVhdGVEaXJlY3RvcnlUb29sIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiY29weUZpbGVUb29sIiwic291cmNlUGF0aCIsImRlc3RpbmF0aW9uUGF0aCIsImZ1bGxTb3VyY2VQYXRoIiwiZnVsbERlc3RQYXRoIiwiY29weUZpbGVTeW5jIiwibW92ZUZpbGVUb29sIiwicmVuYW1lU3luYyIsInJlYWRMaW5lc1Rvb2wiLCJzZWxlY3RlZExpbmVzIiwiZ2V0UHJvamVjdFN0cnVjdHVyZVRvb2wiLCJtYXhEZXB0aCIsInN0cnVjdHVyZSIsInRyYXZlcnNlRGlyZWN0b3J5IiwiZGlyIiwiZGVwdGgiLCJwcmVmaXgiLCJpdGVtcyIsInJlYWRkaXJTeW5jIiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsImlzTGFzdCIsImNvbm5lY3RvciIsInJlbGF0aXZlUGF0aCIsInJlbGF0aXZlIiwic3RhcnRzV2l0aCIsInB1c2giLCJuZXdQcmVmaXgiLCJkZWZhdWx0IiwiZXhlY3V0ZUNvbW1hbmRUb29sIiwiY29tbWFuZCIsImV4ZWNTeW5jIiwicmVxdWlyZSIsIm91dHB1dCIsImN3ZCIsImVuY29kaW5nIiwibWF4QnVmZmVyIiwidGltZW91dCIsInN0ZG91dCIsInN0ZGVyciIsInRvb2xzIiwid3JhcFRvb2xXaXRoTG9nZ2luZyIsInRvb2xGbiIsInRvb2xOYW1lIiwiYXJncyIsImNhbGxJZCIsInN0YXJ0Q2FsbCIsImVuZENhbGwiLCJlcnJvck1zZyIsIlN0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/tools.ts\n");

/***/ }),

/***/ "(rsc)/./lib/agents/utils.ts":
/*!*****************************!*\
  !*** ./lib/agents/utils.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getMemory: () => (/* binding */ getMemory),\n/* harmony export */   getProjectFolder: () => (/* binding */ getProjectFolder),\n/* harmony export */   setSessionMemory: () => (/* binding */ setSessionMemory),\n/* harmony export */   validateFileContent: () => (/* binding */ validateFileContent)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_memory_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/memory-db */ \"(rsc)/./lib/utils/memory-db.ts\");\n\n\n\n// Global memory instance for current session\nlet currentMemory = null;\nlet currentProjectFolder = null;\nlet sessionToFolderMap = new Map();\nfunction setSessionMemory(sessionId) {\n    // Check if this session already has a project folder\n    if (sessionToFolderMap.has(sessionId)) {\n        currentProjectFolder = sessionToFolderMap.get(sessionId);\n    } else {\n        // Create new project folder for this session\n        currentProjectFolder = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"generated\", sessionId);\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(currentProjectFolder)) {\n            fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(currentProjectFolder, {\n                recursive: true\n            });\n        }\n        sessionToFolderMap.set(sessionId, currentProjectFolder);\n    }\n    // Create memory with project folder\n    currentMemory = (0,_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__.getSessionMemory)(sessionId, currentProjectFolder);\n}\nfunction getMemory() {\n    if (!currentMemory) {\n        // Fallback to default session if not set\n        const defaultFolder = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"generated\", \"default_project\");\n        currentMemory = (0,_utils_memory_db__WEBPACK_IMPORTED_MODULE_2__.getSessionMemory)(\"default\", defaultFolder);\n    }\n    return currentMemory;\n}\nfunction getProjectFolder() {\n    if (!currentProjectFolder) {\n        // Fallback to default project folder\n        const defaultFolder = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"generated\", \"default_project\");\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(defaultFolder)) {\n            fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(defaultFolder, {\n                recursive: true\n            });\n        }\n        currentProjectFolder = defaultFolder;\n    }\n    return currentProjectFolder;\n}\n// Helper: Validate file content\nfunction validateFileContent(filename, content) {\n    const trimmed = content.trim();\n    // Check for placeholders\n    if (content.includes(\"...\") || content.toLowerCase().includes(\"todo\") || content.includes(\"placeholder\")) {\n        return {\n            isValid: false,\n            reason: \"Contains placeholders or TODO comments\"\n        };\n    }\n    // Check for empty or very short files\n    if (trimmed.length < 10) {\n        return {\n            isValid: false,\n            reason: \"File is too short or empty\"\n        };\n    }\n    // Check for incomplete code patterns\n    if (filename.endsWith(\".ts\") || filename.endsWith(\".js\")) {\n        if (!trimmed.includes(\"export\") && !trimmed.includes(\"function\") && !trimmed.includes(\"class\") && !trimmed.includes(\"const\") && !trimmed.includes(\"let\")) {\n            return {\n                isValid: false,\n                reason: \"No valid code constructs found\"\n            };\n        }\n    }\n    return {\n        isValid: true,\n        reason: \"Valid content\"\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWdlbnRzL3V0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF5QjtBQUNJO0FBQzZDO0FBRTFFLDZDQUE2QztBQUM3QyxJQUFJRyxnQkFBMkM7QUFDL0MsSUFBSUMsdUJBQXNDO0FBQzFDLElBQUlDLHFCQUFxQixJQUFJQztBQUV0QixTQUFTQyxpQkFBaUJDLFNBQWlCO0lBQ2hELHFEQUFxRDtJQUNyRCxJQUFJSCxtQkFBbUJJLEdBQUcsQ0FBQ0QsWUFBWTtRQUNyQ0osdUJBQXVCQyxtQkFBbUJLLEdBQUcsQ0FBQ0Y7SUFDaEQsT0FBTztRQUNMLDZDQUE2QztRQUM3Q0osdUJBQXVCSCxzQ0FBUyxDQUFDVyxRQUFRQyxHQUFHLElBQUksYUFBYUw7UUFDN0QsSUFBSSxDQUFDUiwwQ0FBYSxDQUFDSSx1QkFBdUI7WUFDeENKLHlDQUFZLENBQUNJLHNCQUFzQjtnQkFBRVksV0FBVztZQUFLO1FBQ3ZEO1FBQ0FYLG1CQUFtQlksR0FBRyxDQUFDVCxXQUFXSjtJQUNwQztJQUVBLG9DQUFvQztJQUNwQ0QsZ0JBQWdCRCxrRUFBZ0JBLENBQUNNLFdBQVdKO0FBQzlDO0FBRU8sU0FBU2M7SUFDZCxJQUFJLENBQUNmLGVBQWU7UUFDbEIseUNBQXlDO1FBQ3pDLE1BQU1nQixnQkFBZ0JsQixzQ0FBUyxDQUFDVyxRQUFRQyxHQUFHLElBQUksYUFBYTtRQUM1RFYsZ0JBQWdCRCxrRUFBZ0JBLENBQUMsV0FBV2lCO0lBQzlDO0lBQ0EsT0FBT2hCO0FBQ1Q7QUFFTyxTQUFTaUI7SUFDZCxJQUFJLENBQUNoQixzQkFBc0I7UUFDekIscUNBQXFDO1FBQ3JDLE1BQU1lLGdCQUFnQmxCLHNDQUFTLENBQUNXLFFBQVFDLEdBQUcsSUFBSSxhQUFhO1FBQzVELElBQUksQ0FBQ2IsMENBQWEsQ0FBQ21CLGdCQUFnQjtZQUNqQ25CLHlDQUFZLENBQUNtQixlQUFlO2dCQUFFSCxXQUFXO1lBQUs7UUFDaEQ7UUFDQVosdUJBQXVCZTtJQUN6QjtJQUNBLE9BQU9mO0FBQ1Q7QUFFQSxnQ0FBZ0M7QUFDekIsU0FBU2lCLG9CQUFvQkMsUUFBZ0IsRUFBRUMsT0FBZTtJQUNuRSxNQUFNQyxVQUFVRCxRQUFRRSxJQUFJO0lBRTVCLHlCQUF5QjtJQUN6QixJQUFJRixRQUFRRyxRQUFRLENBQUMsVUFBVUgsUUFBUUksV0FBVyxHQUFHRCxRQUFRLENBQUMsV0FBV0gsUUFBUUcsUUFBUSxDQUFDLGdCQUFnQjtRQUN4RyxPQUFPO1lBQUVFLFNBQVM7WUFBT0MsUUFBUTtRQUF5QztJQUM1RTtJQUVBLHNDQUFzQztJQUN0QyxJQUFJTCxRQUFRTSxNQUFNLEdBQUcsSUFBSTtRQUN2QixPQUFPO1lBQUVGLFNBQVM7WUFBT0MsUUFBUTtRQUE2QjtJQUNoRTtJQUVBLHFDQUFxQztJQUNyQyxJQUFJUCxTQUFTUyxRQUFRLENBQUMsVUFBVVQsU0FBU1MsUUFBUSxDQUFDLFFBQVE7UUFDeEQsSUFBSSxDQUFDUCxRQUFRRSxRQUFRLENBQUMsYUFBYSxDQUFDRixRQUFRRSxRQUFRLENBQUMsZUFBZSxDQUFDRixRQUFRRSxRQUFRLENBQUMsWUFBWSxDQUFDRixRQUFRRSxRQUFRLENBQUMsWUFBWSxDQUFDRixRQUFRRSxRQUFRLENBQUMsUUFBUTtZQUN4SixPQUFPO2dCQUFFRSxTQUFTO2dCQUFPQyxRQUFRO1lBQWlDO1FBQ3BFO0lBQ0Y7SUFFQSxPQUFPO1FBQUVELFNBQVM7UUFBTUMsUUFBUTtJQUFnQjtBQUNsRCIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2FnZW50cy91dGlscy50cz8zMGM5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25NZW1vcnksIGdldFNlc3Npb25NZW1vcnkgfSBmcm9tICcuLi91dGlscy9tZW1vcnktZGInO1xuXG4vLyBHbG9iYWwgbWVtb3J5IGluc3RhbmNlIGZvciBjdXJyZW50IHNlc3Npb25cbmxldCBjdXJyZW50TWVtb3J5OiBDb252ZXJzYXRpb25NZW1vcnkgfCBudWxsID0gbnVsbDtcbmxldCBjdXJyZW50UHJvamVjdEZvbGRlcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5sZXQgc2Vzc2lvblRvRm9sZGVyTWFwID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNldFNlc3Npb25NZW1vcnkoc2Vzc2lvbklkOiBzdHJpbmcpIHtcbiAgLy8gQ2hlY2sgaWYgdGhpcyBzZXNzaW9uIGFscmVhZHkgaGFzIGEgcHJvamVjdCBmb2xkZXJcbiAgaWYgKHNlc3Npb25Ub0ZvbGRlck1hcC5oYXMoc2Vzc2lvbklkKSkge1xuICAgIGN1cnJlbnRQcm9qZWN0Rm9sZGVyID0gc2Vzc2lvblRvRm9sZGVyTWFwLmdldChzZXNzaW9uSWQpITtcbiAgfSBlbHNlIHtcbiAgICAvLyBDcmVhdGUgbmV3IHByb2plY3QgZm9sZGVyIGZvciB0aGlzIHNlc3Npb25cbiAgICBjdXJyZW50UHJvamVjdEZvbGRlciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZ2VuZXJhdGVkJywgc2Vzc2lvbklkKTtcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoY3VycmVudFByb2plY3RGb2xkZXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoY3VycmVudFByb2plY3RGb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBzZXNzaW9uVG9Gb2xkZXJNYXAuc2V0KHNlc3Npb25JZCwgY3VycmVudFByb2plY3RGb2xkZXIpO1xuICB9XG5cbiAgLy8gQ3JlYXRlIG1lbW9yeSB3aXRoIHByb2plY3QgZm9sZGVyXG4gIGN1cnJlbnRNZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KHNlc3Npb25JZCwgY3VycmVudFByb2plY3RGb2xkZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVtb3J5KCk6IENvbnZlcnNhdGlvbk1lbW9yeSB7XG4gIGlmICghY3VycmVudE1lbW9yeSkge1xuICAgIC8vIEZhbGxiYWNrIHRvIGRlZmF1bHQgc2Vzc2lvbiBpZiBub3Qgc2V0XG4gICAgY29uc3QgZGVmYXVsdEZvbGRlciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZ2VuZXJhdGVkJywgJ2RlZmF1bHRfcHJvamVjdCcpO1xuICAgIGN1cnJlbnRNZW1vcnkgPSBnZXRTZXNzaW9uTWVtb3J5KCdkZWZhdWx0JywgZGVmYXVsdEZvbGRlcik7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRNZW1vcnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm9qZWN0Rm9sZGVyKCk6IHN0cmluZyB7XG4gIGlmICghY3VycmVudFByb2plY3RGb2xkZXIpIHtcbiAgICAvLyBGYWxsYmFjayB0byBkZWZhdWx0IHByb2plY3QgZm9sZGVyXG4gICAgY29uc3QgZGVmYXVsdEZvbGRlciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZ2VuZXJhdGVkJywgJ2RlZmF1bHRfcHJvamVjdCcpO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkZWZhdWx0Rm9sZGVyKSkge1xuICAgICAgZnMubWtkaXJTeW5jKGRlZmF1bHRGb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBjdXJyZW50UHJvamVjdEZvbGRlciA9IGRlZmF1bHRGb2xkZXI7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRQcm9qZWN0Rm9sZGVyO1xufVxuXG4vLyBIZWxwZXI6IFZhbGlkYXRlIGZpbGUgY29udGVudFxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRmlsZUNvbnRlbnQoZmlsZW5hbWU6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogeyBpc1ZhbGlkOiBib29sZWFuOyByZWFzb246IHN0cmluZyB9IHtcbiAgY29uc3QgdHJpbW1lZCA9IGNvbnRlbnQudHJpbSgpO1xuXG4gIC8vIENoZWNrIGZvciBwbGFjZWhvbGRlcnNcbiAgaWYgKGNvbnRlbnQuaW5jbHVkZXMoJy4uLicpIHx8IGNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndG9kbycpIHx8IGNvbnRlbnQuaW5jbHVkZXMoJ3BsYWNlaG9sZGVyJykpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgcmVhc29uOiAnQ29udGFpbnMgcGxhY2Vob2xkZXJzIG9yIFRPRE8gY29tbWVudHMnIH07XG4gIH1cblxuICAvLyBDaGVjayBmb3IgZW1wdHkgb3IgdmVyeSBzaG9ydCBmaWxlc1xuICBpZiAodHJpbW1lZC5sZW5ndGggPCAxMCkge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCByZWFzb246ICdGaWxlIGlzIHRvbyBzaG9ydCBvciBlbXB0eScgfTtcbiAgfVxuXG4gIC8vIENoZWNrIGZvciBpbmNvbXBsZXRlIGNvZGUgcGF0dGVybnNcbiAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcudHMnKSB8fCBmaWxlbmFtZS5lbmRzV2l0aCgnLmpzJykpIHtcbiAgICBpZiAoIXRyaW1tZWQuaW5jbHVkZXMoJ2V4cG9ydCcpICYmICF0cmltbWVkLmluY2x1ZGVzKCdmdW5jdGlvbicpICYmICF0cmltbWVkLmluY2x1ZGVzKCdjbGFzcycpICYmICF0cmltbWVkLmluY2x1ZGVzKCdjb25zdCcpICYmICF0cmltbWVkLmluY2x1ZGVzKCdsZXQnKSkge1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIHJlYXNvbjogJ05vIHZhbGlkIGNvZGUgY29uc3RydWN0cyBmb3VuZCcgfTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCByZWFzb246ICdWYWxpZCBjb250ZW50JyB9O1xufSJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJnZXRTZXNzaW9uTWVtb3J5IiwiY3VycmVudE1lbW9yeSIsImN1cnJlbnRQcm9qZWN0Rm9sZGVyIiwic2Vzc2lvblRvRm9sZGVyTWFwIiwiTWFwIiwic2V0U2Vzc2lvbk1lbW9yeSIsInNlc3Npb25JZCIsImhhcyIsImdldCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsInNldCIsImdldE1lbW9yeSIsImRlZmF1bHRGb2xkZXIiLCJnZXRQcm9qZWN0Rm9sZGVyIiwidmFsaWRhdGVGaWxlQ29udGVudCIsImZpbGVuYW1lIiwiY29udGVudCIsInRyaW1tZWQiLCJ0cmltIiwiaW5jbHVkZXMiLCJ0b0xvd2VyQ2FzZSIsImlzVmFsaWQiLCJyZWFzb24iLCJsZW5ndGgiLCJlbmRzV2l0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/agents/utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/database.ts":
/*!****************************!*\
  !*** ./lib/db/database.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addConversation: () => (/* binding */ addConversation),\n/* harmony export */   addProjectFile: () => (/* binding */ addProjectFile),\n/* harmony export */   cleanupOldSessions: () => (/* binding */ cleanupOldSessions),\n/* harmony export */   createProject: () => (/* binding */ createProject),\n/* harmony export */   getConversations: () => (/* binding */ getConversations),\n/* harmony export */   getCurrentProject: () => (/* binding */ getCurrentProject),\n/* harmony export */   getFileOperations: () => (/* binding */ getFileOperations),\n/* harmony export */   getOrCreateSession: () => (/* binding */ getOrCreateSession),\n/* harmony export */   getProjectFiles: () => (/* binding */ getProjectFiles),\n/* harmony export */   getProjectsBySession: () => (/* binding */ getProjectsBySession),\n/* harmony export */   getRecentConversations: () => (/* binding */ getRecentConversations),\n/* harmony export */   getSessionStats: () => (/* binding */ getSessionStats),\n/* harmony export */   trackFileOperation: () => (/* binding */ trackFileOperation),\n/* harmony export */   updateProject: () => (/* binding */ updateProject),\n/* harmony export */   updateSessionFolder: () => (/* binding */ updateSessionFolder)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ \"(rsc)/./lib/db/prisma.ts\");\n\n/**\n * Session Management\n */ async function getOrCreateSession(sessionId, projectFolder) {\n    let session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        },\n        include: {\n            conversations: {\n                orderBy: {\n                    timestamp: \"asc\"\n                }\n            },\n            projects: {\n                include: {\n                    files: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            }\n        }\n    });\n    if (!session) {\n        session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.create({\n            data: {\n                sessionId,\n                projectFolder\n            },\n            include: {\n                conversations: true,\n                projects: {\n                    include: {\n                        files: true\n                    }\n                }\n            }\n        });\n    }\n    return session;\n}\nasync function updateSessionFolder(sessionId, projectFolder) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.update({\n        where: {\n            sessionId\n        },\n        data: {\n            projectFolder\n        }\n    });\n}\n/**\n * Conversation Management\n */ async function addConversation(sessionId, role, content) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        throw new Error(`Session not found: ${sessionId}`);\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.conversation.create({\n        data: {\n            sessionId: session.id,\n            role,\n            content\n        }\n    });\n}\nasync function getConversations(sessionId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        return [];\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.conversation.findMany({\n        where: {\n            sessionId: session.id\n        },\n        orderBy: {\n            timestamp: \"asc\"\n        }\n    });\n}\nasync function getRecentConversations(sessionId, limit = 10) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        return [];\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.conversation.findMany({\n        where: {\n            sessionId: session.id\n        },\n        orderBy: {\n            timestamp: \"desc\"\n        },\n        take: limit\n    });\n}\n/**\n * Project Management\n */ async function createProject(sessionId, projectFolder, userRequest, plan) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        throw new Error(`Session not found: ${sessionId}`);\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.project.create({\n        data: {\n            sessionId: session.id,\n            projectFolder,\n            userRequest,\n            plan\n        },\n        include: {\n            files: true\n        }\n    });\n}\nasync function updateProject(projectId, data) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.project.update({\n        where: {\n            id: projectId\n        },\n        data\n    });\n}\nasync function getProjectsBySession(sessionId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        }\n    });\n    if (!session) {\n        return [];\n    }\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.project.findMany({\n        where: {\n            sessionId: session.id\n        },\n        include: {\n            files: true\n        },\n        orderBy: {\n            createdAt: \"desc\"\n        }\n    });\n}\nasync function getCurrentProject(sessionId) {\n    const projects = await getProjectsBySession(sessionId);\n    return projects[0] || null;\n}\n/**\n * File Management\n */ async function addProjectFile(projectId, filename, content, operation) {\n    // Check if file already exists\n    const existing = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.findFirst({\n        where: {\n            projectId,\n            filename\n        }\n    });\n    if (existing) {\n        // Update existing file\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.update({\n            where: {\n                id: existing.id\n            },\n            data: {\n                content,\n                operation\n            }\n        });\n    }\n    // Create new file\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.create({\n        data: {\n            projectId,\n            filename,\n            content,\n            operation\n        }\n    });\n}\nasync function getProjectFiles(projectId) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.projectFile.findMany({\n        where: {\n            projectId\n        },\n        orderBy: {\n            updatedAt: \"desc\"\n        }\n    });\n}\n/**\n * File Operations Tracking\n */ async function trackFileOperation(sessionId, operation, filePath) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.fileOperation.create({\n        data: {\n            sessionId,\n            operation,\n            filePath\n        }\n    });\n}\nasync function getFileOperations(sessionId, limit = 50) {\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.fileOperation.findMany({\n        where: {\n            sessionId\n        },\n        orderBy: {\n            timestamp: \"desc\"\n        },\n        take: limit\n    });\n}\n/**\n * Utility Functions\n */ async function getSessionStats(sessionId) {\n    const session = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.findUnique({\n        where: {\n            sessionId\n        },\n        include: {\n            _count: {\n                select: {\n                    conversations: true,\n                    projects: true\n                }\n            }\n        }\n    });\n    if (!session) {\n        return null;\n    }\n    const fileOperations = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.fileOperation.count({\n        where: {\n            sessionId\n        }\n    });\n    return {\n        sessionId: session.sessionId,\n        projectFolder: session.projectFolder,\n        conversationCount: session._count.conversations,\n        projectCount: session._count.projects,\n        fileOperationCount: fileOperations,\n        createdAt: session.createdAt,\n        updatedAt: session.updatedAt\n    };\n}\nasync function cleanupOldSessions(daysOld = 7) {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - daysOld);\n    return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.session.deleteMany({\n        where: {\n            updatedAt: {\n                lt: cutoffDate\n            }\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVLE1BQU1KLDJDQUFNQSxDQUFDSSxPQUFPLENBQUNDLFVBQVUsQ0FBQztRQUM5Q0MsT0FBTztZQUFFSjtRQUFVO1FBQ25CSyxTQUFTO1lBQ1AyQyxRQUFRO2dCQUNOQyxRQUFRO29CQUNOM0MsZUFBZTtvQkFDZkcsVUFBVTtnQkFDWjtZQUNGO1FBQ0Y7SUFDRjtJQUVBLElBQUksQ0FBQ1AsU0FBUztRQUNaLE9BQU87SUFDVDtJQUVBLE1BQU1nRCxpQkFBaUIsTUFBTXBELDJDQUFNQSxDQUFDK0MsYUFBYSxDQUFDTSxLQUFLLENBQUM7UUFDdEQvQyxPQUFPO1lBQUVKO1FBQVU7SUFDckI7SUFFQSxPQUFPO1FBQ0xBLFdBQVdFLFFBQVFGLFNBQVM7UUFDNUJDLGVBQWVDLFFBQVFELGFBQWE7UUFDcENtRCxtQkFBbUJsRCxRQUFROEMsTUFBTSxDQUFDMUMsYUFBYTtRQUMvQytDLGNBQWNuRCxRQUFROEMsTUFBTSxDQUFDdkMsUUFBUTtRQUNyQzZDLG9CQUFvQko7UUFDcEJ2QyxXQUFXVCxRQUFRUyxTQUFTO1FBQzVCK0IsV0FBV3hDLFFBQVF3QyxTQUFTO0lBQzlCO0FBQ0Y7QUFFTyxlQUFlYSxtQkFBbUJDLFVBQWtCLENBQUM7SUFDMUQsTUFBTUMsYUFBYSxJQUFJQztJQUN2QkQsV0FBV0UsT0FBTyxDQUFDRixXQUFXRyxPQUFPLEtBQUtKO0lBRTFDLE9BQU8sTUFBTTFELDJDQUFNQSxDQUFDSSxPQUFPLENBQUMyRCxVQUFVLENBQUM7UUFDckN6RCxPQUFPO1lBQ0xzQyxXQUFXO2dCQUNUb0IsSUFBSUw7WUFDTjtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2RiL2RhdGFiYXNlLnRzPzIzMjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi9wcmlzbWEnO1xuXG4vKipcbiAqIFNlc3Npb24gTWFuYWdlbWVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3JDcmVhdGVTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nLCBwcm9qZWN0Rm9sZGVyOiBzdHJpbmcpIHtcbiAgbGV0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBzZXNzaW9uSWQgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBjb252ZXJzYXRpb25zOiB7XG4gICAgICAgIG9yZGVyQnk6IHsgdGltZXN0YW1wOiAnYXNjJyB9LFxuICAgICAgfSxcbiAgICAgIHByb2plY3RzOiB7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBmaWxlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgfSxcbiAgICB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uY3JlYXRlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc2Vzc2lvbklkLFxuICAgICAgICBwcm9qZWN0Rm9sZGVyLFxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgY29udmVyc2F0aW9uczogdHJ1ZSxcbiAgICAgICAgcHJvamVjdHM6IHtcbiAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBmaWxlczogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBzZXNzaW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU2Vzc2lvbkZvbGRlcihzZXNzaW9uSWQ6IHN0cmluZywgcHJvamVjdEZvbGRlcjogc3RyaW5nKSB7XG4gIHJldHVybiBhd2FpdCBwcmlzbWEuc2Vzc2lvbi51cGRhdGUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICAgIGRhdGE6IHsgcHJvamVjdEZvbGRlciB9LFxuICB9KTtcbn1cblxuLyoqXG4gKiBDb252ZXJzYXRpb24gTWFuYWdlbWVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkQ29udmVyc2F0aW9uKHNlc3Npb25JZDogc3RyaW5nLCByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgY29udGVudDogc3RyaW5nKSB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBwcmlzbWEuc2Vzc2lvbi5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBzZXNzaW9uSWQgfSxcbiAgfSk7XG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBTZXNzaW9uIG5vdCBmb3VuZDogJHtzZXNzaW9uSWR9YCk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcHJpc21hLmNvbnZlcnNhdGlvbi5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5pZCxcbiAgICAgIHJvbGUsXG4gICAgICBjb250ZW50LFxuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udmVyc2F0aW9ucyhzZXNzaW9uSWQ6IHN0cmluZykge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkIH0sXG4gIH0pO1xuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBwcmlzbWEuY29udmVyc2F0aW9uLmZpbmRNYW55KHtcbiAgICB3aGVyZTogeyBzZXNzaW9uSWQ6IHNlc3Npb24uaWQgfSxcbiAgICBvcmRlckJ5OiB7IHRpbWVzdGFtcDogJ2FzYycgfSxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSZWNlbnRDb252ZXJzYXRpb25zKHNlc3Npb25JZDogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTApIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHByaXNtYS5zZXNzaW9uLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcHJpc21hLmNvbnZlcnNhdGlvbi5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkOiBzZXNzaW9uLmlkIH0sXG4gICAgb3JkZXJCeTogeyB0aW1lc3RhbXA6ICdkZXNjJyB9LFxuICAgIHRha2U6IGxpbWl0LFxuICB9KTtcbn1cblxuLyoqXG4gKiBQcm9qZWN0IE1hbmFnZW1lbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QoXG4gIHNlc3Npb25JZDogc3RyaW5nLFxuICBwcm9qZWN0Rm9sZGVyOiBzdHJpbmcsXG4gIHVzZXJSZXF1ZXN0OiBzdHJpbmcsXG4gIHBsYW46IHN0cmluZ1tdXG4pIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHByaXNtYS5zZXNzaW9uLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFNlc3Npb24gbm90IGZvdW5kOiAke3Nlc3Npb25JZH1gKTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBwcmlzbWEucHJvamVjdC5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5pZCxcbiAgICAgIHByb2plY3RGb2xkZXIsXG4gICAgICB1c2VyUmVxdWVzdCxcbiAgICAgIHBsYW4sXG4gICAgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBmaWxlczogdHJ1ZSxcbiAgICB9LFxuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2plY3QoXG4gIHByb2plY3RJZDogc3RyaW5nLFxuICBkYXRhOiB7XG4gICAgcGxhbj86IHN0cmluZ1tdO1xuICAgIGlzQ29tcGxldGU/OiBib29sZWFuO1xuICB9XG4pIHtcbiAgcmV0dXJuIGF3YWl0IHByaXNtYS5wcm9qZWN0LnVwZGF0ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHByb2plY3RJZCB9LFxuICAgIGRhdGEsXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdHNCeVNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHByaXNtYS5zZXNzaW9uLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICB9KTtcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcHJpc21hLnByb2plY3QuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZDogc2Vzc2lvbi5pZCB9LFxuICAgIGluY2x1ZGU6IHtcbiAgICAgIGZpbGVzOiB0cnVlLFxuICAgIH0sXG4gICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRQcm9qZWN0KHNlc3Npb25JZDogc3RyaW5nKSB7XG4gIGNvbnN0IHByb2plY3RzID0gYXdhaXQgZ2V0UHJvamVjdHNCeVNlc3Npb24oc2Vzc2lvbklkKTtcbiAgcmV0dXJuIHByb2plY3RzWzBdIHx8IG51bGw7XG59XG5cbi8qKlxuICogRmlsZSBNYW5hZ2VtZW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRQcm9qZWN0RmlsZShcbiAgcHJvamVjdElkOiBzdHJpbmcsXG4gIGZpbGVuYW1lOiBzdHJpbmcsXG4gIGNvbnRlbnQ6IHN0cmluZyxcbiAgb3BlcmF0aW9uOiAnY3JlYXRlZCcgfCAnbW9kaWZpZWQnIHwgJ2RlbGV0ZWQnXG4pIHtcbiAgLy8gQ2hlY2sgaWYgZmlsZSBhbHJlYWR5IGV4aXN0c1xuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IHByaXNtYS5wcm9qZWN0RmlsZS5maW5kRmlyc3Qoe1xuICAgIHdoZXJlOiB7XG4gICAgICBwcm9qZWN0SWQsXG4gICAgICBmaWxlbmFtZSxcbiAgICB9LFxuICB9KTtcblxuICBpZiAoZXhpc3RpbmcpIHtcbiAgICAvLyBVcGRhdGUgZXhpc3RpbmcgZmlsZVxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEucHJvamVjdEZpbGUudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZy5pZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICBjb250ZW50LFxuICAgICAgICBvcGVyYXRpb24sXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLy8gQ3JlYXRlIG5ldyBmaWxlXG4gIHJldHVybiBhd2FpdCBwcmlzbWEucHJvamVjdEZpbGUuY3JlYXRlKHtcbiAgICBkYXRhOiB7XG4gICAgICBwcm9qZWN0SWQsXG4gICAgICBmaWxlbmFtZSxcbiAgICAgIGNvbnRlbnQsXG4gICAgICBvcGVyYXRpb24sXG4gICAgfSxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9qZWN0RmlsZXMocHJvamVjdElkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGF3YWl0IHByaXNtYS5wcm9qZWN0RmlsZS5maW5kTWFueSh7XG4gICAgd2hlcmU6IHsgcHJvamVjdElkIH0sXG4gICAgb3JkZXJCeTogeyB1cGRhdGVkQXQ6ICdkZXNjJyB9LFxuICB9KTtcbn1cblxuLyoqXG4gKiBGaWxlIE9wZXJhdGlvbnMgVHJhY2tpbmdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRyYWNrRmlsZU9wZXJhdGlvbihcbiAgc2Vzc2lvbklkOiBzdHJpbmcsXG4gIG9wZXJhdGlvbjogJ2NyZWF0ZWQnIHwgJ21vZGlmaWVkJyB8ICdkZWxldGVkJyB8ICdyZWFkJyxcbiAgZmlsZVBhdGg6IHN0cmluZ1xuKSB7XG4gIHJldHVybiBhd2FpdCBwcmlzbWEuZmlsZU9wZXJhdGlvbi5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIHNlc3Npb25JZCxcbiAgICAgIG9wZXJhdGlvbixcbiAgICAgIGZpbGVQYXRoLFxuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsZU9wZXJhdGlvbnMoc2Vzc2lvbklkOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSA1MCkge1xuICByZXR1cm4gYXdhaXQgcHJpc21hLmZpbGVPcGVyYXRpb24uZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IHNlc3Npb25JZCB9LFxuICAgIG9yZGVyQnk6IHsgdGltZXN0YW1wOiAnZGVzYycgfSxcbiAgICB0YWtlOiBsaW1pdCxcbiAgfSk7XG59XG5cbi8qKlxuICogVXRpbGl0eSBGdW5jdGlvbnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb25TdGF0cyhzZXNzaW9uSWQ6IHN0cmluZykge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgcHJpc21hLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkIH0sXG4gICAgaW5jbHVkZToge1xuICAgICAgX2NvdW50OiB7XG4gICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgIGNvbnZlcnNhdGlvbnM6IHRydWUsXG4gICAgICAgICAgcHJvamVjdHM6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgZmlsZU9wZXJhdGlvbnMgPSBhd2FpdCBwcmlzbWEuZmlsZU9wZXJhdGlvbi5jb3VudCh7XG4gICAgd2hlcmU6IHsgc2Vzc2lvbklkIH0sXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgc2Vzc2lvbklkOiBzZXNzaW9uLnNlc3Npb25JZCxcbiAgICBwcm9qZWN0Rm9sZGVyOiBzZXNzaW9uLnByb2plY3RGb2xkZXIsXG4gICAgY29udmVyc2F0aW9uQ291bnQ6IHNlc3Npb24uX2NvdW50LmNvbnZlcnNhdGlvbnMsXG4gICAgcHJvamVjdENvdW50OiBzZXNzaW9uLl9jb3VudC5wcm9qZWN0cyxcbiAgICBmaWxlT3BlcmF0aW9uQ291bnQ6IGZpbGVPcGVyYXRpb25zLFxuICAgIGNyZWF0ZWRBdDogc2Vzc2lvbi5jcmVhdGVkQXQsXG4gICAgdXBkYXRlZEF0OiBzZXNzaW9uLnVwZGF0ZWRBdCxcbiAgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFudXBPbGRTZXNzaW9ucyhkYXlzT2xkOiBudW1iZXIgPSA3KSB7XG4gIGNvbnN0IGN1dG9mZkRhdGUgPSBuZXcgRGF0ZSgpO1xuICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBkYXlzT2xkKTtcblxuICByZXR1cm4gYXdhaXQgcHJpc21hLnNlc3Npb24uZGVsZXRlTWFueSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICBsdDogY3V0b2ZmRGF0ZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiZ2V0T3JDcmVhdGVTZXNzaW9uIiwic2Vzc2lvbklkIiwicHJvamVjdEZvbGRlciIsInNlc3Npb24iLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpbmNsdWRlIiwiY29udmVyc2F0aW9ucyIsIm9yZGVyQnkiLCJ0aW1lc3RhbXAiLCJwcm9qZWN0cyIsImZpbGVzIiwiY3JlYXRlZEF0IiwiY3JlYXRlIiwiZGF0YSIsInVwZGF0ZVNlc3Npb25Gb2xkZXIiLCJ1cGRhdGUiLCJhZGRDb252ZXJzYXRpb24iLCJyb2xlIiwiY29udGVudCIsIkVycm9yIiwiY29udmVyc2F0aW9uIiwiaWQiLCJnZXRDb252ZXJzYXRpb25zIiwiZmluZE1hbnkiLCJnZXRSZWNlbnRDb252ZXJzYXRpb25zIiwibGltaXQiLCJ0YWtlIiwiY3JlYXRlUHJvamVjdCIsInVzZXJSZXF1ZXN0IiwicGxhbiIsInByb2plY3QiLCJ1cGRhdGVQcm9qZWN0IiwicHJvamVjdElkIiwiZ2V0UHJvamVjdHNCeVNlc3Npb24iLCJnZXRDdXJyZW50UHJvamVjdCIsImFkZFByb2plY3RGaWxlIiwiZmlsZW5hbWUiLCJvcGVyYXRpb24iLCJleGlzdGluZyIsInByb2plY3RGaWxlIiwiZmluZEZpcnN0IiwiZ2V0UHJvamVjdEZpbGVzIiwidXBkYXRlZEF0IiwidHJhY2tGaWxlT3BlcmF0aW9uIiwiZmlsZVBhdGgiLCJmaWxlT3BlcmF0aW9uIiwiZ2V0RmlsZU9wZXJhdGlvbnMiLCJnZXRTZXNzaW9uU3RhdHMiLCJfY291bnQiLCJzZWxlY3QiLCJmaWxlT3BlcmF0aW9ucyIsImNvdW50IiwiY29udmVyc2F0aW9uQ291bnQiLCJwcm9qZWN0Q291bnQiLCJmaWxlT3BlcmF0aW9uQ291bnQiLCJjbGVhbnVwT2xkU2Vzc2lvbnMiLCJkYXlzT2xkIiwiY3V0b2ZmRGF0ZSIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRlbGV0ZU1hbnkiLCJsdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/database.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/prisma.ts":
/*!**************************!*\
  !*** ./lib/db/prisma.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ]\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxDQUFDO0lBQy9ESSxLQUFLO1FBQUM7UUFBUztRQUFTO0tBQU87QUFDakMsR0FBRztBQUVILElBQUlDLElBQXlCLEVBQWNKLGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL2RiL3ByaXNtYS50cz8wOTYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KHtcbiAgbG9nOiBbJ3F1ZXJ5JywgJ2Vycm9yJywgJ3dhcm4nXSxcbn0pO1xuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/fileops.ts":
/*!******************************!*\
  !*** ./lib/utils/fileops.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DirectoryListSchema: () => (/* binding */ DirectoryListSchema),\n/* harmony export */   FileAppendSchema: () => (/* binding */ FileAppendSchema),\n/* harmony export */   FileDeleteSchema: () => (/* binding */ FileDeleteSchema),\n/* harmony export */   FileReadSchema: () => (/* binding */ FileReadSchema),\n/* harmony export */   FileSearchSchema: () => (/* binding */ FileSearchSchema),\n/* harmony export */   FileWriteSchema: () => (/* binding */ FileWriteSchema),\n/* harmony export */   appendToFile: () => (/* binding */ appendToFile),\n/* harmony export */   deleteFile: () => (/* binding */ deleteFile),\n/* harmony export */   fileExists: () => (/* binding */ fileExists),\n/* harmony export */   listDirectory: () => (/* binding */ listDirectory),\n/* harmony export */   readFile: () => (/* binding */ readFile),\n/* harmony export */   searchFiles: () => (/* binding */ searchFiles),\n/* harmony export */   writeFile: () => (/* binding */ writeFile)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/.pnpm/zod@3.25.76/node_modules/zod/v3/types.js\");\n\n\n\n// Configuration for safe file operations\nconst SAFE_DIRECTORIES = [\n    \"./generated\",\n    \"./workspace\",\n    \"./temp\"\n];\nconst ALLOWED_EXTENSIONS = [\n    \".ts\",\n    \".tsx\",\n    \".js\",\n    \".jsx\",\n    \".json\",\n    \".css\",\n    \".html\",\n    \".md\",\n    \".txt\",\n    \".yaml\",\n    \".yml\",\n    \".xml\",\n    \".sql\",\n    \".py\",\n    \".rs\",\n    \".go\",\n    \".java\",\n    \".c\",\n    \".cpp\",\n    \"Dockerfile\",\n    \".gitignore\",\n    \".env.example\"\n];\nfunction isPathSafe(filePath) {\n    const normalizedPath = path__WEBPACK_IMPORTED_MODULE_1__.resolve(filePath);\n    const cwd = process.cwd();\n    // Check if path is within allowed directories\n    const allowed = SAFE_DIRECTORIES.some((dir)=>{\n        const resolvedDir = path__WEBPACK_IMPORTED_MODULE_1__.resolve(path__WEBPACK_IMPORTED_MODULE_1__.join(cwd, dir));\n        return normalizedPath.startsWith(resolvedDir);\n    });\n    // Check file extension\n    const ext = path__WEBPACK_IMPORTED_MODULE_1__.extname(filePath);\n    const extAllowed = ALLOWED_EXTENSIONS.includes(ext) || ext === \"\" || filePath.includes(\"Dockerfile\");\n    return allowed && extAllowed && !filePath.includes(\"..\");\n}\n// File read operation\nasync function readFile(filePath) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(filePath)) {\n            return {\n                success: false,\n                error: \"File does not exist\"\n            };\n        }\n        const content = fs__WEBPACK_IMPORTED_MODULE_0__.readFileSync(filePath, \"utf-8\");\n        return {\n            success: true,\n            content\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error reading file\"\n        };\n    }\n}\n// File write operation\nasync function writeFile(filePath, content) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        // Ensure directory exists\n        const dir = path__WEBPACK_IMPORTED_MODULE_1__.dirname(filePath);\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(dir)) {\n            fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync(dir, {\n                recursive: true\n            });\n        }\n        fs__WEBPACK_IMPORTED_MODULE_0__.writeFileSync(filePath, content, \"utf-8\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error writing file\"\n        };\n    }\n}\n// File modification (append)\nasync function appendToFile(filePath, content) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        fs__WEBPACK_IMPORTED_MODULE_0__.appendFileSync(filePath, content, \"utf-8\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error appending to file\"\n        };\n    }\n}\n// File deletion\nasync function deleteFile(filePath) {\n    try {\n        if (!isPathSafe(filePath)) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(filePath)) {\n            return {\n                success: false,\n                error: \"File does not exist\"\n            };\n        }\n        // Only allow deletion of generated files\n        const isInGenerated = filePath.startsWith(path__WEBPACK_IMPORTED_MODULE_1__.resolve(\"./generated\"));\n        if (!isInGenerated) {\n            return {\n                success: false,\n                error: \"Deletion only allowed for generated files\"\n            };\n        }\n        fs__WEBPACK_IMPORTED_MODULE_0__.unlinkSync(filePath);\n        return {\n            success: true\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error deleting file\"\n        };\n    }\n}\n// List directory\nasync function listDirectory(dirPath) {\n    try {\n        if (!isPathSafe(dirPath) && !SAFE_DIRECTORIES.some((dir)=>dirPath.includes(dir))) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(dirPath)) {\n            return {\n                success: false,\n                error: \"Directory does not exist\"\n            };\n        }\n        const files = fs__WEBPACK_IMPORTED_MODULE_0__.readdirSync(dirPath);\n        return {\n            success: true,\n            files\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error listing directory\"\n        };\n    }\n}\n// Check if file exists\nasync function fileExists(filePath) {\n    try {\n        return fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(filePath);\n    } catch  {\n        return false;\n    }\n}\n// Helper function for recursive directory search\nfunction searchDirectory(currentPath, pattern, matches) {\n    try {\n        const items = fs__WEBPACK_IMPORTED_MODULE_0__.readdirSync(currentPath);\n        for (const item of items){\n            const fullPath = path__WEBPACK_IMPORTED_MODULE_1__.join(currentPath, item);\n            const stat = fs__WEBPACK_IMPORTED_MODULE_0__.statSync(fullPath);\n            if (stat.isDirectory()) {\n                // Skip node_modules and .git\n                if (item !== \"node_modules\" && item !== \".git\" && item !== \".next\") {\n                    searchDirectory(fullPath, pattern, matches);\n                }\n            } else if (stat.isFile()) {\n                // Check if file extension is allowed\n                const ext = path__WEBPACK_IMPORTED_MODULE_1__.extname(item);\n                if (ALLOWED_EXTENSIONS.includes(ext) || ext === \"\" || item.includes(\"Dockerfile\")) {\n                    try {\n                        const content = fs__WEBPACK_IMPORTED_MODULE_0__.readFileSync(fullPath, \"utf-8\");\n                        const lines = content.split(\"\\n\");\n                        lines.forEach((line, index)=>{\n                            if (new RegExp(pattern, \"i\").test(line)) {\n                                matches.push({\n                                    file: fullPath,\n                                    content: line.trim(),\n                                    line: index + 1\n                                });\n                            }\n                        });\n                    } catch (error) {\n                        continue;\n                    }\n                }\n            }\n        }\n    } catch (error) {\n        // Skip directories we can't read\n        return;\n    }\n}\n// Regex file search operation\nasync function searchFiles(dirPath, pattern) {\n    try {\n        if (!isPathSafe(dirPath) && !SAFE_DIRECTORIES.some((dir)=>dirPath.includes(dir))) {\n            return {\n                success: false,\n                error: \"Path not allowed for security reasons\"\n            };\n        }\n        // Ensure base directory exists\n        if (!fs__WEBPACK_IMPORTED_MODULE_0__.existsSync(dirPath)) {\n            return {\n                success: false,\n                error: \"Directory does not exist\"\n            };\n        }\n        const matches = [];\n        searchDirectory(dirPath, pattern, matches);\n        return {\n            success: true,\n            matches\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error during file search\"\n        };\n    }\n}\n// Schema definitions for tool calls\nconst FileReadSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the file to read\")\n});\nconst FileWriteSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path where to create/modify the file\"),\n    content: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Content to write to the file\")\n});\nconst FileAppendSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the file to append to\"),\n    content: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Content to append to the file\")\n});\nconst FileDeleteSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    filePath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the file to delete\")\n});\nconst DirectoryListSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    dirPath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Path to the directory to list\")\n});\nconst FileSearchSchema = zod__WEBPACK_IMPORTED_MODULE_2__.object({\n    dirPath: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Directory to search in\"),\n    pattern: zod__WEBPACK_IMPORTED_MODULE_2__.string().describe(\"Regex pattern to search for (JavaScript regex syntax)\")\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFHbUUsUUFBUSxDQUFDO0FBQ2hDLEdBQUc7QUFFSSxNQUFNSSxzQkFBc0J2RSx1Q0FBUSxDQUFDO0lBQzFDc0MsU0FBU3RDLHVDQUFRLEdBQUdtRSxRQUFRLENBQUM7QUFDL0IsR0FBRztBQUVJLE1BQU1LLG1CQUFtQnhFLHVDQUFRLENBQUM7SUFDdkNzQyxTQUFTdEMsdUNBQVEsR0FBR21FLFFBQVEsQ0FBQztJQUM3QnZCLFNBQVM1Qyx1Q0FBUSxHQUFHbUUsUUFBUSxDQUFDO0FBQy9CLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi91dGlscy9maWxlb3BzLnRzP2Q2NjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG4vLyBDb25maWd1cmF0aW9uIGZvciBzYWZlIGZpbGUgb3BlcmF0aW9uc1xuY29uc3QgU0FGRV9ESVJFQ1RPUklFUyA9IFtcbiAgJy4vZ2VuZXJhdGVkJyxcbiAgJy4vd29ya3NwYWNlJyxcbiAgJy4vdGVtcCcsXG5dO1xuXG5jb25zdCBBTExPV0VEX0VYVEVOU0lPTlMgPSBbXG4gICcudHMnLCAnLnRzeCcsICcuanMnLCAnLmpzeCcsICcuanNvbicsICcuY3NzJywgJy5odG1sJywgJy5tZCcsICcudHh0JyxcbiAgJy55YW1sJywgJy55bWwnLCAnLnhtbCcsICcuc3FsJywgJy5weScsICcucnMnLCAnLmdvJywgJy5qYXZhJywgJy5jJywgJy5jcHAnLFxuICAnRG9ja2VyZmlsZScsICcuZ2l0aWdub3JlJywgJy5lbnYuZXhhbXBsZSdcbl07XG5cbmZ1bmN0aW9uIGlzUGF0aFNhZmUoZmlsZVBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBub3JtYWxpemVkUGF0aCA9IHBhdGgucmVzb2x2ZShmaWxlUGF0aCk7XG4gIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKCk7XG5cbiAgLy8gQ2hlY2sgaWYgcGF0aCBpcyB3aXRoaW4gYWxsb3dlZCBkaXJlY3Rvcmllc1xuICBjb25zdCBhbGxvd2VkID0gU0FGRV9ESVJFQ1RPUklFUy5zb21lKGRpciA9PiB7XG4gICAgY29uc3QgcmVzb2x2ZWREaXIgPSBwYXRoLnJlc29sdmUocGF0aC5qb2luKGN3ZCwgZGlyKSk7XG4gICAgcmV0dXJuIG5vcm1hbGl6ZWRQYXRoLnN0YXJ0c1dpdGgocmVzb2x2ZWREaXIpO1xuICB9KTtcblxuICAvLyBDaGVjayBmaWxlIGV4dGVuc2lvblxuICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZVBhdGgpO1xuICBjb25zdCBleHRBbGxvd2VkID0gQUxMT1dFRF9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dCkgfHwgZXh0ID09PSAnJyB8fCBmaWxlUGF0aC5pbmNsdWRlcygnRG9ja2VyZmlsZScpO1xuXG4gIHJldHVybiBhbGxvd2VkICYmIGV4dEFsbG93ZWQgJiYgIWZpbGVQYXRoLmluY2x1ZGVzKCcuLicpO1xufVxuXG4vLyBGaWxlIHJlYWQgb3BlcmF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVhZEZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW4sIGNvbnRlbnQ/OiBzdHJpbmcsIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmlsZSBkb2VzIG5vdCBleGlzdCd9O1xuICAgIH1cblxuICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgsICd1dGYtOCcpO1xuICAgIHJldHVybiB7c3VjY2VzczogdHJ1ZSwgY29udGVudH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgcmVhZGluZyBmaWxlJ1xuICAgIH07XG4gIH1cbn1cblxuLy8gRmlsZSB3cml0ZSBvcGVyYXRpb25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3cml0ZUZpbGUoZmlsZVBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx7c3VjY2VzczogYm9vbGVhbiwgZXJyb3I/OiBzdHJpbmd9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFpc1BhdGhTYWZlKGZpbGVQYXRoKSkge1xuICAgICAgcmV0dXJuIHtzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdQYXRoIG5vdCBhbGxvd2VkIGZvciBzZWN1cml0eSByZWFzb25zJ307XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIGRpcmVjdG9yeSBleGlzdHNcbiAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoZmlsZVBhdGgpO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBjb250ZW50LCAndXRmLTgnKTtcbiAgICByZXR1cm4ge3N1Y2Nlc3M6IHRydWV9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIHdyaXRpbmcgZmlsZSdcbiAgICB9O1xuICB9XG59XG5cbi8vIEZpbGUgbW9kaWZpY2F0aW9uIChhcHBlbmQpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBwZW5kVG9GaWxlKGZpbGVQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGZzLmFwcGVuZEZpbGVTeW5jKGZpbGVQYXRoLCBjb250ZW50LCAndXRmLTgnKTtcbiAgICByZXR1cm4ge3N1Y2Nlc3M6IHRydWV9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGFwcGVuZGluZyB0byBmaWxlJ1xuICAgIH07XG4gIH1cbn1cblxuLy8gRmlsZSBkZWxldGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmlsZSBkb2VzIG5vdCBleGlzdCd9O1xuICAgIH1cblxuICAgIC8vIE9ubHkgYWxsb3cgZGVsZXRpb24gb2YgZ2VuZXJhdGVkIGZpbGVzXG4gICAgY29uc3QgaXNJbkdlbmVyYXRlZCA9IGZpbGVQYXRoLnN0YXJ0c1dpdGgocGF0aC5yZXNvbHZlKCcuL2dlbmVyYXRlZCcpKTtcbiAgICBpZiAoIWlzSW5HZW5lcmF0ZWQpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnRGVsZXRpb24gb25seSBhbGxvd2VkIGZvciBnZW5lcmF0ZWQgZmlsZXMnfTtcbiAgICB9XG5cbiAgICBmcy51bmxpbmtTeW5jKGZpbGVQYXRoKTtcbiAgICByZXR1cm4ge3N1Y2Nlc3M6IHRydWV9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGRlbGV0aW5nIGZpbGUnXG4gICAgfTtcbiAgfVxufVxuXG4vLyBMaXN0IGRpcmVjdG9yeVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3REaXJlY3RvcnkoZGlyUGF0aDogc3RyaW5nKTogUHJvbWlzZTx7c3VjY2VzczogYm9vbGVhbiwgZmlsZXM/OiBzdHJpbmdbXSwgZXJyb3I/OiBzdHJpbmd9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFpc1BhdGhTYWZlKGRpclBhdGgpICYmICFTQUZFX0RJUkVDVE9SSUVTLnNvbWUoZGlyID0+IGRpclBhdGguaW5jbHVkZXMoZGlyKSkpIHtcbiAgICAgIHJldHVybiB7c3VjY2VzczogZmFsc2UsIGVycm9yOiAnUGF0aCBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucyd9O1xuICAgIH1cblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXJQYXRoKSkge1xuICAgICAgcmV0dXJuIHtzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdEaXJlY3RvcnkgZG9lcyBub3QgZXhpc3QnfTtcbiAgICB9XG5cbiAgICBjb25zdCBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKGRpclBhdGgpO1xuICAgIHJldHVybiB7c3VjY2VzczogdHJ1ZSwgZmlsZXN9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGxpc3RpbmcgZGlyZWN0b3J5J1xuICAgIH07XG4gIH1cbn1cblxuLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaWxlRXhpc3RzKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZnMuZXhpc3RzU3luYyhmaWxlUGF0aCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb24gZm9yIHJlY3Vyc2l2ZSBkaXJlY3Rvcnkgc2VhcmNoXG5mdW5jdGlvbiBzZWFyY2hEaXJlY3RvcnkoY3VycmVudFBhdGg6IHN0cmluZywgcGF0dGVybjogc3RyaW5nLCBtYXRjaGVzOiBBcnJheTx7ZmlsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcsIGxpbmU6IG51bWJlcn0+KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgaXRlbXMgPSBmcy5yZWFkZGlyU3luYyhjdXJyZW50UGF0aCk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgIGNvbnN0IGZ1bGxQYXRoID0gcGF0aC5qb2luKGN1cnJlbnRQYXRoLCBpdGVtKTtcbiAgICAgIGNvbnN0IHN0YXQgPSBmcy5zdGF0U3luYyhmdWxsUGF0aCk7XG5cbiAgICAgIGlmIChzdGF0LmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgLy8gU2tpcCBub2RlX21vZHVsZXMgYW5kIC5naXRcbiAgICAgICAgaWYgKGl0ZW0gIT09ICdub2RlX21vZHVsZXMnICYmIGl0ZW0gIT09ICcuZ2l0JyAmJiBpdGVtICE9PSAnLm5leHQnKSB7XG4gICAgICAgICAgc2VhcmNoRGlyZWN0b3J5KGZ1bGxQYXRoLCBwYXR0ZXJuLCBtYXRjaGVzKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChzdGF0LmlzRmlsZSgpKSB7XG4gICAgICAgIC8vIENoZWNrIGlmIGZpbGUgZXh0ZW5zaW9uIGlzIGFsbG93ZWRcbiAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGl0ZW0pO1xuICAgICAgICBpZiAoQUxMT1dFRF9FWFRFTlNJT05TLmluY2x1ZGVzKGV4dCkgfHwgZXh0ID09PSAnJyB8fCBpdGVtLmluY2x1ZGVzKCdEb2NrZXJmaWxlJykpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhmdWxsUGF0aCwgJ3V0Zi04Jyk7XG4gICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXG4gICAgICAgICAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChwYXR0ZXJuLCAnaScpLnRlc3QobGluZSkpIHtcbiAgICAgICAgICAgICAgICBtYXRjaGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgZmlsZTogZnVsbFBhdGgsXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiBsaW5lLnRyaW0oKSxcbiAgICAgICAgICAgICAgICAgIGxpbmU6IGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIFNraXAgZmlsZXMgdGhhdCBjYW4ndCBiZSByZWFkIChiaW5hcnkgZmlsZXMsIGV0Yy4pXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gU2tpcCBkaXJlY3RvcmllcyB3ZSBjYW4ndCByZWFkXG4gICAgcmV0dXJuO1xuICB9XG59XG5cbi8vIFJlZ2V4IGZpbGUgc2VhcmNoIG9wZXJhdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEZpbGVzKGRpclBhdGg6IHN0cmluZywgcGF0dGVybjogc3RyaW5nKTogUHJvbWlzZTx7c3VjY2VzczogYm9vbGVhbiwgbWF0Y2hlcz86IEFycmF5PHtmaWxlOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZywgbGluZTogbnVtYmVyfT4sIGVycm9yPzogc3RyaW5nfT4ge1xuICB0cnkge1xuICAgIGlmICghaXNQYXRoU2FmZShkaXJQYXRoKSAmJiAhU0FGRV9ESVJFQ1RPUklFUy5zb21lKGRpciA9PiBkaXJQYXRoLmluY2x1ZGVzKGRpcikpKSB7XG4gICAgICByZXR1cm4ge3N1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1BhdGggbm90IGFsbG93ZWQgZm9yIHNlY3VyaXR5IHJlYXNvbnMnfTtcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgYmFzZSBkaXJlY3RvcnkgZXhpc3RzXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGRpclBhdGgpKSB7XG4gICAgICByZXR1cm4ge3N1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0RpcmVjdG9yeSBkb2VzIG5vdCBleGlzdCd9O1xuICAgIH1cblxuICAgIGNvbnN0IG1hdGNoZXM6IEFycmF5PHtmaWxlOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZywgbGluZTogbnVtYmVyfT4gPSBbXTtcblxuICAgIHNlYXJjaERpcmVjdG9yeShkaXJQYXRoLCBwYXR0ZXJuLCBtYXRjaGVzKTtcblxuICAgIHJldHVybiB7c3VjY2VzczogdHJ1ZSwgbWF0Y2hlc307XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgZHVyaW5nIGZpbGUgc2VhcmNoJ1xuICAgIH07XG4gIH1cbn1cblxuLy8gU2NoZW1hIGRlZmluaXRpb25zIGZvciB0b29sIGNhbGxzXG5leHBvcnQgY29uc3QgRmlsZVJlYWRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGZpbGVQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBmaWxlIHRvIHJlYWQnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgRmlsZVdyaXRlU2NoZW1hID0gei5vYmplY3Qoe1xuICBmaWxlUGF0aDogei5zdHJpbmcoKS5kZXNjcmliZSgnUGF0aCB3aGVyZSB0byBjcmVhdGUvbW9kaWZ5IHRoZSBmaWxlJyksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ0NvbnRlbnQgdG8gd3JpdGUgdG8gdGhlIGZpbGUnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgRmlsZUFwcGVuZFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZmlsZVBhdGg6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1BhdGggdG8gdGhlIGZpbGUgdG8gYXBwZW5kIHRvJyksXG4gIGNvbnRlbnQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ0NvbnRlbnQgdG8gYXBwZW5kIHRvIHRoZSBmaWxlJyksXG59KTtcblxuZXhwb3J0IGNvbnN0IEZpbGVEZWxldGVTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGZpbGVQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBmaWxlIHRvIGRlbGV0ZScpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBEaXJlY3RvcnlMaXN0U2NoZW1hID0gei5vYmplY3Qoe1xuICBkaXJQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdQYXRoIHRvIHRoZSBkaXJlY3RvcnkgdG8gbGlzdCcpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBGaWxlU2VhcmNoU2NoZW1hID0gei5vYmplY3Qoe1xuICBkaXJQYXRoOiB6LnN0cmluZygpLmRlc2NyaWJlKCdEaXJlY3RvcnkgdG8gc2VhcmNoIGluJyksXG4gIHBhdHRlcm46IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1JlZ2V4IHBhdHRlcm4gdG8gc2VhcmNoIGZvciAoSmF2YVNjcmlwdCByZWdleCBzeW50YXgpJyksXG59KTtcbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJ6IiwiU0FGRV9ESVJFQ1RPUklFUyIsIkFMTE9XRURfRVhURU5TSU9OUyIsImlzUGF0aFNhZmUiLCJmaWxlUGF0aCIsIm5vcm1hbGl6ZWRQYXRoIiwicmVzb2x2ZSIsImN3ZCIsInByb2Nlc3MiLCJhbGxvd2VkIiwic29tZSIsImRpciIsInJlc29sdmVkRGlyIiwiam9pbiIsInN0YXJ0c1dpdGgiLCJleHQiLCJleHRuYW1lIiwiZXh0QWxsb3dlZCIsImluY2x1ZGVzIiwicmVhZEZpbGUiLCJzdWNjZXNzIiwiZXJyb3IiLCJleGlzdHNTeW5jIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsIkVycm9yIiwibWVzc2FnZSIsIndyaXRlRmlsZSIsImRpcm5hbWUiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJ3cml0ZUZpbGVTeW5jIiwiYXBwZW5kVG9GaWxlIiwiYXBwZW5kRmlsZVN5bmMiLCJkZWxldGVGaWxlIiwiaXNJbkdlbmVyYXRlZCIsInVubGlua1N5bmMiLCJsaXN0RGlyZWN0b3J5IiwiZGlyUGF0aCIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJmaWxlRXhpc3RzIiwic2VhcmNoRGlyZWN0b3J5IiwiY3VycmVudFBhdGgiLCJwYXR0ZXJuIiwibWF0Y2hlcyIsIml0ZW1zIiwiaXRlbSIsImZ1bGxQYXRoIiwic3RhdCIsInN0YXRTeW5jIiwiaXNEaXJlY3RvcnkiLCJpc0ZpbGUiLCJsaW5lcyIsInNwbGl0IiwiZm9yRWFjaCIsImxpbmUiLCJpbmRleCIsIlJlZ0V4cCIsInRlc3QiLCJwdXNoIiwiZmlsZSIsInRyaW0iLCJzZWFyY2hGaWxlcyIsIkZpbGVSZWFkU2NoZW1hIiwib2JqZWN0Iiwic3RyaW5nIiwiZGVzY3JpYmUiLCJGaWxlV3JpdGVTY2hlbWEiLCJGaWxlQXBwZW5kU2NoZW1hIiwiRmlsZURlbGV0ZVNjaGVtYSIsIkRpcmVjdG9yeUxpc3RTY2hlbWEiLCJGaWxlU2VhcmNoU2NoZW1hIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/fileops.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/memory-db.ts":
/*!********************************!*\
  !*** ./lib/utils/memory-db.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConversationMemory: () => (/* binding */ ConversationMemory),\n/* harmony export */   getSessionMemory: () => (/* binding */ getSessionMemory),\n/* harmony export */   setupSessionCleanup: () => (/* binding */ setupSessionCleanup)\n/* harmony export */ });\n/* harmony import */ var _db_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../db/database */ \"(rsc)/./lib/db/database.ts\");\n/* harmony import */ var _summarizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./summarizer */ \"(rsc)/./lib/utils/summarizer.ts\");\n\n\n// Configuration\nconst MAX_MESSAGES_BEFORE_SUMMARIZATION = 20;\nconst SUMMARIZATION_INTERVAL_MINUTES = 30;\n// In-memory cache for summarized history to avoid repeated DB queries\nconst summarizationCache = new Map();\nclass ConversationMemory {\n    constructor(sessionId, projectFolder){\n        this.sessionId = sessionId;\n        this.projectFolder = projectFolder;\n        this.initSession();\n    }\n    async initSession() {\n        await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getOrCreateSession)(this.sessionId, this.projectFolder);\n    }\n    // Add a message to memory (now persisted to database)\n    async addMessage(role, content) {\n        const message = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.addConversation)(this.sessionId, role, content);\n        // Check if we need to summarize\n        await this.checkAndSummarize();\n        return {\n            id: message.id,\n            role: message.role,\n            content: message.content,\n            timestamp: message.timestamp\n        };\n    }\n    // Add a file operation to memory (now persisted)\n    async addFileOperation(type, filename) {\n        const operation = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.trackFileOperation)(this.sessionId, type, filename);\n        return {\n            type: operation.operation,\n            filename: operation.filePath,\n            timestamp: operation.timestamp,\n            sessionId: operation.sessionId\n        };\n    }\n    // Get conversation history from database\n    async getMessages(limit) {\n        const conversations = limit ? await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getRecentConversations)(this.sessionId, limit) : await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getConversations)(this.sessionId);\n        return conversations.map((c)=>({\n                id: c.id,\n                role: c.role,\n                content: c.content,\n                timestamp: c.timestamp\n            }));\n    }\n    // Get recent file operations from database\n    async getRecentFileOperations(limit = 10) {\n        const operations = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getFileOperations)(this.sessionId, limit);\n        return operations.map((op)=>({\n                type: op.operation,\n                filename: op.filePath,\n                timestamp: op.timestamp,\n                sessionId: op.sessionId\n            }));\n    }\n    // Get all file operations related to a specific file\n    async getSessionFiles() {\n        const operations = await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getFileOperations)(this.sessionId, 1000);\n        const fileSet = new Set();\n        operations.forEach((op)=>{\n            if (op.operation !== \"deleted\") {\n                fileSet.add(op.filePath);\n            } else {\n                fileSet.delete(op.filePath);\n            }\n        });\n        return Array.from(fileSet);\n    }\n    // Search messages by content\n    async searchMessages(query) {\n        const messages = await this.getMessages();\n        const lowerQuery = query.toLowerCase();\n        return messages.filter((msg)=>msg.content.toLowerCase().includes(lowerQuery));\n    }\n    // Get a context summary for the agent\n    async getContextSummary() {\n        const messages = await this.getMessages();\n        if (messages.length === 0) {\n            return null;\n        }\n        // Check cache first\n        const cached = summarizationCache.get(this.sessionId);\n        if (cached && messages.length < MAX_MESSAGES_BEFORE_SUMMARIZATION) {\n            const age = Date.now() - cached.timestamp.getTime();\n            if (age < SUMMARIZATION_INTERVAL_MINUTES * 60 * 1000) {\n                return cached.summary;\n            }\n        }\n        const recentMessages = messages.slice(-10);\n        const conversationText = recentMessages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\");\n        const files = await this.getSessionFiles();\n        const filesList = files.length > 0 ? `\\nFiles in project: ${files.join(\", \")}` : \"\";\n        return `Previous conversation context:\\n${conversationText}${filesList}`;\n    }\n    // Get compressed context for token efficiency\n    async getCompressedContext(userRequest = \"\") {\n        const messages = await this.getMessages();\n        if (messages.length === 0) {\n            return null;\n        }\n        // Use cached summary if available and recent\n        const cached = summarizationCache.get(this.sessionId);\n        if (cached) {\n            const age = Date.now() - cached.timestamp.getTime();\n            if (age < SUMMARIZATION_INTERVAL_MINUTES * 60 * 1000) {\n                return cached.summary;\n            }\n        }\n        // Generate new summary\n        const messageArray = messages.map((m)=>({\n                role: m.role,\n                content: m.content\n            }));\n        const result = await (0,_summarizer__WEBPACK_IMPORTED_MODULE_1__.compressContext)({\n            userRequest: userRequest || \"Continue working on the project\",\n            conversationHistory: messageArray\n        });\n        const compressed = result.compressedContext;\n        // Cache the result\n        summarizationCache.set(this.sessionId, {\n            summary: compressed,\n            timestamp: new Date()\n        });\n        return compressed;\n    }\n    // Check if summarization is needed\n    async checkAndSummarize() {\n        const messages = await this.getMessages();\n        if (messages.length < MAX_MESSAGES_BEFORE_SUMMARIZATION) {\n            return;\n        }\n        const cached = summarizationCache.get(this.sessionId);\n        if (cached) {\n            const age = Date.now() - cached.timestamp.getTime();\n            if (age < SUMMARIZATION_INTERVAL_MINUTES * 60 * 1000) {\n                return; // Recent summary exists\n            }\n        }\n        // Generate summary\n        await this.summarizeHistory();\n    }\n    // Summarize conversation history\n    async summarizeHistory() {\n        const messages = await this.getMessages();\n        if (messages.length < 5) {\n            return null;\n        }\n        const messageArray = messages.map((m)=>({\n                role: m.role,\n                content: m.content\n            }));\n        const result = await (0,_summarizer__WEBPACK_IMPORTED_MODULE_1__.summarizeConversation)(messageArray);\n        // Cache the summary\n        summarizationCache.set(this.sessionId, {\n            summary: result.summary,\n            timestamp: new Date()\n        });\n        console.log(`📝 Summarized ${messages.length} messages for session ${this.sessionId}`);\n        return result.summary;\n    }\n    // Get token estimate for current context\n    async getTokenEstimate() {\n        const context = await this.getContextSummary();\n        if (!context) return 0;\n        // Rough estimate: ~4 characters per token\n        return Math.ceil(context.length / 4);\n    }\n    // Get session statistics\n    async getStats() {\n        return await (0,_db_database__WEBPACK_IMPORTED_MODULE_0__.getSessionStats)(this.sessionId);\n    }\n    // Clear session cache (useful for testing or memory management)\n    clearCache() {\n        summarizationCache.delete(this.sessionId);\n    }\n}\n// Global session memory instances\nconst sessionMemories = new Map();\nfunction getSessionMemory(sessionId, projectFolder = \"\") {\n    if (!sessionMemories.has(sessionId)) {\n        const memory = new ConversationMemory(sessionId, projectFolder);\n        sessionMemories.set(sessionId, memory);\n    }\n    return sessionMemories.get(sessionId);\n}\n// Clean up old sessions periodically\nfunction setupSessionCleanup(intervalHours = 24) {\n    setInterval(()=>{\n        const cutoffTime = Date.now() - intervalHours * 60 * 60 * 1000;\n        Array.from(sessionMemories.entries()).forEach(([sessionId, memory])=>{\n            memory.getStats().then((stats)=>{\n                if (stats && new Date(stats.updatedAt).getTime() < cutoffTime) {\n                    sessionMemories.delete(sessionId);\n                    console.log(`🧹 Cleaned up inactive session: ${sessionId}`);\n                }\n            });\n        });\n    }, intervalHours * 60 * 60 * 1000);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzdDO0lBRUEsZ0VBQWdFO0lBQ2hFdUUsYUFBYTtRQUNYM0UsbUJBQW1CZ0MsTUFBTSxDQUFDLElBQUksQ0FBQzVCLFNBQVM7SUFDMUM7QUFDRjtBQUVBLGtDQUFrQztBQUNsQyxNQUFNd0Usa0JBQWtCLElBQUkzRTtBQUVyQixTQUFTNEUsaUJBQWlCekUsU0FBaUIsRUFBRUMsZ0JBQXdCLEVBQUU7SUFDNUUsSUFBSSxDQUFDdUUsZ0JBQWdCRSxHQUFHLENBQUMxRSxZQUFZO1FBQ25DLE1BQU0yRSxTQUFTLElBQUk3RSxtQkFBbUJFLFdBQVdDO1FBQ2pEdUUsZ0JBQWdCVixHQUFHLENBQUM5RCxXQUFXMkU7SUFDakM7SUFDQSxPQUFPSCxnQkFBZ0I5QixHQUFHLENBQUMxQztBQUM3QjtBQUVBLHFDQUFxQztBQUM5QixTQUFTNEUsb0JBQW9CQyxnQkFBd0IsRUFBRTtJQUM1REMsWUFBWTtRQUNWLE1BQU1DLGFBQWFuQyxLQUFLQyxHQUFHLEtBQU1nQyxnQkFBZ0IsS0FBSyxLQUFLO1FBRTNEaEQsTUFBTUMsSUFBSSxDQUFDMEMsZ0JBQWdCUSxPQUFPLElBQUl0RCxPQUFPLENBQUMsQ0FBQyxDQUFDMUIsV0FBVzJFLE9BQU87WUFDaEVBLE9BQU9MLFFBQVEsR0FBR1csSUFBSSxDQUFDLENBQUNDO2dCQUN0QixJQUFJQSxTQUFTLElBQUl0QyxLQUFLc0MsTUFBTUMsU0FBUyxFQUFFckMsT0FBTyxLQUFLaUMsWUFBWTtvQkFDN0RQLGdCQUFnQjVDLE1BQU0sQ0FBQzVCO29CQUN2QmdFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdDQUFnQyxFQUFFakUsVUFBVSxDQUFDO2dCQUM1RDtZQUNGO1FBQ0Y7SUFDRixHQUFHNkUsZ0JBQWdCLEtBQUssS0FBSztBQUMvQiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL3V0aWxzL21lbW9yeS1kYi50cz9jN2RhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGdldE9yQ3JlYXRlU2Vzc2lvbixcbiAgYWRkQ29udmVyc2F0aW9uLFxuICBnZXRDb252ZXJzYXRpb25zLFxuICBnZXRSZWNlbnRDb252ZXJzYXRpb25zLFxuICB0cmFja0ZpbGVPcGVyYXRpb24sXG4gIGdldEZpbGVPcGVyYXRpb25zLFxuICBnZXRTZXNzaW9uU3RhdHMsXG59IGZyb20gJy4uL2RiL2RhdGFiYXNlJztcbmltcG9ydCB7IGNvbXByZXNzQ29udGV4dCwgc3VtbWFyaXplQ29udmVyc2F0aW9uIH0gZnJvbSAnLi9zdW1tYXJpemVyJztcblxuaW50ZXJmYWNlIENvbnZlcnNhdGlvbk1lc3NhZ2Uge1xuICBpZDogc3RyaW5nO1xuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgY29udGVudDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmludGVyZmFjZSBGaWxlT3BlcmF0aW9uIHtcbiAgdHlwZTogJ2NyZWF0ZWQnIHwgJ21vZGlmaWVkJyB8ICdyZWFkJyB8ICdkZWxldGVkJztcbiAgZmlsZW5hbWU6IHN0cmluZztcbiAgdGltZXN0YW1wOiBEYXRlO1xuICBzZXNzaW9uSWQ6IHN0cmluZztcbn1cblxuLy8gQ29uZmlndXJhdGlvblxuY29uc3QgTUFYX01FU1NBR0VTX0JFRk9SRV9TVU1NQVJJWkFUSU9OID0gMjA7XG5jb25zdCBTVU1NQVJJWkFUSU9OX0lOVEVSVkFMX01JTlVURVMgPSAzMDtcblxuLy8gSW4tbWVtb3J5IGNhY2hlIGZvciBzdW1tYXJpemVkIGhpc3RvcnkgdG8gYXZvaWQgcmVwZWF0ZWQgREIgcXVlcmllc1xuY29uc3Qgc3VtbWFyaXphdGlvbkNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHtcbiAgc3VtbWFyeTogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59PigpO1xuXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uTWVtb3J5IHtcbiAgcHJpdmF0ZSBzZXNzaW9uSWQ6IHN0cmluZztcbiAgcHJpdmF0ZSBwcm9qZWN0Rm9sZGVyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3Ioc2Vzc2lvbklkOiBzdHJpbmcsIHByb2plY3RGb2xkZXI6IHN0cmluZykge1xuICAgIHRoaXMuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgIHRoaXMucHJvamVjdEZvbGRlciA9IHByb2plY3RGb2xkZXI7XG4gICAgdGhpcy5pbml0U2Vzc2lvbigpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0U2Vzc2lvbigpIHtcbiAgICBhd2FpdCBnZXRPckNyZWF0ZVNlc3Npb24odGhpcy5zZXNzaW9uSWQsIHRoaXMucHJvamVjdEZvbGRlcik7XG4gIH1cblxuICAvLyBBZGQgYSBtZXNzYWdlIHRvIG1lbW9yeSAobm93IHBlcnNpc3RlZCB0byBkYXRhYmFzZSlcbiAgYXN5bmMgYWRkTWVzc2FnZShyb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgY29udGVudDogc3RyaW5nKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IGFkZENvbnZlcnNhdGlvbih0aGlzLnNlc3Npb25JZCwgcm9sZSwgY29udGVudCk7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byBzdW1tYXJpemVcbiAgICBhd2FpdCB0aGlzLmNoZWNrQW5kU3VtbWFyaXplKCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBtZXNzYWdlLmlkLFxuICAgICAgcm9sZTogbWVzc2FnZS5yb2xlIGFzICd1c2VyJyB8ICdhc3Npc3RhbnQnLFxuICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LFxuICAgICAgdGltZXN0YW1wOiBtZXNzYWdlLnRpbWVzdGFtcCxcbiAgICB9O1xuICB9XG5cbiAgLy8gQWRkIGEgZmlsZSBvcGVyYXRpb24gdG8gbWVtb3J5IChub3cgcGVyc2lzdGVkKVxuICBhc3luYyBhZGRGaWxlT3BlcmF0aW9uKHR5cGU6ICdjcmVhdGVkJyB8ICdtb2RpZmllZCcgfCAncmVhZCcgfCAnZGVsZXRlZCcsIGZpbGVuYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBvcGVyYXRpb24gPSBhd2FpdCB0cmFja0ZpbGVPcGVyYXRpb24odGhpcy5zZXNzaW9uSWQsIHR5cGUsIGZpbGVuYW1lKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogb3BlcmF0aW9uLm9wZXJhdGlvbiBhcyAnY3JlYXRlZCcgfCAnbW9kaWZpZWQnIHwgJ3JlYWQnIHwgJ2RlbGV0ZWQnLFxuICAgICAgZmlsZW5hbWU6IG9wZXJhdGlvbi5maWxlUGF0aCxcbiAgICAgIHRpbWVzdGFtcDogb3BlcmF0aW9uLnRpbWVzdGFtcCxcbiAgICAgIHNlc3Npb25JZDogb3BlcmF0aW9uLnNlc3Npb25JZCxcbiAgICB9O1xuICB9XG5cbiAgLy8gR2V0IGNvbnZlcnNhdGlvbiBoaXN0b3J5IGZyb20gZGF0YWJhc2VcbiAgYXN5bmMgZ2V0TWVzc2FnZXMobGltaXQ/OiBudW1iZXIpOiBQcm9taXNlPENvbnZlcnNhdGlvbk1lc3NhZ2VbXT4ge1xuICAgIGNvbnN0IGNvbnZlcnNhdGlvbnMgPSBsaW1pdCBcbiAgICAgID8gYXdhaXQgZ2V0UmVjZW50Q29udmVyc2F0aW9ucyh0aGlzLnNlc3Npb25JZCwgbGltaXQpXG4gICAgICA6IGF3YWl0IGdldENvbnZlcnNhdGlvbnModGhpcy5zZXNzaW9uSWQpO1xuICAgIFxuICAgIHJldHVybiBjb252ZXJzYXRpb25zLm1hcChjID0+ICh7XG4gICAgICBpZDogYy5pZCxcbiAgICAgIHJvbGU6IGMucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JyxcbiAgICAgIGNvbnRlbnQ6IGMuY29udGVudCxcbiAgICAgIHRpbWVzdGFtcDogYy50aW1lc3RhbXAsXG4gICAgfSkpO1xuICB9XG5cbiAgLy8gR2V0IHJlY2VudCBmaWxlIG9wZXJhdGlvbnMgZnJvbSBkYXRhYmFzZVxuICBhc3luYyBnZXRSZWNlbnRGaWxlT3BlcmF0aW9ucyhsaW1pdCA9IDEwKTogUHJvbWlzZTxGaWxlT3BlcmF0aW9uW10+IHtcbiAgICBjb25zdCBvcGVyYXRpb25zID0gYXdhaXQgZ2V0RmlsZU9wZXJhdGlvbnModGhpcy5zZXNzaW9uSWQsIGxpbWl0KTtcbiAgICBcbiAgICByZXR1cm4gb3BlcmF0aW9ucy5tYXAob3AgPT4gKHtcbiAgICAgIHR5cGU6IG9wLm9wZXJhdGlvbiBhcyAnY3JlYXRlZCcgfCAnbW9kaWZpZWQnIHwgJ3JlYWQnIHwgJ2RlbGV0ZWQnLFxuICAgICAgZmlsZW5hbWU6IG9wLmZpbGVQYXRoLFxuICAgICAgdGltZXN0YW1wOiBvcC50aW1lc3RhbXAsXG4gICAgICBzZXNzaW9uSWQ6IG9wLnNlc3Npb25JZCxcbiAgICB9KSk7XG4gIH1cblxuICAvLyBHZXQgYWxsIGZpbGUgb3BlcmF0aW9ucyByZWxhdGVkIHRvIGEgc3BlY2lmaWMgZmlsZVxuICBhc3luYyBnZXRTZXNzaW9uRmlsZXMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IG9wZXJhdGlvbnMgPSBhd2FpdCBnZXRGaWxlT3BlcmF0aW9ucyh0aGlzLnNlc3Npb25JZCwgMTAwMCk7XG4gICAgY29uc3QgZmlsZVNldCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIFxuICAgIG9wZXJhdGlvbnMuZm9yRWFjaChvcCA9PiB7XG4gICAgICBpZiAob3Aub3BlcmF0aW9uICE9PSAnZGVsZXRlZCcpIHtcbiAgICAgICAgZmlsZVNldC5hZGQob3AuZmlsZVBhdGgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmlsZVNldC5kZWxldGUob3AuZmlsZVBhdGgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBBcnJheS5mcm9tKGZpbGVTZXQpO1xuICB9XG5cbiAgLy8gU2VhcmNoIG1lc3NhZ2VzIGJ5IGNvbnRlbnRcbiAgYXN5bmMgc2VhcmNoTWVzc2FnZXMocXVlcnk6IHN0cmluZyk6IFByb21pc2U8Q29udmVyc2F0aW9uTWVzc2FnZVtdPiB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKCk7XG4gICAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgcmV0dXJuIG1lc3NhZ2VzLmZpbHRlcihtc2cgPT5cbiAgICAgIG1zZy5jb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSlcbiAgICApO1xuICB9XG5cbiAgLy8gR2V0IGEgY29udGV4dCBzdW1tYXJ5IGZvciB0aGUgYWdlbnRcbiAgYXN5bmMgZ2V0Q29udGV4dFN1bW1hcnkoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKCk7XG4gICAgXG4gICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcbiAgICBjb25zdCBjYWNoZWQgPSBzdW1tYXJpemF0aW9uQ2FjaGUuZ2V0KHRoaXMuc2Vzc2lvbklkKTtcbiAgICBpZiAoY2FjaGVkICYmIG1lc3NhZ2VzLmxlbmd0aCA8IE1BWF9NRVNTQUdFU19CRUZPUkVfU1VNTUFSSVpBVElPTikge1xuICAgICAgY29uc3QgYWdlID0gRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAuZ2V0VGltZSgpO1xuICAgICAgaWYgKGFnZSA8IFNVTU1BUklaQVRJT05fSU5URVJWQUxfTUlOVVRFUyAqIDYwICogMTAwMCkge1xuICAgICAgICByZXR1cm4gY2FjaGVkLnN1bW1hcnk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVjZW50TWVzc2FnZXMgPSBtZXNzYWdlcy5zbGljZSgtMTApO1xuICAgIGNvbnN0IGNvbnZlcnNhdGlvblRleHQgPSByZWNlbnRNZXNzYWdlc1xuICAgICAgLm1hcChtID0+IGAke20ucm9sZX06ICR7bS5jb250ZW50fWApXG4gICAgICAuam9pbignXFxuJyk7XG5cbiAgICBjb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuZ2V0U2Vzc2lvbkZpbGVzKCk7XG4gICAgY29uc3QgZmlsZXNMaXN0ID0gZmlsZXMubGVuZ3RoID4gMFxuICAgICAgPyBgXFxuRmlsZXMgaW4gcHJvamVjdDogJHtmaWxlcy5qb2luKCcsICcpfWBcbiAgICAgIDogJyc7XG5cbiAgICByZXR1cm4gYFByZXZpb3VzIGNvbnZlcnNhdGlvbiBjb250ZXh0OlxcbiR7Y29udmVyc2F0aW9uVGV4dH0ke2ZpbGVzTGlzdH1gO1xuICB9XG5cbiAgLy8gR2V0IGNvbXByZXNzZWQgY29udGV4dCBmb3IgdG9rZW4gZWZmaWNpZW5jeVxuICBhc3luYyBnZXRDb21wcmVzc2VkQ29udGV4dCh1c2VyUmVxdWVzdDogc3RyaW5nID0gJycpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMuZ2V0TWVzc2FnZXMoKTtcbiAgICBcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBVc2UgY2FjaGVkIHN1bW1hcnkgaWYgYXZhaWxhYmxlIGFuZCByZWNlbnRcbiAgICBjb25zdCBjYWNoZWQgPSBzdW1tYXJpemF0aW9uQ2FjaGUuZ2V0KHRoaXMuc2Vzc2lvbklkKTtcbiAgICBpZiAoY2FjaGVkKSB7XG4gICAgICBjb25zdCBhZ2UgPSBEYXRlLm5vdygpIC0gY2FjaGVkLnRpbWVzdGFtcC5nZXRUaW1lKCk7XG4gICAgICBpZiAoYWdlIDwgU1VNTUFSSVpBVElPTl9JTlRFUlZBTF9NSU5VVEVTICogNjAgKiAxMDAwKSB7XG4gICAgICAgIHJldHVybiBjYWNoZWQuc3VtbWFyeTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBuZXcgc3VtbWFyeVxuICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VzLm1hcChtID0+ICh7IHJvbGU6IG0ucm9sZSwgY29udGVudDogbS5jb250ZW50IH0pKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21wcmVzc0NvbnRleHQoe1xuICAgICAgdXNlclJlcXVlc3Q6IHVzZXJSZXF1ZXN0IHx8ICdDb250aW51ZSB3b3JraW5nIG9uIHRoZSBwcm9qZWN0JyxcbiAgICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IG1lc3NhZ2VBcnJheSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbXByZXNzZWQgPSByZXN1bHQuY29tcHJlc3NlZENvbnRleHQ7XG5cbiAgICAvLyBDYWNoZSB0aGUgcmVzdWx0XG4gICAgc3VtbWFyaXphdGlvbkNhY2hlLnNldCh0aGlzLnNlc3Npb25JZCwge1xuICAgICAgc3VtbWFyeTogY29tcHJlc3NlZCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICB9KTtcblxuICAgIHJldHVybiBjb21wcmVzc2VkO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgc3VtbWFyaXphdGlvbiBpcyBuZWVkZWRcbiAgcHJpdmF0ZSBhc3luYyBjaGVja0FuZFN1bW1hcml6ZSgpIHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMuZ2V0TWVzc2FnZXMoKTtcbiAgICBcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoIDwgTUFYX01FU1NBR0VTX0JFRk9SRV9TVU1NQVJJWkFUSU9OKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgY2FjaGVkID0gc3VtbWFyaXphdGlvbkNhY2hlLmdldCh0aGlzLnNlc3Npb25JZCk7XG4gICAgaWYgKGNhY2hlZCkge1xuICAgICAgY29uc3QgYWdlID0gRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAuZ2V0VGltZSgpO1xuICAgICAgaWYgKGFnZSA8IFNVTU1BUklaQVRJT05fSU5URVJWQUxfTUlOVVRFUyAqIDYwICogMTAwMCkge1xuICAgICAgICByZXR1cm47IC8vIFJlY2VudCBzdW1tYXJ5IGV4aXN0c1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIHN1bW1hcnlcbiAgICBhd2FpdCB0aGlzLnN1bW1hcml6ZUhpc3RvcnkoKTtcbiAgfVxuXG4gIC8vIFN1bW1hcml6ZSBjb252ZXJzYXRpb24gaGlzdG9yeVxuICBwcml2YXRlIGFzeW5jIHN1bW1hcml6ZUhpc3RvcnkoKSB7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKCk7XG4gICAgXG4gICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA8IDUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2VBcnJheSA9IG1lc3NhZ2VzLm1hcChtID0+ICh7IHJvbGU6IG0ucm9sZSwgY29udGVudDogbS5jb250ZW50IH0pKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdW1tYXJpemVDb252ZXJzYXRpb24obWVzc2FnZUFycmF5KTtcbiAgICBcbiAgICAvLyBDYWNoZSB0aGUgc3VtbWFyeVxuICAgIHN1bW1hcml6YXRpb25DYWNoZS5zZXQodGhpcy5zZXNzaW9uSWQsIHtcbiAgICAgIHN1bW1hcnk6IHJlc3VsdC5zdW1tYXJ5LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYPCfk50gU3VtbWFyaXplZCAke21lc3NhZ2VzLmxlbmd0aH0gbWVzc2FnZXMgZm9yIHNlc3Npb24gJHt0aGlzLnNlc3Npb25JZH1gKTtcbiAgICByZXR1cm4gcmVzdWx0LnN1bW1hcnk7XG4gIH1cblxuICAvLyBHZXQgdG9rZW4gZXN0aW1hdGUgZm9yIGN1cnJlbnQgY29udGV4dFxuICBhc3luYyBnZXRUb2tlbkVzdGltYXRlKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0Q29udGV4dFN1bW1hcnkoKTtcbiAgICBpZiAoIWNvbnRleHQpIHJldHVybiAwO1xuICAgIFxuICAgIC8vIFJvdWdoIGVzdGltYXRlOiB+NCBjaGFyYWN0ZXJzIHBlciB0b2tlblxuICAgIHJldHVybiBNYXRoLmNlaWwoY29udGV4dC5sZW5ndGggLyA0KTtcbiAgfVxuXG4gIC8vIEdldCBzZXNzaW9uIHN0YXRpc3RpY3NcbiAgYXN5bmMgZ2V0U3RhdHMoKSB7XG4gICAgcmV0dXJuIGF3YWl0IGdldFNlc3Npb25TdGF0cyh0aGlzLnNlc3Npb25JZCk7XG4gIH1cblxuICAvLyBDbGVhciBzZXNzaW9uIGNhY2hlICh1c2VmdWwgZm9yIHRlc3Rpbmcgb3IgbWVtb3J5IG1hbmFnZW1lbnQpXG4gIGNsZWFyQ2FjaGUoKSB7XG4gICAgc3VtbWFyaXphdGlvbkNhY2hlLmRlbGV0ZSh0aGlzLnNlc3Npb25JZCk7XG4gIH1cbn1cblxuLy8gR2xvYmFsIHNlc3Npb24gbWVtb3J5IGluc3RhbmNlc1xuY29uc3Qgc2Vzc2lvbk1lbW9yaWVzID0gbmV3IE1hcDxzdHJpbmcsIENvbnZlcnNhdGlvbk1lbW9yeT4oKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlc3Npb25NZW1vcnkoc2Vzc2lvbklkOiBzdHJpbmcsIHByb2plY3RGb2xkZXI6IHN0cmluZyA9ICcnKTogQ29udmVyc2F0aW9uTWVtb3J5IHtcbiAgaWYgKCFzZXNzaW9uTWVtb3JpZXMuaGFzKHNlc3Npb25JZCkpIHtcbiAgICBjb25zdCBtZW1vcnkgPSBuZXcgQ29udmVyc2F0aW9uTWVtb3J5KHNlc3Npb25JZCwgcHJvamVjdEZvbGRlcik7XG4gICAgc2Vzc2lvbk1lbW9yaWVzLnNldChzZXNzaW9uSWQsIG1lbW9yeSk7XG4gIH1cbiAgcmV0dXJuIHNlc3Npb25NZW1vcmllcy5nZXQoc2Vzc2lvbklkKSE7XG59XG5cbi8vIENsZWFuIHVwIG9sZCBzZXNzaW9ucyBwZXJpb2RpY2FsbHlcbmV4cG9ydCBmdW5jdGlvbiBzZXR1cFNlc3Npb25DbGVhbnVwKGludGVydmFsSG91cnM6IG51bWJlciA9IDI0KSB7XG4gIHNldEludGVydmFsKCgpID0+IHtcbiAgICBjb25zdCBjdXRvZmZUaW1lID0gRGF0ZS5ub3coKSAtIChpbnRlcnZhbEhvdXJzICogNjAgKiA2MCAqIDEwMDApO1xuICAgIFxuICAgIEFycmF5LmZyb20oc2Vzc2lvbk1lbW9yaWVzLmVudHJpZXMoKSkuZm9yRWFjaCgoW3Nlc3Npb25JZCwgbWVtb3J5XSkgPT4ge1xuICAgICAgbWVtb3J5LmdldFN0YXRzKCkudGhlbigoc3RhdHM6IGFueSkgPT4ge1xuICAgICAgICBpZiAoc3RhdHMgJiYgbmV3IERhdGUoc3RhdHMudXBkYXRlZEF0KS5nZXRUaW1lKCkgPCBjdXRvZmZUaW1lKSB7XG4gICAgICAgICAgc2Vzc2lvbk1lbW9yaWVzLmRlbGV0ZShzZXNzaW9uSWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDwn6e5IENsZWFuZWQgdXAgaW5hY3RpdmUgc2Vzc2lvbjogJHtzZXNzaW9uSWR9YCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LCBpbnRlcnZhbEhvdXJzICogNjAgKiA2MCAqIDEwMDApO1xufVxuIl0sIm5hbWVzIjpbImdldE9yQ3JlYXRlU2Vzc2lvbiIsImFkZENvbnZlcnNhdGlvbiIsImdldENvbnZlcnNhdGlvbnMiLCJnZXRSZWNlbnRDb252ZXJzYXRpb25zIiwidHJhY2tGaWxlT3BlcmF0aW9uIiwiZ2V0RmlsZU9wZXJhdGlvbnMiLCJnZXRTZXNzaW9uU3RhdHMiLCJjb21wcmVzc0NvbnRleHQiLCJzdW1tYXJpemVDb252ZXJzYXRpb24iLCJNQVhfTUVTU0FHRVNfQkVGT1JFX1NVTU1BUklaQVRJT04iLCJTVU1NQVJJWkFUSU9OX0lOVEVSVkFMX01JTlVURVMiLCJzdW1tYXJpemF0aW9uQ2FjaGUiLCJNYXAiLCJDb252ZXJzYXRpb25NZW1vcnkiLCJjb25zdHJ1Y3RvciIsInNlc3Npb25JZCIsInByb2plY3RGb2xkZXIiLCJpbml0U2Vzc2lvbiIsImFkZE1lc3NhZ2UiLCJyb2xlIiwiY29udGVudCIsIm1lc3NhZ2UiLCJjaGVja0FuZFN1bW1hcml6ZSIsImlkIiwidGltZXN0YW1wIiwiYWRkRmlsZU9wZXJhdGlvbiIsInR5cGUiLCJmaWxlbmFtZSIsIm9wZXJhdGlvbiIsImZpbGVQYXRoIiwiZ2V0TWVzc2FnZXMiLCJsaW1pdCIsImNvbnZlcnNhdGlvbnMiLCJtYXAiLCJjIiwiZ2V0UmVjZW50RmlsZU9wZXJhdGlvbnMiLCJvcGVyYXRpb25zIiwib3AiLCJnZXRTZXNzaW9uRmlsZXMiLCJmaWxlU2V0IiwiU2V0IiwiZm9yRWFjaCIsImFkZCIsImRlbGV0ZSIsIkFycmF5IiwiZnJvbSIsInNlYXJjaE1lc3NhZ2VzIiwicXVlcnkiLCJtZXNzYWdlcyIsImxvd2VyUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsImZpbHRlciIsIm1zZyIsImluY2x1ZGVzIiwiZ2V0Q29udGV4dFN1bW1hcnkiLCJsZW5ndGgiLCJjYWNoZWQiLCJnZXQiLCJhZ2UiLCJEYXRlIiwibm93IiwiZ2V0VGltZSIsInN1bW1hcnkiLCJyZWNlbnRNZXNzYWdlcyIsInNsaWNlIiwiY29udmVyc2F0aW9uVGV4dCIsIm0iLCJqb2luIiwiZmlsZXMiLCJmaWxlc0xpc3QiLCJnZXRDb21wcmVzc2VkQ29udGV4dCIsInVzZXJSZXF1ZXN0IiwibWVzc2FnZUFycmF5IiwicmVzdWx0IiwiY29udmVyc2F0aW9uSGlzdG9yeSIsImNvbXByZXNzZWQiLCJjb21wcmVzc2VkQ29udGV4dCIsInNldCIsInN1bW1hcml6ZUhpc3RvcnkiLCJjb25zb2xlIiwibG9nIiwiZ2V0VG9rZW5Fc3RpbWF0ZSIsImNvbnRleHQiLCJNYXRoIiwiY2VpbCIsImdldFN0YXRzIiwiY2xlYXJDYWNoZSIsInNlc3Npb25NZW1vcmllcyIsImdldFNlc3Npb25NZW1vcnkiLCJoYXMiLCJtZW1vcnkiLCJzZXR1cFNlc3Npb25DbGVhbnVwIiwiaW50ZXJ2YWxIb3VycyIsInNldEludGVydmFsIiwiY3V0b2ZmVGltZSIsImVudHJpZXMiLCJ0aGVuIiwic3RhdHMiLCJ1cGRhdGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/memory-db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/prompt-optimizer.ts":
/*!***************************************!*\
  !*** ./lib/utils/prompt-optimizer.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PromptOptimizer: () => (/* binding */ PromptOptimizer),\n/* harmony export */   promptOptimizer: () => (/* binding */ promptOptimizer)\n/* harmony export */ });\n/* harmony import */ var _summarizer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./summarizer */ \"(rsc)/./lib/utils/summarizer.ts\");\n/**\n * Prompt Optimizer\n * Optimizes prompts before sending to AI to reduce token usage and improve clarity\n */ \nclass PromptOptimizer {\n    constructor(maxTokens = 4000){\n        this.maxTokens = maxTokens;\n    }\n    /**\n   * Optimize a prompt by removing redundancy and compressing content\n   */ optimize(prompt, context) {\n        const originalTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(prompt);\n        let optimized = prompt;\n        // 1. Remove excessive whitespace\n        optimized = this.removeExcessiveWhitespace(optimized);\n        // 2. Deduplicate repeated instructions\n        optimized = this.deduplicateInstructions(optimized);\n        // 3. Compress file listings\n        optimized = this.compressFileLists(optimized);\n        // 4. Remove redundant phrases\n        optimized = this.removeRedundantPhrases(optimized);\n        // 5. If still too long, truncate intelligently\n        if ((0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(optimized) > this.maxTokens) {\n            optimized = this.intelligentTruncate(optimized, context);\n        }\n        const optimizedTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(optimized);\n        const savings = originalTokens - optimizedTokens;\n        const savingsPercent = originalTokens > 0 ? savings / originalTokens * 100 : 0;\n        if (savings > 50) {\n            console.log(`🎯 Prompt optimized: ${originalTokens} → ${optimizedTokens} tokens (${Math.round(savingsPercent)}% reduction)`);\n        }\n        return {\n            optimizedPrompt: optimized,\n            originalTokens,\n            optimizedTokens,\n            savings,\n            savingsPercent\n        };\n    }\n    removeExcessiveWhitespace(text) {\n        return text.split(\"\\n\").map((line)=>line.trim()).filter((line)=>line.length > 0).join(\"\\n\").replace(/\\n{3,}/g, \"\\n\\n\"); // Max 2 consecutive newlines\n    }\n    deduplicateInstructions(text) {\n        const lines = text.split(\"\\n\");\n        const seen = new Set();\n        const result = [];\n        for (const line of lines){\n            const normalized = line.toLowerCase().trim();\n            // Skip if we've seen this exact instruction\n            if (normalized.length > 20 && seen.has(normalized)) {\n                continue;\n            }\n            seen.add(normalized);\n            result.push(line);\n        }\n        return result.join(\"\\n\");\n    }\n    compressFileLists(text) {\n        // Compress long file lists\n        const fileListPattern = /(?:EXISTING FILES|Session files|Current state files):\\s*\\n((?:[-•]\\s*[^\\n]+\\n?)+)/gi;\n        return text.replace(fileListPattern, (match, fileList)=>{\n            const files = fileList.split(\"\\n\").filter((l)=>l.trim().length > 0);\n            if (files.length > 10) {\n                const first5 = files.slice(0, 5).join(\"\\n\");\n                const last3 = files.slice(-3).join(\"\\n\");\n                return `${match.split(\":\")[0]}:\\n${first5}\\n... (${files.length - 8} more files)\\n${last3}`;\n            }\n            return match;\n        });\n    }\n    removeRedundantPhrases(text) {\n        // Remove common redundant phrases\n        const redundantPhrases = [\n            /Please note that /gi,\n            /It is important to /gi,\n            /You should be aware that /gi,\n            /Keep in mind that /gi,\n            /Remember to /gi,\n            /Make sure to /gi,\n            /Don't forget to /gi,\n            /Be sure to /gi\n        ];\n        let result = text;\n        for (const phrase of redundantPhrases){\n            result = result.replace(phrase, \"\");\n        }\n        return result;\n    }\n    intelligentTruncate(text, context) {\n        // Priority sections (keep these)\n        const sections = text.split(\"\\n\\n\");\n        const priority = [];\n        const medium = [];\n        const low = [];\n        for (const section of sections){\n            const lower = section.toLowerCase();\n            if (lower.includes(\"critical\") || lower.includes(\"important\") || lower.includes(\"rules:\") || lower.includes(\"current step\")) {\n                priority.push(section);\n            } else if (lower.includes(\"existing files\") || lower.includes(\"available tools\") || lower.includes(\"context\")) {\n                medium.push(section);\n            } else {\n                low.push(section);\n            }\n        }\n        // Rebuild with priority\n        let result = priority.join(\"\\n\\n\");\n        let currentTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(result);\n        // Add medium priority sections if space allows\n        for (const section of medium){\n            const sectionTokens = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.estimateTokens)(section);\n            if (currentTokens + sectionTokens < this.maxTokens * 0.9) {\n                result += \"\\n\\n\" + section;\n                currentTokens += sectionTokens;\n            } else {\n                // Truncate section\n                const truncated = (0,_summarizer__WEBPACK_IMPORTED_MODULE_0__.smartTruncate)(section, 200);\n                result += \"\\n\\n\" + truncated;\n                break;\n            }\n        }\n        return result;\n    }\n    /**\n   * Optimize system prompt specifically\n   */ optimizeSystemPrompt(systemPrompt, contextSummary) {\n        const { optimizedPrompt } = this.optimize(systemPrompt, contextSummary);\n        return optimizedPrompt;\n    }\n    /**\n   * Optimize file content before including in prompt\n   */ optimizeFileContent(filePath, content, maxLines = 50) {\n        const lines = content.split(\"\\n\");\n        if (lines.length <= maxLines) {\n            return content;\n        }\n        // Show first and last portions\n        const firstLines = lines.slice(0, Math.floor(maxLines / 2));\n        const lastLines = lines.slice(-Math.floor(maxLines / 2));\n        return `${firstLines.join(\"\\n\")}\\n... (${lines.length - maxLines} lines omitted) ...\\n${lastLines.join(\"\\n\")}`;\n    }\n    /**\n   * Batch optimize multiple prompts\n   */ batchOptimize(prompts) {\n        return prompts.map((p)=>this.optimize(p).optimizedPrompt);\n    }\n}\nconst promptOptimizer = new PromptOptimizer(4000);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDZ0QsQ0FBQUEsSUFBSyxJQUFJLENBQUNwRSxRQUFRLENBQUNvRSxHQUFHbkQsZUFBZTtJQUMxRDtBQUNGO0FBRU8sTUFBTW9ELGtCQUFrQixJQUFJeEUsZ0JBQWdCLE1BQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcGVucm91dGVyLWxhbmdncmFwaC8uL2xpYi91dGlscy9wcm9tcHQtb3B0aW1pemVyLnRzPzhmYzIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQcm9tcHQgT3B0aW1pemVyXG4gKiBPcHRpbWl6ZXMgcHJvbXB0cyBiZWZvcmUgc2VuZGluZyB0byBBSSB0byByZWR1Y2UgdG9rZW4gdXNhZ2UgYW5kIGltcHJvdmUgY2xhcml0eVxuICovXG5cbmltcG9ydCB7IGVzdGltYXRlVG9rZW5zLCBzbWFydFRydW5jYXRlIH0gZnJvbSAnLi9zdW1tYXJpemVyJztcblxuaW50ZXJmYWNlIFByb21wdE9wdGltaXphdGlvblJlc3VsdCB7XG4gIG9wdGltaXplZFByb21wdDogc3RyaW5nO1xuICBvcmlnaW5hbFRva2VuczogbnVtYmVyO1xuICBvcHRpbWl6ZWRUb2tlbnM6IG51bWJlcjtcbiAgc2F2aW5nczogbnVtYmVyO1xuICBzYXZpbmdzUGVyY2VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgUHJvbXB0T3B0aW1pemVyIHtcbiAgcHJpdmF0ZSBtYXhUb2tlbnM6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihtYXhUb2tlbnM6IG51bWJlciA9IDQwMDApIHtcbiAgICB0aGlzLm1heFRva2VucyA9IG1heFRva2VucztcbiAgfVxuXG4gIC8qKlxuICAgKiBPcHRpbWl6ZSBhIHByb21wdCBieSByZW1vdmluZyByZWR1bmRhbmN5IGFuZCBjb21wcmVzc2luZyBjb250ZW50XG4gICAqL1xuICBvcHRpbWl6ZShwcm9tcHQ6IHN0cmluZywgY29udGV4dD86IHN0cmluZyk6IFByb21wdE9wdGltaXphdGlvblJlc3VsdCB7XG4gICAgY29uc3Qgb3JpZ2luYWxUb2tlbnMgPSBlc3RpbWF0ZVRva2Vucyhwcm9tcHQpO1xuICAgIFxuICAgIGxldCBvcHRpbWl6ZWQgPSBwcm9tcHQ7XG5cbiAgICAvLyAxLiBSZW1vdmUgZXhjZXNzaXZlIHdoaXRlc3BhY2VcbiAgICBvcHRpbWl6ZWQgPSB0aGlzLnJlbW92ZUV4Y2Vzc2l2ZVdoaXRlc3BhY2Uob3B0aW1pemVkKTtcblxuICAgIC8vIDIuIERlZHVwbGljYXRlIHJlcGVhdGVkIGluc3RydWN0aW9uc1xuICAgIG9wdGltaXplZCA9IHRoaXMuZGVkdXBsaWNhdGVJbnN0cnVjdGlvbnMob3B0aW1pemVkKTtcblxuICAgIC8vIDMuIENvbXByZXNzIGZpbGUgbGlzdGluZ3NcbiAgICBvcHRpbWl6ZWQgPSB0aGlzLmNvbXByZXNzRmlsZUxpc3RzKG9wdGltaXplZCk7XG5cbiAgICAvLyA0LiBSZW1vdmUgcmVkdW5kYW50IHBocmFzZXNcbiAgICBvcHRpbWl6ZWQgPSB0aGlzLnJlbW92ZVJlZHVuZGFudFBocmFzZXMob3B0aW1pemVkKTtcblxuICAgIC8vIDUuIElmIHN0aWxsIHRvbyBsb25nLCB0cnVuY2F0ZSBpbnRlbGxpZ2VudGx5XG4gICAgaWYgKGVzdGltYXRlVG9rZW5zKG9wdGltaXplZCkgPiB0aGlzLm1heFRva2Vucykge1xuICAgICAgb3B0aW1pemVkID0gdGhpcy5pbnRlbGxpZ2VudFRydW5jYXRlKG9wdGltaXplZCwgY29udGV4dCk7XG4gICAgfVxuXG4gICAgY29uc3Qgb3B0aW1pemVkVG9rZW5zID0gZXN0aW1hdGVUb2tlbnMob3B0aW1pemVkKTtcbiAgICBjb25zdCBzYXZpbmdzID0gb3JpZ2luYWxUb2tlbnMgLSBvcHRpbWl6ZWRUb2tlbnM7XG4gICAgY29uc3Qgc2F2aW5nc1BlcmNlbnQgPSBvcmlnaW5hbFRva2VucyA+IDAgPyAoc2F2aW5ncyAvIG9yaWdpbmFsVG9rZW5zKSAqIDEwMCA6IDA7XG5cbiAgICBpZiAoc2F2aW5ncyA+IDUwKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+OryBQcm9tcHQgb3B0aW1pemVkOiAke29yaWdpbmFsVG9rZW5zfSDihpIgJHtvcHRpbWl6ZWRUb2tlbnN9IHRva2VucyAoJHtNYXRoLnJvdW5kKHNhdmluZ3NQZXJjZW50KX0lIHJlZHVjdGlvbilgKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgb3B0aW1pemVkUHJvbXB0OiBvcHRpbWl6ZWQsXG4gICAgICBvcmlnaW5hbFRva2VucyxcbiAgICAgIG9wdGltaXplZFRva2VucyxcbiAgICAgIHNhdmluZ3MsXG4gICAgICBzYXZpbmdzUGVyY2VudCxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSByZW1vdmVFeGNlc3NpdmVXaGl0ZXNwYWNlKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgIC5tYXAobGluZSA9PiBsaW5lLnRyaW0oKSlcbiAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmxlbmd0aCA+IDApXG4gICAgICAuam9pbignXFxuJylcbiAgICAgIC5yZXBsYWNlKC9cXG57Myx9L2csICdcXG5cXG4nKTsgLy8gTWF4IDIgY29uc2VjdXRpdmUgbmV3bGluZXNcbiAgfVxuXG4gIHByaXZhdGUgZGVkdXBsaWNhdGVJbnN0cnVjdGlvbnModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBsaW5lLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgXG4gICAgICAvLyBTa2lwIGlmIHdlJ3ZlIHNlZW4gdGhpcyBleGFjdCBpbnN0cnVjdGlvblxuICAgICAgaWYgKG5vcm1hbGl6ZWQubGVuZ3RoID4gMjAgJiYgc2Vlbi5oYXMobm9ybWFsaXplZCkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHNlZW4uYWRkKG5vcm1hbGl6ZWQpO1xuICAgICAgcmVzdWx0LnB1c2gobGluZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdC5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIHByaXZhdGUgY29tcHJlc3NGaWxlTGlzdHModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBDb21wcmVzcyBsb25nIGZpbGUgbGlzdHNcbiAgICBjb25zdCBmaWxlTGlzdFBhdHRlcm4gPSAvKD86RVhJU1RJTkcgRklMRVN8U2Vzc2lvbiBmaWxlc3xDdXJyZW50IHN0YXRlIGZpbGVzKTpcXHMqXFxuKCg/Olst4oCiXVxccypbXlxcbl0rXFxuPykrKS9naTtcbiAgICBcbiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKGZpbGVMaXN0UGF0dGVybiwgKG1hdGNoLCBmaWxlTGlzdCkgPT4ge1xuICAgICAgY29uc3QgZmlsZXMgPSBmaWxlTGlzdFxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5maWx0ZXIoKGw6IHN0cmluZykgPT4gbC50cmltKCkubGVuZ3RoID4gMCk7XG4gICAgICBcbiAgICAgIGlmIChmaWxlcy5sZW5ndGggPiAxMCkge1xuICAgICAgICBjb25zdCBmaXJzdDUgPSBmaWxlcy5zbGljZSgwLCA1KS5qb2luKCdcXG4nKTtcbiAgICAgICAgY29uc3QgbGFzdDMgPSBmaWxlcy5zbGljZSgtMykuam9pbignXFxuJyk7XG4gICAgICAgIHJldHVybiBgJHttYXRjaC5zcGxpdCgnOicpWzBdfTpcXG4ke2ZpcnN0NX1cXG4uLi4gKCR7ZmlsZXMubGVuZ3RoIC0gOH0gbW9yZSBmaWxlcylcXG4ke2xhc3QzfWA7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBtYXRjaDtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgcmVtb3ZlUmVkdW5kYW50UGhyYXNlcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIFJlbW92ZSBjb21tb24gcmVkdW5kYW50IHBocmFzZXNcbiAgICBjb25zdCByZWR1bmRhbnRQaHJhc2VzID0gW1xuICAgICAgL1BsZWFzZSBub3RlIHRoYXQgL2dpLFxuICAgICAgL0l0IGlzIGltcG9ydGFudCB0byAvZ2ksXG4gICAgICAvWW91IHNob3VsZCBiZSBhd2FyZSB0aGF0IC9naSxcbiAgICAgIC9LZWVwIGluIG1pbmQgdGhhdCAvZ2ksXG4gICAgICAvUmVtZW1iZXIgdG8gL2dpLFxuICAgICAgL01ha2Ugc3VyZSB0byAvZ2ksXG4gICAgICAvRG9uJ3QgZm9yZ2V0IHRvIC9naSxcbiAgICAgIC9CZSBzdXJlIHRvIC9naSxcbiAgICBdO1xuXG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XG4gICAgZm9yIChjb25zdCBwaHJhc2Ugb2YgcmVkdW5kYW50UGhyYXNlcykge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UocGhyYXNlLCAnJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHByaXZhdGUgaW50ZWxsaWdlbnRUcnVuY2F0ZSh0ZXh0OiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIFByaW9yaXR5IHNlY3Rpb25zIChrZWVwIHRoZXNlKVxuICAgIGNvbnN0IHNlY3Rpb25zID0gdGV4dC5zcGxpdCgnXFxuXFxuJyk7XG4gICAgY29uc3QgcHJpb3JpdHk6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgbWVkaXVtOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGxvdzogc3RyaW5nW10gPSBbXTtcblxuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBzZWN0aW9ucykge1xuICAgICAgY29uc3QgbG93ZXIgPSBzZWN0aW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgICBcbiAgICAgIGlmIChcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2NyaXRpY2FsJykgfHxcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2ltcG9ydGFudCcpIHx8XG4gICAgICAgIGxvd2VyLmluY2x1ZGVzKCdydWxlczonKSB8fFxuICAgICAgICBsb3dlci5pbmNsdWRlcygnY3VycmVudCBzdGVwJylcbiAgICAgICkge1xuICAgICAgICBwcmlvcml0eS5wdXNoKHNlY3Rpb24pO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2V4aXN0aW5nIGZpbGVzJykgfHxcbiAgICAgICAgbG93ZXIuaW5jbHVkZXMoJ2F2YWlsYWJsZSB0b29scycpIHx8XG4gICAgICAgIGxvd2VyLmluY2x1ZGVzKCdjb250ZXh0JylcbiAgICAgICkge1xuICAgICAgICBtZWRpdW0ucHVzaChzZWN0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvdy5wdXNoKHNlY3Rpb24pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJlYnVpbGQgd2l0aCBwcmlvcml0eVxuICAgIGxldCByZXN1bHQgPSBwcmlvcml0eS5qb2luKCdcXG5cXG4nKTtcbiAgICBsZXQgY3VycmVudFRva2VucyA9IGVzdGltYXRlVG9rZW5zKHJlc3VsdCk7XG5cbiAgICAvLyBBZGQgbWVkaXVtIHByaW9yaXR5IHNlY3Rpb25zIGlmIHNwYWNlIGFsbG93c1xuICAgIGZvciAoY29uc3Qgc2VjdGlvbiBvZiBtZWRpdW0pIHtcbiAgICAgIGNvbnN0IHNlY3Rpb25Ub2tlbnMgPSBlc3RpbWF0ZVRva2VucyhzZWN0aW9uKTtcbiAgICAgIGlmIChjdXJyZW50VG9rZW5zICsgc2VjdGlvblRva2VucyA8IHRoaXMubWF4VG9rZW5zICogMC45KSB7XG4gICAgICAgIHJlc3VsdCArPSAnXFxuXFxuJyArIHNlY3Rpb247XG4gICAgICAgIGN1cnJlbnRUb2tlbnMgKz0gc2VjdGlvblRva2VucztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRydW5jYXRlIHNlY3Rpb25cbiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gc21hcnRUcnVuY2F0ZShzZWN0aW9uLCAyMDApO1xuICAgICAgICByZXN1bHQgKz0gJ1xcblxcbicgKyB0cnVuY2F0ZWQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogT3B0aW1pemUgc3lzdGVtIHByb21wdCBzcGVjaWZpY2FsbHlcbiAgICovXG4gIG9wdGltaXplU3lzdGVtUHJvbXB0KHN5c3RlbVByb21wdDogc3RyaW5nLCBjb250ZXh0U3VtbWFyeT86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgeyBvcHRpbWl6ZWRQcm9tcHQgfSA9IHRoaXMub3B0aW1pemUoc3lzdGVtUHJvbXB0LCBjb250ZXh0U3VtbWFyeSk7XG4gICAgcmV0dXJuIG9wdGltaXplZFByb21wdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcHRpbWl6ZSBmaWxlIGNvbnRlbnQgYmVmb3JlIGluY2x1ZGluZyBpbiBwcm9tcHRcbiAgICovXG4gIG9wdGltaXplRmlsZUNvbnRlbnQoZmlsZVBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nLCBtYXhMaW5lczogbnVtYmVyID0gNTApOiBzdHJpbmcge1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgXG4gICAgaWYgKGxpbmVzLmxlbmd0aCA8PSBtYXhMaW5lcykge1xuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgLy8gU2hvdyBmaXJzdCBhbmQgbGFzdCBwb3J0aW9uc1xuICAgIGNvbnN0IGZpcnN0TGluZXMgPSBsaW5lcy5zbGljZSgwLCBNYXRoLmZsb29yKG1heExpbmVzIC8gMikpO1xuICAgIGNvbnN0IGxhc3RMaW5lcyA9IGxpbmVzLnNsaWNlKC1NYXRoLmZsb29yKG1heExpbmVzIC8gMikpO1xuICAgIFxuICAgIHJldHVybiBgJHtmaXJzdExpbmVzLmpvaW4oJ1xcbicpfVxcbi4uLiAoJHtsaW5lcy5sZW5ndGggLSBtYXhMaW5lc30gbGluZXMgb21pdHRlZCkgLi4uXFxuJHtsYXN0TGluZXMuam9pbignXFxuJyl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBCYXRjaCBvcHRpbWl6ZSBtdWx0aXBsZSBwcm9tcHRzXG4gICAqL1xuICBiYXRjaE9wdGltaXplKHByb21wdHM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBwcm9tcHRzLm1hcChwID0+IHRoaXMub3B0aW1pemUocCkub3B0aW1pemVkUHJvbXB0KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcHJvbXB0T3B0aW1pemVyID0gbmV3IFByb21wdE9wdGltaXplcig0MDAwKTtcbiJdLCJuYW1lcyI6WyJlc3RpbWF0ZVRva2VucyIsInNtYXJ0VHJ1bmNhdGUiLCJQcm9tcHRPcHRpbWl6ZXIiLCJjb25zdHJ1Y3RvciIsIm1heFRva2VucyIsIm9wdGltaXplIiwicHJvbXB0IiwiY29udGV4dCIsIm9yaWdpbmFsVG9rZW5zIiwib3B0aW1pemVkIiwicmVtb3ZlRXhjZXNzaXZlV2hpdGVzcGFjZSIsImRlZHVwbGljYXRlSW5zdHJ1Y3Rpb25zIiwiY29tcHJlc3NGaWxlTGlzdHMiLCJyZW1vdmVSZWR1bmRhbnRQaHJhc2VzIiwiaW50ZWxsaWdlbnRUcnVuY2F0ZSIsIm9wdGltaXplZFRva2VucyIsInNhdmluZ3MiLCJzYXZpbmdzUGVyY2VudCIsImNvbnNvbGUiLCJsb2ciLCJNYXRoIiwicm91bmQiLCJvcHRpbWl6ZWRQcm9tcHQiLCJ0ZXh0Iiwic3BsaXQiLCJtYXAiLCJsaW5lIiwidHJpbSIsImZpbHRlciIsImxlbmd0aCIsImpvaW4iLCJyZXBsYWNlIiwibGluZXMiLCJzZWVuIiwiU2V0IiwicmVzdWx0Iiwibm9ybWFsaXplZCIsInRvTG93ZXJDYXNlIiwiaGFzIiwiYWRkIiwicHVzaCIsImZpbGVMaXN0UGF0dGVybiIsIm1hdGNoIiwiZmlsZUxpc3QiLCJmaWxlcyIsImwiLCJmaXJzdDUiLCJzbGljZSIsImxhc3QzIiwicmVkdW5kYW50UGhyYXNlcyIsInBocmFzZSIsInNlY3Rpb25zIiwicHJpb3JpdHkiLCJtZWRpdW0iLCJsb3ciLCJzZWN0aW9uIiwibG93ZXIiLCJpbmNsdWRlcyIsImN1cnJlbnRUb2tlbnMiLCJzZWN0aW9uVG9rZW5zIiwidHJ1bmNhdGVkIiwib3B0aW1pemVTeXN0ZW1Qcm9tcHQiLCJzeXN0ZW1Qcm9tcHQiLCJjb250ZXh0U3VtbWFyeSIsIm9wdGltaXplRmlsZUNvbnRlbnQiLCJmaWxlUGF0aCIsImNvbnRlbnQiLCJtYXhMaW5lcyIsImZpcnN0TGluZXMiLCJmbG9vciIsImxhc3RMaW5lcyIsImJhdGNoT3B0aW1pemUiLCJwcm9tcHRzIiwicCIsInByb21wdE9wdGltaXplciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/prompt-optimizer.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/summarizer.ts":
/*!*********************************!*\
  !*** ./lib/utils/summarizer.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compressContext: () => (/* binding */ compressContext),\n/* harmony export */   estimateTokens: () => (/* binding */ estimateTokens),\n/* harmony export */   shouldCompress: () => (/* binding */ shouldCompress),\n/* harmony export */   smartTruncate: () => (/* binding */ smartTruncate),\n/* harmony export */   summarizeConversation: () => (/* binding */ summarizeConversation),\n/* harmony export */   summarizeFileContents: () => (/* binding */ summarizeFileContents)\n/* harmony export */ });\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/.pnpm/@langchain+openai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___ws@8.18.3/node_modules/@langchain/openai/dist/index.js\");\n/* harmony import */ var _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @langchain/core/messages */ \"(rsc)/./node_modules/.pnpm/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_/node_modules/@langchain/core/dist/messages/index.js\");\n\n\n// Initialize a lightweight model for summarization\nconst apiKey = process.env.OPENROUTER_API_KEY ?? process.env.OPENAI_API_KEY;\nconst apiBase = \"https://openrouter.ai/api/v1\";\nconst summarizer = new _langchain_openai__WEBPACK_IMPORTED_MODULE_0__.ChatOpenAI({\n    apiKey,\n    configuration: {\n        baseURL: apiBase\n    },\n    model: process.env.OPENROUTER_MODEL,\n    temperature: 0.3,\n    maxTokens: 500\n});\n/**\n * Summarize conversation history to reduce token usage\n */ async function summarizeConversation(messages, maxMessages = 10) {\n    // Keep the most recent messages, summarize older ones\n    if (messages.length <= maxMessages) {\n        return {\n            summary: messages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\"),\n            tokensSaved: 0,\n            originalLength: messages.length\n        };\n    }\n    const recentMessages = messages.slice(-maxMessages);\n    const oldMessages = messages.slice(0, -maxMessages);\n    const oldMessagesText = oldMessages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\");\n    const systemPrompt = `You are a context summarizer. Condense the conversation history into a brief, relevant summary.\n\nFocus on:\n1. Key user requests and what was accomplished\n2. Important decisions made\n3. Files created/modified\n4. Current state of the project\n\nKeep it under 200 words. Be concise but preserve critical context.`;\n    try {\n        const response = await summarizer.invoke([\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.SystemMessage(systemPrompt),\n            new _langchain_core_messages__WEBPACK_IMPORTED_MODULE_1__.HumanMessage(`Summarize this conversation history:\\n\\n${oldMessagesText}`)\n        ]);\n        const summary = response.content.toString();\n        // Estimate tokens saved (rough estimate: 4 chars ≈ 1 token)\n        const originalTokens = Math.ceil(oldMessagesText.length / 4);\n        const summaryTokens = Math.ceil(summary.length / 4);\n        const tokensSaved = originalTokens - summaryTokens;\n        return {\n            summary,\n            tokensSaved,\n            originalLength: messages.length\n        };\n    } catch (error) {\n        console.error(\"Summarization error:\", error);\n        // Fallback: just return recent messages\n        return {\n            summary: recentMessages.map((m)=>`${m.role}: ${m.content}`).join(\"\\n\"),\n            tokensSaved: 0,\n            originalLength: messages.length\n        };\n    }\n}\n/**\n * Summarize file contents to reduce token usage when passing as context\n */ async function summarizeFileContents(files, maxFileSize = 500) {\n    const summarizedFiles = {};\n    for (const [filename, content] of Object.entries(files)){\n        // If file is small enough, keep it as-is\n        if (content.length <= maxFileSize) {\n            summarizedFiles[filename] = content;\n            continue;\n        }\n        // For large files, provide a structure summary\n        const lines = content.split(\"\\n\");\n        const firstLines = lines.slice(0, 10).join(\"\\n\");\n        const lastLines = lines.slice(-5).join(\"\\n\");\n        const summary = `${firstLines}\\n\\n... (${lines.length - 15} lines omitted) ...\\n\\n${lastLines}`;\n        summarizedFiles[filename] = summary;\n    }\n    return summarizedFiles;\n}\n/**\n * Intelligent context compression for agent prompts\n */ async function compressContext(options) {\n    const parts = [];\n    let originalSize = 0;\n    // 1. User request (always include, high priority)\n    parts.push(`USER REQUEST: ${options.userRequest}`);\n    originalSize += options.userRequest.length;\n    // 2. Conversation history (summarize if long)\n    if (options.conversationHistory && options.conversationHistory.length > 0) {\n        const { summary, tokensSaved } = await summarizeConversation(options.conversationHistory, 5 // Keep last 5 messages\n        );\n        parts.push(`\\nCONVERSATION CONTEXT:\\n${summary}`);\n        originalSize += options.conversationHistory.reduce((sum, m)=>sum + m.content.length, 0);\n    }\n    // 3. Existing files (summarize large files)\n    if (options.existingFiles && Object.keys(options.existingFiles).length > 0) {\n        const summarizedFiles = await summarizeFileContents(options.existingFiles, 400);\n        parts.push(`\\nEXISTING FILES:`);\n        for (const [filename, content] of Object.entries(summarizedFiles)){\n            parts.push(`\\n--- ${filename} ---\\n${content}`);\n        }\n        originalSize += Object.values(options.existingFiles).reduce((sum, content)=>sum + content.length, 0);\n    }\n    // 4. Plan (always include if present)\n    if (options.plan && options.plan.length > 0) {\n        parts.push(`\\nPLAN:\\n${options.plan.map((s, i)=>`${i + 1}. ${s}`).join(\"\\n\")}`);\n        originalSize += options.plan.join(\"\").length;\n    }\n    // 5. Recent operations (keep brief)\n    if (options.recentOperations && options.recentOperations.length > 0) {\n        const recentOps = options.recentOperations.slice(-5);\n        parts.push(`\\nRECENT OPERATIONS:\\n${recentOps.join(\"\\n\")}`);\n        originalSize += options.recentOperations.join(\"\").length;\n    }\n    const compressedContext = parts.join(\"\\n\");\n    const compressedSize = compressedContext.length;\n    const compressionRatio = originalSize > 0 ? (originalSize - compressedSize) / originalSize * 100 : 0;\n    return {\n        compressedContext,\n        stats: {\n            originalSize,\n            compressedSize,\n            compressionRatio\n        }\n    };\n}\n/**\n * Smart truncation for very long content\n */ function smartTruncate(text, maxLength) {\n    if (text.length <= maxLength) {\n        return text;\n    }\n    // Try to truncate at a natural boundary (newline, period, etc.)\n    const truncated = text.substring(0, maxLength);\n    const lastNewline = truncated.lastIndexOf(\"\\n\");\n    const lastPeriod = truncated.lastIndexOf(\".\");\n    const cutPoint = Math.max(lastNewline, lastPeriod);\n    if (cutPoint > maxLength * 0.8) {\n        return text.substring(0, cutPoint + 1) + \"\\n... (truncated)\";\n    }\n    return truncated + \"\\n... (truncated)\";\n}\n/**\n * Calculate approximate token count\n */ function estimateTokens(text) {\n    // Rough estimate: ~4 characters per token\n    // More accurate for English text\n    return Math.ceil(text.length / 4);\n}\n/**\n * Check if context is getting too large and needs compression\n */ function shouldCompress(text, maxTokens = 2000) {\n    return estimateTokens(text) > maxTokens;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUJBQW1CaEIsZUFBZSxJQUNuQyxDQUFDQSxlQUFlZSxjQUFhLElBQUtmLGVBQWUsTUFDbEQ7SUFFSixPQUFPO1FBQ0xjO1FBQ0FHLE9BQU87WUFDTGpCO1lBQ0FlO1lBQ0FDO1FBQ0Y7SUFDRjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTRSxjQUFjQyxJQUFZLEVBQUVDLFNBQWlCO0lBQzNELElBQUlELEtBQUt4RCxNQUFNLElBQUl5RCxXQUFXO1FBQzVCLE9BQU9EO0lBQ1Q7SUFFQSxnRUFBZ0U7SUFDaEUsTUFBTUUsWUFBWUYsS0FBS0csU0FBUyxDQUFDLEdBQUdGO0lBQ3BDLE1BQU1HLGNBQWNGLFVBQVVHLFdBQVcsQ0FBQztJQUMxQyxNQUFNQyxhQUFhSixVQUFVRyxXQUFXLENBQUM7SUFFekMsTUFBTUUsV0FBVzdDLEtBQUs4QyxHQUFHLENBQUNKLGFBQWFFO0lBRXZDLElBQUlDLFdBQVdOLFlBQVksS0FBSztRQUM5QixPQUFPRCxLQUFLRyxTQUFTLENBQUMsR0FBR0ksV0FBVyxLQUFLO0lBQzNDO0lBRUEsT0FBT0wsWUFBWTtBQUNyQjtBQUVBOztDQUVDLEdBQ00sU0FBU08sZUFBZVQsSUFBWTtJQUN6QywwQ0FBMEM7SUFDMUMsaUNBQWlDO0lBQ2pDLE9BQU90QyxLQUFLQyxJQUFJLENBQUNxQyxLQUFLeEQsTUFBTSxHQUFHO0FBQ2pDO0FBRUE7O0NBRUMsR0FDTSxTQUFTa0UsZUFBZVYsSUFBWSxFQUFFNUQsWUFBb0IsSUFBSTtJQUNuRSxPQUFPcUUsZUFBZVQsUUFBUTVEO0FBQ2hDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BlbnJvdXRlci1sYW5nZ3JhcGgvLi9saWIvdXRpbHMvc3VtbWFyaXplci50cz9mMTg2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYXRPcGVuQUkgfSBmcm9tICdAbGFuZ2NoYWluL29wZW5haSc7XG5pbXBvcnQgeyBTeXN0ZW1NZXNzYWdlLCBIdW1hbk1lc3NhZ2UgfSBmcm9tICdAbGFuZ2NoYWluL2NvcmUvbWVzc2FnZXMnO1xuXG4vLyBJbml0aWFsaXplIGEgbGlnaHR3ZWlnaHQgbW9kZWwgZm9yIHN1bW1hcml6YXRpb25cbmNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52Lk9QRU5ST1VURVJfQVBJX0tFWSA/PyBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWTtcbmNvbnN0IGFwaUJhc2UgPSAnaHR0cHM6Ly9vcGVucm91dGVyLmFpL2FwaS92MSc7XG5cbmNvbnN0IHN1bW1hcml6ZXIgPSBuZXcgQ2hhdE9wZW5BSSh7XG4gIGFwaUtleSxcbiAgY29uZmlndXJhdGlvbjoge1xuICAgIGJhc2VVUkw6IGFwaUJhc2UsXG4gIH0sXG4gIG1vZGVsOiBwcm9jZXNzLmVudi5PUEVOUk9VVEVSX01PREVMICwgLy8gVXNlIGNoZWFwZXIgbW9kZWwgZm9yIHN1bW1hcml6YXRpb25cbiAgdGVtcGVyYXR1cmU6IDAuMyxcbiAgbWF4VG9rZW5zOiA1MDAsXG59KTtcblxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJpemVkQ29udGV4dCB7XG4gIHN1bW1hcnk6IHN0cmluZztcbiAgdG9rZW5zU2F2ZWQ6IG51bWJlcjtcbiAgb3JpZ2luYWxMZW5ndGg6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBTdW1tYXJpemUgY29udmVyc2F0aW9uIGhpc3RvcnkgdG8gcmVkdWNlIHRva2VuIHVzYWdlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdW1tYXJpemVDb252ZXJzYXRpb24oXG4gIG1lc3NhZ2VzOiBBcnJheTx7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH0+LFxuICBtYXhNZXNzYWdlczogbnVtYmVyID0gMTBcbik6IFByb21pc2U8U3VtbWFyaXplZENvbnRleHQ+IHtcbiAgLy8gS2VlcCB0aGUgbW9zdCByZWNlbnQgbWVzc2FnZXMsIHN1bW1hcml6ZSBvbGRlciBvbmVzXG4gIGlmIChtZXNzYWdlcy5sZW5ndGggPD0gbWF4TWVzc2FnZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VtbWFyeTogbWVzc2FnZXMubWFwKG0gPT4gYCR7bS5yb2xlfTogJHttLmNvbnRlbnR9YCkuam9pbignXFxuJyksXG4gICAgICB0b2tlbnNTYXZlZDogMCxcbiAgICAgIG9yaWdpbmFsTGVuZ3RoOiBtZXNzYWdlcy5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHJlY2VudE1lc3NhZ2VzID0gbWVzc2FnZXMuc2xpY2UoLW1heE1lc3NhZ2VzKTtcbiAgY29uc3Qgb2xkTWVzc2FnZXMgPSBtZXNzYWdlcy5zbGljZSgwLCAtbWF4TWVzc2FnZXMpO1xuXG4gIGNvbnN0IG9sZE1lc3NhZ2VzVGV4dCA9IG9sZE1lc3NhZ2VzXG4gICAgLm1hcChtID0+IGAke20ucm9sZX06ICR7bS5jb250ZW50fWApXG4gICAgLmpvaW4oJ1xcbicpO1xuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgY29udGV4dCBzdW1tYXJpemVyLiBDb25kZW5zZSB0aGUgY29udmVyc2F0aW9uIGhpc3RvcnkgaW50byBhIGJyaWVmLCByZWxldmFudCBzdW1tYXJ5LlxuXG5Gb2N1cyBvbjpcbjEuIEtleSB1c2VyIHJlcXVlc3RzIGFuZCB3aGF0IHdhcyBhY2NvbXBsaXNoZWRcbjIuIEltcG9ydGFudCBkZWNpc2lvbnMgbWFkZVxuMy4gRmlsZXMgY3JlYXRlZC9tb2RpZmllZFxuNC4gQ3VycmVudCBzdGF0ZSBvZiB0aGUgcHJvamVjdFxuXG5LZWVwIGl0IHVuZGVyIDIwMCB3b3Jkcy4gQmUgY29uY2lzZSBidXQgcHJlc2VydmUgY3JpdGljYWwgY29udGV4dC5gO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdW1tYXJpemVyLmludm9rZShbXG4gICAgICBuZXcgU3lzdGVtTWVzc2FnZShzeXN0ZW1Qcm9tcHQpLFxuICAgICAgbmV3IEh1bWFuTWVzc2FnZShgU3VtbWFyaXplIHRoaXMgY29udmVyc2F0aW9uIGhpc3Rvcnk6XFxuXFxuJHtvbGRNZXNzYWdlc1RleHR9YCksXG4gICAgXSk7XG5cbiAgICBjb25zdCBzdW1tYXJ5ID0gcmVzcG9uc2UuY29udGVudC50b1N0cmluZygpO1xuICAgIFxuICAgIC8vIEVzdGltYXRlIHRva2VucyBzYXZlZCAocm91Z2ggZXN0aW1hdGU6IDQgY2hhcnMg4omIIDEgdG9rZW4pXG4gICAgY29uc3Qgb3JpZ2luYWxUb2tlbnMgPSBNYXRoLmNlaWwob2xkTWVzc2FnZXNUZXh0Lmxlbmd0aCAvIDQpO1xuICAgIGNvbnN0IHN1bW1hcnlUb2tlbnMgPSBNYXRoLmNlaWwoc3VtbWFyeS5sZW5ndGggLyA0KTtcbiAgICBjb25zdCB0b2tlbnNTYXZlZCA9IG9yaWdpbmFsVG9rZW5zIC0gc3VtbWFyeVRva2VucztcblxuICAgIHJldHVybiB7XG4gICAgICBzdW1tYXJ5LFxuICAgICAgdG9rZW5zU2F2ZWQsXG4gICAgICBvcmlnaW5hbExlbmd0aDogbWVzc2FnZXMubGVuZ3RoLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignU3VtbWFyaXphdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgLy8gRmFsbGJhY2s6IGp1c3QgcmV0dXJuIHJlY2VudCBtZXNzYWdlc1xuICAgIHJldHVybiB7XG4gICAgICBzdW1tYXJ5OiByZWNlbnRNZXNzYWdlcy5tYXAobSA9PiBgJHttLnJvbGV9OiAke20uY29udGVudH1gKS5qb2luKCdcXG4nKSxcbiAgICAgIHRva2Vuc1NhdmVkOiAwLFxuICAgICAgb3JpZ2luYWxMZW5ndGg6IG1lc3NhZ2VzLmxlbmd0aCxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogU3VtbWFyaXplIGZpbGUgY29udGVudHMgdG8gcmVkdWNlIHRva2VuIHVzYWdlIHdoZW4gcGFzc2luZyBhcyBjb250ZXh0XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdW1tYXJpemVGaWxlQ29udGVudHMoXG4gIGZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuICBtYXhGaWxlU2l6ZTogbnVtYmVyID0gNTAwXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHN0cmluZz4+IHtcbiAgY29uc3Qgc3VtbWFyaXplZEZpbGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG5cbiAgZm9yIChjb25zdCBbZmlsZW5hbWUsIGNvbnRlbnRdIG9mIE9iamVjdC5lbnRyaWVzKGZpbGVzKSkge1xuICAgIC8vIElmIGZpbGUgaXMgc21hbGwgZW5vdWdoLCBrZWVwIGl0IGFzLWlzXG4gICAgaWYgKGNvbnRlbnQubGVuZ3RoIDw9IG1heEZpbGVTaXplKSB7XG4gICAgICBzdW1tYXJpemVkRmlsZXNbZmlsZW5hbWVdID0gY29udGVudDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIC8vIEZvciBsYXJnZSBmaWxlcywgcHJvdmlkZSBhIHN0cnVjdHVyZSBzdW1tYXJ5XG4gICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmaXJzdExpbmVzID0gbGluZXMuc2xpY2UoMCwgMTApLmpvaW4oJ1xcbicpO1xuICAgIGNvbnN0IGxhc3RMaW5lcyA9IGxpbmVzLnNsaWNlKC01KS5qb2luKCdcXG4nKTtcbiAgICBcbiAgICBjb25zdCBzdW1tYXJ5ID0gYCR7Zmlyc3RMaW5lc31cXG5cXG4uLi4gKCR7bGluZXMubGVuZ3RoIC0gMTV9IGxpbmVzIG9taXR0ZWQpIC4uLlxcblxcbiR7bGFzdExpbmVzfWA7XG4gICAgc3VtbWFyaXplZEZpbGVzW2ZpbGVuYW1lXSA9IHN1bW1hcnk7XG4gIH1cblxuICByZXR1cm4gc3VtbWFyaXplZEZpbGVzO1xufVxuXG4vKipcbiAqIEludGVsbGlnZW50IGNvbnRleHQgY29tcHJlc3Npb24gZm9yIGFnZW50IHByb21wdHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbXByZXNzQ29udGV4dChvcHRpb25zOiB7XG4gIHVzZXJSZXF1ZXN0OiBzdHJpbmc7XG4gIGNvbnZlcnNhdGlvbkhpc3Rvcnk/OiBBcnJheTx7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH0+O1xuICBleGlzdGluZ0ZpbGVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgcGxhbj86IHN0cmluZ1tdO1xuICByZWNlbnRPcGVyYXRpb25zPzogc3RyaW5nW107XG59KTogUHJvbWlzZTx7XG4gIGNvbXByZXNzZWRDb250ZXh0OiBzdHJpbmc7XG4gIHN0YXRzOiB7XG4gICAgb3JpZ2luYWxTaXplOiBudW1iZXI7XG4gICAgY29tcHJlc3NlZFNpemU6IG51bWJlcjtcbiAgICBjb21wcmVzc2lvblJhdGlvOiBudW1iZXI7XG4gIH07XG59PiB7XG4gIGNvbnN0IHBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICBsZXQgb3JpZ2luYWxTaXplID0gMDtcblxuICAvLyAxLiBVc2VyIHJlcXVlc3QgKGFsd2F5cyBpbmNsdWRlLCBoaWdoIHByaW9yaXR5KVxuICBwYXJ0cy5wdXNoKGBVU0VSIFJFUVVFU1Q6ICR7b3B0aW9ucy51c2VyUmVxdWVzdH1gKTtcbiAgb3JpZ2luYWxTaXplICs9IG9wdGlvbnMudXNlclJlcXVlc3QubGVuZ3RoO1xuXG4gIC8vIDIuIENvbnZlcnNhdGlvbiBoaXN0b3J5IChzdW1tYXJpemUgaWYgbG9uZylcbiAgaWYgKG9wdGlvbnMuY29udmVyc2F0aW9uSGlzdG9yeSAmJiBvcHRpb25zLmNvbnZlcnNhdGlvbkhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IHsgc3VtbWFyeSwgdG9rZW5zU2F2ZWQgfSA9IGF3YWl0IHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcbiAgICAgIG9wdGlvbnMuY29udmVyc2F0aW9uSGlzdG9yeSxcbiAgICAgIDUgLy8gS2VlcCBsYXN0IDUgbWVzc2FnZXNcbiAgICApO1xuICAgIFxuICAgIHBhcnRzLnB1c2goYFxcbkNPTlZFUlNBVElPTiBDT05URVhUOlxcbiR7c3VtbWFyeX1gKTtcbiAgICBvcmlnaW5hbFNpemUgKz0gb3B0aW9ucy5jb252ZXJzYXRpb25IaXN0b3J5LnJlZHVjZShcbiAgICAgIChzdW0sIG0pID0+IHN1bSArIG0uY29udGVudC5sZW5ndGgsXG4gICAgICAwXG4gICAgKTtcbiAgfVxuXG4gIC8vIDMuIEV4aXN0aW5nIGZpbGVzIChzdW1tYXJpemUgbGFyZ2UgZmlsZXMpXG4gIGlmIChvcHRpb25zLmV4aXN0aW5nRmlsZXMgJiYgT2JqZWN0LmtleXMob3B0aW9ucy5leGlzdGluZ0ZpbGVzKS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3Qgc3VtbWFyaXplZEZpbGVzID0gYXdhaXQgc3VtbWFyaXplRmlsZUNvbnRlbnRzKG9wdGlvbnMuZXhpc3RpbmdGaWxlcywgNDAwKTtcbiAgICBcbiAgICBwYXJ0cy5wdXNoKGBcXG5FWElTVElORyBGSUxFUzpgKTtcbiAgICBmb3IgKGNvbnN0IFtmaWxlbmFtZSwgY29udGVudF0gb2YgT2JqZWN0LmVudHJpZXMoc3VtbWFyaXplZEZpbGVzKSkge1xuICAgICAgcGFydHMucHVzaChgXFxuLS0tICR7ZmlsZW5hbWV9IC0tLVxcbiR7Y29udGVudH1gKTtcbiAgICB9XG4gICAgXG4gICAgb3JpZ2luYWxTaXplICs9IE9iamVjdC52YWx1ZXMob3B0aW9ucy5leGlzdGluZ0ZpbGVzKS5yZWR1Y2UoXG4gICAgICAoc3VtLCBjb250ZW50KSA9PiBzdW0gKyBjb250ZW50Lmxlbmd0aCxcbiAgICAgIDBcbiAgICApO1xuICB9XG5cbiAgLy8gNC4gUGxhbiAoYWx3YXlzIGluY2x1ZGUgaWYgcHJlc2VudClcbiAgaWYgKG9wdGlvbnMucGxhbiAmJiBvcHRpb25zLnBsYW4ubGVuZ3RoID4gMCkge1xuICAgIHBhcnRzLnB1c2goYFxcblBMQU46XFxuJHtvcHRpb25zLnBsYW4ubWFwKChzLCBpKSA9PiBgJHtpICsgMX0uICR7c31gKS5qb2luKCdcXG4nKX1gKTtcbiAgICBvcmlnaW5hbFNpemUgKz0gb3B0aW9ucy5wbGFuLmpvaW4oJycpLmxlbmd0aDtcbiAgfVxuXG4gIC8vIDUuIFJlY2VudCBvcGVyYXRpb25zIChrZWVwIGJyaWVmKVxuICBpZiAob3B0aW9ucy5yZWNlbnRPcGVyYXRpb25zICYmIG9wdGlvbnMucmVjZW50T3BlcmF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgcmVjZW50T3BzID0gb3B0aW9ucy5yZWNlbnRPcGVyYXRpb25zLnNsaWNlKC01KTtcbiAgICBwYXJ0cy5wdXNoKGBcXG5SRUNFTlQgT1BFUkFUSU9OUzpcXG4ke3JlY2VudE9wcy5qb2luKCdcXG4nKX1gKTtcbiAgICBvcmlnaW5hbFNpemUgKz0gb3B0aW9ucy5yZWNlbnRPcGVyYXRpb25zLmpvaW4oJycpLmxlbmd0aDtcbiAgfVxuXG4gIGNvbnN0IGNvbXByZXNzZWRDb250ZXh0ID0gcGFydHMuam9pbignXFxuJyk7XG4gIGNvbnN0IGNvbXByZXNzZWRTaXplID0gY29tcHJlc3NlZENvbnRleHQubGVuZ3RoO1xuICBjb25zdCBjb21wcmVzc2lvblJhdGlvID0gb3JpZ2luYWxTaXplID4gMCBcbiAgICA/ICgob3JpZ2luYWxTaXplIC0gY29tcHJlc3NlZFNpemUpIC8gb3JpZ2luYWxTaXplICogMTAwKVxuICAgIDogMDtcblxuICByZXR1cm4ge1xuICAgIGNvbXByZXNzZWRDb250ZXh0LFxuICAgIHN0YXRzOiB7XG4gICAgICBvcmlnaW5hbFNpemUsXG4gICAgICBjb21wcmVzc2VkU2l6ZSxcbiAgICAgIGNvbXByZXNzaW9uUmF0aW8sXG4gICAgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBTbWFydCB0cnVuY2F0aW9uIGZvciB2ZXJ5IGxvbmcgY29udGVudFxuICovXG5leHBvcnQgZnVuY3Rpb24gc21hcnRUcnVuY2F0ZSh0ZXh0OiBzdHJpbmcsIG1heExlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgaWYgKHRleHQubGVuZ3RoIDw9IG1heExlbmd0aCkge1xuICAgIHJldHVybiB0ZXh0O1xuICB9XG5cbiAgLy8gVHJ5IHRvIHRydW5jYXRlIGF0IGEgbmF0dXJhbCBib3VuZGFyeSAobmV3bGluZSwgcGVyaW9kLCBldGMuKVxuICBjb25zdCB0cnVuY2F0ZWQgPSB0ZXh0LnN1YnN0cmluZygwLCBtYXhMZW5ndGgpO1xuICBjb25zdCBsYXN0TmV3bGluZSA9IHRydW5jYXRlZC5sYXN0SW5kZXhPZignXFxuJyk7XG4gIGNvbnN0IGxhc3RQZXJpb2QgPSB0cnVuY2F0ZWQubGFzdEluZGV4T2YoJy4nKTtcbiAgXG4gIGNvbnN0IGN1dFBvaW50ID0gTWF0aC5tYXgobGFzdE5ld2xpbmUsIGxhc3RQZXJpb2QpO1xuICBcbiAgaWYgKGN1dFBvaW50ID4gbWF4TGVuZ3RoICogMC44KSB7XG4gICAgcmV0dXJuIHRleHQuc3Vic3RyaW5nKDAsIGN1dFBvaW50ICsgMSkgKyAnXFxuLi4uICh0cnVuY2F0ZWQpJztcbiAgfVxuICBcbiAgcmV0dXJuIHRydW5jYXRlZCArICdcXG4uLi4gKHRydW5jYXRlZCknO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZSBhcHByb3hpbWF0ZSB0b2tlbiBjb3VudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgLy8gUm91Z2ggZXN0aW1hdGU6IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuXG4gIC8vIE1vcmUgYWNjdXJhdGUgZm9yIEVuZ2xpc2ggdGV4dFxuICByZXR1cm4gTWF0aC5jZWlsKHRleHQubGVuZ3RoIC8gNCk7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgY29udGV4dCBpcyBnZXR0aW5nIHRvbyBsYXJnZSBhbmQgbmVlZHMgY29tcHJlc3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNob3VsZENvbXByZXNzKHRleHQ6IHN0cmluZywgbWF4VG9rZW5zOiBudW1iZXIgPSAyMDAwKTogYm9vbGVhbiB7XG4gIHJldHVybiBlc3RpbWF0ZVRva2Vucyh0ZXh0KSA+IG1heFRva2Vucztcbn1cbiJdLCJuYW1lcyI6WyJDaGF0T3BlbkFJIiwiU3lzdGVtTWVzc2FnZSIsIkh1bWFuTWVzc2FnZSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOUk9VVEVSX0FQSV9LRVkiLCJPUEVOQUlfQVBJX0tFWSIsImFwaUJhc2UiLCJzdW1tYXJpemVyIiwiY29uZmlndXJhdGlvbiIsImJhc2VVUkwiLCJtb2RlbCIsIk9QRU5ST1VURVJfTU9ERUwiLCJ0ZW1wZXJhdHVyZSIsIm1heFRva2VucyIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsIm1lc3NhZ2VzIiwibWF4TWVzc2FnZXMiLCJsZW5ndGgiLCJzdW1tYXJ5IiwibWFwIiwibSIsInJvbGUiLCJjb250ZW50Iiwiam9pbiIsInRva2Vuc1NhdmVkIiwib3JpZ2luYWxMZW5ndGgiLCJyZWNlbnRNZXNzYWdlcyIsInNsaWNlIiwib2xkTWVzc2FnZXMiLCJvbGRNZXNzYWdlc1RleHQiLCJzeXN0ZW1Qcm9tcHQiLCJyZXNwb25zZSIsImludm9rZSIsInRvU3RyaW5nIiwib3JpZ2luYWxUb2tlbnMiLCJNYXRoIiwiY2VpbCIsInN1bW1hcnlUb2tlbnMiLCJlcnJvciIsImNvbnNvbGUiLCJzdW1tYXJpemVGaWxlQ29udGVudHMiLCJmaWxlcyIsIm1heEZpbGVTaXplIiwic3VtbWFyaXplZEZpbGVzIiwiZmlsZW5hbWUiLCJPYmplY3QiLCJlbnRyaWVzIiwibGluZXMiLCJzcGxpdCIsImZpcnN0TGluZXMiLCJsYXN0TGluZXMiLCJjb21wcmVzc0NvbnRleHQiLCJvcHRpb25zIiwicGFydHMiLCJvcmlnaW5hbFNpemUiLCJwdXNoIiwidXNlclJlcXVlc3QiLCJjb252ZXJzYXRpb25IaXN0b3J5IiwicmVkdWNlIiwic3VtIiwiZXhpc3RpbmdGaWxlcyIsImtleXMiLCJ2YWx1ZXMiLCJwbGFuIiwicyIsImkiLCJyZWNlbnRPcGVyYXRpb25zIiwicmVjZW50T3BzIiwiY29tcHJlc3NlZENvbnRleHQiLCJjb21wcmVzc2VkU2l6ZSIsImNvbXByZXNzaW9uUmF0aW8iLCJzdGF0cyIsInNtYXJ0VHJ1bmNhdGUiLCJ0ZXh0IiwibWF4TGVuZ3RoIiwidHJ1bmNhdGVkIiwic3Vic3RyaW5nIiwibGFzdE5ld2xpbmUiLCJsYXN0SW5kZXhPZiIsImxhc3RQZXJpb2QiLCJjdXRQb2ludCIsIm1heCIsImVzdGltYXRlVG9rZW5zIiwic2hvdWxkQ29tcHJlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/summarizer.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/tool-logger.ts":
/*!**********************************!*\
  !*** ./lib/utils/tool-logger.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toolLogger: () => (/* binding */ toolLogger)\n/* harmony export */ });\n/**\n * Tool Call Logger\n * Logs all tool invocations with timing and results for debugging and optimization\n */ class ToolCallLogger {\n    setSession(sessionId) {\n        this.sessionId = sessionId;\n        this.calls = [];\n    }\n    startCall(toolName, parameters) {\n        const callId = this.calls.length;\n        this.calls.push({\n            toolName,\n            parameters,\n            startTime: Date.now(),\n            success: false\n        });\n        console.log(`🔧 [TOOL START] ${toolName}`, this.formatParams(parameters));\n        return callId;\n    }\n    endCall(callId, result, success = true, error) {\n        const call = this.calls[callId];\n        if (!call) return;\n        call.endTime = Date.now();\n        call.duration = call.endTime - call.startTime;\n        call.success = success;\n        call.result = this.truncateResult(result);\n        call.error = error;\n        const icon = success ? \"✅\" : \"❌\";\n        console.log(`${icon} [TOOL END] ${call.toolName} (${call.duration}ms)`);\n        if (error) {\n            console.log(`   Error: ${error}`);\n        }\n    }\n    getStats() {\n        const totalCalls = this.calls.length;\n        const successfulCalls = this.calls.filter((c)=>c.success).length;\n        const failedCalls = totalCalls - successfulCalls;\n        const totalDuration = this.calls.reduce((sum, c)=>sum + (c.duration || 0), 0);\n        const averageDuration = totalCalls > 0 ? totalDuration / totalCalls : 0;\n        const toolUsage = this.calls.reduce((acc, call)=>{\n            acc[call.toolName] = (acc[call.toolName] || 0) + 1;\n            return acc;\n        }, {});\n        return {\n            totalCalls,\n            successfulCalls,\n            failedCalls,\n            totalDuration,\n            averageDuration: Math.round(averageDuration),\n            toolUsage\n        };\n    }\n    getSummary() {\n        const stats = this.getStats();\n        return `\n📊 Tool Call Statistics:\n- Total calls: ${stats.totalCalls}\n- Successful: ${stats.successfulCalls}\n- Failed: ${stats.failedCalls}\n- Total time: ${stats.totalDuration}ms\n- Average time: ${stats.averageDuration}ms\n- Most used: ${Object.entries(stats.toolUsage).sort((a, b)=>b[1] - a[1]).slice(0, 3).map(([tool, count])=>`${tool}(${count})`).join(\", \")}\n    `.trim();\n    }\n    getCalls() {\n        return this.calls;\n    }\n    clear() {\n        this.calls = [];\n    }\n    formatParams(params) {\n        if (typeof params === \"string\") return params;\n        const str = JSON.stringify(params, null, 0);\n        return str.length > 100 ? str.substring(0, 100) + \"...\" : str;\n    }\n    truncateResult(result) {\n        return result.length > 500 ? result.substring(0, 500) + \"...\" : result;\n    }\n    constructor(){\n        this.calls = [];\n        this.sessionId = \"\";\n    }\n}\nconst toolLogger = new ToolCallLogger();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUdDLElBQU1BLENBQUMsQ0FBQyxFQUFFLEdBQUdELENBQUMsQ0FBQyxFQUFFLEVBQzFCRSxLQUFLLENBQUMsR0FBRyxHQUNUQyxHQUFHLENBQUMsQ0FBQyxDQUFDQyxNQUFNQyxNQUFNLEdBQUssQ0FBQyxFQUFFRCxLQUFLLENBQUMsRUFBRUMsTUFBTSxDQUFDLENBQUMsRUFDMUNDLElBQUksQ0FBQyxNQUFNO0lBQ2QsQ0FBQyxDQUFDQyxJQUFJO0lBQ1I7SUFFQUMsV0FBVztRQUNULE9BQU8sSUFBSSxDQUFDakQsS0FBSztJQUNuQjtJQUVBa0QsUUFBUTtRQUNOLElBQUksQ0FBQ2xELEtBQUssR0FBRyxFQUFFO0lBQ2pCO0lBRVFhLGFBQWFzQyxNQUFXLEVBQVU7UUFDeEMsSUFBSSxPQUFPQSxXQUFXLFVBQVUsT0FBT0E7UUFDdkMsTUFBTUMsTUFBTUMsS0FBS0MsU0FBUyxDQUFDSCxRQUFRLE1BQU07UUFDekMsT0FBT0MsSUFBSS9DLE1BQU0sR0FBRyxNQUFNK0MsSUFBSUcsU0FBUyxDQUFDLEdBQUcsT0FBTyxRQUFRSDtJQUM1RDtJQUVRaEMsZUFBZUwsTUFBYyxFQUFVO1FBQzdDLE9BQU9BLE9BQU9WLE1BQU0sR0FBRyxNQUFNVSxPQUFPd0MsU0FBUyxDQUFDLEdBQUcsT0FBTyxRQUFReEM7SUFDbEU7O2FBOUZRZixRQUFvQixFQUFFO2FBQ3RCRCxZQUFvQjs7QUE4RjlCO0FBRU8sTUFBTXlELGFBQWEsSUFBSTNELGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL29wZW5yb3V0ZXItbGFuZ2dyYXBoLy4vbGliL3V0aWxzL3Rvb2wtbG9nZ2VyLnRzP2ZkOTgiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUb29sIENhbGwgTG9nZ2VyXG4gKiBMb2dzIGFsbCB0b29sIGludm9jYXRpb25zIHdpdGggdGltaW5nIGFuZCByZXN1bHRzIGZvciBkZWJ1Z2dpbmcgYW5kIG9wdGltaXphdGlvblxuICovXG5cbmludGVyZmFjZSBUb29sQ2FsbCB7XG4gIHRvb2xOYW1lOiBzdHJpbmc7XG4gIHBhcmFtZXRlcnM6IGFueTtcbiAgc3RhcnRUaW1lOiBudW1iZXI7XG4gIGVuZFRpbWU/OiBudW1iZXI7XG4gIGR1cmF0aW9uPzogbnVtYmVyO1xuICBzdWNjZXNzOiBib29sZWFuO1xuICByZXN1bHQ/OiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5jbGFzcyBUb29sQ2FsbExvZ2dlciB7XG4gIHByaXZhdGUgY2FsbHM6IFRvb2xDYWxsW10gPSBbXTtcbiAgcHJpdmF0ZSBzZXNzaW9uSWQ6IHN0cmluZyA9ICcnO1xuXG4gIHNldFNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpIHtcbiAgICB0aGlzLnNlc3Npb25JZCA9IHNlc3Npb25JZDtcbiAgICB0aGlzLmNhbGxzID0gW107XG4gIH1cblxuICBzdGFydENhbGwodG9vbE5hbWU6IHN0cmluZywgcGFyYW1ldGVyczogYW55KTogbnVtYmVyIHtcbiAgICBjb25zdCBjYWxsSWQgPSB0aGlzLmNhbGxzLmxlbmd0aDtcbiAgICB0aGlzLmNhbGxzLnB1c2goe1xuICAgICAgdG9vbE5hbWUsXG4gICAgICBwYXJhbWV0ZXJzLFxuICAgICAgc3RhcnRUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coYPCflKcgW1RPT0wgU1RBUlRdICR7dG9vbE5hbWV9YCwgdGhpcy5mb3JtYXRQYXJhbXMocGFyYW1ldGVycykpO1xuICAgIHJldHVybiBjYWxsSWQ7XG4gIH1cblxuICBlbmRDYWxsKGNhbGxJZDogbnVtYmVyLCByZXN1bHQ6IHN0cmluZywgc3VjY2VzczogYm9vbGVhbiA9IHRydWUsIGVycm9yPzogc3RyaW5nKSB7XG4gICAgY29uc3QgY2FsbCA9IHRoaXMuY2FsbHNbY2FsbElkXTtcbiAgICBpZiAoIWNhbGwpIHJldHVybjtcblxuICAgIGNhbGwuZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgY2FsbC5kdXJhdGlvbiA9IGNhbGwuZW5kVGltZSAtIGNhbGwuc3RhcnRUaW1lO1xuICAgIGNhbGwuc3VjY2VzcyA9IHN1Y2Nlc3M7XG4gICAgY2FsbC5yZXN1bHQgPSB0aGlzLnRydW5jYXRlUmVzdWx0KHJlc3VsdCk7XG4gICAgY2FsbC5lcnJvciA9IGVycm9yO1xuXG4gICAgY29uc3QgaWNvbiA9IHN1Y2Nlc3MgPyAn4pyFJyA6ICfinYwnO1xuICAgIGNvbnNvbGUubG9nKGAke2ljb259IFtUT09MIEVORF0gJHtjYWxsLnRvb2xOYW1lfSAoJHtjYWxsLmR1cmF0aW9ufW1zKWApO1xuICAgIFxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coYCAgIEVycm9yOiAke2Vycm9yfWApO1xuICAgIH1cbiAgfVxuXG4gIGdldFN0YXRzKCkge1xuICAgIGNvbnN0IHRvdGFsQ2FsbHMgPSB0aGlzLmNhbGxzLmxlbmd0aDtcbiAgICBjb25zdCBzdWNjZXNzZnVsQ2FsbHMgPSB0aGlzLmNhbGxzLmZpbHRlcihjID0+IGMuc3VjY2VzcykubGVuZ3RoO1xuICAgIGNvbnN0IGZhaWxlZENhbGxzID0gdG90YWxDYWxscyAtIHN1Y2Nlc3NmdWxDYWxscztcbiAgICBjb25zdCB0b3RhbER1cmF0aW9uID0gdGhpcy5jYWxscy5yZWR1Y2UoKHN1bSwgYykgPT4gc3VtICsgKGMuZHVyYXRpb24gfHwgMCksIDApO1xuICAgIGNvbnN0IGF2ZXJhZ2VEdXJhdGlvbiA9IHRvdGFsQ2FsbHMgPiAwID8gdG90YWxEdXJhdGlvbiAvIHRvdGFsQ2FsbHMgOiAwO1xuXG4gICAgY29uc3QgdG9vbFVzYWdlID0gdGhpcy5jYWxscy5yZWR1Y2UoKGFjYywgY2FsbCkgPT4ge1xuICAgICAgYWNjW2NhbGwudG9vbE5hbWVdID0gKGFjY1tjYWxsLnRvb2xOYW1lXSB8fCAwKSArIDE7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj4pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsQ2FsbHMsXG4gICAgICBzdWNjZXNzZnVsQ2FsbHMsXG4gICAgICBmYWlsZWRDYWxscyxcbiAgICAgIHRvdGFsRHVyYXRpb24sXG4gICAgICBhdmVyYWdlRHVyYXRpb246IE1hdGgucm91bmQoYXZlcmFnZUR1cmF0aW9uKSxcbiAgICAgIHRvb2xVc2FnZSxcbiAgICB9O1xuICB9XG5cbiAgZ2V0U3VtbWFyeSgpIHtcbiAgICBjb25zdCBzdGF0cyA9IHRoaXMuZ2V0U3RhdHMoKTtcbiAgICByZXR1cm4gYFxu8J+TiiBUb29sIENhbGwgU3RhdGlzdGljczpcbi0gVG90YWwgY2FsbHM6ICR7c3RhdHMudG90YWxDYWxsc31cbi0gU3VjY2Vzc2Z1bDogJHtzdGF0cy5zdWNjZXNzZnVsQ2FsbHN9XG4tIEZhaWxlZDogJHtzdGF0cy5mYWlsZWRDYWxsc31cbi0gVG90YWwgdGltZTogJHtzdGF0cy50b3RhbER1cmF0aW9ufW1zXG4tIEF2ZXJhZ2UgdGltZTogJHtzdGF0cy5hdmVyYWdlRHVyYXRpb259bXNcbi0gTW9zdCB1c2VkOiAke09iamVjdC5lbnRyaWVzKHN0YXRzLnRvb2xVc2FnZSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlcbiAgICAgIC5zbGljZSgwLCAzKVxuICAgICAgLm1hcCgoW3Rvb2wsIGNvdW50XSkgPT4gYCR7dG9vbH0oJHtjb3VudH0pYClcbiAgICAgIC5qb2luKCcsICcpfVxuICAgIGAudHJpbSgpO1xuICB9XG5cbiAgZ2V0Q2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2FsbHM7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICB0aGlzLmNhbGxzID0gW107XG4gIH1cblxuICBwcml2YXRlIGZvcm1hdFBhcmFtcyhwYXJhbXM6IGFueSk6IHN0cmluZyB7XG4gICAgaWYgKHR5cGVvZiBwYXJhbXMgPT09ICdzdHJpbmcnKSByZXR1cm4gcGFyYW1zO1xuICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KHBhcmFtcywgbnVsbCwgMCk7XG4gICAgcmV0dXJuIHN0ci5sZW5ndGggPiAxMDAgPyBzdHIuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLi4uJyA6IHN0cjtcbiAgfVxuXG4gIHByaXZhdGUgdHJ1bmNhdGVSZXN1bHQocmVzdWx0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiByZXN1bHQubGVuZ3RoID4gNTAwID8gcmVzdWx0LnN1YnN0cmluZygwLCA1MDApICsgJy4uLicgOiByZXN1bHQ7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHRvb2xMb2dnZXIgPSBuZXcgVG9vbENhbGxMb2dnZXIoKTtcbiJdLCJuYW1lcyI6WyJUb29sQ2FsbExvZ2dlciIsInNldFNlc3Npb24iLCJzZXNzaW9uSWQiLCJjYWxscyIsInN0YXJ0Q2FsbCIsInRvb2xOYW1lIiwicGFyYW1ldGVycyIsImNhbGxJZCIsImxlbmd0aCIsInB1c2giLCJzdGFydFRpbWUiLCJEYXRlIiwibm93Iiwic3VjY2VzcyIsImNvbnNvbGUiLCJsb2ciLCJmb3JtYXRQYXJhbXMiLCJlbmRDYWxsIiwicmVzdWx0IiwiZXJyb3IiLCJjYWxsIiwiZW5kVGltZSIsImR1cmF0aW9uIiwidHJ1bmNhdGVSZXN1bHQiLCJpY29uIiwiZ2V0U3RhdHMiLCJ0b3RhbENhbGxzIiwic3VjY2Vzc2Z1bENhbGxzIiwiZmlsdGVyIiwiYyIsImZhaWxlZENhbGxzIiwidG90YWxEdXJhdGlvbiIsInJlZHVjZSIsInN1bSIsImF2ZXJhZ2VEdXJhdGlvbiIsInRvb2xVc2FnZSIsImFjYyIsIk1hdGgiLCJyb3VuZCIsImdldFN1bW1hcnkiLCJzdGF0cyIsIk9iamVjdCIsImVudHJpZXMiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsIm1hcCIsInRvb2wiLCJjb3VudCIsImpvaW4iLCJ0cmltIiwiZ2V0Q2FsbHMiLCJjbGVhciIsInBhcmFtcyIsInN0ciIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWJzdHJpbmciLCJ0b29sTG9nZ2VyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/tool-logger.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/formdata-node@4.4.1","vendor-chunks/@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76_","vendor-chunks/openai@6.7.0_ws@8.18.3_zod@3.25.76","vendor-chunks/semver@7.7.3","vendor-chunks/@langchain+langgraph@1.0.1_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___r_79a741b742ae68db3a00eb54de512e24","vendor-chunks/@langchain+openai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76___ws@8.18.3","vendor-chunks/zod@3.25.76","vendor-chunks/langsmith@0.3.74_openai@6.7.0_ws@8.18.3_zod@3.25.76_","vendor-chunks/groq-sdk@0.19.0","vendor-chunks/@langchain+langgraph-checkpoint@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__","vendor-chunks/uuid@10.0.0","vendor-chunks/form-data-encoder@1.7.2","vendor-chunks/@cfworker+json-schema@4.1.1","vendor-chunks/@langchain+google-genai@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__","vendor-chunks/uuid@11.1.0","vendor-chunks/whatwg-url@5.0.0","vendor-chunks/agentkeepalive@4.6.0","vendor-chunks/retry@0.13.1","vendor-chunks/p-queue@6.6.2","vendor-chunks/js-tiktoken@1.0.21","vendor-chunks/@langchain+groq@1.0.0_@langchain+core@1.0.1_openai@6.7.0_ws@8.18.3_zod@3.25.76__","vendor-chunks/tr46@0.0.3","vendor-chunks/web-streams-polyfill@4.0.0-beta.3","vendor-chunks/node-fetch@2.7.0","vendor-chunks/mustache@4.2.0","vendor-chunks/@google+generative-ai@0.24.1","vendor-chunks/webidl-conversions@3.0.1","vendor-chunks/p-timeout@3.2.0","vendor-chunks/p-retry@4.6.2","vendor-chunks/p-finally@1.0.0","vendor-chunks/ms@2.1.3","vendor-chunks/humanize-ms@1.2.1","vendor-chunks/eventemitter3@4.0.7","vendor-chunks/event-target-shim@5.0.1","vendor-chunks/decamelize@1.2.0","vendor-chunks/camelcase@6.3.0","vendor-chunks/base64-js@1.5.1","vendor-chunks/ansi-styles@5.2.0","vendor-chunks/abort-controller@3.0.0"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.5_@playwright+test@1.56.1_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2FApple%2FDesktop%2FNextLovable%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2FApple%2FDesktop%2FNextLovable&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();